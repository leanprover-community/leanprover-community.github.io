<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="https://leanprover-community.github.io//css/lean.css" >
  <link rel="shortcut icon" href="https://leanprover-community.github.io//img/favicon.ico">
  <link rel="search" type="application/opensearchdescription+xml" title="mathlib docs" href="https://leanprover-community.github.io//opensearch.xml">
  <link href="https://fonts.googleapis.com/css2?family=Merriweather&family=Open+Sans&family=Source+Code+Pro:wght@400;600&display=swap" rel="stylesheet">
    

	<script>
                function buildShortcutsForStructures(names) {
                        const o = {}
                        names.forEach(name => o[name] = `\\mathbb\{${name}\}`)
                        return o
                }
		MathJax = {
			  tex: {
                                  macros: {
                                          ...buildShortcutsForStructures(["R", "Q", "Z", "N", "C"]),
                                  },
				      inlineMath: [['$', '$'], ['\\(', '\\)']]
				    },
		};
	</script>
	<script type="text/javascript" id="MathJax-script" async
		  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
	</script>

	<title>Library Style Guidelines</title>
  </head>
  <body>
  <nav class="navbar navbar-expand-lg navbar-light bg-gradient-light d-md-none">
    <div class="d-flex flex-grow-1">
		<a class="navbar-brand" href="https://leanprover-community.github.io/index.html">Lean Community
    </a>
    </div>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  </nav>

<div id="mainbox">

  <main>
    
<h1 id="library-style-guidelines" class="markdown-heading">Library Style Guidelines <a class="hover-link" href="#library-style-guidelines">#</a></h1>
<p>In addition to the <a href="naming.html">naming conventions</a>,
files in the Lean library generally adhere to the following guidelines
and conventions. Having a uniform style makes it easier to browse the
library and read the contents, but these are meant to be guidelines
rather than rigid rules.</p>
<h3 id="variable-conventions" class="markdown-heading">Variable conventions <a class="hover-link" href="#variable-conventions">#</a></h3>
<ul>
<li><code>u</code>, <code>v</code>, <code>w</code>, ... for universes</li>
<li><code>Œ±</code>, <code>Œ≤</code>, <code>Œ≥</code>, ... for generic types</li>
<li><code>a</code>, <code>b</code>, <code>c</code>, ... for propositions</li>
<li><code>x</code>, <code>y</code>, <code>z</code>, ... for elements of a generic type</li>
<li><code>h</code>, <code>h‚ÇÅ</code>, ...     for assumptions</li>
<li><code>p</code>, <code>q</code>, <code>r</code>, ... for predicates and relations</li>
<li><code>s</code>, <code>t</code>, ...      for lists</li>
<li><code>s</code>, <code>t</code>, ...      for sets</li>
<li><code>m</code>, <code>n</code>, <code>k</code>, ... for natural numbers</li>
<li><code>i</code>, <code>j</code>, <code>k</code>, ... for integers</li>
</ul>
<p>Types with a mathematical content are expressed with the usual
mathematical notation, often with an upper case letter
(<code>G</code> for a group, <code>R</code> for a ring, <code>K</code> or <code>ùïú</code> for a field, <code>E</code> for a vector space, ...).
This convention is not followed in older files, where greek letters are used
for all types. Pull requests renaming type variables in these files are welcome.</p>
<h3 id="line-length" class="markdown-heading">Line length <a class="hover-link" href="#line-length">#</a></h3>
<p>Lines should not be longer than 100 characters. This makes files
easier to read, especially on a small screen or in a small window.
If you are editing with VS Code, there is a visual marker which
will indicate a 100 character limit.</p>
<h3 id="header-and-imports" class="markdown-heading">Header and imports <a class="hover-link" href="#header-and-imports">#</a></h3>
<p>The file header should contain copyright information, a list of all
the authors who have made significant contributions to the file, and
a description of the contents. Do all <code>import</code>s right after the header,
without a line break, on separate lines.</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="c">/-</span>
<span class="cm">Copyright (c) 2024 Joe Cool. All rights reserved.</span>
<span class="cm">Released under Apache 2.0 license as described in the file LICENSE.</span>
<span class="cm">Authors: Joe Cool</span>
<span class="cm">-/</span>
<span class="kn">import</span><span class="w"> </span><span class="n">Mathlib.Data.Nat.Basic</span>
<span class="kn">import</span><span class="w"> </span><span class="n">Mathlib.Algebra.Group.Defs</span>
</code></pre></div>
</div>

<p>(Tip: If you're editing mathlib in VS Code, you can write <code>copy</code>
and then press <kbd>TAB</kbd> to generate a skeleton of the copyright header.)</p>
<p>Regarding the list of authors: use <code>Authors</code> even when there is only a single author.
Don't end the line with a period, and use commas (<code>, </code>) to separate all author names
(so don't use <code>and</code> between the penultimate and final author.)
We don't have strict rules on what contributions qualify for inclusion there.
The general idea is that the people listed there should be the ones we would
reach out to if we had questions about the design or development of the Lean code.</p>
<h3 id="module-docstrings" class="markdown-heading">Module docstrings <a class="hover-link" href="#module-docstrings">#</a></h3>
<p>After the copyright header and the imports,
please add a module docstring (delimited with <code>/-!</code> and <code>-/</code>) containing</p>
<ul>
<li>a title of the file,</li>
<li>a summary of the contents (the main definitions and theorems, proof techniques, etc‚Ä¶)</li>
<li>notation that has been used in the file (if any)</li>
<li>references to the literature (if any)</li>
</ul>
<p>In total, the module docstring should look something like this:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code>/-!
<span class="gh"># Foos and bars</span>

In this file we introduce <span class="sb">`foo`</span> and <span class="sb">`bar`</span>,
two main concepts in the theory of xyzzyology.

<span class="gu">## Main results</span>

<span class="k">-</span><span class="w"> </span><span class="sb">`exists_foo`</span>: the main existence theorem of <span class="sb">`foo`</span>s.
<span class="k">-</span><span class="w"> </span><span class="sb">`bar_of_foo_of_baz`</span>: a construction of a <span class="sb">`bar`</span>, given a <span class="sb">`foo`</span> and a <span class="sb">`baz`</span>.
  If this doc-string is longer than one line, subsequent lines should be indented by two spaces
  (as required by markdown syntax).
<span class="k">-</span><span class="w"> </span><span class="sb">`bar_eq`</span>    : the main classification theorem of <span class="sb">`bar`</span>s.

<span class="gu">## Notation</span>

<span class="w"> </span><span class="k">-</span><span class="w"> </span><span class="sb">`|_|`</span> : The barrification operator, see <span class="sb">`bar_of_foo`</span>.

<span class="gu">## References</span>

See [Thales600BC] for the original account on Xyzzyology.
-/
</code></pre></div>
</div>

<p>New bibliography entries should be added to <code>docs/references.bib</code>.</p>
<p>See our <a href="doc.html">documentation requirements</a> for more suggestions and examples.</p>
<h3 id="structuring-definitions-and-theorems" class="markdown-heading">Structuring definitions and theorems <a class="hover-link" href="#structuring-definitions-and-theorems">#</a></h3>
<p>All declarations (e.g., <code>def</code>, <code>lemma</code>, <code>theorem</code>, <code>class</code>, <code>structure</code>, <code>inductive</code>, <code>instance</code>, etc.)
and commands (e.g., <code>variable</code>, <code>open</code>, <code>section</code>, <code>namespace</code>, <code>notation</code>, etc.) are considered
top-level and these words should appear flush-left in the document. In particular, opening a
namespace or section does not result in indenting the contents of that namespace or section.
(Note: within VS Code, hovering over any declaration such as <code>def Foo ...</code> will show the fully
qualified name, like <code>MyNamespace Foo</code> if <code>Foo</code> is declared while the namespace <code>MyNamespace</code> is open.)</p>
<p>These guidelines hold for declarations starting with <code>def</code>, <code>lemma</code> and <code>theorem</code>.
For &quot;theorem statement&quot;, also read &quot;type of a definition&quot; and for &quot;proof&quot; also read
&quot;definition body&quot;.</p>
<p>Use spaces on both sides of &quot;:&quot;, &quot;:=&quot; or infix operators. Put them before a line break
rather than at the beginning of the next line.</p>
<p>In what follows, &quot;indent&quot; without an explicit indication of the amount means
&quot;indent by 2 additional spaces&quot;.</p>
<p>After stating the theorem, we indent the lines in the subsequent proof by 2 spaces.</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kn">open</span><span class="w"> </span><span class="n">Nat</span>
<span class="kd">theorem</span><span class="w"> </span><span class="n">nat_case</span><span class="w"> </span><span class="o">{</span><span class="n">P</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Nat</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="kt">Prop</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Nat</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">H1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">H2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="n">m</span><span class="o">,</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">(</span><span class="n">succ</span><span class="w"> </span><span class="n">m</span><span class="o">))</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">:=</span>
<span class="w">  </span><span class="n">Nat.recOn</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">H1</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">IH</span><span class="w"> </span><span class="bp">‚Ü¶</span><span class="w"> </span><span class="n">H2</span><span class="w"> </span><span class="n">m</span><span class="o">)</span>
</code></pre></div>
</div>

<p>If the theorem statement requires multiple lines, indent the subsequent lines by 4 spaces.
The proof is still indented only 2 spaces (<em>not</em> 6 = 4 + 2).
When providing a proof in tactic mode, the <code>by</code> is placed on the line <em>prior</em> to the
first tactic; however, <code>by</code> should not be placed on a line by itself.
In practice this means you will often see <code>:= by</code> at the end of a theorem statement.</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="n">Mathlib.Data.Nat.Basic</span>

<span class="kd">theorem</span><span class="w"> </span><span class="n">le_induction</span><span class="w"> </span><span class="o">{</span><span class="n">P</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Nat</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="kt">Prop</span><span class="o">}</span><span class="w"> </span><span class="o">{</span><span class="n">m</span><span class="o">}</span>
<span class="w">    </span><span class="o">(</span><span class="n">h0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">m</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="bp">‚â§</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">1</span><span class="o">))</span><span class="w"> </span><span class="o">:</span>
<span class="w">    </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="bp">‚â§</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">by</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">Nat.le.rec</span>
<span class="w">  </span><span class="bp">¬∑</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">h0</span>
<span class="w">  </span><span class="bp">¬∑</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">h1</span><span class="w"> </span><span class="n">_</span>

<span class="kd">def</span><span class="w"> </span><span class="n">decreasingInduction</span><span class="w"> </span><span class="o">{</span><span class="n">P</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">‚Ñï</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="kt">Sort</span><span class="bp">*</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">1</span><span class="o">)</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">n</span><span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="n">m</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">‚Ñï</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="n">mn</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="bp">‚â§</span><span class="w"> </span><span class="n">n</span><span class="o">)</span>
<span class="w">    </span><span class="o">(</span><span class="n">hP</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">n</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">:=</span>
<span class="w">  </span><span class="n">Nat.leRecOn</span><span class="w"> </span><span class="n">mn</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">{</span><span class="n">k</span><span class="o">}</span><span class="w"> </span><span class="n">ih</span><span class="w"> </span><span class="n">hsk</span><span class="w"> </span><span class="bp">=&gt;</span><span class="w"> </span><span class="n">ih</span><span class="w"> </span><span class="bp">&lt;|</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="n">hsk</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="bp">=&gt;</span><span class="w"> </span><span class="n">h</span><span class="o">)</span><span class="w"> </span><span class="n">hP</span>
</code></pre></div>
</div>

<p>When a proof term takes multiple arguments, it is sometimes clearer, and often
necessary, to put some of the arguments on subsequent lines. In that case,
indent each argument. This rule, i.e., indent an additional two spaces, applies
more generally whenever a term spans multiple lines.</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kn">open</span><span class="w"> </span><span class="n">Nat</span>
<span class="kd">axiom</span><span class="w"> </span><span class="n">zero_or_succ</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Nat</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="bp">‚à®</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">succ</span><span class="w"> </span><span class="o">(</span><span class="n">pred</span><span class="w"> </span><span class="n">n</span><span class="o">)</span>
<span class="kd">theorem</span><span class="w"> </span><span class="n">nat_discriminate</span><span class="w"> </span><span class="o">{</span><span class="n">B</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">}</span><span class="w"> </span><span class="o">{</span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Nat</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="n">H1</span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="n">B</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">H2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="n">m</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">succ</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="n">B</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">:=</span>
<span class="w">  </span><span class="n">Or.elim</span><span class="w"> </span><span class="o">(</span><span class="n">zero_or_succ</span><span class="w"> </span><span class="n">n</span><span class="o">)</span>
<span class="w">    </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">H3</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="bp">‚Ü¶</span><span class="w"> </span><span class="n">H1</span><span class="w"> </span><span class="n">H3</span><span class="o">)</span>
<span class="w">    </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">H3</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">succ</span><span class="w"> </span><span class="o">(</span><span class="n">pred</span><span class="w"> </span><span class="n">n</span><span class="o">)</span><span class="w"> </span><span class="bp">‚Ü¶</span><span class="w"> </span><span class="n">H2</span><span class="w"> </span><span class="o">(</span><span class="n">pred</span><span class="w"> </span><span class="n">n</span><span class="o">)</span><span class="w"> </span><span class="n">H3</span><span class="o">)</span>
</code></pre></div>
</div>

<p>Don't orphan parentheses; keep them with their arguments.</p>
<p>Here is a longer example.</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="n">Mathlib.Init.Data.List.Lemmas</span>

<span class="kn">open</span><span class="w"> </span><span class="n">List</span>
<span class="kd">variable</span><span class="w"> </span><span class="o">{</span><span class="n">T</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="o">}</span>

<span class="kd">theorem</span><span class="w"> </span><span class="n">mem_split</span><span class="w"> </span><span class="o">{</span><span class="n">x</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">T</span><span class="o">}</span><span class="w"> </span><span class="o">{</span><span class="n">l</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">List</span><span class="w"> </span><span class="n">T</span><span class="o">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">‚àà</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="bp">‚àÉ</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">List</span><span class="w"> </span><span class="n">T</span><span class="o">,</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">t</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span>
<span class="w">  </span><span class="n">List.recOn</span><span class="w"> </span><span class="n">l</span>
<span class="w">    </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">‚àà</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="bp">‚Ü¶</span><span class="w"> </span><span class="n">False.elim</span><span class="w"> </span><span class="o">((</span><span class="n">mem_nil_iff</span><span class="w"> </span><span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span><span class="w"> </span><span class="n">H</span><span class="o">))</span>
<span class="w">    </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="bp">‚Ü¶</span>
<span class="w">      </span><span class="k">fun</span><span class="w"> </span><span class="n">IH</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">‚àà</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="bp">‚àÉ</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">List</span><span class="w"> </span><span class="n">T</span><span class="o">,</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">t</span><span class="o">)</span><span class="w"> </span><span class="bp">‚Ü¶</span>
<span class="w">      </span><span class="k">fun</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">‚àà</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="bp">‚Ü¶</span>
<span class="w">      </span><span class="n">Or.elim</span><span class="w"> </span><span class="o">(</span><span class="n">eq_or_mem_of_mem_cons</span><span class="w"> </span><span class="n">H</span><span class="o">)</span>
<span class="w">        </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">H1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">‚Ü¶</span>
<span class="w">          </span><span class="n">Exists.intro</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="o">(</span><span class="n">Exists.intro</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">(</span><span class="kd">by</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">H1</span><span class="o">]</span><span class="bp">;</span><span class="w"> </span><span class="n">rfl</span><span class="o">)))</span>
<span class="w">        </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">H1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">‚àà</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="bp">‚Ü¶</span>
<span class="w">          </span><span class="k">let</span><span class="w"> </span><span class="o">‚ü®</span><span class="n">s</span><span class="o">,</span><span class="w"> </span><span class="o">(</span><span class="n">H2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">‚àÉ</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">List</span><span class="w"> </span><span class="n">T</span><span class="o">,</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">t</span><span class="o">))‚ü©</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">IH</span><span class="w"> </span><span class="n">H1</span>
<span class="w">          </span><span class="k">let</span><span class="w"> </span><span class="o">‚ü®</span><span class="n">t</span><span class="o">,</span><span class="w"> </span><span class="o">(</span><span class="n">H3</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">t</span><span class="o">))‚ü©</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">H2</span>
<span class="w">          </span><span class="k">have</span><span class="w"> </span><span class="n">H4</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">y</span><span class="w">  </span><span class="o">::</span><span class="w">  </span><span class="n">l</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="o">(</span><span class="n">y</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">s</span><span class="o">)</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">t</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">by</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">H3</span><span class="o">]</span><span class="bp">;</span><span class="w"> </span><span class="n">rfl</span>
<span class="w">          </span><span class="n">Exists.intro</span><span class="w"> </span><span class="o">(</span><span class="n">y</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">s</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">Exists.intro</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="n">H4</span><span class="o">)))</span>
</code></pre></div>
</div>

<p>A short declaration can be written on a single line:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kn">open</span><span class="w"> </span><span class="n">Nat</span>
<span class="kd">theorem</span><span class="w"> </span><span class="n">succ_pos</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Nat</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">&lt;</span><span class="w"> </span><span class="n">succ</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">zero_lt_succ</span>

<span class="kd">def</span><span class="w"> </span><span class="n">square</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Nat</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Nat</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">x</span>
</code></pre></div>
</div>

<p>A <code>have</code> can be put on a single line when the justification is short.</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Nat</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">&lt;</span><span class="w"> </span><span class="n">k</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">...</span><span class="w"> </span><span class="o">:=</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="n">h1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">‚â†</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">ne_of_lt</span><span class="w"> </span><span class="n">h</span>
<span class="w">  </span><span class="bp">...</span>
</code></pre></div>
</div>

<p>When the justification is too long, you should put it on the next line,
indented by an additional two spaces.</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Nat</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">&lt;</span><span class="w"> </span><span class="n">k</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">...</span><span class="w"> </span><span class="o">:=</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="n">h1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">‚â†</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:=</span>
<span class="w">    </span><span class="n">ne_of_lt</span><span class="w"> </span><span class="n">h</span>
<span class="w">  </span><span class="bp">...</span>
</code></pre></div>
</div>

<p>When the justification of the <code>have</code> uses tactic mode, the <code>by</code> should
be placed on the same line, regardless of whether the justification
spans multiple lines.</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Nat</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">&lt;</span><span class="w"> </span><span class="n">k</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">...</span><span class="w"> </span><span class="o">:=</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="n">h1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">‚â†</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">by</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="n">ne_of_lt</span><span class="bp">;</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">h</span>
<span class="w">  </span><span class="bp">...</span>

<span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Nat</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">&lt;</span><span class="w"> </span><span class="n">k</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">...</span><span class="w"> </span><span class="o">:=</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="n">h1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">‚â†</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">by</span>
<span class="w">    </span><span class="n">apply</span><span class="w"> </span><span class="n">ne_of_lt</span>
<span class="w">    </span><span class="n">exact</span><span class="w"> </span><span class="n">h</span>
<span class="w">  </span><span class="bp">...</span>
</code></pre></div>
</div>

<p>When the arguments themselves are long enough to require line breaks, use
an additional indent for every line after the first, as in the following
example:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="n">Mathlib.Data.Nat.Basic</span>

<span class="kd">theorem</span><span class="w"> </span><span class="n">Nat.add_right_inj</span><span class="w"> </span><span class="o">{</span><span class="n">n</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Nat</span><span class="o">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:=</span>
<span class="w">  </span><span class="n">Nat.recOn</span><span class="w"> </span><span class="n">n</span>
<span class="w">    </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="bp">‚Ü¶</span><span class="w"> </span><span class="k">calc</span>
<span class="w">      </span><span class="n">m</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">Eq.symm</span><span class="w"> </span><span class="o">(</span><span class="n">zero_add</span><span class="w"> </span><span class="n">m</span><span class="o">)</span>
<span class="w">      </span><span class="n">_</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">H</span>
<span class="w">      </span><span class="n">_</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">k</span><span class="w">     </span><span class="o">:=</span><span class="w"> </span><span class="n">zero_add</span><span class="w"> </span><span class="n">_</span><span class="o">)</span>
<span class="w">    </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Nat</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">IH</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">k</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">H</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">succ</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">succ</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">k</span><span class="o">)</span><span class="w"> </span><span class="bp">‚Ü¶</span>
<span class="w">      </span><span class="k">have</span><span class="w"> </span><span class="n">H2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">succ</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">m</span><span class="o">)</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">succ</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">k</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">calc</span>
<span class="w">        </span><span class="n">succ</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">m</span><span class="o">)</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">succ</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">m</span><span class="w">   </span><span class="o">:=</span><span class="w"> </span><span class="n">Eq.symm</span><span class="w"> </span><span class="o">(</span><span class="n">succ_add</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">m</span><span class="o">)</span>
<span class="w">        </span><span class="n">_</span><span class="w">            </span><span class="bp">=</span><span class="w"> </span><span class="n">succ</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">k</span><span class="w">   </span><span class="o">:=</span><span class="w"> </span><span class="n">H</span>
<span class="w">        </span><span class="n">_</span><span class="w">            </span><span class="bp">=</span><span class="w"> </span><span class="n">succ</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">k</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">succ_add</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">k</span>
<span class="w">      </span><span class="k">have</span><span class="w"> </span><span class="n">H3</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">succ.inj</span><span class="w"> </span><span class="n">H2</span>
<span class="w">      </span><span class="n">IH</span><span class="w"> </span><span class="n">H3</span><span class="o">)</span>
</code></pre></div>
</div>

<p>In a class or structure definition, fields are indented 2 spaces, and moreover
each field should have a docstring, as in:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">structure</span><span class="w"> </span><span class="n">PrincipalSeg</span><span class="w"> </span><span class="o">{</span><span class="n">Œ±</span><span class="w"> </span><span class="n">Œ≤</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="bp">*</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="n">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Œ±</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="n">Œ±</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">s</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Œ≤</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="n">Œ≤</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="kt">Prop</span><span class="o">)</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="bp">‚Ü™</span><span class="n">r</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="n">where</span>
<span class="w">  </span><span class="sd">/-- The supremum of the principal segment -/</span>
<span class="w">  </span><span class="n">top</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Œ≤</span>
<span class="w">  </span><span class="sd">/-- The image of the order embedding is the set of elements `b` such that `s b top` -/</span>
<span class="w">  </span><span class="n">down&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="bp">‚Üî</span><span class="w"> </span><span class="bp">‚àÉ</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">toRelEmbedding</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">b</span>

<span class="kd">class</span><span class="w"> </span><span class="n">Module</span><span class="w"> </span><span class="o">(</span><span class="n">R</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="w"> </span><span class="n">u</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">M</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="w"> </span><span class="n">v</span><span class="o">)</span><span class="w"> </span><span class="o">[</span><span class="n">Semiring</span><span class="w"> </span><span class="n">R</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">AddCommMonoid</span><span class="w"> </span><span class="n">M</span><span class="o">]</span><span class="w"> </span><span class="kd">extends</span>
<span class="w">    </span><span class="n">DistribMulAction</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="n">where</span>
<span class="w">  </span><span class="sd">/-- Scalar multiplication distributes over addition from the right. -/</span>
<span class="w">  </span><span class="kn">protected</span><span class="w"> </span><span class="n">add_smul</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="o">(</span><span class="n">r</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">R</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">M</span><span class="o">),</span><span class="w"> </span><span class="o">(</span><span class="n">r</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">s</span><span class="o">)</span><span class="w"> </span><span class="bp">‚Ä¢</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="bp">‚Ä¢</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="bp">‚Ä¢</span><span class="w"> </span><span class="n">x</span>
<span class="w">  </span><span class="sd">/-- Scalar multiplication by zero gives zero. -/</span>
<span class="w">  </span><span class="kn">protected</span><span class="w"> </span><span class="n">zero_smul</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">M</span><span class="o">,</span><span class="w"> </span><span class="o">(</span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">R</span><span class="o">)</span><span class="w"> </span><span class="bp">‚Ä¢</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div>
</div>

<p>When using a constructor taking several arguments in a definition,
arguments line up, as in:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">theorem</span><span class="w"> </span><span class="n">Ordinal.sub_eq_zero_iff_le</span><span class="w"> </span><span class="o">{</span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Ordinal</span><span class="o">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">-</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">‚Üî</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">‚â§</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span>
<span class="w">  </span><span class="o">‚ü®</span><span class="k">fun</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="bp">=&gt;</span><span class="w"> </span><span class="kd">by</span><span class="w"> </span><span class="n">simpa</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="o">[</span><span class="n">h</span><span class="o">,</span><span class="w"> </span><span class="n">add_zero</span><span class="o">]</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">le_add_sub</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="o">,</span>
<span class="w">   </span><span class="k">fun</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="bp">=&gt;</span><span class="w"> </span><span class="kd">by</span><span class="w"> </span><span class="n">rwa</span><span class="w"> </span><span class="o">[</span><span class="bp">‚Üê</span><span class="w"> </span><span class="n">Ordinal.le_zero</span><span class="o">,</span><span class="w"> </span><span class="n">sub_le</span><span class="o">,</span><span class="w"> </span><span class="n">add_zero</span><span class="o">]‚ü©</span>
</code></pre></div>
</div>

<h3 id="instances" class="markdown-heading">Instances <a class="hover-link" href="#instances">#</a></h3>
<p>When providing terms of structures or instances of classes, the <code>where</code>
syntax should be used to avoid the need for enclosing braces, as in:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">instance</span><span class="w"> </span><span class="n">instOrderBot</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">OrderBot</span><span class="w"> </span><span class="n">‚Ñï</span><span class="w"> </span><span class="n">where</span>
<span class="w">  </span><span class="n">bot</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">  </span><span class="n">bot_le</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">Nat.zero_le</span>
</code></pre></div>
</div>

<p>If there is already an instance <code>instBot</code>, then one can write</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">instance</span><span class="w"> </span><span class="n">instOrderBot</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">OrderBot</span><span class="w"> </span><span class="n">‚Ñï</span><span class="w"> </span><span class="n">where</span>
<span class="w">  </span><span class="n">__</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">instBot</span>
<span class="w">  </span><span class="n">bot_le</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">Nat.zero_le</span>
</code></pre></div>
</div>

<h3 id="hypotheses-left-of-colon" class="markdown-heading">Hypotheses Left of Colon <a class="hover-link" href="#hypotheses-left-of-colon">#</a></h3>
<p>Generally, having arguments to the left of the colon is preferred
over having arguments in universal quantifiers or implications,
if the proof starts by introducing these variables. For instance:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">‚Ñù</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="bp">&lt;</span><span class="w"> </span><span class="n">n</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">&lt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">by</span><span class="w"> </span><span class="n">linarith</span>
</code></pre></div>
</div>

<p>is preferred over</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">‚Ñù</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="bp">&lt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">&lt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="bp">‚Ü¶</span><span class="w"> </span><span class="kd">by</span><span class="w"> </span><span class="n">linarith</span>
</code></pre></div>
</div>

<p>and</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">example</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">‚Ñï</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">‚â§</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">Nat.zero_le</span><span class="w"> </span><span class="n">n</span>
</code></pre></div>
</div>

<p>is preferred over</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="o">(</span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">‚Ñï</span><span class="o">),</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">‚â§</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">Nat.zero_le</span>
</code></pre></div>
</div>

<p>Note that pattern-matching does not count as the proof starting by introducing variables.
For example, the following is a valid use case of having a hypothesis right of the column:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">lemma</span><span class="w"> </span><span class="n">zero_le</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">‚Ñï</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">‚â§</span><span class="w"> </span><span class="n">n</span>
<span class="w">  </span><span class="bp">|</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">=&gt;</span><span class="w"> </span><span class="n">le_rfl</span>
<span class="w">  </span><span class="bp">|</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="bp">=&gt;</span><span class="w"> </span><span class="n">add_nonneg</span><span class="w"> </span><span class="o">(</span><span class="n">zero_le</span><span class="w"> </span><span class="n">n</span><span class="o">)</span><span class="w"> </span><span class="n">zero_le_one</span>
</code></pre></div>
</div>

<h3 id="binders" class="markdown-heading">Binders <a class="hover-link" href="#binders">#</a></h3>
<p>Use a space after binders:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="n">Œ±</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="o">,</span><span class="w"> </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Œ±</span><span class="o">,</span><span class="w"> </span><span class="bp">‚àÉ</span><span class="w"> </span><span class="n">y</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:=</span>
<span class="w">  </span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">Œ±</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Œ±</span><span class="o">)</span><span class="w"> </span><span class="bp">‚Ü¶</span><span class="w"> </span><span class="n">Exists.intro</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">rfl</span>
</code></pre></div>
</div>

<h3 id="anonymous-functions" class="markdown-heading">Anonymous functions <a class="hover-link" href="#anonymous-functions">#</a></h3>
<p>Lean has several nice syntax options for declaring anonymous functions. For very simple
functions, one can use the centered dot as the function argument, as in <code>(¬∑ ^ 2)</code> to
represent the squaring function. However, sometimes it is necessary to refer to the
arguments by name (e.g., if they appear in multiple places in the function body). The
Lean default for this is <code>fun x =&gt; x * x</code>, but the <code>‚Ü¶</code> arrow (inserted with <code>\mapsto</code>)
is also valid. In mathlib the pretty printer displays <code>‚Ü¶</code>, and we slightly prefer this
in the source as well.  The lambda notation <code>Œª x ‚Ü¶ x * x</code>, while syntactically valid,
is disallowed in mathlib in favor of the <code>fun</code> keyword.</p>
<h3 id="calculations" class="markdown-heading">Calculations <a class="hover-link" href="#calculations">#</a></h3>
<p>There is some flexibility in how you write calculational proofs, although there are some
rules enforced by the syntax requirements of <code>calc</code> itself. However, there are some general
guidelines.</p>
<p>As with <code>by</code>, the <code>calc</code> keyword should be placed on the line <em>prior</em> to the start of the
calculation, with the calculation indented. Whichever relations are involved (e.g.,
<code>=</code> or <code>‚â§</code>) should be aligned from one line to the next. The underscores <code>_</code> used as
placeholders for terms indicating the continuation of the calculation should be left-justified.</p>
<p>As for the justifications, it is not necessary to align the <code>:=</code> symbols, but it can be
nice if the expressions are short enough. The terms on either side of the first relation can either
go on one line or separate lines, which may be decided by the size of the expressions.</p>
<p>An example of adequate style which can more easily accommodate longer expressions is:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="n">Init.Data.List.Basic</span>

<span class="kn">open</span><span class="w"> </span><span class="n">List</span>

<span class="kd">theorem</span><span class="w"> </span><span class="n">reverse_reverse</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="o">(</span><span class="n">l</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">List</span><span class="w"> </span><span class="n">Œ±</span><span class="o">),</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="n">l</span><span class="o">)</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">l</span>
<span class="w">  </span><span class="bp">|</span><span class="w"> </span><span class="o">[]</span><span class="w">     </span><span class="bp">=&gt;</span><span class="w"> </span><span class="n">rfl</span>
<span class="w">  </span><span class="bp">|</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="bp">=&gt;</span><span class="w"> </span><span class="k">calc</span>
<span class="w">    </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">l</span><span class="o">))</span>
<span class="w">      </span><span class="bp">=</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="o">[</span><span class="n">a</span><span class="o">])</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">by</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">reverse_cons</span><span class="o">]</span>
<span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="o">[</span><span class="n">a</span><span class="o">]</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="n">l</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">reverse_append</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="n">_</span>
<span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="o">[</span><span class="n">a</span><span class="o">]</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">by</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">reverse_reverse</span><span class="w"> </span><span class="n">l</span><span class="o">]</span>
<span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">rfl</span>
</code></pre></div>
</div>

<p>The following style has the substantial advantage of having all lines be interchangeable, which is
particularly useful when editing the proof in eg VSCode:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="n">Init.Data.List.Basic</span>

<span class="kn">open</span><span class="w"> </span><span class="n">List</span>

<span class="kd">theorem</span><span class="w"> </span><span class="n">reverse_reverse</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="o">(</span><span class="n">l</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">List</span><span class="w"> </span><span class="n">Œ±</span><span class="o">),</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="n">l</span><span class="o">)</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">l</span>
<span class="w">  </span><span class="bp">|</span><span class="w"> </span><span class="o">[]</span><span class="w">     </span><span class="bp">=&gt;</span><span class="w"> </span><span class="n">rfl</span>
<span class="w">  </span><span class="bp">|</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="bp">=&gt;</span><span class="w"> </span><span class="k">calc</span>
<span class="w">        </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">l</span><span class="o">))</span>
<span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="o">[</span><span class="n">a</span><span class="o">])</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">by</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">reverse_cons</span><span class="o">]</span>
<span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="o">[</span><span class="n">a</span><span class="o">]</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="n">l</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">reverse_append</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="n">_</span>
<span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="o">[</span><span class="n">a</span><span class="o">]</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">by</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">reverse_reverse</span><span class="w"> </span><span class="n">l</span><span class="o">]</span>
<span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">rfl</span>
</code></pre></div>
</div>

<p>If the expressions and proofs are relatively short, the following style is also an option:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="n">Init.Data.List.Basic</span>

<span class="kn">open</span><span class="w"> </span><span class="n">List</span>

<span class="kd">theorem</span><span class="w"> </span><span class="n">reverse_reverse</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="o">(</span><span class="n">l</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">List</span><span class="w"> </span><span class="n">Œ±</span><span class="o">),</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="n">l</span><span class="o">)</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">l</span>
<span class="w">  </span><span class="bp">|</span><span class="w"> </span><span class="o">[]</span><span class="w">     </span><span class="bp">=&gt;</span><span class="w"> </span><span class="n">rfl</span>
<span class="w">  </span><span class="bp">|</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="bp">=&gt;</span><span class="w"> </span><span class="k">calc</span>
<span class="w">    </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">l</span><span class="o">))</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="o">[</span><span class="n">a</span><span class="o">])</span><span class="w">         </span><span class="o">:=</span><span class="w"> </span><span class="kd">by</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">reverse_cons</span><span class="o">]</span>
<span class="w">    </span><span class="n">_</span><span class="w">                          </span><span class="bp">=</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="o">[</span><span class="n">a</span><span class="o">]</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="o">(</span><span class="n">reverse</span><span class="w"> </span><span class="n">l</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">reverse_append</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="n">_</span>
<span class="w">    </span><span class="n">_</span><span class="w">                          </span><span class="bp">=</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="o">[</span><span class="n">a</span><span class="o">]</span><span class="w"> </span><span class="bp">++</span><span class="w"> </span><span class="n">l</span><span class="w">                   </span><span class="o">:=</span><span class="w"> </span><span class="kd">by</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">reverse_reverse</span><span class="w"> </span><span class="n">l</span><span class="o">]</span>
<span class="w">    </span><span class="n">_</span><span class="w">                          </span><span class="bp">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">l</span><span class="w">                             </span><span class="o">:=</span><span class="w"> </span><span class="n">rfl</span>
</code></pre></div>
</div>

<h3 id="tactic-mode" class="markdown-heading">Tactic mode <a class="hover-link" href="#tactic-mode">#</a></h3>
<p>As we have already mentioned, when opening a tactic block,
<code>by</code> is placed at the end of the line
<em>preceding</em> the start of the tactic block, but not on its own line.
Everything within the tactic block is indented, as in:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">theorem</span><span class="w"> </span><span class="n">continuous_uncurry_of_discreteTopology</span><span class="w"> </span><span class="o">[</span><span class="n">DiscreteTopology</span><span class="w"> </span><span class="n">Œ±</span><span class="o">]</span><span class="w"> </span><span class="o">{</span><span class="n">f</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Œ±</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="n">Œ≤</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="n">Œ≥</span><span class="o">}</span>
<span class="w">    </span><span class="o">(</span><span class="n">hf</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">Continuous</span><span class="w"> </span><span class="o">(</span><span class="n">f</span><span class="w"> </span><span class="n">a</span><span class="o">))</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Continuous</span><span class="w"> </span><span class="o">(</span><span class="n">uncurry</span><span class="w"> </span><span class="n">f</span><span class="o">)</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">by</span>
<span class="w">  </span><span class="n">apply</span><span class="w"> </span><span class="n">continuous_iff_continuousAt</span><span class="bp">.</span><span class="mi">2</span>
<span class="w">  </span><span class="n">rintro</span><span class="w"> </span><span class="o">‚ü®</span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">‚ü©</span>
<span class="w">  </span><span class="n">change</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="bp">‚â§</span><span class="w"> </span><span class="n">_</span>
<span class="w">  </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">nhds_prod_eq</span><span class="o">,</span><span class="w"> </span><span class="n">nhds_discrete</span><span class="o">,</span><span class="w"> </span><span class="n">Filter.map_pure_prod</span><span class="o">]</span>
<span class="w">  </span><span class="n">exact</span><span class="w"> </span><span class="o">(</span><span class="n">hf</span><span class="w"> </span><span class="n">a</span><span class="o">)</span><span class="bp">.</span><span class="n">continuousAt</span>
</code></pre></div>
</div>

<p>One can mix term mode and tactic mode, as in:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">theorem</span><span class="w"> </span><span class="n">Units.isUnit_units_mul</span><span class="w"> </span><span class="o">{</span><span class="n">M</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Type</span><span class="bp">*</span><span class="o">}</span><span class="w"> </span><span class="o">[</span><span class="n">Monoid</span><span class="w"> </span><span class="n">M</span><span class="o">]</span><span class="w"> </span><span class="o">(</span><span class="n">u</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">M</span><span class="bp">À£</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">a</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">M</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">    </span><span class="n">IsUnit</span><span class="w"> </span><span class="o">(</span><span class="bp">‚Üë</span><span class="n">u</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">a</span><span class="o">)</span><span class="w"> </span><span class="bp">‚Üî</span><span class="w"> </span><span class="n">IsUnit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">:=</span>
<span class="w">  </span><span class="n">Iff.intro</span>
<span class="w">    </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">‚ü®</span><span class="n">v</span><span class="o">,</span><span class="w"> </span><span class="n">hv</span><span class="o">‚ü©</span><span class="w"> </span><span class="bp">=&gt;</span><span class="w"> </span><span class="kd">by</span>
<span class="w">      </span><span class="k">have</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">IsUnit</span><span class="w"> </span><span class="o">(</span><span class="bp">‚Üë</span><span class="n">u</span><span class="bp">‚Åª¬π</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="o">(</span><span class="bp">‚Üë</span><span class="n">u</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">a</span><span class="o">))</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">by</span><span class="w"> </span><span class="n">exists</span><span class="w"> </span><span class="n">u</span><span class="bp">‚Åª¬π</span><span class="w"> </span><span class="bp">*</span><span class="w"> </span><span class="n">v</span><span class="bp">;</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="bp">‚Üê</span><span class="w"> </span><span class="n">hv</span><span class="o">,</span><span class="w"> </span><span class="n">Units.val_mul</span><span class="o">]</span>
<span class="w">      </span><span class="n">rwa</span><span class="w"> </span><span class="o">[</span><span class="bp">‚Üê</span><span class="w"> </span><span class="n">mul_assoc</span><span class="o">,</span><span class="w"> </span><span class="n">Units.inv_mul</span><span class="o">,</span><span class="w"> </span><span class="n">one_mul</span><span class="o">]</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">this</span><span class="o">)</span>
<span class="w">    </span><span class="n">u.isUnit.mul</span>
</code></pre></div>
</div>

<p>When new goals arise as side conditions or steps, they are indented and preceded by
a focusing dot <code>¬∑</code> (inserted as <code>\.</code>); the dot is not indented.</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="n">Mathlib.Algebra.Group.Basic</span>

<span class="kd">theorem</span><span class="w"> </span><span class="n">exists_npow_eq_one_of_zpow_eq_one&#39;</span><span class="w"> </span><span class="o">[</span><span class="n">Group</span><span class="w"> </span><span class="n">G</span><span class="o">]</span><span class="w"> </span><span class="o">{</span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">‚Ñ§</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="n">hn</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">‚â†</span><span class="w"> </span><span class="mi">0</span><span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="n">x</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">G</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">^</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">1</span><span class="o">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">    </span><span class="bp">‚àÉ</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">‚Ñï</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="bp">&lt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">‚àß</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">^</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">by</span>
<span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">n</span>
<span class="w">  </span><span class="bp">¬∑</span><span class="w"> </span><span class="n">simp</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="o">[</span><span class="n">Int.ofNat_eq_coe</span><span class="o">]</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">h</span>
<span class="w">    </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">zpow_ofNat</span><span class="o">]</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">h</span>
<span class="w">    </span><span class="n">refine</span><span class="w"> </span><span class="o">‚ü®</span><span class="n">_</span><span class="o">,</span><span class="w"> </span><span class="n">Nat.pos_of_ne_zero</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="n">n0</span><span class="w"> </span><span class="bp">‚Ü¶</span><span class="w"> </span><span class="n">hn</span><span class="w"> </span><span class="bp">?</span><span class="n">_</span><span class="o">,</span><span class="w"> </span><span class="n">h</span><span class="o">‚ü©</span>
<span class="w">    </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">n0</span><span class="o">]</span>
<span class="w">    </span><span class="n">rfl</span>
<span class="w">  </span><span class="bp">¬∑</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">zpow_negSucc</span><span class="o">,</span><span class="w"> </span><span class="n">inv_eq_one</span><span class="o">]</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">h</span>
<span class="w">    </span><span class="n">refine</span><span class="w"> </span><span class="o">‚ü®</span><span class="n">_</span><span class="w"> </span><span class="bp">+</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="n">Nat.succ_pos</span><span class="w"> </span><span class="n">_</span><span class="o">,</span><span class="w"> </span><span class="n">h</span><span class="o">‚ü©</span>
</code></pre></div>
</div>

<p>Certain tactics, such as <code>refine</code>, can create <em>named</em> subgoals which
can be proven in whichever order is desired using <code>case</code>. This feature
is also useful in aiding readability. However, it is not required to
use this instead of the focusing dot (<code>¬∑</code>).</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">example</span><span class="w"> </span><span class="o">{</span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">Prop</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="n">h‚ÇÅ</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="n">q</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h‚ÇÇ</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="bp">‚Üí</span><span class="w"> </span><span class="n">p</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="bp">‚Üî</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">by</span>
<span class="w">  </span><span class="n">refine</span><span class="w"> </span><span class="o">‚ü®</span><span class="bp">?</span><span class="n">imp</span><span class="o">,</span><span class="w"> </span><span class="bp">?</span><span class="n">converse</span><span class="o">‚ü©</span>
<span class="w">  </span><span class="n">case</span><span class="w"> </span><span class="n">converse</span><span class="w"> </span><span class="bp">=&gt;</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">h‚ÇÇ</span>
<span class="w">  </span><span class="n">case</span><span class="w"> </span><span class="n">imp</span><span class="w"> </span><span class="bp">=&gt;</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">h‚ÇÅ</span>
</code></pre></div>
</div>

<p>Often <code>t0 &lt;;&gt; t1</code> is used to execute <code>t0</code> and then <code>t1</code> on all new goals.
Either write the tactics in one line, or indent the following tactic.</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="w">  </span><span class="n">cases</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">&lt;;&gt;</span>
<span class="w">    </span><span class="n">simp</span><span class="w"> </span><span class="o">[</span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="n">d</span><span class="o">]</span>
</code></pre></div>
</div>

<p>For single line tactic proofs (or short tactic proofs embedded in a term),
it is acceptable to use <code>by tac1; tac2; tac3</code> with semicolons instead of
a new line with indentation.</p>
<p>In general, you should put a single tactic invocation per line, unless you are
closing a goal with a proof that fits entirely on a single line. Short sequences of
tactics that correspond to a single mathematical idea can also be put on a single line,
separated by semicolons as in <code>cases bla; clear h</code> or <code>induction n; simp</code> or
<code>rw [foo]; simp_rw [bar]</code>, but even in these scenarios, newlines are preferred.</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">...</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">by</span>
<span class="w">  </span><span class="n">by_cases</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">  </span><span class="bp">¬∑</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">h</span><span class="o">]</span><span class="bp">;</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">hzero</span><span class="w"> </span><span class="n">ha</span>
<span class="w">  </span><span class="bp">¬∑</span><span class="w"> </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">h</span><span class="o">]</span>
<span class="w">    </span><span class="k">have</span><span class="w"> </span><span class="n">h&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">...</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="n">ha</span>
<span class="w">    </span><span class="n">simp_rw</span><span class="w"> </span><span class="o">[</span><span class="n">h&#39;</span><span class="o">,</span><span class="w"> </span><span class="n">hb</span><span class="o">]</span>
<span class="w">    </span><span class="bp">...</span>
</code></pre></div>
</div>

<p>Very short goals can be closed right away using <code>swap</code> or <code>pick_goal</code> if needed, to avoid
additional indentation in the rest of the proof.</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">example</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">...</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">by</span>
<span class="w">  </span><span class="n">rw</span><span class="w"> </span><span class="o">[</span><span class="n">h</span><span class="o">]</span>
<span class="w">  </span><span class="n">swap</span><span class="bp">;</span><span class="w"> </span><span class="n">exact</span><span class="w"> </span><span class="n">h&#39;</span>
<span class="w">  </span><span class="bp">...</span>
</code></pre></div>
</div>

<p>We generally use a blank line to separate theorems and definitions,
but this can be omitted, for example, to group together a number of
short definitions, or to group together a definition and notation.</p>
<h3 id="squeezing-simp-calls" class="markdown-heading">Squeezing simp calls <a class="hover-link" href="#squeezing-simp-calls">#</a></h3>
<p>Unless performance is particularly poor or the proof breaks otherwise, <em>terminal <code>simp</code> calls</em>
(a <code>simp</code> call is terminal if it closes the current goal or is only followed by flexible tactics
such as <code>ring</code>, <code>field_simp</code>, <code>aesop</code>) should not be <em>squeezed</em> (replaced by the output of <code>simp?</code>).</p>
<p>There are two main reasons for this:</p>
<ol>
<li>A squeezed <code>simp</code> call might be several lines longer than the corresponding unsqueezed one, and
therefore drown the useful information of what key lemmas were added to the unsqueezed <code>simp</code> call
to close the goal in a sea of basic simp lemmas.</li>
<li>A squeezed <code>simp</code> call refers to many lemmas by name, meaning that it will break when one such
lemma gets renamed. Lemma renamings happen often enough for this to matter on a maintenance level.</li>
</ol>
<h3 id="whitespace-and-delimiters" class="markdown-heading">Whitespace and delimiters <a class="hover-link" href="#whitespace-and-delimiters">#</a></h3>
<p>Lean is whitespace-sensitive, and in general we opt for a style which avoids
delimiting code. For instance, when writing tactics, it is possible to write
them as <code>tac1; tac2; tac3</code>, separated by <code>;</code>, in order to override the default
whitespace sensitivity. However, as mentioned above, we generally try to avoid
this except in a few special cases.</p>
<p>Similarly, sometimes parentheses can be avoided by judicious use of the <code>&lt;|</code>
operator (or its cousin <code>|&gt;</code>). Note: while <code>$</code> is a synonym for <code>&lt;|</code>, its
use in mathlib is disallowed in favor of <code>&lt;|</code> for consistency as well as
because of the symmetry with <code>|&gt;</code>. These operators have the effect of
parenthesizing everything to the right of <code>&lt;|</code> (note that <code>(</code> is curved the
same direction as <code>&lt;</code>) or to the left of <code>|&gt;</code> (and <code>)</code> curves the same way
as <code>&gt;</code>).</p>
<p>A common example of the usage of <code>|&gt;</code> occurs with dot notation when the term
preceding the <code>.</code> is a function applied to some arguments. For instance,
<code>((foo a).bar b).baz</code> can be rewritten as <code>foo a |&gt;.bar b |&gt;.baz</code></p>
<p>A common example of the usage of <code>&lt;|</code> is when the user provides a term which
is a function applied to multiple arguments whose last argument is a proof in
tactic mode, especially one that spans multiple lines. In that case, it is
natural to use <code>&lt;| by ...</code> instead of <code>(by ...)</code>, as in:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="n">Mathlib.Tactic</span>

<span class="kd">example</span><span class="w"> </span><span class="o">{</span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">‚Ñù</span><span class="o">}</span><span class="w"> </span><span class="o">(</span><span class="n">hxy</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">‚â§</span><span class="w"> </span><span class="n">y</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">‚àÄ</span><span class="w"> </span><span class="n">Œµ</span><span class="w"> </span><span class="bp">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="bp">-</span><span class="w"> </span><span class="n">Œµ</span><span class="w"> </span><span class="bp">‚â§</span><span class="w"> </span><span class="n">x</span><span class="o">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">:=</span>
<span class="w">  </span><span class="n">le_antisymm</span><span class="w"> </span><span class="n">hxy</span><span class="w"> </span><span class="bp">&lt;|</span><span class="w"> </span><span class="n">le_of_forall_pos_le_add</span><span class="w"> </span><span class="bp">&lt;|</span><span class="w"> </span><span class="kd">by</span>
<span class="w">    </span><span class="n">intro</span><span class="w"> </span><span class="n">Œµ</span><span class="w"> </span><span class="n">hŒµ</span>
<span class="w">    </span><span class="k">have</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="n">Œµ</span><span class="w"> </span><span class="n">hŒµ</span>
<span class="w">    </span><span class="n">linarith</span>
</code></pre></div>
</div>

<p>When using the tactics <code>rw</code> or <code>simp</code> there should be a space after the left arrow  <code>‚Üê</code>.
For instance <code>rw [‚Üê add_comm a b]</code> or <code>simp [‚Üê and_or_left]</code>.
(There should also be a space between the tactic name and its arguments, as in <code>rw [h]</code>.)
This rule applies the <code>do</code> notation as well: <code>do return (‚Üê f) + (‚Üê g)</code></p>
<h3 id="empty-lines-inside-declarations" class="markdown-heading">Empty lines inside declarations <a class="hover-link" href="#empty-lines-inside-declarations">#</a></h3>
<p>Empty lines inside declarations are discouraged and there is a linter that enforces
that they are not present. This helps maintaining a uniform code style throughout
all of mathlib.</p>
<p>You are however encouraged to add comments to your code: even a short sentence communicates
<em>much</em> more than an empty line in the middle of a proof ever will!</p>
<h3 id="normal-forms" class="markdown-heading">Normal forms <a class="hover-link" href="#normal-forms">#</a></h3>
<p>Some statements are equivalent. For instance, there are several equivalent
ways to require that a subset <code>s</code> of a type is nonempty. For another example, given
<code>a : Œ±</code>, the corresponding element of <code>Option Œ±</code> can be equivalently written
as <code>Some a</code> or <code>(a : Option Œ±)</code>. In general, we try to settle
on one standard form, called the normal form, and use it both in statements and
conclusions of theorems. In the above examples, this would be <code>s.Nonempty</code> (which
gives access to dot notation) and <code>(a : Option Œ±)</code>. Often, simp lemmas will be
registered to convert the other equivalent forms to the normal form.</p>
<p>There is a special case to this rule. In types with a bottom element, it is equivalent
to require <code>hlt : ‚ä• &lt; x</code> or <code>hne : x ‚â† ‚ä•</code>, and it is not clear which one would
be better as a normal form since both have their pros and cons. An analogous situation
occurs with <code>hlt : x &lt; ‚ä§</code> and <code>hne : x ‚â† ‚ä§</code> in types with a top element. Since it is very
easy to convert from <code>hlt</code> to <code>hne</code> (by using <code>hlt.ne</code> or <code>hlt.ne'</code> depending
on the direction we want) while the other conversion is more lengthy, we use <code>hne</code> in
<em>assumptions</em> of theorems (as this is the easier assumption to check), and <code>hlt</code> in
<em>conclusions</em> of theorems (as this is the more powerful result to use).
A common usage of this rule is with naturals, where <code>‚ä• = 0</code>.</p>
<h3 id="comments" class="markdown-heading">Comments <a class="hover-link" href="#comments">#</a></h3>
<p>Use module doc delimiters <code>/-! -/</code> to provide section headers and
separators since these get incorporated into the auto-generated docs,
and use <code>/- -/</code> for more technical comments (e.g. TODOs and
implementation notes) or for comments in proofs.
Use <code>--</code> for short or in-line comments.</p>
<p>Documentation strings for declarations are delimited with <code>/-- -/</code>.
When a documentation string for a declaration spans multiple lines, do not indent
subsequent lines.</p>
<p>See our <a href="doc.html">documentation requirements</a> for more suggestions
and examples.</p>
<h3 id="expressions-in-error-or-trace-messages" class="markdown-heading">Expressions in error or trace messages <a class="hover-link" href="#expressions-in-error-or-trace-messages">#</a></h3>
<p>Inside all printed messages (such as, in linters, custom elaborators or other metaprogrammes),
names and interpolated data should either be</p>
<ul>
<li>inline and surrounded by backticks (e.g., <code>m!&quot;</code>{foo}<code>must have type</code>{bar}<code>&quot;</code>), or</li>
<li>on their own line and indented (via e.g. <code>indentD</code>)</li>
</ul>
<p>The second style produces output like the following</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="n">Could</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">corners</span><span class="w"> </span><span class="n">for</span><span class="w"> </span><span class="n">domain</span>
<span class="w">  </span><span class="n">src</span>
<span class="n">nor</span><span class="w"> </span><span class="n">codomain</span>
<span class="w">  </span><span class="n">tgt</span>
<span class="n">of</span><span class="w"> </span><span class="n">function</span>
<span class="w">  </span><span class="n">f</span>
</code></pre></div>
</div>

<p>Not all of mathlib may comply with this rule yet; that is a bug (and PRs fixing this are welcome).</p>
<h3 id="deprecation" class="markdown-heading">Deprecation <a class="hover-link" href="#deprecation">#</a></h3>
<p>Deleting, renaming, or changing declarations can cause downstreams projects that rely on these
definitions to fail to compile.
Any publicly exposed theorems and definitions that are being removed should be gracefully
transitioned by keeping the old declaration with a <code>@[deprecated]</code> attribute.
This warns downstream projects about the change and gives them the opportunity to adjust before the
declarations are deleted.
Renamed definitions should use a deprecated <code>alias</code> to the new name.
Otherwise, when the deprecated definition does not have a direct replacement, the definition should
be deprecated with a message, like so:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kn">theorem</span><span class="w"> </span><span class="n">new_name</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="bp">...</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="bp">...</span>
<span class="kd">@[</span><span class="n">deprecated</span><span class="w"> </span><span class="o">(</span><span class="n">since</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s2">&quot;YYYY-MM-DD&quot;</span><span class="o">)</span><span class="kd">]</span><span class="w"> </span><span class="kn">alias</span><span class="w"> </span><span class="n">old_name</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">new_name</span>

<span class="kd">@[</span><span class="n">deprecated</span><span class="w"> </span><span class="s2">&quot;This theorem is deprecated in favor of using ... with ...&quot;</span><span class="w"> </span><span class="o">(</span><span class="n">since</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s2">&quot;YYYY-MM-DD&quot;</span><span class="o">)</span><span class="kd">]</span>
<span class="kn">theorem</span><span class="w"> </span><span class="n">example_thm</span><span class="w"> </span><span class="bp">...</span>
</code></pre></div>
</div>

<p>The <code>@[deprecated]</code> attribute requires the deprecation date, and an alias to the new declaration
or a string to explain how transition away from the old definition when a new version is no longer
being provided.</p>
<p>The <a href="/mathlib4_docs/Mathlib/Tactic/DeprecateTo.html"><code>deprecate to</code></a> command and
<code>scripts/add_deprecations.sh</code> script can help generate alias definitions.</p>
<p>Deprecations for declarations with the <code>to_additive</code> attribute should ensure the deprecation is
also properly tagged with <code>to_additive</code>, like so:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kd">@[</span><span class="n">to_additive</span><span class="kd">]</span><span class="w"> </span><span class="kn">theorem</span><span class="w"> </span><span class="n">Group_bar</span><span class="w"> </span><span class="o">{</span><span class="n">G</span><span class="o">}</span><span class="w"> </span><span class="o">[</span><span class="n">Group</span><span class="w"> </span><span class="n">G</span><span class="o">]</span><span class="w"> </span><span class="o">{</span><span class="n">a</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">G</span><span class="o">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="bp">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">rfl</span>

<span class="c1">-- Two deprecations required to include the `deprecated` tag on both the additive</span>
<span class="c1">-- and multiplicative versions</span>
<span class="kd">@[</span><span class="n">deprecated</span><span class="w"> </span><span class="o">(</span><span class="n">since</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s2">&quot;YYYY-MM-DD&quot;</span><span class="o">)</span><span class="kd">]</span><span class="w"> </span><span class="kn">alias</span><span class="w"> </span><span class="n">AddGroup_foo</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">AddGroup_bar</span>
<span class="kd">@[</span><span class="n">to_additive</span><span class="w"> </span><span class="n">existing</span><span class="o">,</span><span class="w"> </span><span class="n">deprecated</span><span class="w"> </span><span class="o">(</span><span class="n">since</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s2">&quot;YYYY-MM-DD&quot;</span><span class="o">)</span><span class="kd">]</span><span class="w"> </span><span class="kn">alias</span><span class="w"> </span><span class="n">Group_foo</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">Group_bar</span>
</code></pre></div>
</div>

<p>We allow, but discourage, contributors from simultaneously renaming declarations X to Y and W to X.
In this case, no deprecation attribute is required for X, but it is for W.</p>
<p>Named instances do not require deprecations. Deprecated declarations can be deleted after 6 months.</p>

  </main>

    <nav id="navbar" class="d-md-block bg-light sidebar collapse navbar-light pb-4">
      <div class="d-none d-md-block mt-4"><a class="navbar-brand" href="https://leanprover-community.github.io/index.html">Lean Community</a></div>
      
        <h6 class="sidebar-heading mt-4">Community</h6>
        <ul class="nav">
          <li class="nav-item col-12"><a href="https://leanprover.zulipchat.com/">Zulip chat</a></li>
        
          <li class="nav-item col-12"><a href="https://github.com/leanprover-community/mathlib4">GitHub</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/blog">Blog</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/meet.html">Community information</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/meet.html#community-guidelines">Community guidelines</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/teams.html">Teams</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/papers.html">Papers about Lean</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/lean_projects.html">Projects using Lean</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/teaching/index.html">Teaching using Lean</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/events.html">Events</a></li>
        </ul>
      
        <h6 class="sidebar-heading mt-4">Use Lean</h6>
        <ul class="nav">
          <li class="nav-item col-12"><a href="https://live.lean-lang.org/">Online version (no installation)</a></li>
        
          <li class="nav-item col-12"><a href="https://docs.lean-lang.org/lean4/doc/quickstart.html">Install Lean</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/get_started.html">More options</a></li>
        </ul>
      
        <h6 class="sidebar-heading mt-4">Documentation</h6>
        <ul class="nav">
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/learn.html">Learning resources (start here)</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/mathlib4_docs">API documentation</a></li>
        
          <li class="nav-item col-12"><a href="https://loogle.lean-lang.org/">Declaration search (Loogle)</a></li>
        
          <li class="nav-item col-12"><a href="https://lean-lang.org/doc/reference/latest/">Language reference</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/mathlib-manual/html-multi/">Tactic list</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/extras/calc.html">Calc mode</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/extras/conv.html">Conv mode</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/extras/simp.html">Simplifier</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/extras/well_founded_recursion.html">Well-founded recursion</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/extras/speedup.html">Speeding up Lean files</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/extras/pitfalls.html">Pitfalls and common mistakes</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/did_you_prove_it.html">Did you really prove it?</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/mwe.html">About MWEs</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/glossary.html">Glossary</a></li>
        </ul>
      
        <h6 class="sidebar-heading mt-4">Library overviews</h6>
        <ul class="nav">
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/mathlib-overview.html">Library overview</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/undergrad.html">Undergraduate maths</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/100.html">Wiedijk's 100 theorems</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/1000.html">1000+ theorems</a></li>
        </ul>
      
        <h6 class="sidebar-heading mt-4">Theories</h6>
        <ul class="nav">
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/theories/naturals.html">Natural Numbers</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/theories/linear_algebra.html">Linear Algebra</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/theories/sets.html">Sets and finite sets</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/theories/topology.html">Topology</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/theories/category_theory.html">Category Theory</a></li>
        </ul>
      
        <h6 class="sidebar-heading mt-4">Contributing</h6>
        <ul class="nav">
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/contribute/index.html">Pull request lifecycle</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/queueboard/">Mathlib review and triage dashboard</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/contribute/git.html">Git Guide for Mathlib4 Contributors</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/contribute/naming.html">Naming conventions</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/contribute/style.html">Code style guideline</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/contribute/doc.html">Documentation style</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/contribute/commit.html">Commit conventions</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/contribute/pr-review.html">Pull request review guide</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/mathlib_stats.html">Contribution statistics</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/contribute/tags_and_branches.html">Tags and branches</a></li>
        </ul>
      
    </nav>

</div>


  <nav class="footer navbar navbar-expand-lg navbar-light bg-light justify-content-end">
  <ul class="nav">
    <li class="nav-item">
      <a class="nav-link active" href="https://github.com/leanprover-community/leanprover-community.github.io/blob/lean4/templates/contribute/style.md">Suggest edits to this page on GitHub</a>
    </li>
  </ul>
  </nav>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous"></script>
    <script src="https://leanprover-community.github.io//js/bootstrap.min.js"></script>
    <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
      mermaid.initialize({ startOnLoad: true });
    </script>
    
  </body>
</html>