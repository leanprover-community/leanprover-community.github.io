---
layout: page
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/47076leanpkgupgradegivingme342branch.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html">leanpkg upgrade giving me 3.4.2 branch</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="157935869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157935869" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157935869">Kevin Buzzard (Feb 09 2019 at 16:22)</a>:</h4>
<p>I use elan. In a project I have, which I want to keep up to date with mathlib head, <code>leanpkg upgrade</code> gives me the lean-3.4.2 branch of mathlib. Why is this happening? My <code>leanpkg.toml</code> contains the line <code>lean_version = "3.4.2"</code>. Is that the problem? If so, what should it say?</p>

<a name="157935900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157935900" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157935900">Kevin Buzzard (Feb 09 2019 at 16:22)</a>:</h4>
<p>the mathlib <code>lean-3.4.2</code> branch is currently 9 days behind HEAD.</p>

<a name="157935917"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157935917" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157935917">Kevin Buzzard (Feb 09 2019 at 16:23)</a>:</h4>
<p>Changing <code>3.4.2</code> to <code>master</code> in my <code>leanpkg.toml</code> gives me</p>
<div class="codehilite"><pre><span></span>$ leanpkg upgrade
error: override toolchain &#39;master&#39; is not installed
info: caused by: the toolchain file at &#39;/home/buzzard/Encfs/Computer_languages/Lean/lean-projects/M1P1-lean/leanpkg.toml&#39; specifies an uninstalled toolchain
buzzard@bob:~/Lean/lean-projects/M1P1-lean$
</pre></div>

<a name="157936038"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157936038" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157936038">Kevin Buzzard (Feb 09 2019 at 16:26)</a>:</h4>
<p>With <code>3.4.2</code> I get</p>
<div class="codehilite"><pre><span></span>$ leanpkg upgrade
mathlib: trying to update _target/deps/mathlib to revision 50a03f76bb89ee5cf9d9703f78e1eb2139d9b609
&gt; git checkout --detach 50a03f76bb89ee5cf9d9703f78e1eb2139d9b609    # in directory _target/deps/mathlib
HEAD is now at 50a03f7 chore(test): fix test directory structure
configuring M1P1-lean 0.1
mathlib: trying to update _target/deps/mathlib to revision 50a03f76bb89ee5cf9d9703f78e1eb2139d9b609
&gt; git checkout --detach 50a03f76bb89ee5cf9d9703f78e1eb2139d9b609    # in directory _target/deps/mathlib
HEAD is now at 50a03f7 chore(test): fix test directory structure
buzzard@bob:~/Lean/lean-projects/M1P1-lean$
</pre></div>


<p>which is precisely <a href="https://github.com/leanprover-community/mathlib/tree/lean-3.4.2" target="_blank" title="https://github.com/leanprover-community/mathlib/tree/lean-3.4.2">https://github.com/leanprover-community/mathlib/tree/lean-3.4.2</a></p>

<a name="157936057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157936057" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157936057">Kevin Buzzard (Feb 09 2019 at 16:27)</a>:</h4>
<div class="codehilite"><pre><span></span>buzzard@bob:~/.elan/toolchains$ ls
3.3.0  3.4.2  nightly-2018-06-21  stable
</pre></div>


<p>Hmm....</p>

<a name="157936119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157936119" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157936119">Kevin Buzzard (Feb 09 2019 at 16:28)</a>:</h4>
<p><code>lean_version = "stable"</code></p>
<p>...</p>
<div class="codehilite"><pre><span></span>$ leanpkg upgrade

WARNING: Lean version mismatch: installed version is 3.4.2, but package requires stable

mathlib: trying to update _target/deps/mathlib to revision 50a03f76bb89ee5cf9d9703f78e1eb2139d9b609
&gt; git checkout --detach 50a03f76bb89ee5cf9d9703f78e1eb2139d9b609    # in directory _target/deps/mathlib
HEAD is now at 50a03f7 chore(test): fix test directory structure
From https://github.com/leanprover-community/mathlib
 * [new tag]         bin-20190209-162751-484d864 -&gt; bin-20190209-162751-484d864

WARNING: Lean version mismatch: installed version is 3.4.2, but package requires stable

configuring M1P1-lean 0.1
mathlib: trying to update _target/deps/mathlib to revision 50a03f76bb89ee5cf9d9703f78e1eb2139d9b609
&gt; git checkout --detach 50a03f76bb89ee5cf9d9703f78e1eb2139d9b609    # in directory _target/deps/mathlib
HEAD is now at 50a03f7 chore(test): fix test directory structure
</pre></div>


<p>GAARGH</p>

<a name="157936273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157936273" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157936273">Kevin Buzzard (Feb 09 2019 at 16:33)</a>:</h4>
<p>I think I can push to lean-3.4.2 but I am scared I'll screw up.</p>

<a name="157937052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157937052" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157937052">Kevin Buzzard (Feb 09 2019 at 16:53)</a>:</h4>
<p>If I do (within my clone of <code>leanprover-community/mathlib</code>)</p>
<div class="codehilite"><pre><span></span>$ git checkout master
$ git pull
$ git checkout lean-3.4.2
$ git pull
$ git merge master
$ git push
</pre></div>


<p>will that be a good thing or will something bad happen?</p>

<a name="157937062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157937062" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157937062">Kevin Buzzard (Feb 09 2019 at 16:53)</a>:</h4>
<p>There's a chance it will solve my problem, at least temporarily</p>

<a name="157938442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157938442" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157938442">Patrick Massot (Feb 09 2019 at 17:33)</a>:</h4>
<p>It should be ok</p>

<a name="157953386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953386" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953386">Kevin Buzzard (Feb 10 2019 at 01:08)</a>:</h4>
<div class="codehilite"><pre><span></span> ! [remote rejected] lean-3.4.2 -&gt; lean-3.4.2 (protected branch hook declined)
error: failed to push some refs to &#39;git@github.com:leanprover-community/mathlib.git&#39;
</pre></div>


<p>Rotten luck. OK so I'm out of ideas.</p>

<a name="157953464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953464" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953464">Mario Carneiro (Feb 10 2019 at 01:11)</a>:</h4>
<p>why are you trying to push the changes to the remote</p>

<a name="157953508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953508" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953508">Kevin Buzzard (Feb 10 2019 at 01:12)</a>:</h4>
<p>because leanpkg upgrade is downgrading me</p>

<a name="157953510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953510" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953510">Kevin Buzzard (Feb 10 2019 at 01:12)</a>:</h4>
<p><a href="#narrow/stream/113488-general/topic/leanpkg.20upgrade.20giving.20me.203.2E4.2E2.20branch/near/157935869" title="#narrow/stream/113488-general/topic/leanpkg.20upgrade.20giving.20me.203.2E4.2E2.20branch/near/157935869">https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg.20upgrade.20giving.20me.203.2E4.2E2.20branch/near/157935869</a></p>

<a name="157953512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953512" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953512">Mario Carneiro (Feb 10 2019 at 01:13)</a>:</h4>
<p>that's even if you move up your local branch?</p>

<a name="157953565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953565" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953565">Kevin Buzzard (Feb 10 2019 at 01:14)</a>:</h4>
<p>I don't have a local branch in my repo with mathlib as a dependency. I just have a mathlib with a detached head.</p>

<a name="157953587"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953587" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953587">Kevin Buzzard (Feb 10 2019 at 01:15)</a>:</h4>
<p>I don't want to be copying commit hashes into my leanpkg.toml manually, I just want leanpkg upgrade to do everything for me. I am in my own project with mathlib as a dependency and leanpkg upgrade drags me back to the lagging-behind 3.4.2. I just want to track HEAD</p>

<a name="157953592"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953592" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953592">Kevin Buzzard (Feb 10 2019 at 01:15)</a>:</h4>
<p>Can't I track master?</p>

<a name="157953638"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953638" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953638">Mario Carneiro (Feb 10 2019 at 01:16)</a>:</h4>
<p>I recall Sebastian giving some reasons for why it shouldn't be done, and me being skeptical</p>

<a name="157953642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953642" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953642">Kevin Buzzard (Feb 10 2019 at 01:16)</a>:</h4>
<div class="codehilite"><pre><span></span>$ more leanpkg.toml
[package]
name = &quot;M1P1-lean&quot;
version = &quot;0.1&quot;
lean_version = &quot;3.4.2&quot;
path = &quot;src&quot;

[dependencies]
mathlib = {git = &quot;https://github.com/leanprover-community/mathlib&quot;, rev = &quot;50a03f7
6bb89ee5cf9d9703f78e1eb2139d9b609&quot;}
buzzard@bob:~/Lean/lean-projects/M1P1-lean$
</pre></div>


<p>Whenever I type leanpkg upgrade my toml is pulled back to this</p>

<a name="157953646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953646" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953646">Kevin Buzzard (Feb 10 2019 at 01:16)</a>:</h4>
<p>But now we have control of the repo in a better way, can we just write a hook to make 3.4.2 track master?</p>

<a name="157953653"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953653" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953653">Kevin Buzzard (Feb 10 2019 at 01:17)</a>:</h4>
<p>This was what we couldn't do before, right?</p>

<a name="157953656"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953656" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953656">Kevin Buzzard (Feb 10 2019 at 01:17)</a>:</h4>
<p>Does the change to leanprover-community make all this easier to handle?</p>

<a name="157953696"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953696" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953696">Simon Hudon (Feb 10 2019 at 01:18)</a>:</h4>
<p>Do we want <code>lean-3.4.2</code> to point to the latest nightly (which I'm setting up now)?</p>

<a name="157953700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953700" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953700">Kevin Buzzard (Feb 10 2019 at 01:18)</a>:</h4>
<p>I vote yes</p>

<a name="157953703"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953703" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953703">Kevin Buzzard (Feb 10 2019 at 01:18)</a>:</h4>
<p>Why would anyone vote no?</p>

<a name="157953706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953706" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953706">Simon Hudon (Feb 10 2019 at 01:18)</a>:</h4>
<p>The benefit is that tracking <code>lean-3.4.2</code> should always give you access to binary releases</p>

<a name="157953708"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953708" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953708">Kevin Buzzard (Feb 10 2019 at 01:18)</a>:</h4>
<p>ultimately I want leanpkg upgrade to take me to master</p>

<a name="157953710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953710" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953710">Kevin Buzzard (Feb 10 2019 at 01:18)</a>:</h4>
<p>Oh I see</p>

<a name="157953753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953753" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953753">Simon Hudon (Feb 10 2019 at 01:19)</a>:</h4>
<p>I have no idea why not to do it but the other developers have more imagination than me</p>

<a name="157953754"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953754" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953754">Kevin Buzzard (Feb 10 2019 at 01:19)</a>:</h4>
<p>I think I'd rather have today's commit and then spend 10 minutes compiling</p>

<a name="157953755"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953755" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953755">Mario Carneiro (Feb 10 2019 at 01:19)</a>:</h4>
<p>I vote yes for auto update</p>

<a name="157953757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953757" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953757">Mario Carneiro (Feb 10 2019 at 01:19)</a>:</h4>
<p>especially with the new olean releases</p>

<a name="157953759"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953759" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953759">Kevin Buzzard (Feb 10 2019 at 01:19)</a>:</h4>
<p>actually I think Id rather have yesterday's commit and not compile</p>

<a name="157953803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953803" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953803">Kevin Buzzard (Feb 10 2019 at 01:20)</a>:</h4>
<p>but I don't think I want to be 66 commits behind -- some of those commits are mine and I want them in my repo</p>

<a name="157953805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953805" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953805">Mario Carneiro (Feb 10 2019 at 01:20)</a>:</h4>
<p>But make sure we only run this stuff on master branch</p>

<a name="157953812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953812" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953812">Mario Carneiro (Feb 10 2019 at 01:20)</a>:</h4>
<p>PRs and other things also trigger travis but shouldn't release oleans or move lean-3.4.2</p>

<a name="157953828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953828" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953828">Simon Hudon (Feb 10 2019 at 01:21)</a>:</h4>
<p>That won't be hard</p>

<a name="157953872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953872" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953872">Kevin Buzzard (Feb 10 2019 at 01:22)</a>:</h4>
<p>What we're talking about here is basically the perfect solution for me. I want to keep moving my repos along with master as they are developed, so I quickly see when an update breaks things.</p>

<a name="157953882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157953882" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157953882">Kevin Buzzard (Feb 10 2019 at 01:23)</a>:</h4>
<p>(or even better, fixes things)</p>

<a name="157954535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157954535" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157954535">Simon Hudon (Feb 10 2019 at 01:43)</a>:</h4>
<p>How do you get leanpkg to track <code>lean-3.4.2</code>?</p>

<a name="157954539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157954539" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157954539">Kevin Buzzard (Feb 10 2019 at 01:43)</a>:</h4>
<p>it does it by default as far as I can see</p>

<a name="157954541"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157954541" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157954541">Kevin Buzzard (Feb 10 2019 at 01:43)</a>:</h4>
<div class="codehilite"><pre><span></span>lean_version = &quot;3.4.2&quot;
</pre></div>


<p>in <code>leanpkg.toml</code></p>

<a name="157954569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157954569" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157954569">Kevin Buzzard (Feb 10 2019 at 01:44)</a>:</h4>
<p>if I understood correctly</p>

<a name="157954589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157954589" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157954589">Simon Hudon (Feb 10 2019 at 01:44)</a>:</h4>
<p>Cool! Do you have to call <code>leanpkg upgrade</code> or does it upgrade its packages automatically?</p>

<a name="157954654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157954654" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157954654">Kevin Buzzard (Feb 10 2019 at 01:46)</a>:</h4>
<p>When I type <code>leanpkg upgrade</code> (which I do occasionally, if I am interested in a recent commit, or if I feel like I want to check my project still compiles against mathlib head), it pulls mathlib and switches to the commit corresponding to the lean_version, as far as I can see</p>

<a name="157954658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157954658" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157954658">Kevin Buzzard (Feb 10 2019 at 01:46)</a>:</h4>
<p>This is in a project with mathlib as a dependency</p>

<a name="157954659"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157954659" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157954659">Kevin Buzzard (Feb 10 2019 at 01:46)</a>:</h4>
<p>i.e. where I am 99% of the time</p>

<a name="157954671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157954671" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157954671">Kevin Buzzard (Feb 10 2019 at 01:47)</a>:</h4>
<p>If I understand correctly, it is not recommended that there be a way to track master</p>

<a name="157954674"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157954674" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157954674">Kevin Buzzard (Feb 10 2019 at 01:47)</a>:</h4>
<p>but that's what I want to do.</p>

<a name="157954731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157954731" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157954731">Simon Hudon (Feb 10 2019 at 01:49)</a>:</h4>
<p>With this new nightly system, we could in principle coordinate dependent packages so that they affix the <code>lean-3.4.2</code> only when it works with the <code>lean-3.4.2</code> version of mathlib.</p>

<a name="157968982"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157968982" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157968982">Kevin Buzzard (Feb 10 2019 at 10:07)</a>:</h4>
<p>I am not clear what the solution to my problem is yet. The docs for <code>leanpkg</code> say that <code>leanpkg upgrade</code> will update all dependencies to the latest upstream version. Currently they don't because of the existence of the lean-3.4.2 tag whose behaviour seems to be undefined. What do I do as an end user if I simply want to do the very natural thing of updating my dependencies because they just got a commit I want for my project?</p>

<a name="157970271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157970271" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157970271">Kevin Buzzard (Feb 10 2019 at 10:48)</a>:</h4>
<p>Obviously I can just go into <code>_target</code> and fix things up myself, but then my <code>leanpkg.toml</code> becomes an unreliable witness to the situation, and this won't work for my clients anyway.</p>

<a name="157977627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg%20upgrade%20giving%20me%203.4.2%20branch/near/157977627" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/47076leanpkgupgradegivingme342branch.html#157977627">Reid Barton (Feb 10 2019 at 14:40)</a>:</h4>
<p>What I do in practice is just edit the commit IDs in <code>leanpkg.toml</code> manually. Sometimes you want to do this anyways, because for example the latest commit of mathlib doesn't build, or when updating to the latest mathlib would cause a lot of breakage and you'd rather take smaller steps.</p>


{% endraw %}
