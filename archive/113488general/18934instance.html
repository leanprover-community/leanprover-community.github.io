---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/18934instance.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/18934instance.html">instance</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="132041055"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/instance/near/132041055" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18934instance.html#132041055">Kenny Lau (Aug 13 2018 at 11:47)</a>:</h4>
<p><code>algebra/module.lean</code>:</p>
<div class="codehilite"><pre><span></span><span class="kn">instance</span> <span class="n">range</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">γ</span><span class="o">}</span> <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">is_linear_map</span> <span class="n">f</span><span class="o">)</span> <span class="o">:</span> <span class="n">is_submodule</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">range</span> <span class="n">f</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">set</span><span class="bp">.</span><span class="n">image_univ</span><span class="o">]</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">is_submodule</span><span class="bp">.</span><span class="n">image</span> <span class="n">hf</span>
</pre></div>


<p>should this be an instance?</p>

<a name="132041241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/instance/near/132041241" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18934instance.html#132041241">Mario Carneiro (Aug 13 2018 at 11:51)</a>:</h4>
<p>no good, unless <code>is_linear_map</code> is a typeclass</p>

<a name="132043377"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/instance/near/132043377" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18934instance.html#132043377">Kenny Lau (Aug 13 2018 at 12:32)</a>:</h4>
<p>what to do about it then</p>

<a name="132043635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/instance/near/132043635" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18934instance.html#132043635">Mario Carneiro (Aug 13 2018 at 12:37)</a>:</h4>
<p>fix it?</p>

<a name="132121087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/instance/near/132121087" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18934instance.html#132121087">Guy Leroy (Aug 14 2018 at 16:31)</a>:</h4>
<p>I'm struggling with instances, I have the error:<br>
failed to synthesize type class instance for</p>
<div class="codehilite"><pre><span></span><span class="n">a</span> <span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">,</span>
<span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">pos_nat</span> <span class="n">n</span><span class="o">,</span>
<span class="n">em</span> <span class="o">:</span> <span class="n">coprime</span> <span class="n">a</span> <span class="n">n</span>
<span class="err">⊢</span> <span class="n">decidable_eq</span> <span class="o">(</span><span class="n">coprime</span> <span class="n">a</span> <span class="n">n</span> <span class="bp">→</span> <span class="bp">Π</span> <span class="o">[</span><span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">pos_nat</span> <span class="n">n</span><span class="o">],</span> <span class="n">units</span> <span class="o">(</span><span class="n">zmod</span> <span class="n">n</span><span class="o">))</span>
</pre></div>


<p>How should I state the instance that would solve this?</p>

<a name="132121699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/instance/near/132121699" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18934instance.html#132121699">Patrick Massot (Aug 14 2018 at 16:42)</a>:</h4>
<p>You should give us more context, this goal is probably not what you actually want</p>

<a name="132121881"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/instance/near/132121881" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18934instance.html#132121881">Mario Carneiro (Aug 14 2018 at 16:46)</a>:</h4>
<p>While I agree with patrick, I doubt that this is the right goal to solve, it is incidentally provable. Probably the missing piece is <code>decidable (pos_nat n)</code></p>

<a name="132121916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/instance/near/132121916" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18934instance.html#132121916">Guy Leroy (Aug 14 2018 at 16:47)</a>:</h4>
<p>Thanks Patrick, you're right, I made a mistake when writing my goal and it's all fixed now.<br>
I would still be curious as to what this instance actually means.<br>
As for the context I wrote </p>
<div class="codehilite"><pre><span></span><span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="n">units_zmod_mk</span> <span class="n">a</span> <span class="n">n</span><span class="o">)</span> <span class="err">^</span> <span class="n">order_of</span> <span class="o">(</span><span class="n">units_zmod_mk</span> <span class="n">a</span> <span class="n">n</span><span class="o">),</span> <span class="k">from</span> <span class="n">pow_order_of_eq_one</span> <span class="o">(</span><span class="n">units_zmod_mk</span> <span class="n">a</span> <span class="n">n</span><span class="o">),</span>
</pre></div>


<p>instead of </p>
<div class="codehilite"><pre><span></span><span class="k">have</span>  <span class="o">:</span> <span class="o">(</span><span class="n">units_zmod_mk</span> <span class="n">a</span> <span class="n">n</span> <span class="n">em</span><span class="o">)</span> <span class="err">^</span> <span class="n">order_of</span> <span class="o">(</span><span class="n">units_zmod_mk</span> <span class="n">a</span> <span class="n">n</span> <span class="n">em</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">,</span> <span class="k">from</span> <span class="n">pow_order_of_eq_one</span> <span class="o">(</span><span class="n">units_zmod_mk</span> <span class="n">a</span> <span class="n">n</span> <span class="n">em</span><span class="o">),</span>
</pre></div>


<p>and I have defined above </p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">units_zmod_mk</span> <span class="o">(</span><span class="n">a</span> <span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">nat</span><span class="bp">.</span><span class="n">coprime</span> <span class="n">a</span> <span class="n">n</span><span class="o">)</span> <span class="o">[</span><span class="n">pos_nat</span> <span class="n">n</span><span class="o">]</span> <span class="o">:</span> <span class="n">units</span> <span class="o">(</span><span class="n">zmod</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span>
    <span class="n">val</span> <span class="o">:=</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">inv</span> <span class="o">:=</span> <span class="n">a</span><span class="bp">⁻¹</span><span class="o">,</span>
    <span class="n">val_inv</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">mul_inv_eq_gcd</span> <span class="n">n</span> <span class="n">a</span><span class="o">,</span> <span class="n">coprime</span><span class="bp">.</span><span class="n">gcd_eq_one</span> <span class="n">h</span><span class="o">]</span><span class="bp">;</span><span class="n">dsimp</span><span class="bp">;</span><span class="n">rw</span> <span class="n">zero_add</span><span class="o">,</span>
    <span class="n">inv_val</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">mul_comm</span><span class="o">,</span> <span class="n">mul_inv_eq_gcd</span> <span class="n">n</span> <span class="n">a</span><span class="o">,</span> <span class="n">coprime</span><span class="bp">.</span><span class="n">gcd_eq_one</span> <span class="n">h</span><span class="o">]</span><span class="bp">;</span><span class="n">dsimp</span><span class="bp">;</span><span class="n">rw</span> <span class="n">zero_add</span><span class="o">,</span>
<span class="o">}</span>
</pre></div>

<a name="132121924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/instance/near/132121924" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18934instance.html#132121924">Guy Leroy (Aug 14 2018 at 16:47)</a>:</h4>
<p>Okay thanks Mario</p>

<a name="132122004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/instance/near/132122004" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18934instance.html#132122004">Mario Carneiro (Aug 14 2018 at 16:49)</a>:</h4>
<p>I assume the <code>decidable_eq</code> goal is coming from <code>order_of</code></p>

<a name="132122352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/instance/near/132122352" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18934instance.html#132122352">Guy Leroy (Aug 14 2018 at 16:55)</a>:</h4>
<p>Very well thanks, I'm slowly trying to get a grasp of instances</p>


{% endraw %}
