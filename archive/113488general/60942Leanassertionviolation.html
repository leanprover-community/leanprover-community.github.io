---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/60942Leanassertionviolation.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html">Lean assertion violation</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="123293256"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123293256" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123293256">Kevin Buzzard (Mar 05 2018 at 09:05)</a>:</h4>
<div class="codehilite"><pre><span></span>universes u v

theorem set.subset.trans {α : Type*} {a b c : set α} (ab : a ⊆ b) (bc : b ⊆ c) : a ⊆ c :=
assume x h, bc (ab h)

def set.preimage {α : Type u} {β : Type v} (f : α → β) (s : set β) : set α := {x | f x ∈ s}
infix ` ⁻¹&#39; `:80 := set.preimage

structure presheaf_of_types (α : Type*) :=
(F : Π U : set α,  Type*)
(res : ∀ (U V : set α) (H : V ⊆ U),
  (F U) → (F V))
(Hcomp : ∀ (U V W : set α)
  (HUV : V ⊆ U) (HVW : W ⊆ V),
  (res U W (set.subset.trans HVW HUV)) = (res V W HVW) ∘ (res U V HUV) )

definition presheaf_of_types_pushforward
  {α : Type*}
  {β : Type*}
  (f : α → β)
  (FPT : presheaf_of_types α)
  : presheaf_of_types β :=
  { F := λ V : set β, FPT.F (set.preimage f V),
    res := λ V₁ V₂ H,
    FPT.res (set.preimage f V₁) (set.preimage f V₂)(λ x Hx,H Hx),
    Hcomp := λ Uβ Vβ Wβ HUV HVW,rfl -- assertion violation
}
</pre></div>

<a name="123293261"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123293261" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123293261">Kevin Buzzard (Mar 05 2018 at 09:05)</a>:</h4>
<div class="codehilite"><pre><span></span>LEAN ASSERTION VIOLATION
File: /home/travis/build/leanprover/lean/src/frontends/lean/elaborator.cpp
Line: 3167
Task: /home/buzzard/Encfs/Computer_languages/Lean/lean/bug.lean: presheaf_of_types_pushforward
m_ctx.match(e, *val2)
</pre></div>

<a name="123293307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123293307" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123293307">Kevin Buzzard (Mar 05 2018 at 09:06)</a>:</h4>
<p>Here's a (mathlib-free) assertion violation. Is this a known issue? If not, is my MWE minimal enough? If so, shall I file a bug report? I'd be happy to hear advice before working on this any more</p>

<a name="123293311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123293311" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123293311">Sebastian Ullrich (Mar 05 2018 at 09:06)</a>:</h4>
<p>I'm looking into it</p>

<a name="123293312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123293312" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123293312">Kevin Buzzard (Mar 05 2018 at 09:06)</a>:</h4>
<p><code>Lean (version 3.3.1, commit d6d44a19947e, Release)</code> Ubuntu 16.04</p>

<a name="123293315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123293315" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123293315">Sebastian Ullrich (Mar 05 2018 at 09:06)</a>:</h4>
<p>Can reproduce</p>

<a name="123293322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123293322" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123293322">Kevin Buzzard (Mar 05 2018 at 09:07)</a>:</h4>
<p>Thanks.</p>

<a name="123293326"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123293326" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123293326">Sebastian Ullrich (Mar 05 2018 at 09:08)</a>:</h4>
<p>I get the feeling structure notation is too sophisticated for our (the implementers') own good <span class="emoji emoji-1f605" title="sweat smile">:sweat_smile:</span></p>

<a name="123293365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123293365" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123293365">Kevin Buzzard (Mar 05 2018 at 09:08)</a>:</h4>
<p>ha ha</p>

<a name="123293368"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123293368" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123293368">Kevin Buzzard (Mar 05 2018 at 09:08)</a>:</h4>
<p>so it's my fault? :-)</p>

<a name="123293370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123293370" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123293370">Kevin Buzzard (Mar 05 2018 at 09:08)</a>:</h4>
<p>I wasn't expecting rfl to work, it's just sometimes worth a try</p>

<a name="123293376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123293376" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123293376">Sebastian Ullrich (Mar 05 2018 at 09:09)</a>:</h4>
<p>It's obviously our fault for enabling you to do weird things :)</p>

<a name="123293379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123293379" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123293379">Kevin Buzzard (Mar 05 2018 at 09:09)</a>:</h4>
<p>I would be interested to know what the first thing you do in this situation is. If it's to fire up some C++ debugger then fair enough, you've lost me already, but if it's to just set some options and watch more carefully then I would be interested to follow along for a while</p>

<a name="123293419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123293419" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123293419">Kevin Buzzard (Mar 05 2018 at 09:10)</a>:</h4>
<p>What do I do that is weird?</p>

<a name="123293548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123293548" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123293548">Kevin Buzzard (Mar 05 2018 at 09:14)</a>:</h4>
<p>actually I wonder whether I am now grown up enough to fire up a C++ debugger myself</p>

<a name="123293628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123293628" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123293628">Sebastian Ullrich (Mar 05 2018 at 09:16)</a>:</h4>
<p>It's a unification error, so I'm now looking at the <code>is_def_eq_detail</code> trace. The terms are still quite big - if you find a way to minimize them, that would be great.</p>

<a name="123293638"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123293638" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123293638">Kevin Buzzard (Mar 05 2018 at 09:17)</a>:</h4>
<p>OK I will try and minimise more</p>

<a name="123294055"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123294055" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123294055">Kevin Buzzard (Mar 05 2018 at 09:29)</a>:</h4>
<div class="codehilite"><pre><span></span>definition presheaf_of_types_pushforward
  {β : Type*}
  : presheaf_of_types β :=
  { F := sorry,
    res := sorry,
    Hcomp := λ Uβ Vβ Wβ HUV HVW,rfl -- assertion violation
}
</pre></div>

<a name="123294056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123294056" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123294056">Kevin Buzzard (Mar 05 2018 at 09:29)</a>:</h4>
<p>No idea if that helps</p>

<a name="123294100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123294100" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123294100">Kevin Buzzard (Mar 05 2018 at 09:30)</a>:</h4>
<p>I just replaced some stuff with sorry</p>

<a name="123294184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123294184" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123294184">Kevin Buzzard (Mar 05 2018 at 09:32)</a>:</h4>
<div class="codehilite"><pre><span></span>definition presheaf_of_types_pushforward
  {β : Type*}
  : presheaf_of_types β :=
  { Hcomp := λ Uβ Vβ Wβ HUV HVW,rfl -- assertion violation
}
</pre></div>

<a name="123294251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123294251" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123294251">Kevin Buzzard (Mar 05 2018 at 09:34)</a>:</h4>
<p>oh I have made it smaller</p>

<a name="123294257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123294257" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123294257">Kevin Buzzard (Mar 05 2018 at 09:34)</a>:</h4>
<div class="codehilite"><pre><span></span>universes u v

structure presheaf_of_types (α : Type*) :=
(F : Π U : set α,  Type*)
(res : ∀ (U V : set α) ,
  (F U) → (F V))
(Hcomp : ∀ (U V W : set α),
  (res U W  = (res V W) ∘ (res U V) ))

set_option trace.type_context.is_def_eq_detail true

definition presheaf_of_types_pushforward
  {β : Type*}
  : presheaf_of_types β :=
  { Hcomp := λ Uβ Vβ Wβ,rfl -- assertion violation
}
</pre></div>

<a name="123294683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123294683" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123294683">Kevin Buzzard (Mar 05 2018 at 09:46)</a>:</h4>
<div class="codehilite"><pre><span></span>structure presheaf_of_types (α : Type*) :=
(F : Π U : set α,  Type*)
(res : ∀ (U V : set α) ,
  (F U) → (F V))
(Hidem : ∀ U : set α, res U U = (res U U) ∘ (res U U))

set_option trace.type_context.is_def_eq_detail true

definition presheaf_of_types_pushforward
  {β : Type*}
  : presheaf_of_types β :=
  { Hidem := λ U, rfl,
}
</pre></div>

<a name="123295041"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295041" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295041">Kevin Buzzard (Mar 05 2018 at 09:57)</a>:</h4>
<div class="codehilite"><pre><span></span>structure presheaf_of_types (α : Type) :=
(res : ∀ (U V : set α) ,
  {x : α // U x} → {x : α // V x})
(Hidem : ∀ U : set α, res U U = (res U U) ∘ (res U U))

definition presheaf_of_types_pushforward
  {β : Type}
  : presheaf_of_types β :=
  { Hidem := λ U, rfl,
}
</pre></div>

<a name="123295092"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295092" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295092">Kevin Buzzard (Mar 05 2018 at 09:58)</a>:</h4>
<p>I'm going to stop there because all I am doing now is taking things like my general F from set alpha to Type and replacing it with an arbitrary explicit F (in this case the map sending U to the subtype corresponding to U)</p>

<a name="123295103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295103" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295103">Kevin Buzzard (Mar 05 2018 at 09:59)</a>:</h4>
<p>oh here's an even better one, I can just use some random map unit to unit</p>

<a name="123295104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295104" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295104">Kevin Buzzard (Mar 05 2018 at 09:59)</a>:</h4>
<div class="codehilite"><pre><span></span>structure presheaf_of_types (α : Type) :=
(res : ∀ (U V : set α) ,
  unit → unit)
(Hidem : ∀ U : set α, res U U = (res U U) ∘ (res U U))

definition presheaf_of_types_pushforward
  {β : Type}
  : presheaf_of_types β :=
  { Hidem := λ U, rfl,
}
</pre></div>

<a name="123295160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295160" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295160">Kevin Buzzard (Mar 05 2018 at 10:01)</a>:</h4>
<p>Still simpler:</p>

<a name="123295163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295163" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295163">Kevin Buzzard (Mar 05 2018 at 10:01)</a>:</h4>
<div class="codehilite"><pre><span></span>structure presheaf_of_types (α : Type) :=
(res : ∀ (U : set α) ,
  unit → unit)
(Hidem : ∀ U : set α, res U = (res U) ∘ (res U))

definition presheaf_of_types_pushforward
  {β : Type}
  : presheaf_of_types β :=
  { Hidem := λ U, rfl,
}
</pre></div>

<a name="123295210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295210" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295210">Kevin Buzzard (Mar 05 2018 at 10:02)</a>:</h4>
<div class="codehilite"><pre><span></span>structure presheaf_of_types (α : Type) :=
(res : unit → unit)
(Hidem : ∀ U : set α, res = (res) ∘ (res))

definition presheaf_of_types_pushforward
  {β : Type}
  : presheaf_of_types β :=
  { Hidem := λ U, rfl,
}
</pre></div>

<a name="123295231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295231" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295231">Sebastian Ullrich (Mar 05 2018 at 10:04)</a>:</h4>
<p>Thanks! That should do hopefully.</p>

<a name="123295270"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295270" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295270">Kevin Buzzard (Mar 05 2018 at 10:04)</a>:</h4>
<div class="codehilite"><pre><span></span>structure presheaf_of_types :=
(res : unit → unit)
(Hidem : ∀ U : unit, res = res ∘ res)

set_option trace.type_context.is_def_eq_detail true

definition presheaf_of_types_pushforward
  : presheaf_of_types :=
  { Hidem := λ U, rfl,
}
</pre></div>

<a name="123295286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295286" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295286">Kevin Buzzard (Mar 05 2018 at 10:05)</a>:</h4>
<p>Thanks for asking for more minimisation -- in some sense that was quite instructive. Initially I just removed everything not directly related to the violation in the form I had it, but after you asked more I realised there was nothing stopping me trying to find simpler violations</p>

<a name="123295366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295366" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295366">Kevin Buzzard (Mar 05 2018 at 10:07)</a>:</h4>
<p>Adding the field <code>res := id</code> makes the problem go away</p>

<a name="123295482"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295482" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295482">Kevin Buzzard (Mar 05 2018 at 10:10)</a>:</h4>
<p>Hey, is it doing a prolog-like search?</p>

<a name="123295495"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295495" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295495">Patrick Massot (Mar 05 2018 at 10:11)</a>:</h4>
<p>Poor Kevin was deprived of a prolog-like search yesterday</p>

<a name="123295496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295496" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295496">Patrick Massot (Mar 05 2018 at 10:11)</a>:</h4>
<p>Please be nice this time</p>

<a name="123295504"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295504" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295504">Kevin Buzzard (Mar 05 2018 at 10:11)</a>:</h4>
<p>I should never have equated this phrase with "random thing I don't understand"</p>

<a name="123295549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295549" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295549">Kevin Buzzard (Mar 05 2018 at 10:12)</a>:</h4>
<p>but looking at the debugging output it looks like it might be backtracking...</p>

<a name="123295576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295576" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295576">Patrick Massot (Mar 05 2018 at 10:13)</a>:</h4>
<p>I'm picturing you asking to Scholze: "are you doing a a prolog-like search" at the end of a really tough talk.</p>

<a name="123295702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295702" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295702">Kevin Buzzard (Mar 05 2018 at 10:17)</a>:</h4>
<p>Maybe I don't even know what backtracking means. I guess I look at these debugging outputs and think "oh look it's trying lots of things in what looks like a systematic manner"</p>

<a name="123295706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295706" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295706">Patrick Massot (Mar 05 2018 at 10:17)</a>:</h4>
<p>It's not enough</p>

<a name="123295709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295709" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295709">Kevin Buzzard (Mar 05 2018 at 10:17)</a>:</h4>
<p>but I probably need to look more closely to distinguish the difference between "if this fails, discard it and try something else"</p>

<a name="123295710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295710" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295710">Kevin Buzzard (Mar 05 2018 at 10:17)</a>:</h4>
<p>and "let's actually backtrack here"</p>

<a name="123295711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295711" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295711">Patrick Massot (Mar 05 2018 at 10:17)</a>:</h4>
<p>You want to start following a path and then come back to an earlier branch point</p>

<a name="123295714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123295714" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123295714">Kevin Buzzard (Mar 05 2018 at 10:17)</a>:</h4>
<p>yes this is just dawning on me now</p>

<a name="123298542"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298542" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298542">Sebastian Ullrich (Mar 05 2018 at 11:51)</a>:</h4>
<p><span class="user-mention" data-user-email="k.buzzard@imperial.ac.uk" data-user-id="110038">@Kevin Buzzard</span> Congrats, I think you found a bug where definitional equality is not idempotent</p>

<a name="123298548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298548" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298548">Kevin Buzzard (Mar 05 2018 at 11:51)</a>:</h4>
<p>Is that a good thing?</p>

<a name="123298549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298549" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298549">Kevin Buzzard (Mar 05 2018 at 11:51)</a>:</h4>
<p>Do I get an achievement?</p>

<a name="123298550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298550" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298550">Patrick Massot (Mar 05 2018 at 11:51)</a>:</h4>
<p>I'm jalous</p>

<a name="123298585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298585" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298585">Patrick Massot (Mar 05 2018 at 11:52)</a>:</h4>
<p>My conv bug seems much less cool</p>

<a name="123298715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298715" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298715">Gabriel Ebner (Mar 05 2018 at 11:57)</a>:</h4>
<p><span class="user-mention" data-user-email="sebasti@nullri.ch" data-user-id="110024">@Sebastian Ullrich</span> "Idempotent"??  Do you mean <code>is_def_eq(t, t)</code> returns false?</p>

<a name="123298717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298717" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298717">Sebastian Ullrich (Mar 05 2018 at 11:57)</a>:</h4>
<p>On the first run it returns true for two terms, then false on any subsequent runs</p>

<a name="123298811"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298811" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298811">Kevin Buzzard (Mar 05 2018 at 12:00)</a>:</h4>
<p>ooh can I prove false??</p>

<a name="123298814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298814" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298814">Kevin Buzzard (Mar 05 2018 at 12:00)</a>:</h4>
<p>I would definitely get an achievement for that</p>

<a name="123298816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298816" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298816">Sebastian Ullrich (Mar 05 2018 at 12:00)</a>:</h4>
<p>Nah, it's just the elaborator</p>

<a name="123298818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298818" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298818">Kevin Buzzard (Mar 05 2018 at 12:00)</a>:</h4>
<p>aah well</p>

<a name="123298831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298831" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298831">Sebastian Ullrich (Mar 05 2018 at 12:01)</a>:</h4>
<p>Apparently <code>elim_delayed_abstractions</code> accidentally supports backtracking assignments to a metavar... not the correct place for a Prolog-like search</p>

<a name="123298834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298834" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298834">Kevin Buzzard (Mar 05 2018 at 12:01)</a>:</h4>
<p>you lost me at the prolog-like search bit</p>

<a name="123298883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298883" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298883">Sebastian Ullrich (Mar 05 2018 at 12:02)</a>:</h4>
<p>That was mostly a joke :)</p>

<a name="123298896"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298896" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298896">Gabriel Ebner (Mar 05 2018 at 12:03)</a>:</h4>
<p>Wow, this is unexpected.</p>

<a name="123298946"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298946" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298946">Kevin Buzzard (Mar 05 2018 at 12:04)</a>:</h4>
<p>Kenny posted this about a week ago</p>

<a name="123298947"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298947" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298947">Kevin Buzzard (Mar 05 2018 at 12:04)</a>:</h4>
<p><code>instance error (α : Type) : group α := { mul_assoc := λ x y z, rfl }
</code></p>

<a name="123298948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298948" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298948">Kevin Buzzard (Mar 05 2018 at 12:04)</a>:</h4>
<p>without any further comment</p>

<a name="123298954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123298954" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123298954">Kevin Buzzard (Mar 05 2018 at 12:05)</a>:</h4>
<p>and it might be the same thing</p>

<a name="123299000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123299000" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123299000">Sebastian Ullrich (Mar 05 2018 at 12:06)</a>:</h4>
<p>Yep, same assertion</p>

<a name="123299285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20assertion%20violation/near/123299285" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/60942Leanassertionviolation.html#123299285">Patrick Massot (Mar 05 2018 at 12:17)</a>:</h4>
<p><a href="/user_uploads/3121/JbuLIJprxGe-IqMGOyrrJlyK/users.png" target="_blank" title="users.png">users.png</a><br>
One little bug and everybody flies out, except devs. So sad...</p>
<div class="message_inline_image"><a href="/user_uploads/3121/JbuLIJprxGe-IqMGOyrrJlyK/users.png" target="_blank" title="users.png"><img src="/user_uploads/3121/JbuLIJprxGe-IqMGOyrrJlyK/users.png"></a></div>


{% endraw %}
