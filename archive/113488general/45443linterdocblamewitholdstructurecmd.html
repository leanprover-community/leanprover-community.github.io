---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/45443linterdocblamewitholdstructurecmd.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html">linter doc_blame with old_structure_cmd</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="193763256"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193763256" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193763256">Oliver Nash (Apr 13 2020 at 11:25)</a>:</h4>
<p>The following snippet triggers the "missing doc string" complaint from the linter:</p>
<div class="codehilite"><pre><span></span><span class="kn">set_option</span> <span class="n">old_structure_cmd</span> <span class="n">true</span>

<span class="c">/-</span><span class="cm">- Foo structure -/</span>
<span class="kn">structure</span> <span class="n">foo</span> <span class="o">:=</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span>

<span class="c">/-</span><span class="cm">- Bar structure -/</span>
<span class="kn">structure</span> <span class="n">bar</span> <span class="kn">extends</span> <span class="n">foo</span> <span class="o">:=</span> <span class="o">(</span><span class="n">y</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span>

<span class="bp">#</span><span class="n">lint</span> <span class="c1">-- #print bar.to_foo /- def missing doc string -/</span>
</pre></div>

<a name="193763345"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193763345" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193763345">Kenny Lau (Apr 13 2020 at 11:26)</a>:</h4>
<p>then don't use <code>old_structure_cmd</code></p>

<a name="193763348"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193763348" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193763348">Oliver Nash (Apr 13 2020 at 11:26)</a>:</h4>
<p>I note that even though Lean automatically created <code>bar.to_foo</code> regardless of whether I'm using the <code>old_structure_cmd</code>, it is only when this option is true (as above) that the linter complains.</p>

<a name="193763359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193763359" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193763359">Mario Carneiro (Apr 13 2020 at 11:26)</a>:</h4>
<p>well it's not wrong</p>

<a name="193763383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193763383" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193763383">Oliver Nash (Apr 13 2020 at 11:26)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> Oh really? It's much more convenient in some situations I think. I'd be happy to be corrected!</p>

<a name="193763418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193763418" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193763418">Kenny Lau (Apr 13 2020 at 11:27)</a>:</h4>
<p>I was referring to the old joke "Doctor I feel painful when I breathe; doctor: then don't breathe"</p>

<a name="193763420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193763420" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193763420">Mario Carneiro (Apr 13 2020 at 11:27)</a>:</h4>
<p>I would hate for this to be the reason you choose one method over the other</p>

<a name="193763421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193763421" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193763421">Oliver Nash (Apr 13 2020 at 11:27)</a>:</h4>
<p>I had scanned some old threads here before deciding to use it and I <em>thought</em> the current wisdom was that it's fine to use it, and even that the name is a bit of a misnomer but really I'm far from sure.</p>

<a name="193763432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193763432" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193763432">Oliver Nash (Apr 13 2020 at 11:28)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> Ah I see. <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>

<a name="193763481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193763481" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193763481">Oliver Nash (Apr 13 2020 at 11:28)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Noted, thanks. Perhaps I'll add an appropriate <code>nolint</code> statement and allow the advice to flow in the code review.</p>

<a name="193763491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193763491" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193763491">Oliver Nash (Apr 13 2020 at 11:28)</a>:</h4>
<p>Thank you both.</p>

<a name="193763497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193763497" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193763497">Mario Carneiro (Apr 13 2020 at 11:28)</a>:</h4>
<p>you can also document it</p>

<a name="193763513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193763513" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193763513">Mario Carneiro (Apr 13 2020 at 11:29)</a>:</h4>
<p>there is a command like <code>add_doc_string</code> for adding doc strings to automatic definitions</p>

<a name="193763523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193763523" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193763523">Rob Lewis (Apr 13 2020 at 11:29)</a>:</h4>
<p>The linter generally ignores auto-generated stuff but I guess this doesn't get flagged as auto-generated.</p>

<a name="193763529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193763529" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193763529">Gabriel Ebner (Apr 13 2020 at 11:29)</a>:</h4>
<p>It's called <code>add_decl_doc</code>.</p>

<a name="193763607"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193763607" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193763607">Oliver Nash (Apr 13 2020 at 11:30)</a>:</h4>
<p>OK thanks. It feels a bit funny to have to add a doc string to an auto-generated function but I am still glad to learn about <code>add_decl_doc</code>.</p>

<a name="193763895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193763895" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193763895">Kevin Buzzard (Apr 13 2020 at 11:35)</a>:</h4>
<p>You're right that the name is terrible. It implies it's deprecated, whereas in fact for part of the structure heirarchy it's exactly what we want.</p>

<a name="193764064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193764064" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193764064">Mario Carneiro (Apr 13 2020 at 11:38)</a>:</h4>
<p>PR?</p>

<a name="193764072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193764072" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193764072">Mario Carneiro (Apr 13 2020 at 11:38)</a>:</h4>
<p>How about <code>flat_structure</code> instead</p>

<a name="193764075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193764075" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193764075">Oliver Nash (Apr 13 2020 at 11:38)</a>:</h4>
<p>I literally just created one here: <a href="https://github.com/leanprover-community/mathlib/pull/2404" title="https://github.com/leanprover-community/mathlib/pull/2404">https://github.com/leanprover-community/mathlib/pull/2404</a></p>

<a name="193764083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193764083" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193764083">Oliver Nash (Apr 13 2020 at 11:38)</a>:</h4>
<p>(I'm currently scanning it to make sure I haven't done anything stupid before I request review.)</p>

<a name="193764108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193764108" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193764108">Oliver Nash (Apr 13 2020 at 11:39)</a>:</h4>
<p>I have not previously seen <code>flat_structure</code>. I'd love to learn about it. I just grepped the Mathlib source but didn't find it anywhere!</p>

<a name="193764114"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193764114" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193764114">Mario Carneiro (Apr 13 2020 at 11:39)</a>:</h4>
<p>I just made the name up</p>

<a name="193764124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193764124" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193764124">Mario Carneiro (Apr 13 2020 at 11:39)</a>:</h4>
<p>as an alternative to <code>old_structure_cmd</code> which has wrong connotations</p>

<a name="193764127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193764127" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193764127">Oliver Nash (Apr 13 2020 at 11:39)</a>:</h4>
<p>Oh I see: my comment about the possible misnomer. Yeah, <code>flat_structure</code> is nice</p>

<a name="193764169"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/linter%20doc_blame%20with%20old_structure_cmd/near/193764169" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/45443linterdocblamewitholdstructurecmd.html#193764169">Oliver Nash (Apr 13 2020 at 11:40)</a>:</h4>
<p>I'd vote for that over <code>old_structure_cmd</code> for sure.</p>


{% endraw %}

{% include archive_update.html %}