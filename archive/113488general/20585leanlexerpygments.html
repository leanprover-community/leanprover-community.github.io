---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/20585leanlexerpygments.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/20585leanlexerpygments.html">lean lexer (pygments)</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="130273767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20lexer%20%28pygments%29/near/130273767" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20585leanlexerpygments.html#130273767">Joseph Corneli (Jul 25 2018 at 12:59)</a>:</h4>
<p>FYI I found and reported the following bug in the LeanLexer: <a href="https://bitbucket.org/birkenfeld/pygments-main/issues/1459/leanlexer-does-not-have-a-operator" target="_blank" title="https://bitbucket.org/birkenfeld/pygments-main/issues/1459/leanlexer-does-not-have-a-operator">#1459: LeanLexer does not have a "^" operator</a>.  The fix is simple, but my BitBucket account is locked so I can't submit the fix myself! (... Though I guess I could register another account there easily enough ...) Maybe it's worth setting up a stress-test for the Lexer to make sure that it has all the other required syntax?</p>

<a name="130274242"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20lexer%20%28pygments%29/near/130274242" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20585leanlexerpygments.html#130274242">Gabriel Ebner (Jul 25 2018 at 13:08)</a>:</h4>
<p>BTW, we're using a pygments fork for the reference manual, etc.: <a href="https://bitbucket.org/gebner/pygments-main/src/default/" target="_blank" title="https://bitbucket.org/gebner/pygments-main/src/default/">https://bitbucket.org/gebner/pygments-main/src/default/</a></p>

<a name="130274253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20lexer%20%28pygments%29/near/130274253" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20585leanlexerpygments.html#130274253">Gabriel Ebner (Jul 25 2018 at 13:08)</a>:</h4>
<p>The upstream pygments project is unfortunately not very active.  The lean highlighting there is still from Lean 2.</p>

<a name="130278694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20lexer%20%28pygments%29/near/130278694" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20585leanlexerpygments.html#130278694">Patrick Massot (Jul 25 2018 at 14:34)</a>:</h4>
<p>And we still need to bring this fork to use in Zulip...</p>

<a name="130280318"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20lexer%20%28pygments%29/near/130280318" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20585leanlexerpygments.html#130280318">Joseph Corneli (Jul 25 2018 at 15:01)</a>:</h4>
<blockquote>
<p>The upstream pygments project is unfortunately not very active.  The lean highlighting there is still from Lean 2.</p>
</blockquote>
<p>Thanks for the tip!  I installed the fork, and got a replacement version of sphinx set up with the correct requirement <code>'Pygments==2.1a0.dev20180725',</code> in <code>setup.py</code>.  No problems with this version of the LeanLexer.</p>

<a name="165468973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20lexer%20%28pygments%29/near/165468973" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20585leanlexerpygments.html#165468973">William DeMeo (May 12 2019 at 15:23)</a>:</h4>
<p>Is anyone else having trouble with Pygments?  I'm getting the error <code>WARNING: Could not lex literal_block as "lean". Highlighting skipped.</code> with valid lean code when I try to <code>make html</code> with sphinx. What version of Pygments is working well with Lean and how do I install it and make sure that's the version that is being used when I do <code>make html</code>.  Any/all suggestions would be much appreciated!</p>

<a name="165470006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20lexer%20%28pygments%29/near/165470006" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20585leanlexerpygments.html#165470006">William DeMeo (May 12 2019 at 15:52)</a>:</h4>
<p><span class="user-mention" data-user-id="122022">@Joseph Corneli</span> Can you share with me the "simple fix" you found for getting lexer to lex specific symbols,  e.g., <code>^</code>?  Right now I'm getting an error with valid Lean code, I think because of the presence of certain symbols such as these: <code>⋂₀, Π, ↑, ∘</code>.</p>

<a name="165470089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20lexer%20%28pygments%29/near/165470089" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20585leanlexerpygments.html#165470089">Reid Barton (May 12 2019 at 15:55)</a>:</h4>
<p>Are you using <span class="user-mention" data-user-id="110043">@Gabriel Ebner</span>'s fork of pygments? <a href="https://bitbucket.org/gebner/pygments-main/src/default/" target="_blank" title="https://bitbucket.org/gebner/pygments-main/src/default/">https://bitbucket.org/gebner/pygments-main/src/default/</a></p>

<a name="165500563"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20lexer%20%28pygments%29/near/165500563" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20585leanlexerpygments.html#165500563">William DeMeo (May 13 2019 at 05:54)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span> thanks for the suggestion. It's hard for me to know version I'm using.  I did clone Gabriel Ebner's fork of pygments and I installed it with the command <code>pip3 install Pygments</code>.  Nothing changed.  I then tried <span class="user-mention" data-user-id="122022">@Joseph Corneli</span> 's suggestion from last July, adding <code>version = '2.1a0.dev20180725',</code> to the setup.py file in the pygments-main directory and (re)installed pygments with the command <code>sudo python3 setup.py install</code>  It seems to have installed successfully.  (I get the response <code>Installed /usr/local/lib/python3.6/dist-packages/Pygments-2.1a0.dev20180725dev_20190512-py3.6.egg</code> among lots of other output.)  Nothing changed.  The lexer still fails to lex correct Lean code involving the symbols I mentioned above.</p>

<a name="165500826"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20lexer%20%28pygments%29/near/165500826" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20585leanlexerpygments.html#165500826">William DeMeo (May 13 2019 at 06:00)</a>:</h4>
<p>Next I tried to replicate the setup of the Logic and Proof book as closely as possible.  This sets up a fresh install of needed dependencies in a local directory called .venv, when one invokes <code>make install-deps</code>(in particular, this make directive installs pygments with <code> pip3 install https://bitbucket.org/gebner/pygments-main/get/default.tar.gz#egg=Pygments</code>.   However, after <code>make install-deps</code> completes successfully, I invoke <code>make html</code> and I get the following weird output:  <br>
``Running Sphinx v2.0.1</p>
<p>Extension error:<br>
Could not import extension sphinx.builders.epub3 (exception: No module named 'sphinxcontrib.serializinghtml')<br>
Makefile:35: recipe for target 'html' failed<br>
make: *** [html] Error 2``</p>
<p>...which is strange because I have compiled the Logic and Proof book before and it worked fine.  Well, I'll keep hacking away at this for a while, but may have to let it go unresolved for now.</p>

<a name="165501359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20lexer%20%28pygments%29/near/165501359" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20585leanlexerpygments.html#165501359">William DeMeo (May 13 2019 at 06:15)</a>:</h4>
<p>Out of curiosity, I tried the following experiment: I inserted the seemingly unlexable bit of Lean code (code that includes symbols like <code>↑</code> and <code>∘</code>) into a code-block of my fork of the Logic and Proof book and tried <code>make html</code>, and low and behold, the lexer could handle it... so clearly there's something wrong with the setup of my other project.  When I resolve it, if there's any useful information that comes out of this, I'll post again.  Thanks again for your help!</p>


{% endraw %}

{% include archive_update.html %}