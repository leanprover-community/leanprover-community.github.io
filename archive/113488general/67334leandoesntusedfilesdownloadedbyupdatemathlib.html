---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html">lean doesn't used files downloaded by update-mathlib</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="168571417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168571417" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168571417">Floris van Doorn (Jun 20 2019 at 06:57)</a>:</h4>
<p>Someone in the Hanoi formalabstracts group had the following issue. After running <code>update-mathlib</code>, Lean does not use the downloaded compiled files (the compilation time of <code>logic.basic</code> is instantaneous, but the compilation time is longer if we go further into mathlib, both in VSCode and running <code>lean</code> on the command line).</p>
<p>Does someone have an idea what could cause the issue? I attached a downloaded and compiled olean file from her laptop. There are some changes on the first line which might give a hint to someone who can read that line (<span class="user-mention" data-user-id="110049">@Mario Carneiro</span>?). </p>
<p>Some notes: It is a Windows laptop, and <code>elan</code> was not installed on her laptop (is that a potential issue?).</p>
<p><a href="/user_uploads/3121/yDUy8mdnlcJd5VDTE8JtyJ_Z/basic.olean" target="_blank" title="basic.olean">basic.olean</a> <a href="/user_uploads/3121/I28tnDj4Op7LRH_RwemJAl3Z/basic_downloaded.olean" target="_blank" title="basic_downloaded.olean">basic_downloaded.olean</a></p>

<a name="168571471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168571471" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168571471">Mario Carneiro (Jun 20 2019 at 06:58)</a>:</h4>
<p>if there is a change in the first few lines of the olean file that's probably the checksum</p>

<a name="168571546"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168571546" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168571546">Floris van Doorn (Jun 20 2019 at 07:00)</a>:</h4>
<p>This is the checksum of the <code>.lean</code> file which is used to see if the file needs to be compiled again?</p>

<a name="168571577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168571577" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168571577">Floris van Doorn (Jun 20 2019 at 07:01)</a>:</h4>
<p>was there a description of the meaning of the first line? I remember seeing that somewhere...</p>

<a name="168571734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168571734" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168571734">Mario Carneiro (Jun 20 2019 at 07:04)</a>:</h4>
<p>oh no, it's the file length</p>

<a name="168571769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168571769" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168571769">Mario Carneiro (Jun 20 2019 at 07:05)</a>:</h4>
<p>no I was right the first time, it's the checksum</p>

<a name="168571773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168571773" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168571773">Mario Carneiro (Jun 20 2019 at 07:05)</a>:</h4>
<p>I suggest olean-rs for documentation on the olean format</p>

<a name="168571823"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168571823" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168571823">Mario Carneiro (Jun 20 2019 at 07:06)</a>:</h4>
<p><a href="https://github.com/digama0/olean-rs/blob/master/olean.lean" target="_blank" title="https://github.com/digama0/olean-rs/blob/master/olean.lean">https://github.com/digama0/olean-rs/blob/master/olean.lean</a></p>

<a name="168572039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168572039" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168572039">Mario Carneiro (Jun 20 2019 at 07:12)</a>:</h4>
<p>The olean dumps are identical though</p>

<a name="168572066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168572066" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168572066">Mario Carneiro (Jun 20 2019 at 07:13)</a>:</h4>
<p>It's a checksum of the rest of the olean file</p>

<a name="168572078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168572078" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168572078">Mario Carneiro (Jun 20 2019 at 07:13)</a>:</h4>
<p>And indeed the files are not byte for byte identical, there is a change somewhere in the middle but the dumps are the same suggesting it's not a semantic difference</p>

<a name="168572524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168572524" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168572524">Floris van Doorn (Jun 20 2019 at 07:23)</a>:</h4>
<p>So any idea why these <code>.olean</code> files are not used by lean?</p>

<a name="168572537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168572537" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168572537">Mario Carneiro (Jun 20 2019 at 07:23)</a>:</h4>
<p>they aren't the same, so yeah</p>

<a name="168572577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168572577" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168572577">Mario Carneiro (Jun 20 2019 at 07:24)</a>:</h4>
<p>lean rejects it because it's changed</p>

<a name="168572583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168572583" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168572583">Mario Carneiro (Jun 20 2019 at 07:24)</a>:</h4>
<p>I'm not sure what exactly has changed or why though</p>

<a name="168572689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168572689" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168572689">Floris van Doorn (Jun 20 2019 at 07:26)</a>:</h4>
<p>Also, does your <code>def read_olean</code> read the checksum/whatever the difference is between the files on the first line?</p>
<p>I'll double check if she has the same version of Lean as me.</p>

<a name="168572788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168572788" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168572788">Mario Carneiro (Jun 20 2019 at 07:28)</a>:</h4>
<p>The lean version of the olean reader ignores the checksum, but the rust version computes the real checksum and compares</p>

<a name="168572797"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168572797" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168572797">Mario Carneiro (Jun 20 2019 at 07:29)</a>:</h4>
<p>The lean version is stored in the olean file, and it's the same</p>

<a name="168572859"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168572859" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168572859">Floris van Doorn (Jun 20 2019 at 07:30)</a>:</h4>
<p>ah, I see, that's <code>claimed_hash</code>.</p>

<a name="168580093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168580093" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168580093">Floris van Doorn (Jun 20 2019 at 09:30)</a>:</h4>
<p>In the end we just reinstalled Lean from scratch, which solved the issue.</p>

<a name="168581259"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168581259" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168581259">Scott Morrison (Jun 20 2019 at 09:47)</a>:</h4>
<p>Hopefully using elan this time. :-)</p>

<a name="168583479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168583479" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168583479">Floris van Doorn (Jun 20 2019 at 10:22)</a>:</h4>
<p>Of course :)</p>

<a name="168587414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168587414" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168587414">Andrew Ashworth (Jun 20 2019 at 11:33)</a>:</h4>
<p>I wonder if when Lean4 comes out there will be interest in binary package management</p>

<a name="168587471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168587471" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168587471">Andrew Ashworth (Jun 20 2019 at 11:34)</a>:</h4>
<p>With the bigger focus on code extraction to C++, and people grousing about compile times for both languages, seems like it could be useful</p>

<a name="168587488"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168587488" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168587488">Andrew Ashworth (Jun 20 2019 at 11:34)</a>:</h4>
<p>I've been using Conan to manage my C++ build dependencies lately and I've been pretty impressed.</p>

<a name="168588275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/168588275" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#168588275">Simon Hudon (Jun 20 2019 at 11:49)</a>:</h4>
<p>I've been thinking of adopting a solution like Nix for building snapshots of the Lean ecosystem and distributing the binaries. Unfortunately, we can't adopt Nix because of complications on Windows. But I'm looking different package management approaches for Lean 3 and <span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> is looking at it for Lean 4</p>

<a name="169702460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/169702460" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#169702460">Johan Commelin (Jul 05 2019 at 11:43)</a>:</h4>
<p>I'm also having problems now... on Linux.</p>

<a name="169702470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/169702470" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#169702470">Johan Commelin (Jul 05 2019 at 11:43)</a>:</h4>
<p>I run <code>update-mathlib</code> in the perfectoid project, but Lean happily starts recompiling all the dependencies.</p>

<a name="169702827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/169702827" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#169702827">Kevin Buzzard (Jul 05 2019 at 11:50)</a>:</h4>
<p>Check the timestamps of the olean files and see if they're strictly after the timestamps of the corresponding lean files.</p>

<a name="169702889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/169702889" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#169702889">Johan Commelin (Jul 05 2019 at 11:52)</a>:</h4>
<p>Ok, let me try to do that...</p>

<a name="169703115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/169703115" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#169703115">Johan Commelin (Jul 05 2019 at 11:56)</a>:</h4>
<div class="codehilite"><pre><span></span>-rw-rw-r-- <span class="m">1</span> jmc jmc  <span class="m">4274</span> Jun <span class="m">14</span> <span class="m">15</span>:36 _target/deps/mathlib/src/tactic/squeeze.lean
-rw-rw-r-- <span class="m">1</span> jmc jmc <span class="m">19564</span> Jul  <span class="m">3</span> <span class="m">11</span>:52 _target/deps/mathlib/src/tactic/squeeze.olean
</pre></div>

<a name="169703118"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/169703118" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#169703118">Johan Commelin (Jul 05 2019 at 11:56)</a>:</h4>
<p>Looks fine to me.</p>

<a name="169703368"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/169703368" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#169703368">Johan Commelin (Jul 05 2019 at 12:01)</a>:</h4>
<p><span class="user-mention" data-user-id="110026">@Simon Hudon</span> Any clue what could be the issue here?</p>

<a name="169711440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/169711440" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#169711440">Johan Commelin (Jul 05 2019 at 14:10)</a>:</h4>
<p><code>find src | grep "[.]olean" | xargs touch</code> has saved me quite a bit today</p>

<a name="169785456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/169785456" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#169785456">Simon Hudon (Jul 06 2019 at 22:42)</a>:</h4>
<p>do you know what archive you're expanding? Try expanding it in a new directory and checking the time stamps of <code>squeeze.[o]lean</code> again</p>

<a name="172123129"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/172123129" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#172123129">Kevin Kappelmann (Jul 31 2019 at 12:43)</a>:</h4>
<p>Is there some URL that update-mathlib uses to download the latest mathlib + olean files? I'd like to use it for the <a href="https://competition.isabelle.systems/competitions/" target="_blank" title="https://competition.isabelle.systems/competitions/">proving is fun</a> backend.</p>

<a name="172123531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/172123531" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#172123531">Kevin Kappelmann (Jul 31 2019 at 12:48)</a>:</h4>
<p>I think I got it: <a href="https://github.com/leanprover-community/mathlib-nightly/releases" target="_blank" title="https://github.com/leanprover-community/mathlib-nightly/releases">https://github.com/leanprover-community/mathlib-nightly/releases</a></p>

<a name="172169210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/172169210" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#172169210">Floris van Doorn (Jul 31 2019 at 21:48)</a>:</h4>
<p>I'm having these problems now myself. I downloaded today's archive - file name <code>mathlib-olean-nightly-2019-07-31.tar.gz</code>. However, if I make a single file, it seems to recompile a large chunk of the library.</p>
<p>In more detail:</p>
<ul>
<li>I extract the archive I downloaded earlier today:</li>
</ul>
<div class="codehilite"><pre><span></span>Floris@MSI MINGW64 /d/projects/mathlib ((badeb48b...))
$ cache-olean --fetch
Info: No github section found in &#39;git config&#39;, we will use GitHub with no authentication
Querying GitHub...
Reusing cached olean archive
... successfully extracted olean archive.
</pre></div>


<ul>
<li>I check in more detail what's in the <code>algebra</code> folder:</li>
</ul>
<div class="codehilite"><pre><span></span>Floris@MSI MINGW64 /d/projects/mathlib ((badeb48b...))
$ ls src/algebra/ -alt --time-style=full-iso
total 3973
drwxr-xr-x 1 Floris 197121      0 2019-07-31 05:24:01.000000000 -0400 ./
drwxr-xr-x 1 Floris 197121      0 2019-07-31 05:24:01.000000000 -0400 CommRing/
drwxr-xr-x 1 Floris 197121      0 2019-07-31 05:24:01.000000000 -0400 Mon/
drwxr-xr-x 1 Floris 197121      0 2019-07-31 05:23:59.000000000 -0400 group/
-rw-r--r-- 1 Floris 197121 470882 2019-07-31 05:14:21.000000000 -0400 direct_limit.olean
-rw-r--r-- 1 Floris 197121  48982 2019-07-30 03:28:45.000000000 -0400 direct_sum.olean
-rw-r--r-- 1 Floris 197121 240420 2019-07-30 03:25:53.000000000 -0400 pi_instances.olean
-rw-r--r-- 1 Floris 197121  23435 2019-07-30 03:24:39.000000000 -0400 punit_instances.olean
-rw-r--r-- 1 Floris 197121  46890 2019-07-30 03:22:47.000000000 -0400 char_p.olean
-rw-r--r-- 1 Floris 197121   2195 2019-07-30 03:22:01.000000000 -0400 default.olean
-rw-r--r-- 1 Floris 197121 194740 2019-07-30 03:22:00.000000000 -0400 module.olean
-rw-r--r-- 1 Floris 197121 115308 2019-07-30 03:20:25.000000000 -0400 pointwise.olean
-rw-r--r-- 1 Floris 197121 267084 2019-07-30 03:08:50.000000000 -0400 big_operators.olean
-rw-r--r-- 1 Floris 197121 228629 2019-07-30 03:07:36.000000000 -0400 gcd_domain.olean
-rw-r--r-- 1 Floris 197121 190155 2019-07-30 03:06:20.000000000 -0400 associated.olean
-rw-r--r-- 1 Floris 197121 144643 2019-07-30 03:05:46.000000000 -0400 archimedean.olean
-rw-r--r-- 1 Floris 197121  51843 2019-07-30 03:02:00.000000000 -0400 field_power.olean
-rw-r--r-- 1 Floris 197121 168299 2019-07-30 03:01:50.000000000 -0400 group_power.olean
-rw-r--r-- 1 Floris 197121 110312 2019-07-30 03:01:26.000000000 -0400 euclidean_domain.olean
-rw-r--r-- 1 Floris 197121  45067 2019-07-30 03:00:16.000000000 -0400 ordered_field.olean
-rw-r--r-- 1 Floris 197121  17108 2019-07-30 03:00:12.000000000 -0400 char_zero.olean
-rw-r--r-- 1 Floris 197121  51115 2019-07-30 03:00:10.000000000 -0400 field.olean
-rw-r--r-- 1 Floris 197121   8777 2019-07-30 03:00:05.000000000 -0400 field.lean
-rw-r--r-- 1 Floris 197121  27526 2019-07-30 03:00:05.000000000 -0400 group_power.lean
-rw-r--r-- 1 Floris 197121   9130 2019-07-30 03:00:05.000000000 -0400 ordered_field.lean
-rw-r--r-- 1 Floris 197121 306809 2019-07-29 12:26:57.000000000 -0400 ordered_ring.olean
-rw-r--r-- 1 Floris 197121  47613 2019-07-29 12:25:06.000000000 -0400 order_functions.olean
-rw-r--r-- 1 Floris 197121 298623 2019-07-29 12:25:05.000000000 -0400 ordered_group.olean
-rw-r--r-- 1 Floris 197121 269333 2019-07-29 12:22:18.000000000 -0400 free.olean
-rw-r--r-- 1 Floris 197121 180370 2019-07-29 12:21:26.000000000 -0400 ring.olean
-rw-r--r-- 1 Floris 197121  45015 2019-07-29 12:18:42.000000000 -0400 opposites.olean
-rw-r--r-- 1 Floris 197121  15325 2019-07-19 10:40:32.000000000 -0400 free.lean
-rw-r--r-- 1 Floris 197121  18757 2019-07-18 11:19:45.000000000 -0400 pi_instances.lean
-rw-r--r-- 1 Floris 197121  10353 2019-07-18 11:19:45.000000000 -0400 pointwise.lean
drwxr-xr-x 1 Floris 197121      0 2019-07-12 17:47:57.000000000 -0400 ../
-rw-r--r-- 1 Floris 197121  26082 2019-07-11 09:59:06.000000000 -0400 gcd_domain.lean
-rw-r--r-- 1 Floris 197121  30949 2019-07-11 06:13:21.000000000 -0400 big_operators.lean
-rw-r--r-- 1 Floris 197121  25098 2019-07-11 06:13:21.000000000 -0400 direct_limit.lean
-rw-r--r-- 1 Floris 197121   6126 2019-07-11 06:13:21.000000000 -0400 direct_sum.lean
-rw-r--r-- 1 Floris 197121  14904 2019-07-11 06:13:21.000000000 -0400 module.lean
-rw-r--r-- 1 Floris 197121   3561 2019-07-11 06:13:21.000000000 -0400 punit_instances.lean
-rw-r--r-- 1 Floris 197121  11805 2019-07-11 06:13:21.000000000 -0400 ring.lean
-rw-r--r-- 1 Floris 197121  18067 2019-07-11 00:19:32.000000000 -0400 ordered_ring.lean
-rw-r--r-- 1 Floris 197121  25188 2019-07-04 15:49:44.000000000 -0400 ordered_group.lean
-rw-r--r-- 1 Floris 197121  10197 2019-07-04 12:48:24.000000000 -0400 order_functions.lean
-rw-r--r-- 1 Floris 197121  15761 2019-06-14 21:30:47.000000000 -0400 archimedean.lean
-rw-r--r-- 1 Floris 197121  32748 2019-06-14 09:37:10.000000000 -0400 order.olean
-rw-r--r-- 1 Floris 197121  25505 2019-06-14 09:36:49.000000000 -0400 associated.lean
-rw-r--r-- 1 Floris 197121   8715 2019-06-14 09:36:49.000000000 -0400 char_p.lean
-rw-r--r-- 1 Floris 197121   3118 2019-06-14 09:36:49.000000000 -0400 char_zero.lean
-rw-r--r-- 1 Floris 197121    182 2019-06-14 09:36:49.000000000 -0400 default.lean
-rw-r--r-- 1 Floris 197121  13472 2019-06-14 09:36:49.000000000 -0400 euclidean_domain.lean
-rw-r--r-- 1 Floris 197121   6236 2019-06-14 09:36:49.000000000 -0400 field_power.lean
-rw-r--r-- 1 Floris 197121   4862 2019-06-14 09:36:49.000000000 -0400 opposites.lean
-rw-r--r-- 1 Floris 197121   9155 2019-06-14 09:36:49.000000000 -0400 order.lean
</pre></div>


<ul>
<li>I build an arbitrary file, which seems to take longer than I would expect from compiling a single file:</li>
</ul>
<div class="codehilite"><pre><span></span>Floris@MSI MINGW64 /d/projects/mathlib ((badeb48b...))
$ lean --make src/algebra/ring.lean
</pre></div>


<p>(continued in next message)</p>

<a name="172169237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/172169237" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#172169237">Floris van Doorn (Jul 31 2019 at 21:49)</a>:</h4>
<ul>
<li>I check the algebra folder again:</li>
</ul>
<div class="codehilite"><pre><span></span>Floris@MSI MINGW64 /d/projects/mathlib ((badeb48b...))
$ ls src/algebra/ -alt --time-style=full-iso
total 3973
drwxr-xr-x 1 Floris 197121      0 2019-07-31 17:36:48.436140600 -0400 ./
-rw-r--r-- 1 Floris 197121 180253 2019-07-31 17:36:48.435177800 -0400 ring.olean
drwxr-xr-x 1 Floris 197121      0 2019-07-31 17:36:45.694285600 -0400 group/
-rw-r--r-- 1 Floris 197121  32746 2019-07-31 17:36:17.927331700 -0400 order.olean
drwxr-xr-x 1 Floris 197121      0 2019-07-31 05:24:01.000000000 -0400 CommRing/
drwxr-xr-x 1 Floris 197121      0 2019-07-31 05:24:01.000000000 -0400 Mon/
-rw-r--r-- 1 Floris 197121 470882 2019-07-31 05:14:21.000000000 -0400 direct_limit.olean
-rw-r--r-- 1 Floris 197121  48982 2019-07-30 03:28:45.000000000 -0400 direct_sum.olean
-rw-r--r-- 1 Floris 197121 240420 2019-07-30 03:25:53.000000000 -0400 pi_instances.olean
-rw-r--r-- 1 Floris 197121  23435 2019-07-30 03:24:39.000000000 -0400 punit_instances.olean
-rw-r--r-- 1 Floris 197121  46890 2019-07-30 03:22:47.000000000 -0400 char_p.olean
-rw-r--r-- 1 Floris 197121   2195 2019-07-30 03:22:01.000000000 -0400 default.olean
-rw-r--r-- 1 Floris 197121 194740 2019-07-30 03:22:00.000000000 -0400 module.olean
-rw-r--r-- 1 Floris 197121 115308 2019-07-30 03:20:25.000000000 -0400 pointwise.olean
-rw-r--r-- 1 Floris 197121 267084 2019-07-30 03:08:50.000000000 -0400 big_operators.olean
-rw-r--r-- 1 Floris 197121 228629 2019-07-30 03:07:36.000000000 -0400 gcd_domain.olean
-rw-r--r-- 1 Floris 197121 190155 2019-07-30 03:06:20.000000000 -0400 associated.olean
-rw-r--r-- 1 Floris 197121 144643 2019-07-30 03:05:46.000000000 -0400 archimedean.olean
-rw-r--r-- 1 Floris 197121  51843 2019-07-30 03:02:00.000000000 -0400 field_power.olean
-rw-r--r-- 1 Floris 197121 168299 2019-07-30 03:01:50.000000000 -0400 group_power.olean
-rw-r--r-- 1 Floris 197121 110312 2019-07-30 03:01:26.000000000 -0400 euclidean_domain.olean
-rw-r--r-- 1 Floris 197121  45067 2019-07-30 03:00:16.000000000 -0400 ordered_field.olean
-rw-r--r-- 1 Floris 197121  17108 2019-07-30 03:00:12.000000000 -0400 char_zero.olean
-rw-r--r-- 1 Floris 197121  51115 2019-07-30 03:00:10.000000000 -0400 field.olean
-rw-r--r-- 1 Floris 197121   8777 2019-07-30 03:00:05.000000000 -0400 field.lean
-rw-r--r-- 1 Floris 197121  27526 2019-07-30 03:00:05.000000000 -0400 group_power.lean
-rw-r--r-- 1 Floris 197121   9130 2019-07-30 03:00:05.000000000 -0400 ordered_field.lean
-rw-r--r-- 1 Floris 197121 306809 2019-07-29 12:26:57.000000000 -0400 ordered_ring.olean
-rw-r--r-- 1 Floris 197121  47613 2019-07-29 12:25:06.000000000 -0400 order_functions.olean
-rw-r--r-- 1 Floris 197121 298623 2019-07-29 12:25:05.000000000 -0400 ordered_group.olean
-rw-r--r-- 1 Floris 197121 269333 2019-07-29 12:22:18.000000000 -0400 free.olean
-rw-r--r-- 1 Floris 197121  45015 2019-07-29 12:18:42.000000000 -0400 opposites.olean
-rw-r--r-- 1 Floris 197121  15325 2019-07-19 10:40:32.000000000 -0400 free.lean
-rw-r--r-- 1 Floris 197121  18757 2019-07-18 11:19:45.000000000 -0400 pi_instances.lean
-rw-r--r-- 1 Floris 197121  10353 2019-07-18 11:19:45.000000000 -0400 pointwise.lean
drwxr-xr-x 1 Floris 197121      0 2019-07-12 17:47:57.000000000 -0400 ../
-rw-r--r-- 1 Floris 197121  26082 2019-07-11 09:59:06.000000000 -0400 gcd_domain.lean
-rw-r--r-- 1 Floris 197121  30949 2019-07-11 06:13:21.000000000 -0400 big_operators.lean
-rw-r--r-- 1 Floris 197121  25098 2019-07-11 06:13:21.000000000 -0400 direct_limit.lean
-rw-r--r-- 1 Floris 197121   6126 2019-07-11 06:13:21.000000000 -0400 direct_sum.lean
-rw-r--r-- 1 Floris 197121  14904 2019-07-11 06:13:21.000000000 -0400 module.lean
-rw-r--r-- 1 Floris 197121   3561 2019-07-11 06:13:21.000000000 -0400 punit_instances.lean
-rw-r--r-- 1 Floris 197121  11805 2019-07-11 06:13:21.000000000 -0400 ring.lean
-rw-r--r-- 1 Floris 197121  18067 2019-07-11 00:19:32.000000000 -0400 ordered_ring.lean
-rw-r--r-- 1 Floris 197121  25188 2019-07-04 15:49:44.000000000 -0400 ordered_group.lean
-rw-r--r-- 1 Floris 197121  10197 2019-07-04 12:48:24.000000000 -0400 order_functions.lean
-rw-r--r-- 1 Floris 197121  15761 2019-06-14 21:30:47.000000000 -0400 archimedean.lean
-rw-r--r-- 1 Floris 197121  25505 2019-06-14 09:36:49.000000000 -0400 associated.lean
-rw-r--r-- 1 Floris 197121   8715 2019-06-14 09:36:49.000000000 -0400 char_p.lean
-rw-r--r-- 1 Floris 197121   3118 2019-06-14 09:36:49.000000000 -0400 char_zero.lean
-rw-r--r-- 1 Floris 197121    182 2019-06-14 09:36:49.000000000 -0400 default.lean
-rw-r--r-- 1 Floris 197121  13472 2019-06-14 09:36:49.000000000 -0400 euclidean_domain.lean
-rw-r--r-- 1 Floris 197121   6236 2019-06-14 09:36:49.000000000 -0400 field_power.lean
-rw-r--r-- 1 Floris 197121   4862 2019-06-14 09:36:49.000000000 -0400 opposites.lean
-rw-r--r-- 1 Floris 197121   9155 2019-06-14 09:36:49.000000000 -0400 order.lean
</pre></div>

<a name="172169453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/172169453" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#172169453">Floris van Doorn (Jul 31 2019 at 21:51)</a>:</h4>
<p>The interesting observations here are:</p>
<ul>
<li>It did create a new compiled file <code>ring.olean</code>, so that's good</li>
<li>It also created a new compiled file <code>order.olean</code>, but not for any other files imported by <code>ring.lean</code> (<code>ring.lean</code> does indeed import <code>order.olean</code> via (among others) <code>group.to_additive</code> and <code>tactic.push_neg</code>)</li>
</ul>

<a name="172169563"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/172169563" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#172169563">Floris van Doorn (Jul 31 2019 at 21:52)</a>:</h4>
<p>The compiled file <code>order.olean</code> is indeed different (e.g. it has 2 fewer bytes).</p>

<a name="172169707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/172169707" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#172169707">Floris van Doorn (Jul 31 2019 at 21:55)</a>:</h4>
<p>So what does this mean? </p>
<ul>
<li>Did Lean decide it had to re-generate <code>order.olean</code>, and therefore also had to compile all other files which imported <code>order.lean</code>? If so, why did this happen?</li>
<li>Is it expected that Lean doesn't generate <code>olean</code> files for the other intermediate files, even though <code>order.olean</code> changed? (Making <code>ring.lean</code> another time is almost immediate, so this seems fine.)</li>
</ul>

<a name="172170344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/172170344" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#172170344">Floris van Doorn (Jul 31 2019 at 22:04)</a>:</h4>
<p>One other (mostly unrelated) question:</p>
<ul>
<li>When I run <code>lean --make</code> (or <code>leanpkg build</code>) I don't get output in the terminal while Lean is running. I think I saw that other users did get output when Lean was running, namely the file (and the line number?) it was compiling at the moment. Is the fact that I don't see this related to Windows? It is really frustrating, since it means I cannot see whether Lean is recompiling the whole library, when I expect it just to compile the file I've changed/added. Is there any way I can get this output (at this point, I would consider using a Linux VM if that would solve this issue)</li>
</ul>

<a name="172170810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/172170810" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#172170810">Floris van Doorn (Jul 31 2019 at 22:10)</a>:</h4>
<p>Oh, wait, I now see that <code>ring.lean</code> doesn't actually import any other file from this folder (I thought it would, but all the <code>group</code> files are now in a subfolder). Lean <em>did</em> generate olean files for all files imported by <code>ring.lean</code>.</p>

<a name="172170846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/172170846" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#172170846">Kevin Kappelmann (Jul 31 2019 at 22:11)</a>:</h4>
<blockquote>
<p>One other (mostly unrelated) question:</p>
<ul>
<li>When I run <code>lean --make</code> (or <code>leanpkg build</code>) I don't get output in the terminal while Lean is running. I think I saw that other users did get output when Lean was running, namely the file (and the line number?) it was compiling at the moment. Is the fact that I don't see this related to Windows? It is really frustrating, since it means I cannot see whether Lean is recompiling the whole library, when I expect it just to compile the file I've changed/added. Is there any way I can get this output (at this point, I would consider using a Linux VM if that would solve this issue)</li>
</ul>
</blockquote>
<p>I do get that output using <code>leanpkg build</code> as well as <code>lean --make</code> but I am using Linux.</p>

<a name="172171480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20doesn%27t%20used%20files%20downloaded%20by%20update-mathlib/near/172171480" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67334leandoesntusedfilesdownloadedbyupdatemathlib.html#172171480">Floris van Doorn (Jul 31 2019 at 22:18)</a>:</h4>
<p>Ok. Then there is probably something wrong on Windows (or possible specifically on my machine/terminal)</p>


{% endraw %}

{% include archive_update.html %}