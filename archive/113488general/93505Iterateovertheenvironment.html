---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/93505Iterateovertheenvironment.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/93505Iterateovertheenvironment.html">Iterate over the environment</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="159071899"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Iterate%20over%20the%20environment/near/159071899" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/93505Iterateovertheenvironment.html#159071899">Neil Strickland (Feb 21 2019 at 14:35)</a>:</h4>
<p>I know essentially nothing about the metaprogramming framework so I am sorry if this question is somehow misconceived.</p>
<p>I would like to write some new commands that summarise information about what Lean knows.  My idea was to start with <code>#print prefix</code> and modify it.  However, if I understand correctly, <code>#print prefix</code> is implemented by the function <code>print_prefix</code> defined in C++ in the file <code>src/frontends/lean/print_cmd.cpp</code>.  That uses a method called <code>for_each_declaration</code>.  In Lean I can do some inspection of the environment like this:</p>
<div class="codehilite"><pre><span></span><span class="n">meta</span> <span class="n">def</span> <span class="n">foo</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>  <span class="n">do</span> <span class="n">env</span> <span class="err">‚Üê</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">get_env</span><span class="o">,</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">trace</span> <span class="o">(</span><span class="n">environment</span><span class="bp">.</span><span class="n">contains</span> <span class="n">env</span> <span class="bp">`</span><span class="n">nat</span><span class="o">)</span>
</pre></div>


<p>However, I am not seeing anything in Lean that is equivalent to <code>for_each_declaration</code>.  Am I missing something?</p>
<p>Incidentally, <code>tactic_writing.md</code> contains a link to "Programming in Lean", which is now dead.  I don't know whether "Programming in Lean" is still available somewhere, or whether it has been decided that it is too outdated to distribute.  But I have a copy that I downloaded a while ago, so this is not an immediate issue for me.</p>

<a name="159072116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Iterate%20over%20the%20environment/near/159072116" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/93505Iterateovertheenvironment.html#159072116">Chris Hughes (Feb 21 2019 at 14:38)</a>:</h4>
<p><code>environment.fold</code> perhaps?</p>

<a name="159072387"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Iterate%20over%20the%20environment/near/159072387" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/93505Iterateovertheenvironment.html#159072387">Neil Strickland (Feb 21 2019 at 14:41)</a>:</h4>
<p>Thanks, that's probably what's required.  It looks like it will need some monadic yoga to use it.  I will try to work it out.</p>

<a name="159117492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Iterate%20over%20the%20environment/near/159117492" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/93505Iterateovertheenvironment.html#159117492">Mario Carneiro (Feb 22 2019 at 00:22)</a>:</h4>
<p><span class="user-mention" data-user-id="130308">@Neil Strickland</span> Programming in Lean is half done and out of date, and it is currently going through some restructuring. I think Simon plans to fill in several more chapters. It is currently available at <a href="https://leanprover.github.io/programming_in_lean/programming_in_lean.pdf" target="_blank" title="https://leanprover.github.io/programming_in_lean/programming_in_lean.pdf">https://leanprover.github.io/programming_in_lean/programming_in_lean.pdf</a> (same place as before, just without the link on the main page), or on github at <a href="https://github.com/avigad/programming_in_lean" target="_blank" title="https://github.com/avigad/programming_in_lean">https://github.com/avigad/programming_in_lean</a></p>


{% endraw %}

{% include archive_update.html %}