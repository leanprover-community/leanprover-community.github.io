---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/35331leanpkg.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html">leanpkg</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="123021774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/123021774" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#123021774">Simon Hudon (Feb 27 2018 at 01:29)</a>:</h4>
<p>It is possible to specify git branches in <code>leanpkg</code>?</p>

<a name="123022299"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/123022299" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#123022299">Mario Carneiro (Feb 27 2018 at 01:44)</a>:</h4>
<div class="codehilite"><pre><span></span>[package]
name = &quot;my_awesome_pkg&quot;
version = &quot;0.1&quot;         # no semantic significance currently
lean_version = &quot;3.3.0&quot;  # optional, prints a warning on mismatch with Lean executable
path = &quot;src&quot;            # hard-coded, will be removed in the future
timeout = 100           # optional, passed to `lean` as `-T` parameter

[dependencies]
# local dependency
demopkg = { path = &quot;relative/path/to/demopkg&quot; }
# git dependency
mathlib =
  { git = &quot;https://github.com/leanprover/mathlib&quot;,
    rev = &quot;62f7883d937861b618ae8bd645ee16ec137dd0bd&quot; }
</pre></div>


<p>You should be able to specify a branch using the <code>rev</code> field</p>

<a name="123022372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/123022372" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#123022372">Simon Hudon (Feb 27 2018 at 01:46)</a>:</h4>
<p>When doing that, I keep getting something saying that that revision is not a part of the tree. It's odd</p>

<a name="123028434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/123028434" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#123028434">Simon Hudon (Feb 27 2018 at 05:23)</a>:</h4>
<p>update: I managed to make it work. It might not be a leanpkg issue but I'm not sure. It seemed to be having a hard time cloning repositories for some reason. I wonder if it has anything to do that I wasn't pointing at the usual <code>mathlib</code> repo</p>

<a name="123033857"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/123033857" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#123033857">Sebastian Ullrich (Feb 27 2018 at 08:38)</a>:</h4>
<p>Can you reproduce it if you copy the toml to a fresh directory?</p>

<a name="123033928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/123033928" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#123033928">Simon Hudon (Feb 27 2018 at 08:41)</a>:</h4>
<p>Actually, if you clone my repo, the problem should occur again:</p>
<div class="codehilite"><pre><span></span>git clone https://github.com/cipher1024/lean-pipes
</pre></div>

<a name="123033977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/123033977" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#123033977">Simon Hudon (Feb 27 2018 at 08:42)</a>:</h4>
<p>Sorry, you asked for a naked toml file. Let's see</p>

<a name="123034036"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/123034036" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#123034036">Simon Hudon (Feb 27 2018 at 08:44)</a>:</h4>
<p>So, yes the problem occurs even if the toml file is left on its own</p>

<a name="123034038"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/123034038" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#123034038">Sebastian Ullrich (Feb 27 2018 at 08:44)</a>:</h4>
<p>Okay, I'll try your repo</p>

<a name="123086767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/123086767" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#123086767">Sebastian Ullrich (Feb 28 2018 at 11:48)</a>:</h4>
<p>I don't see your leanpkg.toml referencing a branch</p>

<a name="123102397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/123102397" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#123102397">Simon Hudon (Feb 28 2018 at 19:03)</a>:</h4>
<p>Here's the contents of <code>leanpkg.toml</code>:</p>
<div class="codehilite"><pre><span></span>[package]
name = &quot;pipes&quot;
version = &quot;0.1&quot;
lean_version = &quot;master&quot;
path = &quot;src&quot;

[dependencies]
mathlib = {git = &quot;https://github.com/cipher1024/mathlib&quot;, rev = &quot;ce8da6ab07a68dca1743bd7d8f9768157d644736&quot;}
</pre></div>


<p>It is on my fork of <code>mathlib</code> and that commit is the head of my <code>coinductive-types</code> branch</p>

<a name="134435061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134435061" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134435061">Reid Barton (Sep 22 2018 at 11:57)</a>:</h4>
<p>This is a really basic question, but what's the right way to start and maintain a new package that depends on mathlib?<br>
I see mathlib's <code>leanpkg.toml</code> specifies <code>lean_version = "3.4.1"</code>, so I guess I should use Lean 3.4.1.<br>
So let's say I run <code>elan run --install 3.4.1 leanpkg new my_project</code>, as recommended by <a href="https://github.com/leanprover/mathlib/blob/master/docs/elan.md" target="_blank" title="https://github.com/leanprover/mathlib/blob/master/docs/elan.md">https://github.com/leanprover/mathlib/blob/master/docs/elan.md</a>. Now I get a new project whose <code>leanpkg.toml</code> also specifies <code>lean_version = "3.4.1"</code>.<br>
Continuing to follow those directions, I run <code>leanpkg add leanprover/mathlib</code>. But now I end up with the <code>lean-3.4.1</code> branch of mathlib, which hasn't been updated since June 20. I wanted the latest version. And <code>leanpkg upgrade</code> makes no difference.</p>

<a name="134435107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134435107" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134435107">Reid Barton (Sep 22 2018 at 11:59)</a>:</h4>
<p>Is this behavior intentional? At best, it's confusing if following the instructions in that elan.md file doesn't give you the latest version of mathlib, I think.</p>

<a name="134435173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134435173" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134435173">Reid Barton (Sep 22 2018 at 12:01)</a>:</h4>
<p>Even though I should supposedly know how all of this works (e.g., I know there is a <code>lean-3.4.1</code> branch of mathlib and leanpkg will select it), I still get caught by surprise since starting a new project is so infrequent--I just made a new project and built mathlib in it and then a half hour later discovered I had the June 20 version which didn't have the new features I wanted to use.</p>

<a name="134435346"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134435346" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134435346">Kevin Buzzard (Sep 22 2018 at 12:06)</a>:</h4>
<p>I once thought that editing the toml file and changing 3.4.1 to "master" would fix this, but maybe the issue is that you are using 3.4.1's <code>leanpkg</code>?</p>

<a name="134435466"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134435466" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134435466">Reid Barton (Sep 22 2018 at 12:11)</a>:</h4>
<p>It probably would fix it, especially since I am using elan (although I'm not sure whether it is the version of leanpkg that matters, or what you write in the <code>lean_version</code> field of the toml file).<br>
The elan.md instructions (I'm talking about "Scenario 1: Start a new package") suggest that you might see <code>nightly-2018-04-06</code> as the Lean version, and I found that <code>elan run --install nightly-2018-04-06 leanpkg new my_playground</code> does give you master mathlib, maybe because there is no branch corresponding to <code>nightly-2018-04-06</code>.<br>
But it seems strange that the way to get mathlib master is to tell elan/leanpkg to use any other Lean version than the one actually used by mathlib...</p>

<a name="134435506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134435506" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134435506">Reid Barton (Sep 22 2018 at 12:12)</a>:</h4>
<p>Presumably when those instructions were written, mathlib really did specify a version other than 3.4.1 and so the instructions worked</p>

<a name="134435557"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134435557" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134435557">Reid Barton (Sep 22 2018 at 12:14)</a>:</h4>
<p>By the way I should say explicitly that I'm assuming the current behavior is incorrect and I'm not supposed to get what appears to me to be this random version from June 20, but maybe others (like perhaps you Kevin) think it's working as intended because you want a fixed version for all your students.</p>

<a name="134436089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134436089" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134436089">Kevin Buzzard (Sep 22 2018 at 12:32)</a>:</h4>
<p>That is all over now. I wanted a fixed version for my summer students just so I could see the advantages and the disadvantages. One of the advantages is that they don't ever have to update mathlib. What happened in practice was that people generally wanted more recent mathlib stuff and they learnt how to upgrade anyway, because sufficiently many of them knew how to use git because they were on a joint maths/computer science degree, so it worked out fine in the end and everyone was using different mathlibs anyway, and there didn't seem to be a problem.</p>

<a name="134436346"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134436346" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134436346">Reid Barton (Sep 22 2018 at 12:42)</a>:</h4>
<p>Okay, great. In that case I'm going to push for making it impossible to get this random old version of mathlib without asking for it, since I think that results in a potentially confusing experience for new users (e.g., one hears "mathlib has X" but then makes a project to try it out and X is missing).</p>

<a name="134436566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134436566" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134436566">Reid Barton (Sep 22 2018 at 12:51)</a>:</h4>
<p>Moved discussion to github: <a href="https://github.com/leanprover/lean/issues/365" target="_blank" title="https://github.com/leanprover/lean/issues/365">#365</a></p>

<a name="134436567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134436567" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134436567">Reid Barton (Sep 22 2018 at 12:51)</a>:</h4>
<p>Dang that's not a link to a mathlib issue.</p>

<a name="134436607"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134436607" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134436607">Reid Barton (Sep 22 2018 at 12:52)</a>:</h4>
<p><a href="https://github.com/leanprover/mathlib/issues/365" target="_blank" title="https://github.com/leanprover/mathlib/issues/365">https://github.com/leanprover/mathlib/issues/365</a></p>

<a name="134456778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134456778" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134456778">Scott Morrison (Sep 22 2018 at 23:41)</a>:</h4>
<p>I think this is a really good idea. I've been confused by this, too.</p>

<a name="134457081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457081" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457081">Mario Carneiro (Sep 22 2018 at 23:53)</a>:</h4>
<p>I guess leanpkg and elan have been designed for reproducible builds, which is the popular option these days. Unfortunately the usual thing new lean/mathlib users want is master + master, which goes against this idea, and so the tools fight them on this.</p>

<a name="134457122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457122" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457122">Mario Carneiro (Sep 22 2018 at 23:54)</a>:</h4>
<p>I guess you could say they are being "too smart for their own good"</p>

<a name="134457124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457124" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457124">Simon Hudon (Sep 22 2018 at 23:54)</a>:</h4>
<p>Is this something a switch could fix?</p>

<a name="134457132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457132" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457132">Mario Carneiro (Sep 22 2018 at 23:55)</a>:</h4>
<p><code>elan</code> in particular should strive for setting up users with the latest everything unless the user specifically asks for an old version</p>

<a name="134457135"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457135" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457135">Reid Barton (Sep 22 2018 at 23:55)</a>:</h4>
<p>Well you still get reproducible builds because the mathlib commit hash is in the leanpkg.toml file. It's just a matter of where you want to start a new project.</p>

<a name="134457182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457182" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457182">Mario Carneiro (Sep 22 2018 at 23:57)</a>:</h4>
<p>Does <code>elan</code> know that mathlib exists? Or does the default thing just get you lean on its own</p>

<a name="134457187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457187" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457187">Reid Barton (Sep 22 2018 at 23:57)</a>:</h4>
<p>I'm definitely happy that I can still build my lean-homotopy-theory project against the version of mathlib specified in the file, otherwise I would have no idea how any of the proofs that broke when building against master were supposed to work :)</p>

<a name="134457228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457228" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457228">Simon Hudon (Sep 22 2018 at 23:58)</a>:</h4>
<p>I think elan only gets you Lean and the lean version in your toml file selects the tag of mathlib</p>

<a name="134457230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457230" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457230">Reid Barton (Sep 22 2018 at 23:58)</a>:</h4>
<p>elan doesn't know about mathlib. The process is <code>elan run --install 3.4.1 leanpkg new myproject</code>, <code>cd myproject</code>, <code>leanpkg add leanprover/mathlib</code>.</p>

<a name="134457237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457237" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457237">Reid Barton (Sep 22 2018 at 23:59)</a>:</h4>
<p>Then <code>leanpkg</code> picks the 3.4.1 branch of mathlib because that is what is specified in the <code>leanpkg.toml</code> file that elan wrote. I think</p>

<a name="134457238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457238" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457238">Reid Barton (Sep 22 2018 at 23:59)</a>:</h4>
<p>Sorry--that leanpkg wrote</p>

<a name="134457240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457240" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457240">Mario Carneiro (Sep 22 2018 at 23:59)</a>:</h4>
<p>Right, and this is backwards since it says "get me the version of mathlib compatible with 3.4.1" rather than "get me the version of lean compatible with mathlib master"</p>

<a name="134457298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457298" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457298">Reid Barton (Sep 23 2018 at 00:01)</a>:</h4>
<p>Yes, that is definitely a bit weird.</p>

<a name="134457304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457304" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457304">Mario Carneiro (Sep 23 2018 at 00:01)</a>:</h4>
<p>I think you should be able to ask elan to target a particular version/branch of any lean project, not just lean itself</p>

<a name="134457305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457305" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457305">Mario Carneiro (Sep 23 2018 at 00:01)</a>:</h4>
<p>and then it derives the lean version from the toml file of that project</p>

<a name="134457403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457403" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457403">Reid Barton (Sep 23 2018 at 00:05)</a>:</h4>
<p>I think the current situation is a consequence of the fact that the "package manager" leanpkg is shipped/versioned with lean itself</p>

<a name="134457445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457445" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457445">Reid Barton (Sep 23 2018 at 00:06)</a>:</h4>
<p>that is, only leanpkg (not elan) knows about packages at all, but in order to get (any) leanpkg, you first must choose a lean version</p>

<a name="134457902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134457902" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134457902">Reid Barton (Sep 23 2018 at 00:23)</a>:</h4>
<p>I wonder how crazy it would be to just replace leanpkg with crate or some other language's tool</p>

<a name="134458086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134458086" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134458086">Mario Carneiro (Sep 23 2018 at 00:28)</a>:</h4>
<p>Note that <code>elan</code> <em>is</em> some other language's tool (it is forked from Rust's <code>cargo</code>)</p>

<a name="134458484"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134458484" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134458484">Sebastian Ullrich (Sep 23 2018 at 00:41)</a>:</h4>
<blockquote>
<p>I think you should be able to ask elan to target a particular version/branch of any lean project, not just lean itself<br>
and then it derives the lean version from the toml file of that project</p>
</blockquote>
<p>But that's exactly what it's doing :) . Check out a Lean project at some commit and elan sets up the right Lean version for you.<br>
What you're asking for is for elan not to set up some existing project, but a _new_ project based on its intended _dependencies_, no? What I could imagine is a command <code>elan new</code> that works like <code>leanpkg new</code>, but also takes a list of initial dependencies and selects the new package's Lean version based on that</p>

<a name="134458530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134458530" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134458530">Mario Carneiro (Sep 23 2018 at 00:43)</a>:</h4>
<p>That sounds good to me. Is it currently possible to write stuff in a file to get the equivalent of <code>elan new</code> using <code>elan</code>?</p>

<a name="134458543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134458543" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134458543">Sebastian Ullrich (Sep 23 2018 at 00:44)</a>:</h4>
<p>Though that seems like much more work than documenting "active mathlib development is happening for Lean version $VERSION, so use <code>elan +$VERSION leanpkg new</code> if you want to use it"</p>

<a name="134458597"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134458597" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134458597">Mario Carneiro (Sep 23 2018 at 00:44)</a>:</h4>
<p>It also sounds like it might be possible for me to set up a "template" project that depends on mathlib but otherwise contains very little, as a target for users to download and make elan understand</p>

<a name="134458609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134458609" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134458609">Mario Carneiro (Sep 23 2018 at 00:45)</a>:</h4>
<p>Is it possible for a project like this to target the master branch of mathlib?</p>

<a name="134458660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134458660" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134458660">Mario Carneiro (Sep 23 2018 at 00:47)</a>:</h4>
<p>What does <code>elan +$VERSION leanpkg new</code> mean here? Do you mean <code>$VERSION = 3.4.1</code>?</p>

<a name="134458663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134458663" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134458663">Mario Carneiro (Sep 23 2018 at 00:47)</a>:</h4>
<p>the really important part is being able to tell elan "get mathlib master" without having to specify a commit</p>

<a name="134458711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134458711" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134458711">Mario Carneiro (Sep 23 2018 at 00:49)</a>:</h4>
<p>I'm fine with telling people to get 3.4.1, since it's basically going to stay that way until lean 4 and then everything will be different anyway, but mathlib won't stay still and elan has to be able to adapt to that</p>

<a name="134458754"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134458754" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134458754">Sebastian Ullrich (Sep 23 2018 at 00:50)</a>:</h4>
<p>Okay, that <code>leanpkg upgrade</code> doesn't allow you to customize which branch it uses is a related but separate issue (and specific to leanpkg, not elan)</p>

<a name="134458814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134458814" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134458814">Mario Carneiro (Sep 23 2018 at 00:53)</a>:</h4>
<p>So what is the current recommendation? Do users need to go into <code>_target/deps/mathlib</code> and checkout master?</p>

<a name="134458817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134458817" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134458817">Sebastian Ullrich (Sep 23 2018 at 00:53)</a>:</h4>
<p>I guess we can agree that leanpkg using a separate branch per Lean version was a good idea but didn't work out in practice, since nobody wants to maintain code for multiple Lean versions. We could definitely change that in Lean 4, ie. when development on leanpkg continues</p>

<a name="134458860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134458860" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134458860">Mario Carneiro (Sep 23 2018 at 00:54)</a>:</h4>
<p>The problem isn't maintaining multiple lean versions, it's not allowing other kinds of branches</p>

<a name="134458870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134458870" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134458870">Mario Carneiro (Sep 23 2018 at 00:55)</a>:</h4>
<p>in particular master branches, which are going to be, ehm, rather common</p>

<a name="134458974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134458974" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134458974">Sebastian Ullrich (Sep 23 2018 at 00:58)</a>:</h4>
<p>If you use the master branch for development against a Lean version that is not master, it does look like you don't agree with leanpkg at all how branches should be handled</p>

<a name="134458994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134458994" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134458994">Sebastian Ullrich (Sep 23 2018 at 00:59)</a>:</h4>
<p>Given the current leanpkg, the only real solution would be to rename the master branch to <code>lean-3.4.1</code>. If we don't want that, we'll have to change leanpkg... at some point</p>

<a name="134459118"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134459118" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134459118">Reid Barton (Sep 23 2018 at 01:02)</a>:</h4>
<p>Is deleting the <code>lean-3.4.1</code> branch not a solution, or merely not a "real solution"?</p>

<a name="134459128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134459128" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134459128">Sebastian Ullrich (Sep 23 2018 at 01:03)</a>:</h4>
<p>Then <code>leanpkg upgrade</code> will simply do nothing except complain, afaik</p>

<a name="134459129"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134459129" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134459129">Reid Barton (Sep 23 2018 at 01:03)</a>:</h4>
<p>When Lean 4 arrives we will be able to modify leanpkg at the same time, so is it reasonable to assume for now that there is only one version of Lean in existence?</p>

<a name="134459132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134459132" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134459132">Reid Barton (Sep 23 2018 at 01:04)</a>:</h4>
<p>Hmm, let me try.</p>

<a name="134459171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134459171" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134459171">Sebastian Ullrich (Sep 23 2018 at 01:04)</a>:</h4>
<p><a href="https://github.com/leanprover/lean/blob/b13ac127fd83f3724d2f096b1fb85dc6b15e3746/leanpkg/leanpkg/git.lean#L10-L14" target="_blank" title="https://github.com/leanprover/lean/blob/b13ac127fd83f3724d2f096b1fb85dc6b15e3746/leanpkg/leanpkg/git.lean#L10-L14">https://github.com/leanprover/lean/blob/b13ac127fd83f3724d2f096b1fb85dc6b15e3746/leanpkg/leanpkg/git.lean#L10-L14</a></p>

<a name="134459228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134459228" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134459228">Reid Barton (Sep 23 2018 at 01:07)</a>:</h4>
<p>I have a toy project here using <code>nightly-2018-04-06</code> and I changed the mathlib commit to an older version and ran leanpkg configure and verified that it checked out the old version. Then I ran <code>leanpkg upgrade</code> and it successfully upgraded to mathlib master:</p>
<div class="codehilite"><pre><span></span>rwbarton@bridge:~/lean/my_playground2$ leanpkg upgrade
mathlib: trying to update _target/deps/mathlib to revision f53c776c2e09eff5358c5de6902e402c641a1673
&gt; git checkout --detach f53c776c2e09eff5358c5de6902e402c641a1673    # in directory _target/deps/mathlib
HEAD is now at f53c776... feat(analysis/topology): pi-spaces: topolopgy generation, prove second countability
configuring my_playground2 0.1
mathlib: trying to update _target/deps/mathlib to revision ca7f118058342a2f077e836e643d26e0ad1f3ca6
&gt; git checkout --detach ca7f118058342a2f077e836e643d26e0ad1f3ca6    # in directory _target/deps/mathlib
Previous HEAD position was f53c776... feat(analysis/topology): pi-spaces: topolopgy generation, prove second countability
HEAD is now at ca7f118... fix(docs/tactics.md): missing backquote, formatting
rwbarton@bridge:~/lean/my_playground2$ echo $?
0
rwbarton@bridge:~/lean/my_playground2$ cat leanpkg.toml
[package]
name = &quot;my_playground2&quot;
version = &quot;0.1&quot;
lean_version = &quot;nightly-2018-04-06&quot;
path = &quot;src&quot;

[dependencies]
mathlib = {git = &quot;https://github.com/leanprover/mathlib&quot;, rev = &quot;ca7f118058342a2f077e836e643d26e0ad1f3ca6&quot;}
</pre></div>

<a name="134459230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134459230" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134459230">Reid Barton (Sep 23 2018 at 01:07)</a>:</h4>
<p>Is that something special about using nightly lean vs a stable version number?</p>

<a name="134459253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134459253" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134459253">Sebastian Ullrich (Sep 23 2018 at 01:08)</a>:</h4>
<p>Yes, see the link above</p>

<a name="134459273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134459273" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134459273">Reid Barton (Sep 23 2018 at 01:08)</a>:</h4>
<p>Ah...</p>

<a name="134459287"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134459287" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134459287">Sebastian Ullrich (Sep 23 2018 at 01:09)</a>:</h4>
<blockquote>
<p>When Lean 4 arrives we will be able to modify leanpkg at the same time, so is it reasonable to assume for now that there is only one version of Lean in existence?</p>
</blockquote>
<p>I suppose that is a reasonable assumption right now. Even if we don't change the leanpkg semantics, it will just work if Lean 4 porting efforts happen on the mathlib master branch and development for Lean 3 on the <code>lean-3.4.1</code> branch</p>

<a name="134459337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134459337" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134459337">Mario Carneiro (Sep 23 2018 at 01:10)</a>:</h4>
<blockquote>
<p>If you use the master branch for development against a Lean version that is not master, it does look like you don't agree with leanpkg at all how branches should be handled</p>
</blockquote>
<p>I think the master branch of lean is basically 3.4.1, so if this is what is needed then I'm okay with it. How do I sign up?</p>

<a name="134459715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134459715" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134459715">Reid Barton (Sep 23 2018 at 01:25)</a>:</h4>
<p>So before I incorrectly "realized" that we could just delete the lean-3.4.1 branch, options I was considering were:</p>
<ul>
<li>Development happens on the lean-3.4.1 branch, not master. (You can set lean-3.4.1 as the "default" branch in the github UI to help with this--I did it for <a href="https://github.com/rwbarton/lean-homotopy-theory" target="_blank" title="https://github.com/rwbarton/lean-homotopy-theory">https://github.com/rwbarton/lean-homotopy-theory</a>. But I don't know whether changing this for an existing project like mathlib with many forks would have some ramifications.)</li>
<li>There are some obscure git features like <code>git symbolic-ref</code> which might allow us to make lean-3.4.1 an alias to master, but it's not clear whether they would really work for us or whether they can be configured through github.</li>
<li>We could try to keep lean-3.4.1 up to date with master by some technical or semi-technical means (like a pre-push hook for mathlib committers--there are few enough of them that it should be feasible).</li>
</ul>

<a name="134469763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134469763" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134469763">Kevin Buzzard (Sep 23 2018 at 07:54)</a>:</h4>
<p>Why don't people use the latest lean nightly? It's 3.4.1 with some broken stuff fixed.</p>

<a name="134469804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134469804" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134469804">Kevin Buzzard (Sep 23 2018 at 07:54)</a>:</h4>
<p>6th April, 20th April -- why? I use the June version</p>

<a name="134469964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134469964" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134469964">Bryan Gin-ge Chen (Sep 23 2018 at 08:01)</a>:</h4>
<p>Actually, there's an August version out now...</p>

<a name="134470067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134470067" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134470067">Mario Carneiro (Sep 23 2018 at 08:04)</a>:</h4>
<p>The fixes aren't so important to me. More important is whether switching back to nightlies will improve or exacerbate the <code>leanpkg</code> situation</p>

<a name="134470078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134470078" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134470078">Mario Carneiro (Sep 23 2018 at 08:06)</a>:</h4>
<p>Is Kevin's blog post still the best option for installing lean + mathlib on windows?</p>

<a name="134472306"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134472306" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134472306">Scott Morrison (Sep 23 2018 at 09:30)</a>:</h4>
<p>As far as I can tell. We really need something like elan for windows.</p>

<a name="134472811"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134472811" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134472811">Olli (Sep 23 2018 at 09:50)</a>:</h4>
<p>elan works fine on Windows</p>

<a name="134472866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134472866" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134472866">Olli (Sep 23 2018 at 09:53)</a>:</h4>
<p>the Windows specific issue I and a few others seem to run into is leanpkg failing with "failed to start child process", for which I have found no solution for</p>

<a name="134473291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134473291" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134473291">Bryan Gin-ge Chen (Sep 23 2018 at 10:09)</a>:</h4>
<p>For which subcommands and under what precise circumstances does leanpkg fail on your machine? Does it output anything else?</p>

<a name="134474398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134474398" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134474398">Olli (Sep 23 2018 at 10:53)</a>:</h4>
<p>any command that has to do with creating a project, adding dependencies etc. here is an example, where I have modified the leanpkg script (i.e. leanpkg.bat on Windows) to ignore the <code>@ECHO OFF</code> directive so that the commands getting ran are printed:</p>
<div class="codehilite"><pre><span></span>PS C:\Users\Olli\Dev\Lean&gt; leanpkg new playground

C:\Users\Olli\Dev\Lean&gt;SET LEANDIR=C:\Users\Olli\.elan\toolchains\stable\bin\../

C:\Users\Olli\Dev\Lean&gt;SET LIBDIR=C:\Users\Olli\.elan\toolchains\stable\bin\../\lib\lean

C:\Users\Olli\Dev\Lean&gt;IF NOT EXIST C:\Users\Olli\.elan\toolchains\stable\bin\../\lib\lean SET LIBDIR=C:\Users\Olli\.ela
n\toolchains\stable\bin\../

C:\Users\Olli\Dev\Lean&gt;SET LEAN_PATH=C:\Users\Olli\.elan\toolchains\stable\bin\../\lib\lean\library;C:\Users\Olli\.elan\toolchains\stable\bin\../\lib\lean\leanpkg

C:\Users\Olli\Dev\Lean&gt;SET PATH=C:\Users\Olli\.elan\toolchains\stable\bin\../\bin;C:\Users\Olli\.elan\bin;C:\Users\Olli\.elan\toolchains\stable\bin;C:\Users\Olli\lean-3.4.1-windows\bin;;C:\Users\Olli\AppData\Local\Programs\Microsoft VS Code\bin

C:\Users\Olli\Dev\Lean&gt;lean --run C:\Users\Olli\.elan\toolchains\stable\bin\../\lib\lean\leanpkg\leanpkg\main.lean new playground
failed to start child process
PS C:\Users\Olli\Dev\Lean&gt;
</pre></div>


<p>I also tried modifying the script to get rid of the funny looking <code>\../</code> part of the path, but I get the same result</p>

<a name="134474483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134474483" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134474483">Olli (Sep 23 2018 at 10:56)</a>:</h4>
<p>This is what I have installed:</p>
<div class="codehilite"><pre><span></span>PS C:\Users\Olli\Dev\Lean&gt; lean --version
Lean (version 3.4.1, commit 17fe3decaf8a, Release)
PS C:\Users\Olli\Dev\Lean&gt; elan --version
elan 0.7.0 (0dd8c5ce4 2018-09-16)
</pre></div>

<a name="134474485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134474485" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134474485">Keeley Hoek (Sep 23 2018 at 10:57)</a>:</h4>
<p>At your terminal what happens if you type <code>test -f foo</code></p>

<a name="134474491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134474491" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134474491">Olli (Sep 23 2018 at 10:58)</a>:</h4>
<p>this is PowerShell, so there is no such command</p>

<a name="134474530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134474530" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134474530">Olli (Sep 23 2018 at 10:58)</a>:</h4>
<p>what are we trying to find out?</p>

<a name="134474536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134474536" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134474536">Keeley Hoek (Sep 23 2018 at 10:59)</a>:</h4>
<p>this is precisely the problem!</p>

<a name="134474537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134474537" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134474537">Keeley Hoek (Sep 23 2018 at 10:59)</a>:</h4>
<p>(and maybe other things)</p>

<a name="134474539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134474539" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134474539">Keeley Hoek (Sep 23 2018 at 10:59)</a>:</h4>
<p><code>leanpkg</code> attempts to spawn <code>test</code> when it runs, and it fails, so you see that message</p>

<a name="134474605"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134474605" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134474605">Olli (Sep 23 2018 at 11:01)</a>:</h4>
<p>ah I see, so if I installed a version of that utility compiled for Windows, then that might be a workaround?</p>

<a name="134474648"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134474648" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134474648">Keeley Hoek (Sep 23 2018 at 11:02)</a>:</h4>
<p>If you'd be willing to help diagnose, try opening <code>C:\Users\Olli\.elan\toolchains\stable\bin\../\lib\lean\leanpkg\leanpkg\main.lean</code> in a text editor, and navigate to line <code>199</code>. You should see a line:</p>
<div class="codehilite"><pre><span></span>  ex ← exists_file user_toml_fn,
</pre></div>


<p>Try replacing that line with</p>
<div class="codehilite"><pre><span></span> let ex := tt,
</pre></div>


<p>Does your command before work then?</p>

<a name="134474660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134474660" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134474660">Keeley Hoek (Sep 23 2018 at 11:03)</a>:</h4>
<p>Yes I suppose having a unix-like environment with coreutils would work, but it really shouldn't be necessary. <code>leanpkg</code> should be better<br>
If this works for you I can get you a less dodgy solution cooked up in a second, since you're using elan</p>

<a name="134474704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134474704" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134474704">Keeley Hoek (Sep 23 2018 at 11:04)</a>:</h4>
<p>Actually my line number is wrong.... But I still mean that line I quoted</p>

<a name="134474705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134474705" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134474705">Keeley Hoek (Sep 23 2018 at 11:04)</a>:</h4>
<p>Should be line <code>196</code></p>

<a name="134474757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134474757" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134474757">Olli (Sep 23 2018 at 11:06)</a>:</h4>
<p>Like this?</p>
<div class="codehilite"><pre><span></span>  <span class="k">let</span> <span class="n">user_toml_fn</span> <span class="o">:=</span> <span class="n">dot_lean_dir</span> <span class="bp">++</span> <span class="s2">&quot;/&quot;</span> <span class="bp">++</span> <span class="n">leanpkg_toml_fn</span><span class="o">,</span>
  <span class="n">ex</span> <span class="o">:=</span> <span class="n">tt</span><span class="o">,</span>
  <span class="n">when</span> <span class="o">(</span><span class="bp">¬</span> <span class="n">ex</span><span class="o">)</span> <span class="err">$</span> <span class="n">write_manifest</span> <span class="o">{</span>
      <span class="n">name</span> <span class="o">:=</span> <span class="s2">&quot;_user_local_packages&quot;</span><span class="o">,</span>
      <span class="n">version</span> <span class="o">:=</span> <span class="s2">&quot;1&quot;</span>
    <span class="o">}</span> <span class="n">user_toml_fn</span><span class="o">,</span>
</pre></div>


<p>I get:</p>
<div class="codehilite"><pre><span></span>C:\Users\Olli\.elan\toolchains\stable\lib\lean\leanpkg\leanpkg\main.lean:182:4: error: non-exhaustive match, the followi
ng cases are missing:
main &quot;configure&quot; list.nil ({data := _} :: _)
main &quot;configure&quot; ({data := _} :: _) _
main &quot;new&quot; list.nil _
main &quot;new&quot; [_] ({data := _} :: _)
main &quot;new&quot; (_ :: {data := _} :: _) _
main &quot;init&quot; list.nil _
main &quot;init&quot; [_] ({data := _} :: _)
main &quot;init&quot; (_ :: {data := _} :: _) _
main &quot;add&quot; list.nil _
main &quot;add&quot; [_] ({data := _} :: _)
main &quot;add&quot; (_ :: {data := _} :: _) _
main &quot;upgrade&quot; list.nil ({data := _} :: _)
main &quot;upgrade&quot; ({data := _} :: _) _
main &quot;install&quot; list.nil _
main &quot;install&quot; [_] ({data := _} :: _)
main &quot;install&quot; (_ :: {data := _} :: _) _
main _ _ _
C:\Users\Olli\.elan\toolchains\stable\lib\lean\leanpkg\leanpkg\main.lean:196:5: error: command expected
failed to start child process
</pre></div>

<a name="134474819"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134474819" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134474819">Keeley Hoek (Sep 23 2018 at 11:09)</a>:</h4>
<p>you need a <code>let</code> in front of the <code>ex</code>, but I'm reading more now and this won't solve your problem :(( (it will still be the same)<br>
<code>leanpkg</code> wants <code>test</code> and (unix) <code>mkdir</code></p>

<a name="134474837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134474837" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134474837">Keeley Hoek (Sep 23 2018 at 11:09)</a>:</h4>
<p>I should be able to cook something up which does help you, though! Let me dig in a for a sec</p>

<a name="134475008"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134475008" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134475008">Olli (Sep 23 2018 at 11:14)</a>:</h4>
<p>thanks, yeah I now see what the issue is, I have been meaning to install Lean in WSL but so far haven't had any need to use libraries yet so I didn't get around to it</p>

<a name="134475208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134475208" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134475208">Keeley Hoek (Sep 23 2018 at 11:22)</a>:</h4>
<p>Yeah there are very many pieces which assume a unix-y environment, even just down to the directory separator character<br>
Setting something like WSL up sounds like your best bet :)</p>

<a name="134475210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134475210" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134475210">Keeley Hoek (Sep 23 2018 at 11:22)</a>:</h4>
<p>(at the moment)</p>

<a name="134475526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134475526" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134475526">Olli (Sep 23 2018 at 11:35)</a>:</h4>
<p>if making leanpkg natively support Windows is too tall of a task, I would say the next best thing would be improving the error messages for this particular situation</p>

<a name="134475862"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134475862" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134475862">Keeley Hoek (Sep 23 2018 at 11:49)</a>:</h4>
<p>I didn't write it, but the comments in there make sure to say the intention was to add windows support later<br>
I didn't realise that it was just broken on windows</p>
<p>I might try to make a version that runs natively later this week</p>

<a name="134477434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134477434" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134477434">Andrew Ashworth (Sep 23 2018 at 12:51)</a>:</h4>
<p>don't all the lean installation instructions assume a mingw installation?</p>

<a name="134477522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134477522" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134477522">Olli (Sep 23 2018 at 12:54)</a>:</h4>
<p>I do have MinGW installed, but that does not include <code>test</code> which is not an executable but rather a shell built-in as far as I can tell</p>

<a name="134477633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134477633" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134477633">Andrew Ashworth (Sep 23 2018 at 12:58)</a>:</h4>
<p>ahh. I never noticed this issue, because a bash shell is required to compile lean</p>

<a name="134477915"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134477915" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134477915">Keeley Hoek (Sep 23 2018 at 13:08)</a>:</h4>
<p>So I have no idea about MinGW anything, but for what its worth I've built coreutils before and it has a <code>test</code> binary<br>
Idk if it's in MinGW though</p>

<a name="134477924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134477924" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134477924">Reid Barton (Sep 23 2018 at 13:09)</a>:</h4>
<p>Yeah, on a normal unix system, <code>test</code> is both a shell built-in (for speed) and an executable</p>

<a name="134477978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134477978" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134477978">Reid Barton (Sep 23 2018 at 13:11)</a>:</h4>
<p>I don't know how POSIX-like the MinGW shell is, but you can try <code>which test</code> or <code>command test</code> (if nothing happens, it worked)</p>

<a name="134478025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478025" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478025">Olli (Sep 23 2018 at 13:12)</a>:</h4>
<p>it's not included with the installation of MinGW that I have, and I've tried googling if I can download it separately from somewhere but unfortunately <code>test</code> is a rather tricky name when it comes to search engines</p>

<a name="134478027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478027" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478027">Reid Barton (Sep 23 2018 at 13:12)</a>:</h4>
<p>Yes, I found that as well...</p>

<a name="134478030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478030" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478030">Keeley Hoek (Sep 23 2018 at 13:13)</a>:</h4>
<p>does MinGW ship with a shell?</p>

<a name="134478035"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478035" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478035">Reid Barton (Sep 23 2018 at 13:13)</a>:</h4>
<p>Are you using MSYS?</p>

<a name="134478074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478074" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478074">Olli (Sep 23 2018 at 13:14)</a>:</h4>
<p>yes</p>

<a name="134478075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478075" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478075">Keeley Hoek (Sep 23 2018 at 13:14)</a>:</h4>
<p>doesn't msys have bash?</p>

<a name="134478088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478088" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478088">Olli (Sep 23 2018 at 13:15)</a>:</h4>
<p>yes it does, I will try that next</p>

<a name="134478095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478095" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478095">Reid Barton (Sep 23 2018 at 13:16)</a>:</h4>
<p>The question is whether it has <code>/usr/bin/test</code> though, right?</p>

<a name="134478136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478136" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478136">Keeley Hoek (Sep 23 2018 at 13:16)</a>:</h4>
<p>I'd be blown away if it didn't!</p>

<a name="134478138"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478138" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478138">Reid Barton (Sep 23 2018 at 13:16)</a>:</h4>
<p>Well, yeah...</p>

<a name="134478194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478194" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478194">Olli (Sep 23 2018 at 13:18)</a>:</h4>
<div class="codehilite"><pre><span></span>PS C:\MSYS\1.0\bin&gt; ./bash.exe
bash.exe&quot;-3.1$ which test
which: test: unknown command
bash.exe&quot;-3.1$ exit
</pre></div>

<a name="134478200"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478200" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478200">Keeley Hoek (Sep 23 2018 at 13:18)</a>:</h4>
<p>classic!</p>

<a name="134478206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478206" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478206">Olli (Sep 23 2018 at 13:18)</a>:</h4>
<p>Git bash for windows has it</p>

<a name="134478228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478228" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478228">Olli (Sep 23 2018 at 13:19)</a>:</h4>
<p>and there it does work as expected</p>

<a name="134478294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478294" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478294">Reid Barton (Sep 23 2018 at 13:20)</a>:</h4>
<p>I have no idea whether this is useful, but I did find through Google some log <a href="https://gist.github.com/choco-bot/eec2966667c148959f417ca93995222e#file-install-txt-L523" target="_blank" title="https://gist.github.com/choco-bot/eec2966667c148959f417ca93995222e#file-install-txt-L523">https://gist.github.com/choco-bot/eec2966667c148959f417ca93995222e#file-install-txt-L523</a> where it installs something called <code>msys2-base-x86_64-20180531.tar</code> and on line 1054 it installs a certain <code>test.exe</code></p>

<a name="134478303"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478303" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478303">Keeley Hoek (Sep 23 2018 at 13:21)</a>:</h4>
<p>a few windows people here seem to use MSYS2, maybe its less insane! (I dare say that's why they have been oblivious to these issues on windows)</p>

<a name="134478459"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478459" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478459">Andrew Ashworth (Sep 23 2018 at 13:27)</a>:</h4>
<p>you can't just run bash exe</p>

<a name="134478460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478460" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478460">Andrew Ashworth (Sep 23 2018 at 13:27)</a>:</h4>
<p>the mingw bash script sets a bunch of environment variables</p>

<a name="134478461"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478461" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478461">Andrew Ashworth (Sep 23 2018 at 13:27)</a>:</h4>
<p>also, I use MSYS2 with no issues</p>

<a name="134478505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134478505" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134478505">Olli (Sep 23 2018 at 13:28)</a>:</h4>
<p>I see, yeah I will try installing MSYS2, and I just confirmed that I was able to add mathlib to a new project and it appears to work fine from VSCode which is good</p>

<a name="134482297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134482297" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134482297">Reid Barton (Sep 23 2018 at 15:47)</a>:</h4>
<p><span class="user-mention" data-user-id="126113">@Olli</span>, so is your conclusion that leanpkg is not compatible with MSYS, but is compatible with MSYS2?</p>

<a name="134482841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134482841" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134482841">Olli (Sep 23 2018 at 16:05)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span> yes that appears to be correct</p>

<a name="134483308"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134483308" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134483308">Olli (Sep 23 2018 at 16:20)</a>:</h4>
<p>MSYS2 contains <code>test.exe</code></p>

<a name="134485601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134485601" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134485601">Bryan Gin-ge Chen (Sep 23 2018 at 17:45)</a>:</h4>
<p>Is it also true that using the git-for-windows bash shell also works for you? I don't think I have msys2 on my windows 10 machine and I got leanpkg working there.</p>

<a name="134486944"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134486944" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134486944">Olli (Sep 23 2018 at 18:33)</a>:</h4>
<p>yes, I should probably have tried that first, but had totally forgot I even had it installed</p>

<a name="134487071"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134487071" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134487071">Bryan Gin-ge Chen (Sep 23 2018 at 18:37)</a>:</h4>
<p>That's great, thanks for being so patient and looking into it. Now we should look into editing these solutions into the various docs that are floating around out there...</p>

<a name="134487567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134487567" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134487567">Mario Carneiro (Sep 23 2018 at 18:54)</a>:</h4>
<p>I don't think git bash is fully usable for lean, although I forget why. I made some attempts to do this when I started and some necessary packages were missing with no clear way to get them</p>

<a name="134487588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134487588" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134487588">Mario Carneiro (Sep 23 2018 at 18:55)</a>:</h4>
<p>Certainly CMD and powershell won't work</p>

<a name="134487622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134487622" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134487622">Mario Carneiro (Sep 23 2018 at 18:56)</a>:</h4>
<p>I haven't tested Cygwin extensively, but it has its own issues to deal with and I found MSYS2 much easier</p>

<a name="134487642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134487642" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134487642">Mario Carneiro (Sep 23 2018 at 18:56)</a>:</h4>
<p>I'd be curious to see if anyone makes lean work with WSL</p>

<a name="134487844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/134487844" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#134487844">Bryan Gin-ge Chen (Sep 23 2018 at 19:02)</a>:</h4>
<p>I've been using git bash up to now and haven't noticed anything wrong, but all I'm doing with regards to lean is just running <code>leanpkg upgrade</code> and <code>leanpkg build</code> occasionally. I did have to mess around with my console program to get unicode characters to print properly though.</p>

<a name="136440118"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/136440118" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#136440118">Scott Morrison (Oct 24 2018 at 22:16)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="110032">@Reid Barton</span>, did you ever sort this out? Can we just delete the <code>lean-3.4.1</code> branch of <code>mathlib</code>? I see that Mario has been occasionally updating, but it still requires manual intervention.</p>

<a name="136440150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/136440150" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#136440150">Reid Barton (Oct 24 2018 at 22:17)</a>:</h4>
<p>No, we can't just delete it unfortunately--leanpkg requires a branch matching the lean version to exist, when that version is a stable version</p>

<a name="136440338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/136440338" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#136440338">Reid Barton (Oct 24 2018 at 22:20)</a>:</h4>
<p>I think the best "solution" we have for now is for somebody to figure out how to write a git hook that Mario can use to update the branch head automatically</p>

<a name="156376118"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/156376118" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#156376118">Neil Strickland (Jan 18 2019 at 15:30)</a>:</h4>
<p>I am also using git bash without obvious problems.  I have msys2 installed but it is not in the path so that should not make a difference.<br>
<span class="user-mention" data-user-id="123965">@Bryan Gin-ge Chen</span> , what did you do to fix the unicode?</p>

<a name="156376424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/156376424" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#156376424">Bryan Gin-ge Chen (Jan 18 2019 at 15:34)</a>:</h4>
<p>For me it was an issue with a setting in my console program, <a href="http://cmder.net/" target="_blank" title="http://cmder.net/"><code>cmder</code></a> which seems to be a reskin or repackaging of <a href="https://conemu.github.io/" target="_blank" title="https://conemu.github.io/"><code>conemu</code></a>. I had to add the setting <code>chcp utf8</code> to the environment per <a href="https://conemu.github.io/en/UnicodeSupport.html" target="_blank" title="https://conemu.github.io/en/UnicodeSupport.html">this page</a>.</p>

<a name="156378147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanpkg/near/156378147" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/35331leanpkg.html#156378147">Neil Strickland (Jan 18 2019 at 15:54)</a>:</h4>
<p>Thanks.  That suggestion doesn't seem immediately applicable to me as I am just using git bash in vscode (and git bash outside vscode seems to handle unicode correctly).  I poked around a bit more and found this page <a href="https://github.com/Microsoft/vscode/issues/60330" target="_blank" title="https://github.com/Microsoft/vscode/issues/60330">https://github.com/Microsoft/vscode/issues/60330</a>, but the suggestions there seemed to have no effect.  I'll probably just leave it now as it is not really causing me any trouble, it's just untidy.</p>


{% endraw %}
