---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/79339profiling.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html">profiling</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="124196289"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124196289" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124196289">Simon Hudon (Mar 25 2018 at 18:34)</a>:</h4>
<p>Am I correct to believe that <code>lean --make</code> and <code>lean --profile</code> are not meant to be used together? </p>
<p>When I use them together, I get this error:</p>
<div class="codehilite"><pre><span></span>libc++abi.dylib: terminating with uncaught exception of type std::length_error: vector
</pre></div>


<p>Do people use <code>--profile</code> one file at a time?</p>

<a name="124200802"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124200802" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124200802">Sebastian Ullrich (Mar 25 2018 at 21:38)</a>:</h4>
<p>I constantly use both flags together. The error message sure sounds bad.</p>

<a name="124200863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124200863" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124200863">Simon Hudon (Mar 25 2018 at 21:41)</a>:</h4>
<p>I'm on Mac. What about you?</p>

<a name="124200866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124200866" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124200866">Sebastian Ullrich (Mar 25 2018 at 21:41)</a>:</h4>
<p>Linux. I was about to ask.</p>

<a name="124200916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124200916" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124200916">Simon Hudon (Mar 25 2018 at 21:43)</a>:</h4>
<p>I'm wondering if the C++ runtime on Mac allocates less memory than on Linux. Does that sound sensible?</p>

<a name="124200957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124200957" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124200957">Simon Hudon (Mar 25 2018 at 21:44)</a>:</h4>
<p>(now I'm getting around that limitation with a Makefile)</p>

<a name="124200959"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124200959" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124200959">Simon Hudon (Mar 25 2018 at 21:44)</a>:</h4>
<p>(... which profiles one file at a time)</p>

<a name="124200966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124200966" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124200966">Sebastian Ullrich (Mar 25 2018 at 21:45)</a>:</h4>
<p>You can also use <code>--profile --recursive</code></p>

<a name="124201067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124201067" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124201067">Simon Hudon (Mar 25 2018 at 21:49)</a>:</h4>
<p>What's the difference with <code>--make</code>?</p>

<a name="124201114"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124201114" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124201114">Sebastian Ullrich (Mar 25 2018 at 21:50)</a>:</h4>
<p>It doesn't actually save .olean files, but I'll assume that's not that part you want to profile :)</p>

<a name="124201118"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124201118" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124201118">Simon Hudon (Mar 25 2018 at 21:50)</a>:</h4>
<p>I believe you're right :)</p>

<a name="124201121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124201121" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124201121">Simon Hudon (Mar 25 2018 at 21:51)</a>:</h4>
<p>The bad news is that I get the same error</p>

<a name="124201331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124201331" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124201331">Sebastian Ullrich (Mar 25 2018 at 21:59)</a>:</h4>
<p>Well that's not good</p>

<a name="124201382"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124201382" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124201382">Moses Sch√∂nfinkel (Mar 25 2018 at 22:01)</a>:</h4>
<p>About as good as the broken link to Nightly Lean Windows build :P.</p>

<a name="124348839"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124348839" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124348839">Simon Hudon (Mar 29 2018 at 02:49)</a>:</h4>
<p>I've been using <code>lean --profile</code> on Mac and Linux and they seem to produce different information. On Mac, I get information like:</p>
<div class="codehilite"><pre><span></span>elaboration: tactic compilation took 8.2ms
elaboration: tactic execution took 221ms
num. allocated objects:  1407
num. allocated closures: 366
  221ms   100.0%   _interaction._lambda_2
  221ms   100.0%   scope_trace
  221ms   100.0%   tactic.istep._lambda_1
  221ms   100.0%   tactic.solve1
  221ms   100.0%   tactic.step
  221ms   100.0%   tactic.istep
  220ms    99.5%   tactic.interactive.simp_core
  220ms    99.5%   tactic.interactive.propagate_tags
  218ms    98.6%   tactic.mk_simp_set_core
  218ms    98.6%   tactic.mk_simp_set
  217ms    98.2%   tactic.get_user_simp_lemmas
  217ms    98.2%   get_attribute_cache_dyn._lambda_1
  217ms    98.2%   user_attribute.get_cache
  217ms    98.2%   simp_attr.tl_simp._lambda_3
  217ms    98.2%   tactic.to_simp_lemmas
  217ms    98.2%   tactic.join_user_simp_lemmas_core
  217ms    98.2%   tactic.join_user_simp_lemmas
  215ms    97.3%   simp_lemmas.add_simp
  202ms    91.4%   interaction_monad.monad._lambda_9
  201ms    91.0%   simp_attr.tl_simp._lambda_2
</pre></div>


<p>while on Linux, I do not. Otherwise, the information looks the same</p>

<a name="124348841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124348841" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124348841">Simon Hudon (Mar 29 2018 at 02:49)</a>:</h4>
<p>Is that normal?</p>

<a name="124361454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124361454" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124361454">Sebastian Ullrich (Mar 29 2018 at 10:28)</a>:</h4>
<p><span class="user-mention" data-user-id="110026">@Simon Hudon</span> No, it should work on Linux as well</p>

<a name="124361455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124361455" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124361455">Sebastian Ullrich (Mar 29 2018 at 10:28)</a>:</h4>
<p>Btw, you can use <code>-D profiler.threshold=0.5</code> to suppress output &lt; 0.5s for example</p>

<a name="124363084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124363084" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124363084">Simon Hudon (Mar 29 2018 at 11:27)</a>:</h4>
<p>thanks! Thanks should be useful! I'll try that. Any list of those fun constants?</p>

<a name="124363129"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124363129" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124363129">Sebastian Ullrich (Mar 29 2018 at 11:28)</a>:</h4>
<p>Same constants as after <code>set_option</code></p>

<a name="124363483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124363483" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124363483">Simon Hudon (Mar 29 2018 at 11:41)</a>:</h4>
<p>thanks! What does <code>profiler.freq</code> do?</p>

<a name="124363782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/profiling/near/124363782" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79339profiling.html#124363782">Sebastian Ullrich (Mar 29 2018 at 11:53)</a>:</h4>
<p>The tactic execution profile as above is computed by sampling the top-most stack frame at that frequency</p>


{% endraw %}
