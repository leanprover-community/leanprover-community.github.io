---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/65585themostpointlessconstruction.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html">the most pointless construction</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="159206182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159206182" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159206182">Kenny Lau (Feb 23 2019 at 01:15)</a>:</h4>
<p>I constructed the left adjoint of the forgetful functor from (the category of fields with 0^-1 = 0) to (the category of nonzero comm rings where every element is a unit)</p>

<a name="159214903"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159214903" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159214903">Johan Commelin (Feb 23 2019 at 05:30)</a>:</h4>
<p>Awesome... ...</p>

<a name="159214918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159214918" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159214918">Johan Commelin (Feb 23 2019 at 05:31)</a>:</h4>
<p>That's an equivalence. But not constructively so? I don't know. Whatever <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>

<a name="159221914"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159221914" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159221914">Kenny Lau (Feb 23 2019 at 09:23)</a>:</h4>
<p>Sneak peak:</p>
<div class="codehilite"><pre><span></span><span class="kn">inductive</span> <span class="n">pre_to_field</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span>
<span class="bp">|</span> <span class="n">of</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">pre_to_field</span>
<span class="bp">|</span> <span class="n">add</span> <span class="o">:</span> <span class="n">pre_to_field</span> <span class="bp">→</span> <span class="n">pre_to_field</span> <span class="bp">→</span> <span class="n">pre_to_field</span>
<span class="bp">|</span> <span class="n">mul</span> <span class="o">:</span> <span class="n">pre_to_field</span> <span class="bp">→</span> <span class="n">pre_to_field</span> <span class="bp">→</span> <span class="n">pre_to_field</span>
<span class="bp">|</span> <span class="n">inv</span> <span class="o">:</span> <span class="n">pre_to_field</span> <span class="bp">→</span> <span class="n">pre_to_field</span>

<span class="n">def</span> <span class="n">mk</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">to_field</span> <span class="n">α</span> <span class="o">:=</span>
<span class="err">⟦</span><span class="n">pre_to_field</span><span class="bp">.</span><span class="n">of</span> <span class="n">x</span><span class="err">⟧</span>

<span class="kn">theorem</span> <span class="n">mk</span><span class="bp">.</span><span class="n">bijective</span> <span class="o">:</span> <span class="n">function</span><span class="bp">.</span><span class="n">bijective</span> <span class="o">(</span><span class="bp">@</span><span class="n">mk</span> <span class="n">α</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">H</span><span class="o">,</span> <span class="k">let</span> <span class="bp">⟨</span><span class="n">z</span><span class="o">,</span> <span class="n">hxz</span><span class="o">,</span> <span class="n">hyz</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">exact</span> <span class="n">H</span> <span class="k">in</span> <span class="n">eq</span><span class="bp">.</span><span class="n">trans</span> <span class="n">hxz</span> <span class="n">hyz</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span>
<span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">x</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span><span class="o">,</span> <span class="k">let</span> <span class="bp">⟨</span><span class="n">z</span><span class="o">,</span> <span class="n">hz</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="n">pre_to_field</span><span class="bp">.</span><span class="n">unique_rel</span> <span class="n">p</span> <span class="k">in</span>
<span class="bp">⟨</span><span class="n">z</span><span class="o">,</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">sound</span> <span class="bp">⟨</span><span class="n">z</span><span class="o">,</span> <span class="n">rfl</span><span class="o">,</span> <span class="n">hz</span><span class="bp">.</span><span class="mi">1</span><span class="bp">⟩⟩⟩</span>

<span class="n">def</span> <span class="kn">eval</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">field&#39;</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">f</span><span class="o">]</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">to_field</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">β</span> <span class="o">:=</span>
<span class="n">quotient</span><span class="bp">.</span><span class="n">lift_on</span> <span class="n">p</span> <span class="o">(</span><span class="n">pre_to_field</span><span class="bp">.</span><span class="kn">eval</span> <span class="n">f</span><span class="o">)</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hqx</span><span class="bp">⟩</span><span class="o">,</span>
<span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">pre_to_field</span><span class="bp">.</span><span class="n">eval_of_rel</span> <span class="n">f</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">pre_to_field</span><span class="bp">.</span><span class="n">eval_of_rel</span> <span class="n">f</span> <span class="n">hqx</span><span class="o">]</span>
</pre></div>

<a name="159222328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159222328" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159222328">Mario Carneiro (Feb 23 2019 at 09:36)</a>:</h4>
<p>is this the free meadow?</p>

<a name="159222339"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159222339" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159222339">Johan Commelin (Feb 23 2019 at 09:37)</a>:</h4>
<p>I never understood why "champ algebrique" was translated into English as "algebraic stack" instead of "algebraic acre".</p>

<a name="159223780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159223780" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159223780">Kenny Lau (Feb 23 2019 at 10:27)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> does this have its place in mathlib?</p>

<a name="159223782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159223782" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159223782">Kenny Lau (Feb 23 2019 at 10:27)</a>:</h4>
<p>we can redefine the reals to have "computable" inverse :P</p>

<a name="159226006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226006" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226006">Mario Carneiro (Feb 23 2019 at 11:39)</a>:</h4>
<p>what's <code>field'</code>?</p>

<a name="159226010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226010" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226010">Kenny Lau (Feb 23 2019 at 11:39)</a>:</h4>
<p>good question</p>

<a name="159226055"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226055" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226055">Kenny Lau (Feb 23 2019 at 11:40)</a>:</h4>
<p><a href="#narrow/stream/113488-general/topic/field" title="#narrow/stream/113488-general/topic/field">https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/field</a>'</p>

<a name="159226056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226056" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226056">Kenny Lau (Feb 23 2019 at 11:40)</a>:</h4>
<p>see this thread :P</p>

<a name="159226057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226057" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226057">Mario Carneiro (Feb 23 2019 at 11:40)</a>:</h4>
<p>what's <code>to_field</code>?</p>

<a name="159226060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226060" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226060">Kenny Lau (Feb 23 2019 at 11:40)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">to_field</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">is_division_ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="o">:=</span>
<span class="n">quotient</span> <span class="o">(</span><span class="n">pre_to_field</span><span class="bp">.</span><span class="n">setoid</span> <span class="n">α</span><span class="o">)</span>
</pre></div>

<a name="159226140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226140" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226140">Mario Carneiro (Feb 23 2019 at 11:43)</a>:</h4>
<p>I think <code>field'</code> should be <code>discrete_field</code></p>

<a name="159226142"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226142" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226142">Kenny Lau (Feb 23 2019 at 11:44)</a>:</h4>
<p>I don't think so</p>

<a name="159226185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226185" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226185">Kenny Lau (Feb 23 2019 at 11:44)</a>:</h4>
<p>because we don't assume modules, abelian groups, rings, semirings, etc, to have decidable equality</p>

<a name="159226353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226353" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226353">Mario Carneiro (Feb 23 2019 at 11:50)</a>:</h4>
<p>that's true, but decidability is sort of part of a field - it's basically impossible to define a field structure without decidable equality</p>

<a name="159226364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226364" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226364">Kenny Lau (Feb 23 2019 at 11:51)</a>:</h4>
<p>I just did it :P</p>

<a name="159226419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226419" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226419">Mario Carneiro (Feb 23 2019 at 11:52)</a>:</h4>
<p>what about 0 != 1? What's <code>pre_to_field.setoid</code>?</p>

<a name="159226441"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226441" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226441">Kenny Lau (Feb 23 2019 at 11:53)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">ring</span>

<span class="n">universes</span> <span class="n">u</span> <span class="n">v</span>

<span class="kn">variables</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span>

<span class="n">class</span> <span class="n">is_division_ring</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">exists_inv</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">},</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span>

<span class="kn">section</span>
<span class="kn">set_option</span> <span class="n">old_structure_cmd</span> <span class="n">true</span>
<span class="n">class</span> <span class="n">field&#39;</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">division_ring</span> <span class="n">α</span><span class="o">,</span> <span class="n">comm_ring</span> <span class="n">α</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">inv_zero</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">α</span><span class="o">)</span><span class="bp">⁻¹</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span>
<span class="kn">end</span>

<span class="kn">theorem</span> <span class="n">inv_zero&#39;</span> <span class="o">[</span><span class="n">field&#39;</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">α</span><span class="o">)</span><span class="bp">⁻¹</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="n">field&#39;</span><span class="bp">.</span><span class="n">inv_zero</span> <span class="n">α</span>

<span class="kn">theorem</span> <span class="n">mul_eq_one_comm</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">is_division_ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">hxy</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="n">y</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="n">classical</span><span class="bp">.</span><span class="n">by_cases</span>
  <span class="o">(</span><span class="k">assume</span> <span class="n">hy0</span> <span class="o">:</span> <span class="n">y</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">hxy</span><span class="o">,</span> <span class="n">hy0</span><span class="o">,</span> <span class="n">zero_mul</span><span class="o">,</span> <span class="n">mul_zero</span><span class="o">])</span>
  <span class="o">(</span><span class="k">assume</span> <span class="n">hy0</span> <span class="o">:</span> <span class="n">y</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span> <span class="k">let</span> <span class="bp">⟨</span><span class="n">z</span><span class="o">,</span> <span class="n">hz</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="n">is_division_ring</span><span class="bp">.</span><span class="n">exists_inv</span> <span class="n">hy0</span> <span class="k">in</span>
    <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">mul_one</span> <span class="n">x</span><span class="o">,</span> <span class="err">←</span> <span class="n">hz</span><span class="o">,</span> <span class="err">←</span> <span class="n">mul_assoc</span> <span class="n">x</span><span class="o">,</span> <span class="n">hxy</span><span class="o">,</span> <span class="n">one_mul</span><span class="o">])</span>

<span class="kn">inductive</span> <span class="n">pre_to_field</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span>
<span class="bp">|</span> <span class="n">of</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">pre_to_field</span>
<span class="bp">|</span> <span class="n">add</span> <span class="o">:</span> <span class="n">pre_to_field</span> <span class="bp">→</span> <span class="n">pre_to_field</span> <span class="bp">→</span> <span class="n">pre_to_field</span>
<span class="bp">|</span> <span class="n">mul</span> <span class="o">:</span> <span class="n">pre_to_field</span> <span class="bp">→</span> <span class="n">pre_to_field</span> <span class="bp">→</span> <span class="n">pre_to_field</span>
<span class="bp">|</span> <span class="n">inv</span> <span class="o">:</span> <span class="n">pre_to_field</span> <span class="bp">→</span> <span class="n">pre_to_field</span>

<span class="kn">namespace</span> <span class="n">pre_to_field</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span>

<span class="n">def</span> <span class="n">rel</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="o">(</span><span class="n">pre_to_field</span> <span class="n">α</span><span class="o">)</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">of</span> <span class="n">p</span><span class="o">)</span>    <span class="n">z</span> <span class="o">:=</span> <span class="n">p</span> <span class="bp">=</span> <span class="n">z</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">add</span> <span class="n">p</span> <span class="n">q</span><span class="o">)</span> <span class="n">z</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">rel</span> <span class="n">p</span> <span class="n">x</span> <span class="bp">∧</span> <span class="n">rel</span> <span class="n">q</span> <span class="n">y</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">z</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">mul</span> <span class="n">p</span> <span class="n">q</span><span class="o">)</span> <span class="n">z</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">rel</span> <span class="n">p</span> <span class="n">x</span> <span class="bp">∧</span> <span class="n">rel</span> <span class="n">q</span> <span class="n">y</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">z</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">inv</span> <span class="n">p</span><span class="o">)</span>   <span class="n">z</span> <span class="o">:=</span> <span class="n">rel</span> <span class="n">p</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">z</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">∨</span> <span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="n">rel</span> <span class="n">p</span> <span class="n">x</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">z</span> <span class="bp">=</span> <span class="mi">1</span>

<span class="n">def</span> <span class="n">neg</span> <span class="o">[</span><span class="n">has_neg</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">pre_to_field</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">pre_to_field</span> <span class="n">α</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">of</span> <span class="n">p</span><span class="o">)</span>    <span class="o">:=</span> <span class="n">of</span> <span class="o">(</span><span class="bp">-</span><span class="n">p</span><span class="o">)</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">add</span> <span class="n">x</span> <span class="n">y</span><span class="o">)</span> <span class="o">:=</span> <span class="n">add</span> <span class="o">(</span><span class="n">neg</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">neg</span> <span class="n">y</span><span class="o">)</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">mul</span> <span class="n">x</span> <span class="n">y</span><span class="o">)</span> <span class="o">:=</span> <span class="n">mul</span> <span class="o">(</span><span class="n">neg</span> <span class="n">x</span><span class="o">)</span> <span class="n">y</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">inv</span> <span class="n">x</span><span class="o">)</span>   <span class="o">:=</span> <span class="n">inv</span> <span class="o">(</span><span class="n">neg</span> <span class="n">x</span><span class="o">)</span>

<span class="kn">theorem</span> <span class="n">rel_neg</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">p</span><span class="o">}</span> <span class="o">{</span><span class="n">z</span> <span class="o">:</span> <span class="n">α</span><span class="o">},</span> <span class="n">rel</span> <span class="n">p</span> <span class="n">z</span> <span class="bp">→</span> <span class="n">rel</span> <span class="o">(</span><span class="n">neg</span> <span class="n">p</span><span class="o">)</span> <span class="o">(</span><span class="bp">-</span><span class="n">z</span><span class="o">)</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">of</span> <span class="n">p</span><span class="o">)</span>    <span class="n">z</span> <span class="n">hpz</span>                   <span class="o">:=</span> <span class="n">congr_arg</span> <span class="n">has_neg</span><span class="bp">.</span><span class="n">neg</span> <span class="n">hpz</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">add</span> <span class="n">p</span> <span class="n">q</span><span class="o">)</span> <span class="n">z</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hqy</span><span class="o">,</span> <span class="n">hxyz</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="bp">⟨-</span><span class="n">x</span><span class="o">,</span> <span class="bp">-</span><span class="n">y</span><span class="o">,</span> <span class="n">rel_neg</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">rel_neg</span> <span class="n">hqy</span><span class="o">,</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">hxyz</span><span class="o">,</span> <span class="n">neg_add</span><span class="o">]</span><span class="bp">⟩</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">mul</span> <span class="n">p</span> <span class="n">q</span><span class="o">)</span> <span class="n">z</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hqy</span><span class="o">,</span> <span class="n">hxyz</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="bp">⟨-</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">rel_neg</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hqy</span><span class="o">,</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">hxyz</span><span class="o">,</span> <span class="n">neg_mul_eq_neg_mul</span><span class="o">]</span><span class="bp">⟩</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">inv</span> <span class="n">p</span><span class="o">)</span>   <span class="n">z</span> <span class="o">(</span><span class="n">or</span><span class="bp">.</span><span class="n">inl</span> <span class="bp">⟨</span><span class="n">hp0</span><span class="o">,</span> <span class="n">hz0</span><span class="bp">⟩</span><span class="o">)</span>    <span class="o">:=</span> <span class="n">or</span><span class="bp">.</span><span class="n">inl</span> <span class="bp">⟨@</span><span class="n">neg_zero</span> <span class="n">α</span> <span class="bp">_</span> <span class="bp">▸</span> <span class="n">rel_neg</span> <span class="n">hp0</span><span class="o">,</span> <span class="n">neg_eq_zero</span><span class="bp">.</span><span class="mi">2</span> <span class="n">hz0</span><span class="bp">⟩</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">inv</span> <span class="n">p</span><span class="o">)</span>   <span class="n">z</span> <span class="o">(</span><span class="n">or</span><span class="bp">.</span><span class="n">inr</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hxz</span><span class="bp">⟩</span><span class="o">)</span> <span class="o">:=</span> <span class="n">or</span><span class="bp">.</span><span class="n">inr</span> <span class="bp">⟨-</span><span class="n">x</span><span class="o">,</span> <span class="n">rel_neg</span> <span class="n">hpx</span><span class="o">,</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">neg_mul_neg</span><span class="o">,</span> <span class="n">hxz</span><span class="o">]</span><span class="bp">⟩</span>

<span class="kn">variables</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">is_division_ring</span> <span class="n">α</span><span class="o">]</span>

<span class="kn">lemma</span> <span class="n">unique_rel</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">pre_to_field</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃!</span><span class="n">x</span><span class="o">,</span> <span class="n">rel</span> <span class="n">p</span> <span class="n">x</span> <span class="o">:=</span>
<span class="n">pre_to_field</span><span class="bp">.</span><span class="n">rec_on</span> <span class="n">p</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">rfl</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">y</span> <span class="n">hxy</span><span class="o">,</span> <span class="n">hxy</span><span class="bp">.</span><span class="n">symm</span><span class="bp">⟩</span><span class="o">)</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hpx2</span><span class="bp">⟩</span> <span class="bp">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">hqy</span><span class="o">,</span> <span class="n">hqy2</span><span class="bp">⟩</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">x</span><span class="bp">+</span><span class="n">y</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hqy</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span><span class="o">,</span>
    <span class="bp">λ</span> <span class="n">z</span> <span class="bp">⟨</span><span class="n">x&#39;</span><span class="o">,</span> <span class="n">y&#39;</span><span class="o">,</span> <span class="n">hpx&#39;</span><span class="o">,</span> <span class="n">hqy&#39;</span><span class="o">,</span> <span class="n">hxyz</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">hpx2</span> <span class="n">x&#39;</span> <span class="n">hpx&#39;</span> <span class="bp">▸</span> <span class="n">hqy2</span> <span class="n">y&#39;</span> <span class="n">hqy&#39;</span> <span class="bp">▸</span> <span class="n">hxyz</span><span class="bp">.</span><span class="n">symm</span><span class="bp">⟩</span><span class="o">)</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hpx2</span><span class="bp">⟩</span> <span class="bp">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">hqy</span><span class="o">,</span> <span class="n">hqy2</span><span class="bp">⟩</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">x</span><span class="bp">*</span><span class="n">y</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hqy</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span><span class="o">,</span>
    <span class="bp">λ</span> <span class="n">z</span> <span class="bp">⟨</span><span class="n">x&#39;</span><span class="o">,</span> <span class="n">y&#39;</span><span class="o">,</span> <span class="n">hpx&#39;</span><span class="o">,</span> <span class="n">hqy&#39;</span><span class="o">,</span> <span class="n">hxyz</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">hpx2</span> <span class="n">x&#39;</span> <span class="n">hpx&#39;</span> <span class="bp">▸</span> <span class="n">hqy2</span> <span class="n">y&#39;</span> <span class="n">hqy&#39;</span> <span class="bp">▸</span> <span class="n">hxyz</span><span class="bp">.</span><span class="n">symm</span><span class="bp">⟩</span><span class="o">)</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="n">p</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hpx2</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">classical</span><span class="bp">.</span><span class="n">by_cases</span>
    <span class="o">(</span><span class="k">assume</span> <span class="n">hx0</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span> <span class="bp">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">or</span><span class="bp">.</span><span class="n">inl</span> <span class="bp">⟨</span><span class="n">hx0</span> <span class="bp">▸</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">y</span> <span class="n">hy</span><span class="o">,</span>
      <span class="n">or</span><span class="bp">.</span><span class="n">cases_on</span> <span class="n">hy</span> <span class="n">and</span><span class="bp">.</span><span class="n">right</span> <span class="err">$</span> <span class="bp">λ</span> <span class="bp">⟨</span><span class="n">z</span><span class="o">,</span> <span class="n">hpz</span><span class="o">,</span> <span class="n">hzy</span><span class="bp">⟩</span><span class="o">,</span>
      <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">one_mul</span> <span class="n">y</span><span class="o">,</span> <span class="err">←</span> <span class="n">hzy</span><span class="o">,</span> <span class="n">hpx2</span> <span class="n">z</span> <span class="n">hpz</span><span class="o">,</span> <span class="n">hx0</span><span class="o">,</span> <span class="n">zero_mul</span><span class="o">,</span> <span class="n">zero_mul</span><span class="o">]</span><span class="bp">⟩</span><span class="o">)</span>
    <span class="o">(</span><span class="k">assume</span> <span class="n">hx0</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span> <span class="k">let</span> <span class="bp">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">hxy</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="n">is_division_ring</span><span class="bp">.</span><span class="n">exists_inv</span> <span class="n">hx0</span> <span class="k">in</span>
      <span class="bp">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">or</span><span class="bp">.</span><span class="n">inr</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hxy</span><span class="bp">⟩</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">z</span> <span class="n">hz</span><span class="o">,</span> <span class="n">or</span><span class="bp">.</span><span class="n">cases_on</span> <span class="n">hz</span>
        <span class="o">(</span><span class="bp">λ</span> <span class="bp">⟨</span><span class="n">hp0</span><span class="o">,</span> <span class="n">hz0</span><span class="bp">⟩</span><span class="o">,</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hz0</span><span class="o">,</span> <span class="err">←</span> <span class="n">one_mul</span> <span class="n">y</span><span class="o">,</span> <span class="err">←</span> <span class="n">hxy</span><span class="o">,</span> <span class="err">←</span> <span class="n">hpx2</span> <span class="mi">0</span> <span class="n">hp0</span><span class="o">,</span> <span class="n">zero_mul</span><span class="o">,</span> <span class="n">zero_mul</span><span class="o">])</span>
        <span class="o">(</span><span class="bp">λ</span> <span class="bp">⟨</span><span class="n">s</span><span class="o">,</span> <span class="n">hps</span><span class="o">,</span> <span class="n">hsz</span><span class="bp">⟩</span><span class="o">,</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">mul_one</span> <span class="n">y</span><span class="o">,</span> <span class="err">←</span> <span class="n">hsz</span><span class="o">,</span> <span class="err">←</span> <span class="n">mul_assoc</span><span class="o">,</span> <span class="n">hpx2</span> <span class="n">s</span> <span class="n">hps</span><span class="o">,</span> <span class="n">mul_eq_one_comm</span> <span class="n">hxy</span><span class="o">,</span> <span class="n">one_mul</span><span class="o">])</span><span class="bp">⟩</span><span class="o">))</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span>

<span class="n">def</span> <span class="kn">eval</span> <span class="o">[</span><span class="n">division_ring</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="n">pre_to_field</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">of</span> <span class="n">p</span><span class="o">)</span>    <span class="o">:=</span> <span class="n">f</span> <span class="n">p</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">add</span> <span class="n">x</span> <span class="n">y</span><span class="o">)</span> <span class="o">:=</span> <span class="kn">eval</span> <span class="n">x</span> <span class="bp">+</span> <span class="kn">eval</span> <span class="n">y</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">mul</span> <span class="n">x</span> <span class="n">y</span><span class="o">)</span> <span class="o">:=</span> <span class="kn">eval</span> <span class="n">x</span> <span class="bp">*</span> <span class="kn">eval</span> <span class="n">y</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">inv</span> <span class="n">p</span><span class="o">)</span>   <span class="o">:=</span> <span class="o">(</span><span class="kn">eval</span> <span class="n">p</span><span class="o">)</span><span class="bp">⁻¹</span>

<span class="kn">theorem</span> <span class="n">eval_of_rel</span> <span class="o">[</span><span class="n">field&#39;</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">f</span><span class="o">]</span> <span class="o">:</span>
  <span class="bp">Π</span> <span class="o">{</span><span class="n">p</span><span class="o">}</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">hpx</span> <span class="o">:</span> <span class="n">pre_to_field</span><span class="bp">.</span><span class="n">rel</span> <span class="n">p</span> <span class="n">x</span><span class="o">),</span> <span class="kn">eval</span> <span class="n">f</span> <span class="n">p</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">x</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">of</span> <span class="n">p</span><span class="o">)</span>    <span class="n">z</span> <span class="n">hpz</span>                   <span class="o">:=</span> <span class="n">congr_arg</span> <span class="n">f</span> <span class="n">hpz</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">add</span> <span class="n">p</span> <span class="n">q</span><span class="o">)</span> <span class="n">z</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hqy</span><span class="o">,</span> <span class="n">hxyz</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="kn">eval</span><span class="o">,</span> <span class="n">eval_of_rel</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">eval_of_rel</span> <span class="n">hqy</span><span class="o">,</span> <span class="err">←</span> <span class="n">hxyz</span><span class="o">,</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_add</span> <span class="n">f</span><span class="o">]</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">mul</span> <span class="n">p</span> <span class="n">q</span><span class="o">)</span> <span class="n">z</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hqy</span><span class="o">,</span> <span class="n">hxyz</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="kn">eval</span><span class="o">,</span> <span class="n">eval_of_rel</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">eval_of_rel</span> <span class="n">hqy</span><span class="o">,</span> <span class="err">←</span> <span class="n">hxyz</span><span class="o">,</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_mul</span> <span class="n">f</span><span class="o">]</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">inv</span> <span class="n">p</span><span class="o">)</span>   <span class="n">z</span> <span class="o">(</span><span class="n">or</span><span class="bp">.</span><span class="n">inl</span> <span class="bp">⟨</span><span class="n">hp0</span><span class="o">,</span> <span class="n">hz0</span><span class="bp">⟩</span><span class="o">)</span>    <span class="o">:=</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="kn">eval</span><span class="o">,</span> <span class="n">eval_of_rel</span> <span class="n">hp0</span><span class="o">,</span> <span class="n">hz0</span><span class="o">,</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_zero</span> <span class="n">f</span><span class="o">,</span> <span class="n">inv_zero&#39;</span><span class="o">]</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">inv</span> <span class="n">p</span><span class="o">)</span>   <span class="n">z</span> <span class="o">(</span><span class="n">or</span><span class="bp">.</span><span class="n">inr</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hxz</span><span class="bp">⟩</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="kn">eval</span><span class="o">,</span> <span class="n">eval_of_rel</span> <span class="n">hpx</span><span class="o">,</span> <span class="err">←</span> <span class="n">mul_one</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span><span class="bp">⁻¹</span><span class="o">,</span> <span class="err">←</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_one</span> <span class="n">f</span><span class="o">,</span>
    <span class="err">←</span> <span class="n">hxz</span><span class="o">,</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_mul</span> <span class="n">f</span><span class="o">,</span> <span class="err">←</span> <span class="n">mul_assoc</span><span class="o">,</span>
    <span class="n">inv_mul_cancel</span> <span class="o">(</span><span class="k">assume</span> <span class="n">hfx</span> <span class="o">:</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span> <span class="bp">@</span><span class="n">zero_ne_one</span> <span class="n">β</span> <span class="bp">_</span> <span class="err">$</span>
      <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_one</span> <span class="n">f</span><span class="o">,</span> <span class="err">←</span> <span class="n">hxz</span><span class="o">,</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_mul</span> <span class="n">f</span><span class="o">,</span> <span class="n">hfx</span><span class="o">,</span> <span class="n">zero_mul</span><span class="o">]),</span>
    <span class="n">one_mul</span><span class="o">]</span>

<span class="kn">variables</span> <span class="o">(</span><span class="n">α</span><span class="o">)</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">setoid</span> <span class="o">(</span><span class="n">pre_to_field</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">r</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span><span class="o">,</span> <span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="n">rel</span> <span class="n">p</span> <span class="n">x</span> <span class="bp">∧</span> <span class="n">rel</span> <span class="n">q</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">iseqv</span> <span class="o">:=</span> <span class="bp">⟨λ</span> <span class="n">p</span><span class="o">,</span> <span class="k">let</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hx</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="n">unique_rel</span> <span class="n">p</span> <span class="k">in</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hx</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span> <span class="n">hx</span><span class="bp">.</span><span class="mi">1</span><span class="bp">⟩</span><span class="o">,</span>
    <span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hqx</span><span class="bp">⟩</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hqx</span><span class="o">,</span> <span class="n">hpx</span><span class="bp">⟩</span><span class="o">,</span>
    <span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span> <span class="n">r</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hqx</span><span class="bp">⟩</span> <span class="bp">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">hqy</span><span class="o">,</span> <span class="n">hry</span><span class="bp">⟩</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">unique_of_exists_unique</span> <span class="o">(</span><span class="n">unique_rel</span> <span class="n">q</span><span class="o">)</span> <span class="n">hqy</span> <span class="n">hqx</span> <span class="bp">▸</span> <span class="n">hry</span><span class="bp">⟩⟩</span> <span class="o">}</span>

<span class="kn">end</span> <span class="n">pre_to_field</span>


<span class="n">def</span> <span class="n">to_field</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">is_division_ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="o">:=</span>
<span class="n">quotient</span> <span class="o">(</span><span class="n">pre_to_field</span><span class="bp">.</span><span class="n">setoid</span> <span class="n">α</span><span class="o">)</span>

<span class="kn">namespace</span> <span class="n">to_field</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">is_division_ring</span> <span class="n">α</span><span class="o">]</span>

<span class="n">def</span> <span class="n">mk</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">to_field</span> <span class="n">α</span> <span class="o">:=</span>
<span class="err">⟦</span><span class="n">pre_to_field</span><span class="bp">.</span><span class="n">of</span> <span class="n">x</span><span class="err">⟧</span>

<span class="kn">variables</span> <span class="o">(</span><span class="n">α</span><span class="o">)</span>

<span class="kn">theorem</span> <span class="n">mk</span><span class="bp">.</span><span class="n">bijective</span> <span class="o">:</span> <span class="n">function</span><span class="bp">.</span><span class="n">bijective</span> <span class="o">(</span><span class="bp">@</span><span class="n">mk</span> <span class="n">α</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">H</span><span class="o">,</span> <span class="k">let</span> <span class="bp">⟨</span><span class="n">z</span><span class="o">,</span> <span class="n">hxz</span><span class="o">,</span> <span class="n">hyz</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">exact</span> <span class="n">H</span> <span class="k">in</span> <span class="n">eq</span><span class="bp">.</span><span class="n">trans</span> <span class="n">hxz</span> <span class="n">hyz</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span>
<span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">x</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span><span class="o">,</span> <span class="k">let</span> <span class="bp">⟨</span><span class="n">z</span><span class="o">,</span> <span class="n">hz</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="n">pre_to_field</span><span class="bp">.</span><span class="n">unique_rel</span> <span class="n">p</span> <span class="k">in</span>
<span class="bp">⟨</span><span class="n">z</span><span class="o">,</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">sound</span> <span class="bp">⟨</span><span class="n">z</span><span class="o">,</span> <span class="n">rfl</span><span class="o">,</span> <span class="n">hz</span><span class="bp">.</span><span class="mi">1</span><span class="bp">⟩⟩⟩</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">has_add</span> <span class="o">(</span><span class="n">to_field</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">lift_on₂</span> <span class="n">x</span> <span class="n">y</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span><span class="o">,</span> <span class="err">⟦</span><span class="n">pre_to_field</span><span class="bp">.</span><span class="n">add</span> <span class="n">p</span> <span class="n">q</span><span class="err">⟧</span><span class="o">)</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span> <span class="n">r</span> <span class="n">s</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hrx</span><span class="bp">⟩</span> <span class="bp">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">hqy</span><span class="o">,</span> <span class="n">hsy</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">sound</span>
<span class="bp">⟨</span><span class="n">x</span> <span class="bp">+</span> <span class="n">y</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hqy</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">hrx</span><span class="o">,</span> <span class="n">hsy</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩⟩⟩</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">has_neg</span> <span class="o">(</span><span class="n">to_field</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">lift_on</span> <span class="n">x</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">p</span><span class="o">,</span> <span class="err">⟦</span><span class="n">pre_to_field</span><span class="bp">.</span><span class="n">neg</span> <span class="n">p</span><span class="err">⟧</span><span class="o">)</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hqx</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">sound</span>
<span class="bp">⟨-</span><span class="n">x</span><span class="o">,</span> <span class="n">pre_to_field</span><span class="bp">.</span><span class="n">rel_neg</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">pre_to_field</span><span class="bp">.</span><span class="n">rel_neg</span> <span class="n">hqx</span><span class="bp">⟩⟩</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">has_mul</span> <span class="o">(</span><span class="n">to_field</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">lift_on₂</span> <span class="n">x</span> <span class="n">y</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span><span class="o">,</span> <span class="err">⟦</span><span class="n">pre_to_field</span><span class="bp">.</span><span class="n">mul</span> <span class="n">p</span> <span class="n">q</span><span class="err">⟧</span><span class="o">)</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span> <span class="n">r</span> <span class="n">s</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hrx</span><span class="bp">⟩</span> <span class="bp">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">hqy</span><span class="o">,</span> <span class="n">hsy</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">sound</span>
<span class="bp">⟨</span><span class="n">x</span> <span class="bp">*</span> <span class="n">y</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hqy</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">hrx</span><span class="o">,</span> <span class="n">hsy</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩⟩⟩</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">has_inv</span> <span class="o">(</span><span class="n">to_field</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">lift_on</span> <span class="n">x</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">p</span><span class="o">,</span> <span class="err">⟦</span><span class="n">pre_to_field</span><span class="bp">.</span><span class="n">inv</span> <span class="n">p</span><span class="err">⟧</span><span class="o">)</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hqx</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">sound</span> <span class="err">$</span>
<span class="n">classical</span><span class="bp">.</span><span class="n">by_cases</span>
  <span class="o">(</span><span class="k">assume</span> <span class="n">hx0</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span> <span class="bp">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">or</span><span class="bp">.</span><span class="n">inl</span> <span class="bp">⟨</span><span class="n">hx0</span> <span class="bp">▸</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">or</span><span class="bp">.</span><span class="n">inl</span> <span class="bp">⟨</span><span class="n">hx0</span> <span class="bp">▸</span> <span class="n">hqx</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩⟩</span><span class="o">)</span>
  <span class="o">(</span><span class="k">assume</span> <span class="n">hx0</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span> <span class="k">let</span> <span class="bp">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">hy</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="n">is_division_ring</span><span class="bp">.</span><span class="n">exists_inv</span> <span class="n">hx0</span> <span class="k">in</span> <span class="bp">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">or</span><span class="bp">.</span><span class="n">inr</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hy</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">or</span><span class="bp">.</span><span class="n">inr</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hqx</span><span class="o">,</span> <span class="n">hy</span><span class="bp">⟩⟩</span><span class="o">)</span><span class="bp">⟩</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span>

<span class="bp">@</span><span class="o">[</span><span class="n">elab_as_eliminator</span><span class="o">]</span> <span class="kn">protected</span> <span class="kn">lemma</span> <span class="n">induction_on</span>
  <span class="o">{</span><span class="n">C</span> <span class="o">:</span> <span class="n">to_field</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">}</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">to_field</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">ih</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">z</span><span class="o">,</span> <span class="n">C</span> <span class="o">(</span><span class="n">mk</span> <span class="n">z</span><span class="o">))</span> <span class="o">:</span> <span class="n">C</span> <span class="n">x</span> <span class="o">:=</span>
<span class="k">let</span> <span class="bp">⟨</span><span class="n">z</span><span class="o">,</span> <span class="n">hz</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="o">(</span><span class="n">mk</span><span class="bp">.</span><span class="n">bijective</span> <span class="n">α</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span> <span class="n">x</span> <span class="k">in</span> <span class="n">hz</span> <span class="bp">▸</span> <span class="n">ih</span> <span class="n">z</span>

<span class="bp">@</span><span class="o">[</span><span class="n">elab_as_eliminator</span><span class="o">]</span> <span class="kn">protected</span> <span class="kn">lemma</span> <span class="n">induction_on₂</span>
  <span class="o">{</span><span class="n">C</span> <span class="o">:</span> <span class="n">to_field</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">to_field</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">}</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">to_field</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">ih</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">p</span> <span class="n">q</span><span class="o">,</span> <span class="n">C</span> <span class="o">(</span><span class="n">mk</span> <span class="n">p</span><span class="o">)</span> <span class="o">(</span><span class="n">mk</span> <span class="n">q</span><span class="o">))</span> <span class="o">:</span> <span class="n">C</span> <span class="n">x</span> <span class="n">y</span> <span class="o">:=</span>
<span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">x</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span><span class="o">,</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">y</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">q</span><span class="o">,</span> <span class="n">ih</span> <span class="n">p</span> <span class="n">q</span>

<span class="bp">@</span><span class="o">[</span><span class="n">elab_as_eliminator</span><span class="o">]</span> <span class="kn">protected</span> <span class="kn">lemma</span> <span class="n">induction_on₃</span>
  <span class="o">{</span><span class="n">C</span> <span class="o">:</span> <span class="n">to_field</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">to_field</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">to_field</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">}</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">to_field</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">ih</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">p</span> <span class="n">q</span> <span class="n">r</span><span class="o">,</span> <span class="n">C</span> <span class="o">(</span><span class="n">mk</span> <span class="n">p</span><span class="o">)</span> <span class="o">(</span><span class="n">mk</span> <span class="n">q</span><span class="o">)</span> <span class="o">(</span><span class="n">mk</span> <span class="n">r</span><span class="o">))</span> <span class="o">:</span> <span class="n">C</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:=</span>
<span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">x</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span><span class="o">,</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">y</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">q</span><span class="o">,</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">z</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">r</span><span class="o">,</span> <span class="n">ih</span> <span class="n">p</span> <span class="n">q</span> <span class="n">r</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">mk_add</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">mk</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">y</span><span class="o">)</span> <span class="bp">=</span> <span class="n">mk</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">mk</span> <span class="n">y</span> <span class="o">:=</span>
<span class="n">quotient</span><span class="bp">.</span><span class="n">sound</span> <span class="bp">⟨</span><span class="n">x</span> <span class="bp">+</span> <span class="n">y</span><span class="o">,</span> <span class="n">rfl</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">rfl</span><span class="o">,</span> <span class="n">rfl</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩⟩</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">mk_neg</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">mk</span> <span class="o">(</span><span class="bp">-</span><span class="n">x</span><span class="o">)</span> <span class="bp">=</span> <span class="bp">-</span><span class="n">mk</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">mk_mul</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">mk</span> <span class="o">(</span><span class="n">x</span> <span class="bp">*</span> <span class="n">y</span><span class="o">)</span> <span class="bp">=</span> <span class="n">mk</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">mk</span> <span class="n">y</span> <span class="o">:=</span>
<span class="n">quotient</span><span class="bp">.</span><span class="n">sound</span> <span class="bp">⟨</span><span class="n">x</span> <span class="bp">*</span> <span class="n">y</span><span class="o">,</span> <span class="n">rfl</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">rfl</span><span class="o">,</span> <span class="n">rfl</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩⟩</span>

<span class="kn">lemma</span> <span class="n">mk_inv</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">hxy</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">mk</span> <span class="n">x</span><span class="o">)</span><span class="bp">⁻¹</span> <span class="bp">=</span> <span class="n">mk</span> <span class="n">y</span> <span class="o">:=</span>
<span class="n">quotient</span><span class="bp">.</span><span class="n">sound</span> <span class="bp">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">or</span><span class="bp">.</span><span class="n">inr</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">rfl</span><span class="o">,</span> <span class="n">hxy</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span>

<span class="kn">variables</span> <span class="o">(</span><span class="n">α</span><span class="o">)</span>
<span class="kn">instance</span> <span class="o">:</span> <span class="n">ring</span> <span class="o">(</span><span class="n">to_field</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">zero</span> <span class="o">:=</span> <span class="n">mk</span> <span class="mi">0</span><span class="o">,</span>
  <span class="n">one</span> <span class="o">:=</span> <span class="n">mk</span> <span class="mi">1</span><span class="o">,</span>
  <span class="n">add_assoc</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">,</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on₃</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span> <span class="n">r</span><span class="o">,</span>
    <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">mk_add</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_add</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_add</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_add</span><span class="o">,</span> <span class="n">add_assoc</span><span class="o">],</span>
  <span class="n">zero_add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">x</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span><span class="o">,</span>
    <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">mk_add</span><span class="o">,</span> <span class="n">zero_add</span><span class="o">],</span>
  <span class="n">add_zero</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">x</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span><span class="o">,</span>
    <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">mk_add</span><span class="o">,</span> <span class="n">add_zero</span><span class="o">],</span>
  <span class="n">add_left_neg</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">x</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span><span class="o">,</span>
    <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">mk_neg</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_add</span><span class="o">,</span> <span class="n">add_left_neg</span><span class="o">]</span><span class="bp">;</span> <span class="n">refl</span><span class="o">,</span>
  <span class="n">add_comm</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on₂</span> <span class="n">x</span> <span class="n">y</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span><span class="o">,</span>
    <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">mk_add</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_add</span><span class="o">,</span> <span class="n">add_comm</span><span class="o">],</span>
  <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">,</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on₃</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span> <span class="n">r</span><span class="o">,</span>
    <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">mk_mul</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_mul</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_mul</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_mul</span><span class="o">,</span> <span class="n">mul_assoc</span><span class="o">],</span>
  <span class="n">one_mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">x</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span><span class="o">,</span>
    <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">mk_mul</span><span class="o">,</span> <span class="n">one_mul</span><span class="o">],</span>
  <span class="n">mul_one</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">x</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span><span class="o">,</span>
    <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">mk_mul</span><span class="o">,</span> <span class="n">mul_one</span><span class="o">],</span>
  <span class="n">left_distrib</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">,</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on₃</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span> <span class="n">r</span><span class="o">,</span>
    <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">mk_add</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_mul</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_mul</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_mul</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_add</span><span class="o">,</span> <span class="n">mul_add</span><span class="o">],</span>
  <span class="n">right_distrib</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">,</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on₃</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span> <span class="n">r</span><span class="o">,</span>
    <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">mk_add</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_mul</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_mul</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_mul</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_add</span><span class="o">,</span> <span class="n">add_mul</span><span class="o">],</span>
  <span class="bp">..</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">has_add</span> <span class="n">α</span><span class="o">,</span>
  <span class="bp">..</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">has_neg</span> <span class="n">α</span><span class="o">,</span>
  <span class="bp">..</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">has_mul</span> <span class="n">α</span> <span class="o">}</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">mk_zero</span> <span class="o">:</span> <span class="n">mk</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">mk_one</span> <span class="o">:</span> <span class="n">mk</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kn">instance</span> <span class="n">mk</span><span class="bp">.</span><span class="n">is_ring_hom</span> <span class="o">:</span> <span class="n">is_ring_hom</span> <span class="o">(</span><span class="bp">@</span><span class="n">mk</span> <span class="n">α</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨</span><span class="n">mk_one</span> <span class="n">α</span><span class="o">,</span> <span class="n">mk_mul</span><span class="o">,</span> <span class="n">mk_add</span><span class="bp">⟩</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span>
<span class="n">def</span> <span class="kn">eval</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">field&#39;</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">f</span><span class="o">]</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">to_field</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">β</span> <span class="o">:=</span>
<span class="n">quotient</span><span class="bp">.</span><span class="n">lift_on</span> <span class="n">p</span> <span class="o">(</span><span class="n">pre_to_field</span><span class="bp">.</span><span class="kn">eval</span> <span class="n">f</span><span class="o">)</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">hqx</span><span class="bp">⟩</span><span class="o">,</span>
<span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">pre_to_field</span><span class="bp">.</span><span class="n">eval_of_rel</span> <span class="n">f</span> <span class="n">hpx</span><span class="o">,</span> <span class="n">pre_to_field</span><span class="bp">.</span><span class="n">eval_of_rel</span> <span class="n">f</span> <span class="n">hqx</span><span class="o">]</span>

<span class="kn">instance</span> <span class="kn">eval</span><span class="bp">.</span><span class="n">is_ring_hom</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">field&#39;</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">f</span><span class="o">]</span> <span class="o">:</span> <span class="n">is_ring_hom</span> <span class="o">(</span><span class="kn">eval</span> <span class="n">f</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨</span><span class="k">by</span> <span class="n">convert</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_one</span> <span class="n">f</span><span class="o">,</span>
<span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span><span class="o">,</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">induction_on₂</span> <span class="n">p</span> <span class="n">q</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">rfl</span><span class="o">,</span>
<span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span><span class="o">,</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">induction_on₂</span> <span class="n">p</span> <span class="n">q</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span>

<span class="kn">end</span> <span class="n">to_field</span>

<span class="kn">namespace</span> <span class="n">to_field</span>

<span class="kn">instance</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">is_division_ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">comm_ring</span> <span class="o">(</span><span class="n">to_field</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">mul_comm</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on₂</span> <span class="n">x</span> <span class="n">y</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span> <span class="n">q</span><span class="o">,</span>
    <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">mk_mul</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_mul</span><span class="o">,</span> <span class="n">mul_comm</span><span class="o">],</span>
  <span class="bp">..</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">ring</span> <span class="n">α</span> <span class="o">}</span>

<span class="kn">instance</span> <span class="o">[</span><span class="n">nonzero_comm_ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">is_division_ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">field</span> <span class="o">(</span><span class="n">to_field</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">zero_ne_one</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">H</span><span class="o">,</span> <span class="n">zero_ne_one</span> <span class="err">$</span> <span class="o">(</span><span class="n">mk</span><span class="bp">.</span><span class="n">bijective</span> <span class="n">α</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">H</span><span class="o">,</span>
  <span class="n">mul_inv_cancel</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">x</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span> <span class="n">hp0</span><span class="o">,</span>
    <span class="k">let</span> <span class="bp">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">hy</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="n">is_division_ring</span><span class="bp">.</span><span class="n">exists_inv</span> <span class="o">(</span><span class="n">mt</span> <span class="o">(</span><span class="n">congr_arg</span> <span class="n">mk</span><span class="o">)</span> <span class="n">hp0</span><span class="o">)</span> <span class="k">in</span>
    <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">mk_inv</span> <span class="n">hy</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_mul</span><span class="o">,</span> <span class="n">hy</span><span class="o">,</span> <span class="n">mk_one</span><span class="o">],</span>
  <span class="n">inv_mul_cancel</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">x</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">p</span> <span class="n">hp0</span><span class="o">,</span>
    <span class="k">let</span> <span class="bp">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">hy</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="n">is_division_ring</span><span class="bp">.</span><span class="n">exists_inv</span> <span class="o">(</span><span class="n">mt</span> <span class="o">(</span><span class="n">congr_arg</span> <span class="n">mk</span><span class="o">)</span> <span class="n">hp0</span><span class="o">)</span> <span class="k">in</span>
    <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">mk_inv</span> <span class="n">hy</span><span class="o">,</span> <span class="err">←</span> <span class="n">mk_mul</span><span class="o">,</span> <span class="n">mul_eq_one_comm</span> <span class="n">hy</span><span class="o">,</span> <span class="n">mk_one</span><span class="o">],</span>
  <span class="bp">..</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">comm_ring</span> <span class="n">α</span><span class="o">,</span>
  <span class="bp">..</span> <span class="n">to_field</span><span class="bp">.</span><span class="n">has_inv</span> <span class="n">α</span> <span class="o">}</span>

<span class="kn">end</span> <span class="n">to_field</span>
</pre></div>

<a name="159226489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226489" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226489">Kenny Lau (Feb 23 2019 at 11:54)</a>:</h4>
<p>oh and to give a concrete example: the Cauchy sequence construction of the real numbers allow you to define it as a ring constructively; then <code>to_field real</code> would be an example of a field where the inverse of 0 is 0, but it has no decidable equality.</p>

<a name="159226549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226549" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226549">Chris Hughes (Feb 23 2019 at 11:56)</a>:</h4>
<p>But you can't do it with computable inverses is the point I think.</p>

<a name="159226552"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226552" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226552">Kenny Lau (Feb 23 2019 at 11:56)</a>:</h4>
<p><code>to_field real</code> has computable inverse, inv zero = zero, and no decidable equality</p>

<a name="159226610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226610" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226610">Mario Carneiro (Feb 23 2019 at 11:58)</a>:</h4>
<p>I see a <code>classical.by_cases</code> in there though</p>

<a name="159226616"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226616" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226616">Kenny Lau (Feb 23 2019 at 11:58)</a>:</h4>
<p><code>classical.by_cases</code> is computable</p>

<a name="159226618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226618" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226618">Mario Carneiro (Feb 23 2019 at 11:58)</a>:</h4>
<p>In order to work with the axioms of a division ring you don't actually need decidable eq but rather eq LEM</p>

<a name="159226620"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226620" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226620">Mario Carneiro (Feb 23 2019 at 11:59)</a>:</h4>
<p>but we don't have a typeclass for that</p>

<a name="159226699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226699" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226699">Kenny Lau (Feb 23 2019 at 12:00)</a>:</h4>
<p>I just find it inconvenient that the inverse of zero is left unspecified in <code>field</code> (which makes <code>subfield</code> weird, as seen in <a href="https://github.com/leanprover/mathlib/issues/742" target="_blank" title="https://github.com/leanprover/mathlib/issues/742">#742</a>), and too strict that <code>discrete_field </code>requires decidable equality</p>

<a name="159226700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226700" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226700">Kenny Lau (Feb 23 2019 at 12:01)</a>:</h4>
<p>I think <code>field'</code> is the correct structure</p>

<a name="159226760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226760" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226760">Mario Carneiro (Feb 23 2019 at 12:02)</a>:</h4>
<p>I agree that <code>field</code> is stupid, that's why I've been telling everyone to use <code>discrete_field</code> instead</p>

<a name="159226774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226774" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226774">Kenny Lau (Feb 23 2019 at 12:03)</a>:</h4>
<p>but we don't assume <code>add_comm_group</code> or <code>semiring</code> or <code>module</code> to have decidable equality either, so decidable equality seems too strong</p>

<a name="159226778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226778" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226778">Mario Carneiro (Feb 23 2019 at 12:03)</a>:</h4>
<p>That's because none of those have case analysis on equaling zero</p>

<a name="159226824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226824" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226824">Mario Carneiro (Feb 23 2019 at 12:04)</a>:</h4>
<p>I think the proper constructive analogue of <code>field</code> is <code>ring</code></p>

<a name="159226891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226891" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226891">Mario Carneiro (Feb 23 2019 at 12:06)</a>:</h4>
<p>Also, we do have plenty of structures that assume decidable equality, specifically the order structures</p>

<a name="159226893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226893" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226893">Mario Carneiro (Feb 23 2019 at 12:06)</a>:</h4>
<p><code>decidable_linear_ordered_semigroup</code> and so on</p>

<a name="159226910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226910" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226910">Kenny Lau (Feb 23 2019 at 12:07)</a>:</h4>
<p>but the category of discrete rings is not closed under direct limit</p>

<a name="159226954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226954" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226954">Mario Carneiro (Feb 23 2019 at 12:08)</a>:</h4>
<p>is the category of fields?</p>

<a name="159226955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226955" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226955">Kenny Lau (Feb 23 2019 at 12:08)</a>:</h4>
<p>yes</p>

<a name="159226957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226957" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226957">Mario Carneiro (Feb 23 2019 at 12:08)</a>:</h4>
<p>in that case, I have no idea what you are talking about</p>

<a name="159226958"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226958" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226958">Kenny Lau (Feb 23 2019 at 12:08)</a>:</h4>
<p>what?</p>

<a name="159226965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226965" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226965">Mario Carneiro (Feb 23 2019 at 12:09)</a>:</h4>
<p>I don't have any conception of how direct limits work</p>

<a name="159226966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226966" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226966">Mario Carneiro (Feb 23 2019 at 12:09)</a>:</h4>
<p>or what the issues are</p>

<a name="159226969"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226969" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226969">Kenny Lau (Feb 23 2019 at 12:09)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/blob/cf8a619bde24d327387dd7321a8da55fd3bbd585/src/algebra/direct_limit.lean#L503-L555" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/cf8a619bde24d327387dd7321a8da55fd3bbd585/src/algebra/direct_limit.lean#L503-L555">https://github.com/leanprover-community/mathlib/blob/cf8a619bde24d327387dd7321a8da55fd3bbd585/src/algebra/direct_limit.lean#L503-L555</a></p>

<a name="159226972"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159226972" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159226972">Kenny Lau (Feb 23 2019 at 12:10)</a>:</h4>
<p>the issue is that to_field works great with direct limit</p>

<a name="159227019"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227019" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227019">Kenny Lau (Feb 23 2019 at 12:10)</a>:</h4>
<p>the category of field is closed under direct limit</p>

<a name="159227021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227021" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227021">Kenny Lau (Feb 23 2019 at 12:10)</a>:</h4>
<p>and the category of discrete field might also be (I haven't thought about it)</p>

<a name="159227025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227025" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227025">Kenny Lau (Feb 23 2019 at 12:10)</a>:</h4>
<p>but the category of discrete rings, I'm 50% certain that it must not be closed under direct limit</p>

<a name="159227030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227030" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227030">Mario Carneiro (Feb 23 2019 at 12:11)</a>:</h4>
<p>I didn't say anything about discrete rings though</p>

<a name="159227037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227037" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227037">Kenny Lau (Feb 23 2019 at 12:11)</a>:</h4>
<p>so you think that <code>field'</code> should not even exist?</p>

<a name="159227038"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227038" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227038">Mario Carneiro (Feb 23 2019 at 12:11)</a>:</h4>
<p>I'm asserting that all interesting fields are decidable</p>

<a name="159227040"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227040" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227040">Kenny Lau (Feb 23 2019 at 12:11)</a>:</h4>
<p>and I gave you a concrete counter-example</p>

<a name="159227042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227042" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227042">Kenny Lau (Feb 23 2019 at 12:11)</a>:</h4>
<p>there's no way to make <code>real</code> decidable</p>

<a name="159227084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227084" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227084">Mario Carneiro (Feb 23 2019 at 12:12)</a>:</h4>
<p>You want a different structure than <code>field'</code>... you want a ring where inverses exist</p>

<a name="159227087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227087" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227087">Mario Carneiro (Feb 23 2019 at 12:12)</a>:</h4>
<p>exist in the weak sense</p>

<a name="159227089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227089" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227089">Kenny Lau (Feb 23 2019 at 12:12)</a>:</h4>
<p>well then theorems become a bit clumsy</p>

<a name="159227096"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227096" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227096">Kenny Lau (Feb 23 2019 at 12:13)</a>:</h4>
<p>so no that's not what I want</p>

<a name="159227139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227139" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227139">Mario Carneiro (Feb 23 2019 at 12:14)</a>:</h4>
<p><code>to_field</code> gives you a way to explicitly refer to these elements that are only known to exist propositionally</p>

<a name="159227145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227145" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227145">Mario Carneiro (Feb 23 2019 at 12:14)</a>:</h4>
<p>but the cost is that you "only" get a <code>bijection</code> rather than an <code>equiv</code></p>

<a name="159227154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227154" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227154">Kenny Lau (Feb 23 2019 at 12:15)</a>:</h4>
<p>is there a situation where the hypothetical inverse function <code>to_field real -&gt; real</code> is helpful?</p>

<a name="159227212"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227212" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227212">Mario Carneiro (Feb 23 2019 at 12:17)</a>:</h4>
<p>sure... if you want to talk about the inverse of a real number</p>

<a name="159227219"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227219" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227219">Kenny Lau (Feb 23 2019 at 12:17)</a>:</h4>
<p>I mean, let's say we replaced <code>real</code> with <code>to_field real</code></p>

<a name="159227221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227221" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227221">Kenny Lau (Feb 23 2019 at 12:17)</a>:</h4>
<p>everywhere in mathlib</p>

<a name="159227224"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227224" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227224">Kenny Lau (Feb 23 2019 at 12:17)</a>:</h4>
<p>so the canonical structure of the real numbers is a field where the inverse of zero is zero, without decidable equality</p>

<a name="159227273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227273" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227273">Kenny Lau (Feb 23 2019 at 12:18)</a>:</h4>
<p>also I think the category of discrete fields is not closed under direct limit</p>

<a name="159227278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227278" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227278">Mario Carneiro (Feb 23 2019 at 12:19)</a>:</h4>
<p>The real numbers are a quotient of Cauchy sequences. <code>to_field real</code> is a quotient of field expressions with constants in <code>real</code>... so it's like you just adjoined inverses for everything</p>

<a name="159227287"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227287" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227287">Kenny Lau (Feb 23 2019 at 12:19)</a>:</h4>
<p>you never use the Cauchy sequences anyway</p>

<a name="159227289"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227289" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227289">Mario Carneiro (Feb 23 2019 at 12:19)</a>:</h4>
<p>How do you define the supremum?</p>

<a name="159227291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227291" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227291">Kenny Lau (Feb 23 2019 at 12:19)</a>:</h4>
<p>ok let's put this in context</p>

<a name="159227292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227292" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227292">Kenny Lau (Feb 23 2019 at 12:19)</a>:</h4>
<p>what should I replace <a href="https://github.com/leanprover-community/mathlib/blob/cf8a619bde24d327387dd7321a8da55fd3bbd585/src/algebra/direct_limit.lean#L503-L555" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/cf8a619bde24d327387dd7321a8da55fd3bbd585/src/algebra/direct_limit.lean#L503-L555">https://github.com/leanprover-community/mathlib/blob/cf8a619bde24d327387dd7321a8da55fd3bbd585/src/algebra/direct_limit.lean#L503-L555</a> by?</p>

<a name="159227328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227328" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227328">Kenny Lau (Feb 23 2019 at 12:20)</a>:</h4>
<p>I definitely want direct limit of fields</p>

<a name="159227336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227336" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227336">Kenny Lau (Feb 23 2019 at 12:20)</a>:</h4>
<p>so don't tell me replace it with EOF</p>

<a name="159227338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227338" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227338">Mario Carneiro (Feb 23 2019 at 12:20)</a>:</h4>
<p>go classical, man</p>

<a name="159227339"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227339" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227339">Kenny Lau (Feb 23 2019 at 12:20)</a>:</h4>
<p>classical != noncomputable</p>

<a name="159227341"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227341" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227341">Mario Carneiro (Feb 23 2019 at 12:20)</a>:</h4>
<p>go noncomputable, man</p>

<a name="159227342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227342" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227342">Kenny Lau (Feb 23 2019 at 12:20)</a>:</h4>
<p>really?</p>

<a name="159227360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227360" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227360">Mario Carneiro (Feb 23 2019 at 12:21)</a>:</h4>
<p>if it requires you to invent entirely new algebraic structures just to get this theorem, yes it seems like a valid approach</p>

<a name="159227361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227361" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227361">Kenny Lau (Feb 23 2019 at 12:21)</a>:</h4>
<p>what's wrong with inventing new algebraic structures</p>

<a name="159227362"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227362" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227362">Mario Carneiro (Feb 23 2019 at 12:21)</a>:</h4>
<p>well you have to make sure they play well with everything else</p>

<a name="159227404"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227404" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227404">Mario Carneiro (Feb 23 2019 at 12:22)</a>:</h4>
<p>particularly if you are planning on replacing the original</p>

<a name="159227418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227418" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227418">Mario Carneiro (Feb 23 2019 at 12:23)</a>:</h4>
<p>I should say that I am actually quite impressed with the whole construction; I didn't know this was possible until you showed me</p>

<a name="159227422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227422" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227422">Kenny Lau (Feb 23 2019 at 12:23)</a>:</h4>
<p>thanks for your appreciation</p>

<a name="159227423"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227423" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227423">Mario Carneiro (Feb 23 2019 at 12:24)</a>:</h4>
<p>But I'm 110% sure kevin will say you are wasting your time</p>

<a name="159227476"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227476" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227476">Kenny Lau (Feb 23 2019 at 12:25)</a>:</h4>
<p>... on a more related note, does this have its place in mathlib?</p>

<a name="159227477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227477" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227477">Kenny Lau (Feb 23 2019 at 12:25)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">class</span> <span class="n">is_division_ring</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">exists_inv</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">},</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span>
</pre></div>

<a name="159227538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227538" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227538">Mario Carneiro (Feb 23 2019 at 12:27)</a>:</h4>
<p>This seems a bit easier to deal with. This is what division rings should have been</p>

<a name="159227582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227582" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227582">Mario Carneiro (Feb 23 2019 at 12:28)</a>:</h4>
<p>IIUC real is a division ring in this sense</p>

<a name="159227668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159227668" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159227668">Kenny Lau (Feb 23 2019 at 12:31)</a>:</h4>
<p>so in which file should I put this?</p>

<a name="159228024"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159228024" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159228024">Kevin Buzzard (Feb 23 2019 at 12:42)</a>:</h4>
<p>(wasting your time) -- I simply do not understand the issues here and with things like this I only attempt to understand the issues when they actually affect my own work (like I never understood why lean treated quotients differently from equivalence classes until it began to matter to me). I'm not sure this will ever matter to me but I can quite believe there is a discussion to be had</p>

<a name="159231432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159231432" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159231432">Sebastien Gouezel (Feb 23 2019 at 14:30)</a>:</h4>
<p>Why shouldn't we assume that all our structures have decidable equality? I am sure there are interesting things to be discussed here, but I don't really get them. I think what I would like to see is a concrete example where it creates a problem to assume decidable equality everywhere.</p>

<a name="159234211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159234211" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159234211">Mario Carneiro (Feb 23 2019 at 15:50)</a>:</h4>
<p>I think the main problem is that this can make definitions noncomputable when they should be computable, e.g. rational arithmetic</p>

<a name="159234216"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159234216" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159234216">Mario Carneiro (Feb 23 2019 at 15:50)</a>:</h4>
<p>and this can block some <code>rfl</code> proofs of trivial facts</p>

<a name="159234230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159234230" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159234230">Mario Carneiro (Feb 23 2019 at 15:51)</a>:</h4>
<p>(that's the pragmatic answer; there might also be religious reasons)</p>

<a name="159235663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159235663" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159235663">Sebastien Gouezel (Feb 23 2019 at 16:30)</a>:</h4>
<p>I am very much interested in pragmatic answers, thanks. And what if general decidable equality is declared with priority 0, and specific computable instances are declared with higher priority, say 50. Would that still block anything?</p>

<a name="159235774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159235774" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159235774">Mario Carneiro (Feb 23 2019 at 16:32)</a>:</h4>
<p>The problem isn't so much with finding the wrong instance as it is with intermediate constructions being more classical than they could be with more care</p>

<a name="159235807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159235807" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159235807">Mario Carneiro (Feb 23 2019 at 16:33)</a>:</h4>
<p>i.e. if you use that int is a ring then you are depending on the axiom of choice, because an intermediate step decided not to use decidable equality when it was available</p>

<a name="159236995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159236995" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159236995">Sebastien Gouezel (Feb 23 2019 at 17:02)</a>:</h4>
<p>I still don't get why it could be important in proofs, since they are irrelevant anyway. In definitions where one might want to compute, sure. But my question is even more pragmatic: if one removed everything about <code>linear_order</code> in mathlib, using only <code>decidable_linear_order</code> everywhere, would that break something? If one assumed in the very definition of <code>ring</code>, and <code>group</code>, and everything, that equality is decidable, would that break something?</p>

<a name="159237225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159237225" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159237225">Kenny Lau (Feb 23 2019 at 17:08)</a>:</h4>
<p>"Proofs are irrelevant" -- every Lean user ever</p>

<a name="159238902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159238902" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159238902">Johannes Hölzl (Feb 23 2019 at 17:54)</a>:</h4>
<p>Lean 3 users, there is still HoTT Lean</p>

<a name="159238968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159238968" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159238968">Johannes Hölzl (Feb 23 2019 at 17:56)</a>:</h4>
<p>But I would also prefer to add decidability to most things: (additive) semigroups, orders etc.</p>

<a name="159239496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/the%20most%20pointless%20construction/near/159239496" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65585themostpointlessconstruction.html#159239496">Sebastien Gouezel (Feb 23 2019 at 18:11)</a>:</h4>
<blockquote>
<p>"Proofs are irrelevant" -- every Lean user ever</p>
</blockquote>
<p>This quote is crazy, and I can't believe I said it myself. Don't tell that to my fellow mathematicians, please.</p>


{% endraw %}
