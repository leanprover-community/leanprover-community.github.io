---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/03459convexample.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html">conv example</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="123651407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123651407" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123651407">Kevin Buzzard (Mar 13 2018 at 11:43)</a>:</h4>
<p>I was trying to write an example to illustrate the power of <code>conv</code>, by finding an example where the entire goal was difficult to work with because it contained implicit proofs. I realised that there were two things I didn't understand properly. Here's some code.</p>

<a name="123651409"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123651409" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123651409">Kevin Buzzard (Mar 13 2018 at 11:43)</a>:</h4>
<div class="codehilite"><pre><span></span>@[elab_simple] def subtypeadd {m : ℕ} {n : ℕ} (A : fin m) (B : fin n) : fin (m+n) :=
  ⟨A.val+B.val,add_lt_add A.is_lt B.is_lt⟩

definition phi {m n : ℕ} : fin (m + n) → fin (n + m) := λ ⟨i,Hi⟩, ⟨i,add_comm m n ▸ Hi⟩

example {m n : ℕ} (A : fin m) (B : fin n) : phi (subtypeadd A B) = subtypeadd B A :=
begin
  have H : A.val + B.val = B.val + A.val := add_comm _ _,
  -- unfold subtypeadd using show
  show phi ⟨A.val + B.val, _⟩ = ⟨B.val + A.val, _⟩,
  rw H -- fails
end
</pre></div>

<a name="123651451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123651451" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123651451">Kevin Buzzard (Mar 13 2018 at 11:44)</a>:</h4>
<p>I wanted to make the example hard for one reason, but it somehow turned out to be hard for another reason :-/</p>

<a name="123651460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123651460" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123651460">Kevin Buzzard (Mar 13 2018 at 11:45)</a>:</h4>
<p>My first question is why does the <code>show</code> command succeed? I assumed that what <code>show X</code> did was that it first checked that <code>X</code> made sense, and then checked that it was defeq to the goal.</p>

<a name="123651464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123651464" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123651464">Kevin Buzzard (Mar 13 2018 at 11:45)</a>:</h4>
<p>But I thought I had explicitly rigged it here so that <code>X</code> wouldn't be able to be elaborated, because of the missing proofs.</p>

<a name="123651506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123651506" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123651506">Kevin Buzzard (Mar 13 2018 at 11:46)</a>:</h4>
<p>My second question is why does <code>rw</code> fail. I have heard rumours that <code>rw</code> will not work inside a lambda (although I don't really understand why -- why is this?) but this is not a lambda and I think the reason for failure is something else.</p>

<a name="123651512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123651512" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123651512">Kevin Buzzard (Mar 13 2018 at 11:47)</a>:</h4>
<p>The error message is</p>
<div class="codehilite"><pre><span></span>rewrite tactic failed, motive is not type correct
nested exception message:
check failed, application type mismatch (use &#39;set_option trace.check true&#39; for additional details)
state:
m n : ℕ,
A : fin m,
B : fin n,
H : A.val + B.val = B.val + A.val
⊢ phi ⟨A.val + B.val, _⟩ = ⟨B.val + A.val, _⟩
</pre></div>

<a name="123651515"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123651515" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123651515">Kevin Buzzard (Mar 13 2018 at 11:47)</a>:</h4>
<p>and if I <code>set_option trace.check true</code> then I get an exciting helpful extra hint:</p>

<a name="123651516"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123651516" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123651516">Kevin Buzzard (Mar 13 2018 at 11:47)</a>:</h4>
<div class="codehilite"><pre><span></span>[check] application type mismatch at
  ⟨_a, _⟩
argument type
  A.val + B.val &lt; m + n
expected type
  _a &lt; m + n
</pre></div>

<a name="123651557"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123651557" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123651557">Kevin Buzzard (Mar 13 2018 at 11:48)</a>:</h4>
<p>which makes no sense to me...oh! Is it rewriting too many A.val + B.val's?</p>

<a name="123651559"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123651559" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123651559">Kevin Buzzard (Mar 13 2018 at 11:48)</a>:</h4>
<p>I am still a bit bewildered about why this is a type mismatch I guess.</p>

<a name="123651565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123651565" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123651565">Kevin Buzzard (Mar 13 2018 at 11:49)</a>:</h4>
<p>(deleted)</p>

<a name="123651618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123651618" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123651618">Kevin Buzzard (Mar 13 2018 at 11:50)</a>:</h4>
<p>(deleted)</p>

<a name="123651680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123651680" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123651680">Kevin Buzzard (Mar 13 2018 at 11:52)</a>:</h4>
<p>For the first question I guess an underlying question is "which option do you switch on so you can see how Lean is filling in <code>_</code>s?"</p>

<a name="123652795"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123652795" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123652795">Mario Carneiro (Mar 13 2018 at 12:32)</a>:</h4>
<blockquote>
<p>My first question is why does the show command succeed? I assumed that what show X did was that it first checked that X made sense, and then checked that it was defeq to the goal.</p>
</blockquote>
<p>I was going to mention this before with your <code>X = Y</code> into <code>X' = Y</code> problem - you could have just written <code>show X' = _</code>. The reason this works is because the checking is done in a weak mode that tolerates metavariable generation, and the second defeq step is not just checking defeq, it is unifying with the target. This means that the first stage will create metavariables and the second stage will unfold stuff as needed to figure out the metavariables. If it can't completely solve the metavariables, you will get new goals instead of an error.</p>
<div class="codehilite"><pre><span></span>example : tt = tt :=
begin
  show (λ x, tt) _ = tt,
  -- ⊢ (λ (x : ?m_1), tt) ?m_2 = tt
end

example : tt = tt :=
begin
  change (λ x, tt) _ = tt,
  -- ⊢ (λ (x : ?m_1), tt) ?m_2 = tt
  -- ⊢ Sort ?
  -- ⊢ ?m_1
end
</pre></div>


<p>As you can see, <code>show</code> differs slightly in that it doesn't change the number of goals while <code>change</code> will add all those unsolved metavariables as new goals, just like <code>refine</code> would.</p>

<a name="123652855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123652855" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123652855">Mario Carneiro (Mar 13 2018 at 12:35)</a>:</h4>
<p>By the way, goals that look like your <code>phi ⟨A.val + B.val, _⟩ = ⟨B.val + A.val, _⟩</code> often don't work (they fail in the first stage of parsing), because the anonymous constructor can't be solved outright. In this case it works because <code>phi</code> is sufficient to deduce that both constructors are <code>fin</code>.</p>

<a name="123653214"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123653214" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123653214">Mario Carneiro (Mar 13 2018 at 12:48)</a>:</h4>
<blockquote>
<p>My second question is why does rw fail. I have heard rumours that rw will not work inside a lambda (although I don't really understand why -- why is this?) but this is not a lambda and I think the reason for failure is something else.</p>
</blockquote>
<p><code>rw</code> is very sensitive to dependencies. (Or more accurately, it is sufficiently <em>insensitive</em> to dependencies that it will generally fail in their presence.) Both <code>rw</code> and <code>generalize</code> are built on the same basic underlying internal tactic <code>kabstract</code>, which is supposed to take a term <code>P[T]</code> containing a subterm <code>T</code>, and replace it with a variable <code>x</code>. This is needed to construct the motive of the <code>eq.rec</code> application that goes in the proof term when using <code>rw</code>, and it's what you see directly if you use <code>generalize</code>.</p>
<p>The strategy is very simple: look through the term for any subterms that match <code>T</code> (up to some very light unfolding), and replace them with <code>x</code>. It should be obvious that this can get you into trouble when you have dependencies. For example, if <code>two_pos : 0 &lt; 2</code> then <code>&lt;2, two_pos&gt;</code> is a well typed element of <code>fin 2</code>, but if you simply replace 2 with x you get <code>&lt;x, two_pos&gt;</code> which is not in either <code>fin x</code> or <code>fin 2</code>, it's just malformed. It is actually really difficult to do this correctly in general; in this case you would probably want to generalize the proof of <code>two_pos</code> first so that it will "ride the wave" of 2 -&gt; x renaming rather than being stuck talking about the fixed number 2.</p>
<p>As it pertains to your example, the error message is fairly clear, although it would be more obvious with <code>set_option pp.proofs true</code>. The left argument to the <code>fin</code> constructor has been generalized from <code>A.val + B.val</code> to <code>_a</code>, but the right argument, the proof, is still a proof of <code>A.val + B.val &lt; m + n</code> (namely <code>add_lt_add A.is_lt B.is_lt</code>, what you ended up with after the unfolding), and this is not a correct proof of <code>_a &lt; m + n</code>.</p>
<p>The other major rewrite engine in lean is <code>simp</code>, which does not use <code>kabstract</code>. It operates by using congruence lemmas to recurse into subterms, and this strategy makes it much more reliably type-correct when it comes to rewriting under dependencies. If you try to use <code>simp</code> to rewrite here, it will work, and the proof argument will change to a cast of some sort to accommodate the new type.</p>

<a name="123653217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123653217" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123653217">Kevin Buzzard (Mar 13 2018 at 12:48)</a>:</h4>
<p>Is it possible for me to watch all this unification taking place explicitly? i.e. some set_option?</p>

<a name="123653282"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123653282" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123653282">Kevin Buzzard (Mar 13 2018 at 12:51)</a>:</h4>
<p>[that was about the show / change stuff]</p>

<a name="123653325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123653325" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123653325">Mario Carneiro (Mar 13 2018 at 12:52)</a>:</h4>
<p>I think <code>set_option trace.type_context.is_def_eq true</code> is what you want</p>

<a name="123653332"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123653332" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123653332">Kevin Buzzard (Mar 13 2018 at 12:52)</a>:</h4>
<p>Earlier on I realised that I didn't really know what rw did, so I've just spent 20 minutes doing edge cases and now I can understand the rw issue. I found that <code>rw</code> doesn't commute with <code>eq.symm</code> in general :-)</p>

<a name="123653334"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123653334" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123653334">Sebastian Ullrich (Mar 13 2018 at 12:52)</a>:</h4>
<p>Plus <code>...is_def_eq_detail</code>, probably</p>

<a name="123653381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123653381" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123653381">Kevin Buzzard (Mar 13 2018 at 12:54)</a>:</h4>
<div class="codehilite"><pre><span></span>example (a b: ℕ) : b + a = b + a + a + b := begin
rw add_comm, -- a + b = a + b + a + b
end
</pre></div>

<a name="123653455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123653455" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123653455">Kevin Buzzard (Mar 13 2018 at 12:57)</a>:</h4>
<p>Are the <code>set_option</code> options documented anywhere?</p>

<a name="123653753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123653753" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123653753">Mario Carneiro (Mar 13 2018 at 13:06)</a>:</h4>
<p><code>#help options</code> seems to do the trick. (I had to search the code to find that gem. <code>#help</code> is such a rarely used command for me, I'm not even really sure what's there...)</p>

<a name="123654932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123654932" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123654932">Kevin Buzzard (Mar 13 2018 at 13:39)</a>:</h4>
<p>I am not even sure if I knew <code>#help</code> existed. I thought the help command in Lean was <code>#print</code></p>

<a name="123654973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123654973" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123654973">Mario Carneiro (Mar 13 2018 at 13:40)</a>:</h4>
<p>it certainly does seem to be a large overlap of duties</p>

<a name="123654990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123654990" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123654990">Kevin Buzzard (Mar 13 2018 at 13:40)</a>:</h4>
<p>I can use conv to rewrite <code>A.val + B.val</code> in that earlier example.</p>

<a name="123654994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123654994" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123654994">Kevin Buzzard (Mar 13 2018 at 13:40)</a>:</h4>
<div class="codehilite"><pre><span></span>@[elab_simple] def subtypeadd {m : ℕ} {n : ℕ} (A : fin m) (B : fin n) : fin (m+n) :=
  ⟨A.val+B.val,add_lt_add A.is_lt B.is_lt⟩

definition phi {m n : ℕ} : fin (m + n) → fin (n + m) := λ ⟨i,Hi⟩, ⟨i,add_comm m n ▸ Hi⟩

example {m n : ℕ} (A : fin m) (B : fin n) : phi (subtypeadd A B) = subtypeadd B A :=
begin
  have H : A.val + B.val = B.val + A.val := add_comm _ _,
  -- unfold subtypeadd using show
  show phi ⟨A.val + B.val, _⟩ = ⟨B.val + A.val, _⟩,
  conv
  begin
  congr,
  congr,
  congr,
  rw H,
  end, -- is the term on the left OK??
  admit
end
</pre></div>

<a name="123654999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123654999" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123654999">Kevin Buzzard (Mar 13 2018 at 13:41)</a>:</h4>
<p>conv is doing all sorts of funny things here</p>

<a name="123655000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655000" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655000">Kevin Buzzard (Mar 13 2018 at 13:41)</a>:</h4>
<p>It seems to forget some terms</p>

<a name="123655002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655002" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655002">Kevin Buzzard (Mar 13 2018 at 13:41)</a>:</h4>
<p>and I managed to do a rewrite which earlier on was impossible for a good reason</p>

<a name="123655052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655052" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655052">Kevin Buzzard (Mar 13 2018 at 13:42)</a>:</h4>
<p>or was it impossible for a bad reason?</p>

<a name="123655114"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655114" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655114">Kevin Buzzard (Mar 13 2018 at 13:44)</a>:</h4>
<p>Oh maybe conv doesn't care about the terms it forgets.</p>

<a name="123655119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655119" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655119">Mario Carneiro (Mar 13 2018 at 13:44)</a>:</h4>
<p>I would be in support of moving all "auxiliary" <code>#print</code> stuff to <code>#help</code>; it is a little confusing to have namespace overlapping between <code>#print options</code> (which prints lean cmdline options), <code>#print option</code> (which prints the <code>option</code> type) and <code>#print pp.all</code> (which prints info on the <code>pp.all</code> option)</p>

<a name="123655120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655120" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655120">Kevin Buzzard (Mar 13 2018 at 13:44)</a>:</h4>
<p>Does conv not bother with subsingletons?</p>

<a name="123655126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655126" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655126">Kevin Buzzard (Mar 13 2018 at 13:44)</a>:</h4>
<p>I lost a proof</p>

<a name="123655197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655197" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655197">Kevin Buzzard (Mar 13 2018 at 13:46)</a>:</h4>
<p>I see. So <code>fin</code> is a structure so I can build things of type <code>fin n</code> and they will be of the form <code>&lt;value,proof that this value is less than n&gt;</code></p>

<a name="123655205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655205" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655205">Kevin Buzzard (Mar 13 2018 at 13:47)</a>:</h4>
<p>but there's nothing stopping me from deviously changing the value without changing the proof</p>

<a name="123655213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655213" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655213">Mario Carneiro (Mar 13 2018 at 13:47)</a>:</h4>
<p>By the way, if you are actually interested in this theorem, a short proof is <code>fin.eq_of_veq (add_comm _ _)</code></p>

<a name="123655278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655278" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655278">Kevin Buzzard (Mar 13 2018 at 13:49)</a>:</h4>
<p>I don't need the theorem, I was experimenting with trying to build goals which the prettyprinter wouldn't let me use show with ("show &lt;what the pretty printer says the goal is&gt;" failing)</p>

<a name="123655280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655280" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655280">Mario Carneiro (Mar 13 2018 at 13:49)</a>:</h4>
<p><code>conv</code> uses congrence lemmas, like <code>simp</code>, to traverse the term, certainly if you are using the <code>congr</code> tactic</p>

<a name="123655286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655286" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655286">Mario Carneiro (Mar 13 2018 at 13:49)</a>:</h4>
<p>so it will succeed for the same reason that simp does</p>

<a name="123655290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655290" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655290">Kevin Buzzard (Mar 13 2018 at 13:49)</a>:</h4>
<p>conv is really useful for a learner like me.</p>

<a name="123655342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655342" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655342">Kevin Buzzard (Mar 13 2018 at 13:50)</a>:</h4>
<p>It enables to you really zoom in to parts of complicated things which beginners have trouble manipulating</p>

<a name="123655343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655343" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655343">Mario Carneiro (Mar 13 2018 at 13:50)</a>:</h4>
<p>You should turn on <code>pp.proofs</code> while working with this</p>

<a name="123655346"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655346" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655346">Kevin Buzzard (Mar 13 2018 at 13:50)</a>:</h4>
<p>oh that's a cool option</p>

<a name="123655358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655358" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655358">Mario Carneiro (Mar 13 2018 at 13:51)</a>:</h4>
<p>lol I remember the days when it was the only option. It's like 80% a good idea to hide proofs</p>

<a name="123655359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655359" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655359">Kevin Buzzard (Mar 13 2018 at 13:51)</a>:</h4>
<p>is there a command which just changes the state of every option that is available?</p>

<a name="123655364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655364" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655364">Kevin Buzzard (Mar 13 2018 at 13:51)</a>:</h4>
<p>then I could easily see all the other things I'm missing</p>

<a name="123655365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655365" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655365">Mario Carneiro (Mar 13 2018 at 13:51)</a>:</h4>
<p>lol that would be bedlam</p>

<a name="123655368"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655368" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655368">Kevin Buzzard (Mar 13 2018 at 13:52)</a>:</h4>
<p>Imagine how much I'd learn</p>

<a name="123655417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655417" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655417">Mario Carneiro (Mar 13 2018 at 13:52)</a>:</h4>
<p>If you care about printing, look at completions for <code>set_option pp.</code></p>

<a name="123655428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655428" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655428">Kevin Buzzard (Mar 13 2018 at 13:53)</a>:</h4>
<p>I remember getting really confused early on because of those <code>_</code>s in goals which I'd completely forgotten what they stood for</p>

<a name="123655438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655438" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655438">Kevin Buzzard (Mar 13 2018 at 13:53)</a>:</h4>
<p>It would be even better if it said what they were a proof of</p>

<a name="123655455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655455" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655455">Mario Carneiro (Mar 13 2018 at 13:53)</a>:</h4>
<p>That was proposed; but it would make things even harder for the copy-pasters</p>

<a name="123655497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655497" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655497">Kevin Buzzard (Mar 13 2018 at 13:54)</a>:</h4>
<p>why not make it an option?</p>

<a name="123655502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655502" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655502">Mario Carneiro (Mar 13 2018 at 13:54)</a>:</h4>
<p>I don't want to have to edit all those types out</p>

<a name="123655505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655505" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655505">Mario Carneiro (Mar 13 2018 at 13:54)</a>:</h4>
<p>to make it compile</p>

<a name="123655512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655512" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655512">Kevin Buzzard (Mar 13 2018 at 13:54)</a>:</h4>
<p>Oh wooah if I set proofs on, then does "show (goal)" always succeed?</p>

<a name="123655514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655514" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655514">Mario Carneiro (Mar 13 2018 at 13:54)</a>:</h4>
<p>no, silly</p>

<a name="123655515"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655515" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655515">Kevin Buzzard (Mar 13 2018 at 13:55)</a>:</h4>
<p>:-)</p>

<a name="123655524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655524" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655524">Kevin Buzzard (Mar 13 2018 at 13:55)</a>:</h4>
<p>does that solve the halting problem or something?</p>

<a name="123655526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655526" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655526">Mario Carneiro (Mar 13 2018 at 13:55)</a>:</h4>
<p>there are a thousand and one edge cases that cause bad printing</p>

<a name="123655528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655528" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655528">Kevin Buzzard (Mar 13 2018 at 13:55)</a>:</h4>
<p>Oh OK.</p>

<a name="123655529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655529" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655529">Mario Carneiro (Mar 13 2018 at 13:55)</a>:</h4>
<p>even <code>pp.all</code> sometimes fails</p>

<a name="123655530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655530" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655530">Kevin Buzzard (Mar 13 2018 at 13:55)</a>:</h4>
<p>o_O</p>

<a name="123655728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655728" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655728">Mario Carneiro (Mar 13 2018 at 14:01)</a>:</h4>
<p>Here's an example:</p>
<div class="codehilite"><pre><span></span>theorem T : nat.zero = nat.zero :=
by have f := (λ {x}, eq.refl x); exact f

set_option pp.all true
#print T
theorem T&#39; : @eq.{1} nat nat.zero nat.zero :=
@(λ {x : nat}, @eq.refl.{1} nat x) nat.zero --parse error
</pre></div>

<a name="123655807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655807" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655807">Kevin Buzzard (Mar 13 2018 at 14:03)</a>:</h4>
<p>Oh maybe we're talking at cross purposes.</p>

<a name="123655814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655814" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655814">Kevin Buzzard (Mar 13 2018 at 14:03)</a>:</h4>
<div class="codehilite"><pre><span></span>theorem T&#39; : @eq.{1} nat nat.zero nat.zero :=
begin
show @eq.{1} nat nat.zero nat.zero -- succeeds
end
</pre></div>

<a name="123655864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655864" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655864">Kevin Buzzard (Mar 13 2018 at 14:04)</a>:</h4>
<p>I was wondering if one could be in tactic mode in a situation where the goal is represented by some string S, and then <code>show S</code> fails</p>

<a name="123655937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123655937" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123655937">Kevin Buzzard (Mar 13 2018 at 14:07)</a>:</h4>
<p>I am pretty sure I've done that before, but I am less sure about having done it with pp.all true</p>

<a name="123656284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123656284" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123656284">Mario Carneiro (Mar 13 2018 at 14:16)</a>:</h4>
<p>It's easiest to demonstrate by using <code>#print</code> to view proof terms, but this affects all printing, and you can make it work with target printing as well by a similar mechanism.</p>
<div class="codehilite"><pre><span></span>--set_option pp.all true
theorem T : nat.le nat.zero (by have f := (λ {x:ℕ}, 0); exact @f nat.zero) :=
begin
  -- ⊢ nat.le 0 (λ {x : ℕ}, 0)
  change nat.le 0 (λ {x : ℕ}, 0), --fail
  change nat.le nat.zero (@(λ {x : nat}, @has_zero.zero.{0} nat nat.has_zero) nat.zero) -- parse error
end
</pre></div>

<a name="123656605"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123656605" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123656605">Kevin Buzzard (Mar 13 2018 at 14:26)</a>:</h4>
<p>Are these bugs in the prettyprinter? Or just interesting features?</p>

<a name="123656620"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123656620" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123656620">Kevin Buzzard (Mar 13 2018 at 14:27)</a>:</h4>
<p>Or should <code>@(lam {x},...)</code> actually work?</p>

<a name="123656672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123656672" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123656672">Sebastian Ullrich (Mar 13 2018 at 14:29)</a>:</h4>
<p>It's the pretty printer wishing for a feature the parser hasn't implemented yet</p>

<a name="123656731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123656731" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123656731">Sebastian Ullrich (Mar 13 2018 at 14:30)</a>:</h4>
<p>Slightly passive-agressive behavior</p>

<a name="123657305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123657305" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123657305">Kevin Buzzard (Mar 13 2018 at 14:46)</a>:</h4>
<p>I see. The pretty printer is somehow the anti-parser isn't it.</p>

<a name="123657312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123657312" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123657312">Kevin Buzzard (Mar 13 2018 at 14:47)</a>:</h4>
<p>in fact it's a one-sided inverse, in a perfect world.</p>

<a name="123657314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123657314" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123657314">Patrick Massot (Mar 13 2018 at 14:47)</a>:</h4>
<p>See <a href="https://github.com/leanprover/lean/issues/1900" target="_blank" title="https://github.com/leanprover/lean/issues/1900">#1900</a></p>

<a name="123661013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123661013" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123661013">Kevin Buzzard (Mar 13 2018 at 16:24)</a>:</h4>
<p>I am still unclear about one thing in this thread.</p>

<a name="123661014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123661014" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123661014">Kevin Buzzard (Mar 13 2018 at 16:24)</a>:</h4>
<div class="codehilite"><pre><span></span>example (a b c N : ℕ) (H1 : a = b) (H2 : a &lt; N) (H3 : b &lt; N) :
 (⟨a,H2⟩:fin N) = ⟨b,H3⟩ :=
begin
-- rw H1 fails
conv begin
  to_lhs,congr, -- goal now | a
  rw H1, -- succeeds
  end,
end
</pre></div>

<a name="123661095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123661095" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123661095">Kevin Buzzard (Mar 13 2018 at 16:27)</a>:</h4>
<p>The first rw fails and my understanding is that it fails because it gives rise to a term which is malformed (copying from Mario's comments above). However it seems to be only as malformed as the term I successfully construct using the conv trick.</p>

<a name="123723050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123723050" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123723050">Kevin Buzzard (Mar 14 2018 at 21:41)</a>:</h4>
<p>I am still none the wiser about this. One conclusion which I've not yet ruled out is simply that whoever wrote <code>rw</code> could have done better, and made that first <code>rw H1</code> above succeed, because there is nothing in type theory stopping it from succeeding, as we see from the conv approach. Is the reason that <code>rw H1</code> fails simply that the <code>rw</code> code just doesn't cover this use case?</p>

<a name="123723190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123723190" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123723190">Mario Carneiro (Mar 14 2018 at 21:45)</a>:</h4>
<p>I think you are missing that the <code>conv</code> version isn't using just <code>rw</code>, it's using <code>rw</code> + <code>congr</code>, and it is applying <code>congr</code> in the place where dependency matters. Once the goal is <code>| a</code>, there is no longer a dependency to worry about, and <code>rw</code> has no problems.</p>

<a name="123723911"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123723911" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123723911">Kevin Buzzard (Mar 14 2018 at 22:05)</a>:</h4>
<p>But there is nothing stopping someone from beefing up rw so that it works without using conv? It's just some tactic, right?</p>

<a name="123724107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724107" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724107">Kevin Buzzard (Mar 14 2018 at 22:10)</a>:</h4>
<p>Initially when I heard that rw couldn't rewrite in certain circumstances I thought that this was because of some theoretical type theory issue which was beyond me, but now I am more inclined to believe that it's just beyond rw.</p>

<a name="123724117"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724117" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724117">Kevin Buzzard (Mar 14 2018 at 22:10)</a>:</h4>
<p>This typechecks:</p>
<div class="codehilite"><pre><span></span>example (a b c N : ℕ) (H1 : a = b) (H2 : a &lt; N) (H3 : b &lt; N) :
 (⟨a,H2⟩:fin N) = ⟨b,H3⟩ := sorry
</pre></div>

<a name="123724133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724133" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724133">Kevin Buzzard (Mar 14 2018 at 22:11)</a>:</h4>
<p>but if I replace <code>sorry</code> with <code>eq.subst H1 _</code> then all of a sudden I get a type mismatch in the statement (not the proof) of the example.</p>

<a name="123724136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724136" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724136">Mario Carneiro (Mar 14 2018 at 22:11)</a>:</h4>
<p>Yes and no. <code>rw</code> does exactly what we want it to, which is to produce an <code>eq.rec</code> term with a well chosen motive. <code>congr</code> applies an appropriate congruence lemma. There are theoretical limitations on what you can prove using <code>eq.rec</code>, and this is why one wouldn't want to change <code>rw</code> for this</p>

<a name="123724181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724181" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724181">Mario Carneiro (Mar 14 2018 at 22:12)</a>:</h4>
<p>I opened an issue on dependent <code>rw</code> a while ago, I think it was closed by "use <code>simp</code> instead"</p>

<a name="123724194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724194" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724194">Kevin Buzzard (Mar 14 2018 at 22:13)</a>:</h4>
<p>I now know from experience that this is not a satisfactory response</p>

<a name="123724201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724201" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724201">Kevin Buzzard (Mar 14 2018 at 22:13)</a>:</h4>
<p>The reason I got interested in this use of conv was that I had a situation where simp simplified too much</p>

<a name="123724245"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724245" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724245">Kevin Buzzard (Mar 14 2018 at 22:14)</a>:</h4>
<p>so I had to be super-accurate with my rw</p>

<a name="123724246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724246" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724246">Kevin Buzzard (Mar 14 2018 at 22:14)</a>:</h4>
<p>conv saved me</p>

<a name="123724250"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724250" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724250">Mario Carneiro (Mar 14 2018 at 22:14)</a>:</h4>
<p>I mean the <code>simp</code> engine, not necessarily <code>simp</code> on its own</p>

<a name="123724253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724253" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724253">Kevin Buzzard (Mar 14 2018 at 22:14)</a>:</h4>
<p>How do you use the simp engine??</p>

<a name="123724256"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724256" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724256">Simon Hudon (Mar 14 2018 at 22:14)</a>:</h4>
<p>Did it simplify too much even when you called <code>simp only [your rules here]</code>?</p>

<a name="123724259"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724259" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724259">Mario Carneiro (Mar 14 2018 at 22:14)</a>:</h4>
<p>You know that <code>simp</code> has a bazillion options, right?</p>

<a name="123724265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724265" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724265">Kevin Buzzard (Mar 14 2018 at 22:15)</a>:</h4>
<p>Oh that's a good point Simon, I didn't try this</p>

<a name="123724279"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724279" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724279">Mario Carneiro (Mar 14 2018 at 22:15)</a>:</h4>
<p>Remember when you discovered that <code>unfold</code> is really <code>simp</code>?</p>

<a name="123724280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724280" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724280">Kevin Buzzard (Mar 14 2018 at 22:15)</a>:</h4>
<p>Are those bazillion options documented? If not, then no I don't know and I don't know how to find out.</p>

<a name="123724289"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724289" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724289">Kevin Buzzard (Mar 14 2018 at 22:15)</a>:</h4>
<p>other than random looking through changelogs and source code</p>

<a name="123724290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724290" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724290">Kevin Buzzard (Mar 14 2018 at 22:15)</a>:</h4>
<p>which I find about as pleasant as looking through trash cans</p>

<a name="123724327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724327" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724327">Simon Hudon (Mar 14 2018 at 22:16)</a>:</h4>
<p>That would deserve a good amount of documentation, that's true.</p>

<a name="123724335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724335" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724335">Mario Carneiro (Mar 14 2018 at 22:16)</a>:</h4>
<p><code>simp only [h] {single_pass := tt}</code> is pretty close to <code>rw</code>-like rewriting</p>

<a name="123724349"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724349" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724349">Kevin Buzzard (Mar 14 2018 at 22:16)</a>:</h4>
<p>I did know about simp only from TPIL but somehow it's one of those options which I would never use in practice because my initial reaction when I read TPIL was "whyever would you want to use simp only?"</p>

<a name="123724352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724352" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724352">Simon Hudon (Mar 14 2018 at 22:17)</a>:</h4>
<p>And if you identify the lemmas that cause trouble you can disable it specifically with <code>simp [my_rule, - naughty]</code></p>

<a name="123724358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724358" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724358">Kevin Buzzard (Mar 14 2018 at 22:17)</a>:</h4>
<p>and it's only more recently as I have become more experienced that I realise I need it, by which time I have forgotten about it</p>

<a name="123724366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724366" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724366">Kevin Buzzard (Mar 14 2018 at 22:17)</a>:</h4>
<p>and the simp docs which I PR'ed have explanations of how to find out which lemmas are causing trouble</p>

<a name="123724367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724367" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724367">Mario Carneiro (Mar 14 2018 at 22:17)</a>:</h4>
<p>And to identify naughty lemmas you can use <code>set_option trace.simplify.rewrite true</code></p>

<a name="123724370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724370" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724370">Kevin Buzzard (Mar 14 2018 at 22:17)</a>:</h4>
<p>yeah, I read that in the docs</p>

<a name="123724371"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724371" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724371">Kevin Buzzard (Mar 14 2018 at 22:17)</a>:</h4>
<p>which I wrote</p>

<a name="123724376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724376" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724376">Kevin Buzzard (Mar 14 2018 at 22:17)</a>:</h4>
<p>because I cannot manage without docs</p>

<a name="123724383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724383" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724383">Kevin Buzzard (Mar 14 2018 at 22:18)</a>:</h4>
<p>because I am an old man</p>

<a name="123724420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724420" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724420">Kevin Buzzard (Mar 14 2018 at 22:18)</a>:</h4>
<p>so no I don't know about the bazillion simp options</p>

<a name="123724424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724424" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724424">Kevin Buzzard (Mar 14 2018 at 22:18)</a>:</h4>
<p>if you just rattled a few off now I might add them to the docs</p>

<a name="123724426"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724426" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724426">Kevin Buzzard (Mar 14 2018 at 22:18)</a>:</h4>
<p>I am in my late 40s :-)</p>

<a name="123724430"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724430" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724430">Mario Carneiro (Mar 14 2018 at 22:18)</a>:</h4>
<div class="codehilite"><pre><span></span>structure simp_config :=
(max_steps : nat           := simp.default_max_steps)
(contextual : bool         := ff)
(lift_eq : bool            := tt)
(canonize_instances : bool := tt)
(canonize_proofs : bool    := ff)
(use_axioms : bool         := tt)
(zeta : bool               := tt)
(beta : bool               := tt)
(eta  : bool               := tt)
(proj : bool               := tt) -- reduce projections
(iota : bool               := tt)
(iota_eqn : bool           := ff) -- reduce using all equation lemmas generated by equation/pattern-matching compiler
(constructor_eq : bool     := tt)
(single_pass : bool        := ff)
(fail_if_unchanged         := tt)
(memoize                   := tt)
</pre></div>

<a name="123724441"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724441" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724441">Mario Carneiro (Mar 14 2018 at 22:19)</a>:</h4>
<p>as you can see, leo is hard at work with those docstrings :)</p>

<a name="123724688"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724688" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724688">Kevin Buzzard (Mar 14 2018 at 22:25)</a>:</h4>
<p>two out of 16 ain't bad, as Meat Loaf once said</p>

<a name="123724692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724692" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724692">Kevin Buzzard (Mar 14 2018 at 22:25)</a>:</h4>
<p>I am now going to have to rewrite some of my updated simp docs which I was editing as this post arrived.</p>

<a name="123724735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724735" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724735">Kevin Buzzard (Mar 14 2018 at 22:26)</a>:</h4>
<p>About to be deleted: <code>It is well-known that there are a bazillion simp options, although most are known only to the Lean Inner Circle. Examples which mere mortals know about are those documented in the reference manual and Theorem Proving In Lean.</code></p>

<a name="123724966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123724966" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123724966">Mario Carneiro (Mar 14 2018 at 22:32)</a>:</h4>
<p>That's not even all of it - there is also the underlying command <code>ext_simplify_core</code> with lots of space for configurability. And <code>dsimp</code> has its own variants on all of this.</p>

<a name="123725306"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123725306" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123725306">Kevin Buzzard (Mar 14 2018 at 22:40)</a>:</h4>
<p>There are more options somehow:</p>

<a name="123725311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123725311" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123725311">Kevin Buzzard (Mar 14 2018 at 22:41)</a>:</h4>
<p><code>simp tactics in interactive mode have a new configuration parameter (discharger : tactic unit) a tactic for discharging subgoals created by the simplifier. If the tactic fails, the simplifier tries to discharge the subgoal by reducing it to true. Example: simp {discharger := assumption}.</code></p>

<a name="123725317"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123725317" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123725317">Kevin Buzzard (Mar 14 2018 at 22:41)</a>:</h4>
<p>from the changelog</p>

<a name="123725379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123725379" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123725379">Kevin Buzzard (Mar 14 2018 at 22:42)</a>:</h4>
<p>I can't get this to work though</p>

<a name="123725587"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123725587" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123725587">Kevin Buzzard (Mar 14 2018 at 22:47)</a>:</h4>
<p>OK I added some stuff about simp config options and added it to my PR</p>

<a name="123725662"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123725662" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123725662">Mario Carneiro (Mar 14 2018 at 22:49)</a>:</h4>
<p>the <code>discharger</code>is a <code>tactic unit</code>, so you have to write it in non-interactive mode (or else have <code>tactic</code> open, which is I think what Leo did in that quote). <code>simp {discharger := `[assumption]}</code> should work</p>

<a name="123725719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/conv%20example/near/123725719" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03459convexample.html#123725719">Mario Carneiro (Mar 14 2018 at 22:50)</a>:</h4>
<p>but it's not that useful compared to <code>simp *</code></p>


{% endraw %}
