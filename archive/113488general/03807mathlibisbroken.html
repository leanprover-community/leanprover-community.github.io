---
layout: page
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/03807mathlibisbroken.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html">mathlib is broken</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="154987864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154987864" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154987864">Kenny Lau (Jan 12 2019 at 15:28)</a>:</h4>
<p>The new Lean (merged just yesterday) breaks mathlib</p>

<a name="154987876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154987876" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154987876">Mario Carneiro (Jan 12 2019 at 15:29)</a>:</h4>
<p>naturally</p>

<a name="154987880"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154987880" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154987880">Kenny Lau (Jan 12 2019 at 15:29)</a>:</h4>
<p>what should we do then?</p>

<a name="154987884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154987884" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154987884">Mario Carneiro (Jan 12 2019 at 15:29)</a>:</h4>
<p>the breakage is mostly just theorems that moved from here to there or vice versa</p>

<a name="154987937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154987937" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154987937">Mario Carneiro (Jan 12 2019 at 15:30)</a>:</h4>
<p>travis seems to disagree</p>

<a name="154987962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154987962" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154987962">Kenny Lau (Jan 12 2019 at 15:31)</a>:</h4>
<div class="codehilite"><pre><span></span>$ cd /c/lean

Kenny Lau@DESKTOP-F01EMD3 MINGW64 /c/lean
$ git log -1 --pretty=oneline
92826917a252a6092cffaf5fc5f1acb1f8cef379 fix(library/module_mgr): ignore &#39;\r&#39; changes

Kenny Lau@DESKTOP-F01EMD3 MINGW64 /c/lean
$ cd /c/mathlib

Kenny Lau@DESKTOP-F01EMD3 MINGW64 /c/mathlib
$ git pull
Already up-to-date.

Kenny Lau@DESKTOP-F01EMD3 MINGW64 /c/mathlib
$ winpty /c/lean/bin/lean --make
C:\mathlib\tactic\mk_iff_of_inductive_prop.lean:50:9: error: unknown identifier
&#39;drop_pis&#39;
[...]
</pre></div>

<a name="154988008"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154988008" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154988008">Kenny Lau (Jan 12 2019 at 15:32)</a>:</h4>
<p>I think travis uses the old lean</p>

<a name="154988014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154988014" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154988014">Gabriel Ebner (Jan 12 2019 at 15:32)</a>:</h4>
<p>Travis uses the Lean version specified in leanpkg.toml.</p>

<a name="154988024"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154988024" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154988024">Kenny Lau (Jan 12 2019 at 15:33)</a>:</h4>
<p>which is 3.4.1</p>

<a name="154988027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154988027" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154988027">Mario Carneiro (Jan 12 2019 at 15:33)</a>:</h4>
<p>in that case I think we're fine</p>

<a name="154988030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154988030" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154988030">Mario Carneiro (Jan 12 2019 at 15:33)</a>:</h4>
<p>we can just make an update commit at some point</p>

<a name="154988031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154988031" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154988031">Kenny Lau (Jan 12 2019 at 15:33)</a>:</h4>
<p>so I need to refrain from using 3.4.2? I really like the <code>\r</code> fix though...</p>

<a name="154988078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154988078" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154988078">Mario Carneiro (Jan 12 2019 at 15:34)</a>:</h4>
<p>adapting to 3.4.2 isn't totally trivial, at least we have to import the removed things and remove any mathlib patches for the bugs</p>

<a name="154988090"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154988090" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154988090">Kenny Lau (Jan 12 2019 at 15:35)</a>:</h4>
<p><a href="https://github.com/leanprover/lean/compare/17fe3de...master" target="_blank" title="https://github.com/leanprover/lean/compare/17fe3de...master">https://github.com/leanprover/lean/compare/17fe3de...master</a></p>

<a name="154988092"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154988092" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154988092">Kenny Lau (Jan 12 2019 at 15:35)</a>:</h4>
<p>changes</p>

<a name="154988093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154988093" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154988093">Kenny Lau (Jan 12 2019 at 15:35)</a>:</h4>
<p>I'll just go back to 3.4.1 then</p>

<a name="154988149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154988149" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154988149">Mario Carneiro (Jan 12 2019 at 15:37)</a>:</h4>
<p>I can't find a 3.4.2 on lean repo</p>

<a name="154988150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154988150" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154988150">Mario Carneiro (Jan 12 2019 at 15:37)</a>:</h4>
<p>are you sure it's released?</p>

<a name="154988152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154988152" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154988152">Sebastian Ullrich (Jan 12 2019 at 15:37)</a>:</h4>
<p>It's not. The nightly is.</p>

<a name="154988195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154988195" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154988195">Kenny Lau (Jan 12 2019 at 15:38)</a>:</h4>
<p>I build Lean myself</p>

<a name="154988205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154988205" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154988205">Sebastian Ullrich (Jan 12 2019 at 15:39)</a>:</h4>
<p>I'm ready to release 3.4.2, but maybe someone wants to port mathlib first and make sure everything works out. With the intended branch layout, that would happen on the <code>master</code> branch while regular mathlib stays on the <code>3.4.1</code> default branch :) ...</p>

<a name="154988460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154988460" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154988460">Kenny Lau (Jan 12 2019 at 15:47)</a>:</h4>
<p>oh man imagine when Lean 4 comes out</p>

<a name="154994675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/154994675" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#154994675">Kenny Lau (Jan 12 2019 at 18:35)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> I think coinductive was removed, and I think <code>tactic/mk_iff_of_inductive_prop.lean</code> depends on it</p>

<a name="155049149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/155049149" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#155049149">Bryan Gin-ge Chen (Jan 13 2019 at 22:28)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/tree/3.4.2" target="_blank" title="https://github.com/leanprover-community/mathlib/tree/3.4.2">The branch <code>3.4.2</code> in <code>leanprover-community/mathlib</code></a> compiles with the latest nightly Lean. I didn't commit any changes to <code>leanpkg.toml</code> so if you want to try it out, you'll have to change <code>3.4.1</code> to <code>nightly</code> after you checkout.</p>
<p>For reference, here are the relevant commits to base Lean <a href="https://github.com/leanprover/lean/commit/e79cb3f2c4987dcfbec8e3e15eb83837cabe1058" target="_blank" title="https://github.com/leanprover/lean/commit/e79cb3f2c4987dcfbec8e3e15eb83837cabe1058">removing coinductive_predicates</a> and <a href="https://github.com/leanprover/lean/commit/95fa4cfb0a8774570d67bb231c1ab088a94e12bb" target="_blank" title="https://github.com/leanprover/lean/commit/95fa4cfb0a8774570d67bb231c1ab088a94e12bb">removing relators and transfer</a>.</p>
<p>All I did was copy the old <code>coinductive_predicates</code> to <code>meta</code>, merge the old <code>relator</code> into <code>logic/relator</code>, copy <code>transfer</code> to <code>tactics</code>, and then add the necessary <code>import</code> statements. I think the only thing that was removed that hasn't been added back in this branch is the transfer-related stuff in <code>library/data/dlist</code> since it only seemed to be used in the code in <code>int</code> that was removed.</p>

<a name="155054930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/155054930" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#155054930">Mario Carneiro (Jan 14 2019 at 01:26)</a>:</h4>
<p>Looks good. <span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> , I think we are go for launch</p>

<a name="155088895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/155088895" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#155088895">Bryan Gin-ge Chen (Jan 14 2019 at 14:49)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> I forgot to mention that the file <a href="https://github.com/leanprover-community/mathlib/blob/3.4.2/tests/coinductive.lean" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/3.4.2/tests/coinductive.lean"><code>tests/coinductive</code></a> currently uses <code>#check</code>, <code>#print</code> and <code>admit</code>, which seems to be against mathlib style.</p>

<a name="156375247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/156375247" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#156375247">Abhimanyu Pallavi Sudhir (Jan 18 2019 at 15:18)</a>:</h4>
<blockquote>
<p>so I need to refrain from using 3.4.2? I really like the <code>\r</code> fix though...</p>
</blockquote>
<p>What's the <code>\r</code> fix?</p>

<a name="156375747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/156375747" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#156375747">Bryan Gin-ge Chen (Jan 18 2019 at 15:25)</a>:</h4>
<p><span class="user-mention" data-user-id="130500">@Abhimanyu Pallavi Sudhir</span> It's a fix for an issue that windows users were having with unnecessary recompilation: see <a href="https://github.com/leanprover/lean/pull/1986" target="_blank" title="https://github.com/leanprover/lean/pull/1986">https://github.com/leanprover/lean/pull/1986</a></p>

<a name="156375774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/156375774" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#156375774">Bryan Gin-ge Chen (Jan 18 2019 at 15:25)</a>:</h4>
<p>I've PR'd the 3.4.2 branch: <a href="https://github.com/leanprover/mathlib/pull/610" target="_blank" title="https://github.com/leanprover/mathlib/pull/610">https://github.com/leanprover/mathlib/pull/610</a></p>

<a name="162183714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20is%20broken/near/162183714" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03807mathlibisbroken.html#162183714">Bryan Gin-ge Chen (Mar 31 2019 at 17:20)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> The recent <a href="https://github.com/leanprover-community/mathlib/commit/72634d2c5ca048582107778aab164ac12aba0d40" target="_blank" title="https://github.com/leanprover-community/mathlib/commit/72634d2c5ca048582107778aab164ac12aba0d40">"feat(data/complex/basic): smul_re,im" commit</a> has broken mathlib (<a href="https://travis-ci.org/leanprover-community/mathlib/jobs/513739846#L482" target="_blank" title="https://travis-ci.org/leanprover-community/mathlib/jobs/513739846#L482">travis</a>). The issue is <a href="https://github.com/leanprover-community/mathlib/blob/master/src/ring_theory/algebra.lean#L355" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/master/src/ring_theory/algebra.lean#L355">these lemmas in <code>ring_theory.algebra</code></a>.</p>


{% endraw %}
