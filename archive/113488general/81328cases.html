---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/81328cases.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html">cases</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="125991838"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125991838" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125991838">Jakob von Raumer (May 02 2018 at 12:46)</a>:</h4>
<p>I know this is fuzzy as hell, but I've run into the problem that when writing an automated tactic, <code>cases</code> fails for a goal in which it succeeds when I run <code>cases</code> manually. It fails with <code>cases tactic failed, it is not applicable to the given hypothesis</code>.</p>

<a name="125991862"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125991862" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125991862">Mario Carneiro (May 02 2018 at 12:47)</a>:</h4>
<p>and what is the hypothesis?</p>

<a name="125991869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125991869" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125991869">Mario Carneiro (May 02 2018 at 12:47)</a>:</h4>
<p>Keep in mind that <code>tactic.cases</code> and <code>tactic.interactive.cases</code> are not the same. Does calling the other one result in the same thing?</p>

<a name="125992075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992075" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992075">Jakob von Raumer (May 02 2018 at 12:52)</a>:</h4>
<p>I'll try</p>

<a name="125992089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992089" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992089">Jakob von Raumer (May 02 2018 at 12:53)</a>:</h4>
<p>Oh, so <code>tactic.cases</code> lacks the generalizing part?</p>

<a name="125992145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992145" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992145">Mario Carneiro (May 02 2018 at 12:54)</a>:</h4>
<p>I guess so</p>

<a name="125992222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992222" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992222">Kevin Buzzard (May 02 2018 at 12:58)</a>:</h4>
<p>The distinction between <code>tactic</code> and <code>tactic.interactive</code> is I think never mentioned in Programming In Lean, and caused me some grief when I discovered it the hard way (attempting to write basic tactics which ran tactics which were already there).</p>

<a name="125992263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992263" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992263">Kevin Buzzard (May 02 2018 at 12:58)</a>:</h4>
<p>(but in a different namespace :-) )</p>

<a name="125992285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992285" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992285">Jakob von Raumer (May 02 2018 at 12:59)</a>:</h4>
<p>So does <code>begin ... end</code> open <code>tactic.interactive</code>?</p>

<a name="125992440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992440" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992440">Mario Carneiro (May 02 2018 at 13:02)</a>:</h4>
<p>Not exactly. More accurate is that if the first token in an interactive script line is <code>token</code>, then that is interpreted as a call to the tactic <code>tactic.interactive.token</code></p>

<a name="125992444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992444" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992444">Mario Carneiro (May 02 2018 at 13:02)</a>:</h4>
<p>there is no elaborate namespace resolution like normal</p>

<a name="125992549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992549" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992549">Jakob von Raumer (May 02 2018 at 13:05)</a>:</h4>
<p>Hmm okay... looking at the definition of <code>tactic.interactive.cases</code> it doesn't look like this is the problem here...</p>

<a name="125992598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992598" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992598">Jakob von Raumer (May 02 2018 at 13:06)</a>:</h4>
<p>So the goal looks like this:</p>
<div class="codehilite"><pre><span></span>cases tactic failed, it is not applicable to the given hypothesis
state:
5 goals
DC.M.A&#39; : Type,
DC.M.lt&#39; : DC.M.A&#39; → DC.M.A&#39; → Type,
DC.M.iota_A : A → DC.M.A&#39;,
DC.M.mid : Π (DC.M.x DC.M.y : DC.M.A&#39;), DC.M.lt&#39; DC.M.x DC.M.y → DC.M.A&#39;,
DC.M.iota_lt : Π (a b : A), lt a b → DC.M.lt&#39; (DC.M.iota_A a) (DC.M.iota_A b),
DC.M.mid_l :
  Π (DC.M.x DC.M.y : DC.M.A&#39;) (DC.M.p : DC.M.lt&#39; DC.M.x DC.M.y), DC.M.lt&#39; DC.M.x (DC.M.mid DC.M.x DC.M.y DC.M.p),
DC.M.mid_r :
  Π (DC.M.x DC.M.y : DC.M.A&#39;) (DC.M.p : DC.M.lt&#39; DC.M.x DC.M.y), DC.M.lt&#39; (DC.M.mid DC.M.x DC.M.y DC.M.p) DC.M.y,
b : DC.SI,
x : A,
a a&#39; : DC.Rarg DC.SI.A&#39;,
ar : DC.rel DC.SI.A&#39; (DC.S&#39;.iota_A x) a,
ar&#39; : DC.rel DC.SI.A&#39; (DC.S&#39;.iota_A x) a&#39;
⊢ a = a&#39;
</pre></div>

<a name="125992608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992608" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992608">Jakob von Raumer (May 02 2018 at 13:06)</a>:</h4>
<p>And the failing tactic is</p>
<div class="codehilite"><pre><span></span>b ←  i_to_expr ```(ar&#39;),
cases_core b [],
</pre></div>

<a name="125992624"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992624" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992624">Mario Carneiro (May 02 2018 at 13:07)</a>:</h4>
<p>your local variables have namespaces?</p>

<a name="125992681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992681" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992681">Jakob von Raumer (May 02 2018 at 13:08)</a>:</h4>
<p>They're just composite names, because.... because I didn't know what else to do with them. Actually I'd want to put all of that <code>DC.M</code> into parameters of some section...</p>

<a name="125992700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992700" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992700">Mario Carneiro (May 02 2018 at 13:09)</a>:</h4>
<p>seems like you want a structure to hold all that</p>

<a name="125992762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992762" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992762">Jakob von Raumer (May 02 2018 at 13:10)</a>:</h4>
<p>Structures aren't exposed to the meta languages, so I thought I'd spare me the work.</p>

<a name="125992767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992767" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992767">Mario Carneiro (May 02 2018 at 13:10)</a>:</h4>
<p>in any case I don't recommend variable names with dots in them</p>

<a name="125992775"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992775" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992775">Mario Carneiro (May 02 2018 at 13:11)</a>:</h4>
<p>not sure if it's causing the problem, but it might be related</p>

<a name="125992779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992779" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992779">Jakob von Raumer (May 02 2018 at 13:11)</a>:</h4>
<p>If you want, you can have a look at the mess that is my attempt to implement inductive-inductive types at <a href="https://bitbucket.org/javra/indind/src/master/" target="_blank" title="https://bitbucket.org/javra/indind/src/master/">https://bitbucket.org/javra/indind/src/master/</a></p>

<a name="125992783"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992783" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992783">Jakob von Raumer (May 02 2018 at 13:11)</a>:</h4>
<p>Okay, thanks for the advice</p>

<a name="125992862"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125992862" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125992862">Mario Carneiro (May 02 2018 at 13:13)</a>:</h4>
<blockquote>
<p>Structures aren't exposed to the meta languages, so I thought I'd spare me the work.</p>
</blockquote>
<p>What do you mean by this?</p>

<a name="125993005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/125993005" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#125993005">Jakob von Raumer (May 02 2018 at 13:16)</a>:</h4>
<p>Since I want to create all that stuff automatically, I need to rely on what's available to the meta language which afaik is just <code>add_inductive</code>. I'd have to define all the projections of the structure myself, no?</p>

<a name="126000435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126000435" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126000435">Jakob von Raumer (May 02 2018 at 16:08)</a>:</h4>
<p>Any more clues? :(</p>

<a name="126000989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126000989" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126000989">Mario Carneiro (May 02 2018 at 16:20)</a>:</h4>
<p>It's not quite clear to me what you are trying to do, exactly. If you are doing an automatic theorem, presumably all the assumptions are generated from the inputs somehow? What is induction-induction and how does it map to your representation?</p>

<a name="126001180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126001180" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126001180">Sebastian Ullrich (May 02 2018 at 16:25)</a>:</h4>
<p><span class="user-mention" data-user-id="110789">@Jakob von Raumer</span> It's so hacky I haven't even thought about it until now, but since you're inside a user-defined command, I guess you could define structures by assembling them as strings and passing them to the parser, like Gabriel did in hott3 <a href="https://github.com/gebner/hott3/blob/ec79a762a478f775ca03de45361e215a5ad4c129/src/hott/init/meta/support.lean#L97-L98" target="_blank" title="https://github.com/gebner/hott3/blob/ec79a762a478f775ca03de45361e215a5ad4c129/src/hott/init/meta/support.lean#L97-L98">https://github.com/gebner/hott3/blob/ec79a762a478f775ca03de45361e215a5ad4c129/src/hott/init/meta/support.lean#L97-L98</a></p>

<a name="126001274"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126001274" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126001274">Sebastian Ullrich (May 02 2018 at 16:27)</a>:</h4>
<p>This is quite fragile of course since the pretty printer doesn't always roundtrip, even with <code>pp.all</code></p>

<a name="126004451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126004451" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126004451">Jakob von Raumer (May 02 2018 at 17:40)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> I can tell you all of that but it's pretty irrelevant to my problem :D In short the thing I'm trying to write gets some expressions as input and adds some stuff to the environment. So yes, the type of the theorem I'm proving is generated with some steps from these inputs. <code>DC.SI</code>, <code>DC.Rarg</code> and <code>DC.rel</code> are all inductive types that I add via <code>add_inductive</code> before I get to prove the theorem with the goal which I stated above. (Said theorem I'm adding via <code>add_theorem_by</code>, so I assemble the type directly but prove the theorem itself by a tactic which I'm just about to write.</p>
<p>The question is just why I'm getting this error message instead of <code>cases</code> being sucessful in destructing <code>ar'</code>.</p>

<a name="126004480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126004480" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126004480">Jakob von Raumer (May 02 2018 at 17:41)</a>:</h4>
<p><span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span>  Oh wow, that's evil. Thanks for the pointer. But I guess I'd rather stay away from that :D</p>

<a name="126007194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126007194" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126007194">Jakob von Raumer (May 02 2018 at 18:33)</a>:</h4>
<p>Ohhh could it be that cases just doesn't deal with inductive types that have been added using <code>add_inductive</code> when they lack <code>rec_names</code>, for example?</p>

<a name="126007262"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126007262" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126007262">Jakob von Raumer (May 02 2018 at 18:34)</a>:</h4>
<p>That would be a shame <span class="emoji emoji-1f61e" title="disappointed">:disappointed:</span></p>

<a name="126041805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126041805" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126041805">Jakob von Raumer (May 03 2018 at 12:00)</a>:</h4>
<p>I got a MNWE here:</p>
<div class="codehilite"><pre><span></span>meta def add_stuff : tactic unit :=
do tactic.add_inductive `foo [] 0 `(Type) $
   [(`bar, expr.const `foo [])]

example : unit :=
begin
  add_stuff,
  have x : foo, exact bar,
  cases x,
end
</pre></div>

<a name="126053566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126053566" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126053566">Jakob von Raumer (May 03 2018 at 16:44)</a>:</h4>
<p>Does <code>is_ginductive</code> fail for the inductive types added by <code>add_inductive</code>? <em>guess</em></p>

<a name="126053612"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126053612" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126053612">Sebastian Ullrich (May 03 2018 at 16:44)</a>:</h4>
<p>yes</p>

<a name="126054107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126054107" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126054107">Jakob von Raumer (May 03 2018 at 16:57)</a>:</h4>
<p>So there's just no way to use <code>cases</code> then? :(</p>

<a name="126054191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126054191" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126054191">Sebastian Ullrich (May 03 2018 at 16:58)</a>:</h4>
<p>You can use <code>induction</code> :)</p>

<a name="126054440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126054440" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126054440">Jakob von Raumer (May 03 2018 at 17:03)</a>:</h4>
<p><code>induction</code> doesn't do the generalizing itself, right?</p>

<a name="126087605"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126087605" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126087605">Sebastian Ullrich (May 04 2018 at 09:09)</a>:</h4>
<p><span class="user-mention" data-user-id="110789">@Jakob von Raumer</span> This one? <a href="https://github.com/leanprover/lean/blob/e181232c8ffd2bc2ba1b2f9799f8ac0ea0e4e505/library/init/meta/interactive.lean#L518" target="_blank" title="https://github.com/leanprover/lean/blob/e181232c8ffd2bc2ba1b2f9799f8ac0ea0e4e505/library/init/meta/interactive.lean#L518">https://github.com/leanprover/lean/blob/e181232c8ffd2bc2ba1b2f9799f8ac0ea0e4e505/library/init/meta/interactive.lean#L518</a></p>

<a name="126088668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126088668" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126088668">Jakob von Raumer (May 04 2018 at 09:40)</a>:</h4>
<p>Ah, I only tried <code>tactic.induction</code> before... The problem is not generalizing the expression itself but errors like <code>induction tactic failed, argument #8 of major premise type
  DC.rel DC.M.A' DC.M.lt' DC.M.iota_A DC.M.mid DC.M.iota_lt DC.M.mid_l DC.M.mid_r DC.SI.A' (DC.S'.iota_A x) a
is not a variable</code>...</p>

<a name="126088856"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126088856" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126088856">Jakob von Raumer (May 04 2018 at 09:47)</a>:</h4>
<p>Isn't it a bit strange that the parsing bits of the interactive versions of these tactics are combined with adding more features?</p>

<a name="126089062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126089062" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126089062">Jakob von Raumer (May 04 2018 at 09:53)</a>:</h4>
<p>It seems pretty bad that I have to fiddle around with the parser monad :(</p>

<a name="126090649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126090649" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126090649">Jakob von Raumer (May 04 2018 at 10:44)</a>:</h4>
<p>In that sense <code>cases</code> is stronger than <code>tactic.interactive.inductive</code>...</p>

<a name="126090829"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126090829" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126090829">Sebastian Ullrich (May 04 2018 at 10:50)</a>:</h4>
<p>Hm, I thought we generalized major premise in <code>induction</code> as well</p>

<a name="126092990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126092990" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126092990">Jakob von Raumer (May 04 2018 at 12:00)</a>:</h4>
<p>At least not in the version I'm on right now (3.3)</p>

<a name="126092999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126092999" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126092999">Jakob von Raumer (May 04 2018 at 12:01)</a>:</h4>
<p>The best solution for this mismatch would be to somehow expose <code>add_ginductive</code> to the meta language, I guess</p>

<a name="126094398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126094398" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126094398">Sebastian Ullrich (May 04 2018 at 12:45)</a>:</h4>
<p>Well, why would you use such an ancient version :P</p>

<a name="126095025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126095025" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126095025">Jakob von Raumer (May 04 2018 at 13:04)</a>:</h4>
<p>Well, in 3.4.1 it doesn't look any different ;)</p>

<a name="126095041"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126095041" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126095041">Jakob von Raumer (May 04 2018 at 13:05)</a>:</h4>
<p>I think it's about generalizing the _argument_ to the major premise, no?</p>

<a name="126095100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126095100" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126095100">Jakob von Raumer (May 04 2018 at 13:07)</a>:</h4>
<p>What's your best guess for the amount of work it would be to add an interface <code>add_ginductive</code>?</p>

<a name="126097169"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126097169" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126097169">Sebastian Ullrich (May 04 2018 at 14:04)</a>:</h4>
<blockquote>
<p>I think it's about generalizing the _argument_ to the major premise, no?</p>
</blockquote>
<p>There is <a href="https://github.com/leanprover/lean/blob/master/library/init/meta/interactive.lean#L545" target="_blank" title="https://github.com/leanprover/lean/blob/master/library/init/meta/interactive.lean#L545">https://github.com/leanprover/lean/blob/master/library/init/meta/interactive.lean#L545</a></p>

<a name="126097297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126097297" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126097297">Sebastian Ullrich (May 04 2018 at 14:06)</a>:</h4>
<blockquote>
<p>What's your best guess for the amount of work it would be to add an interface <code>add_ginductive</code>?</p>
</blockquote>
<p>Well, first you have to fork Lean... but the implementation itself shouldn't be hard</p>

<a name="126097884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126097884" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126097884">Jakob von Raumer (May 04 2018 at 14:20)</a>:</h4>
<blockquote>
<p>There is <a href="https://github.com/leanprover/lean/blob/master/library/init/meta/interactive.lean#L545" target="_blank" title="https://github.com/leanprover/lean/blob/master/library/init/meta/interactive.lean#L545">https://github.com/leanprover/lean/blob/master/library/init/meta/interactive.lean#L545</a></p>
</blockquote>
<p>I saw that, yes, but that's still not as general as <code>cases</code>, otherwise the message <code>argument #8 of major premise type [...] is not a variable</code> wouldn't make sense. I'll try to come up with a small example...</p>

<a name="126097901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126097901" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126097901">Jakob von Raumer (May 04 2018 at 14:20)</a>:</h4>
<p>The generalization has some issues anyway, see for example the error that</p>
<div class="codehilite"><pre><span></span>inductive foo : bool → Type
| mk : foo ff

inductive bar : Π b, foo b → Type
| mk : bar ff foo.mk

example (y: foo ff) (x : bar ff y) : unit :=
begin
  induction x,
end
</pre></div>


<p>gives...</p>

<a name="126098128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126098128" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126098128">Jakob von Raumer (May 04 2018 at 14:26)</a>:</h4>
<p>Small example where cases works:</p>
<div class="codehilite"><pre><span></span>inductive foo : bool → Type
| mk : foo ff

inductive bar : Π b, foo b → Type

example (x : bar ff foo.mk): unit :=
begin
  induction x,
end
</pre></div>

<a name="126256543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126256543" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126256543">Jakob von Raumer (May 08 2018 at 09:19)</a>:</h4>
<p>Recreating all the <code>revert</code>s and <code>generalize</code>s is really difficult :-/</p>

<a name="126258976"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126258976" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126258976">Jakob von Raumer (May 08 2018 at 10:41)</a>:</h4>
<p>Does anybody have a good explanation of what's the difference between <code>cases</code> and <code>induction</code> there?</p>

<a name="126259387"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126259387" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126259387">Kevin Buzzard (May 08 2018 at 10:54)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="c1">--bar.cases_on : Π (C : Π (b : bool) (a : foo b), bar b a → Sort l) {b : bool} {a : foo b} (n : bar b a), C b a n</span>
<span class="c1">--bar.rec_on   : Π (C : Π (b : bool) (a : foo b), bar b a → Sort l) {b : bool} {a : foo b} (n : bar b a), C b a n</span>
</pre></div>

<a name="126259390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126259390" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126259390">Kevin Buzzard (May 08 2018 at 10:54)</a>:</h4>
<p>o_O</p>

<a name="126259508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126259508" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126259508">Kevin Buzzard (May 08 2018 at 10:58)</a>:</h4>
<p>But in Jacob's code, <code>cases</code> works and <code>induction</code> produces the error</p>

<a name="126259509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126259509" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126259509">Kevin Buzzard (May 08 2018 at 10:58)</a>:</h4>
<div class="codehilite"><pre><span></span>generalize tactic failed, result is not type correct
nested exception message:
check failed, application type mismatch (use &#39;set_option trace.check true&#39; for additional details)
state:
⊢ bar ff foo.mk → unit
</pre></div>

<a name="126259574"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126259574" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126259574">Kevin Buzzard (May 08 2018 at 11:00)</a>:</h4>
<p>With <code>set_option trace.check true</code> we see</p>

<a name="126259576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126259576" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126259576">Kevin Buzzard (May 08 2018 at 11:00)</a>:</h4>
<div class="codehilite"><pre><span></span>[check] application type mismatch at
  bar _x foo.mk
argument type
  foo ff
expected type
  foo _x
</pre></div>

<a name="126259597"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126259597" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126259597">Kevin Buzzard (May 08 2018 at 11:01)</a>:</h4>
<p>(this is with the 20/4 nightly)</p>

<a name="126263030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126263030" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126263030">Jakob von Raumer (May 08 2018 at 12:46)</a>:</h4>
<p><code>cases</code> does <em>something</em> to generalize the arguments in the correct way that <code>induction</code> doesn't, it's not really about the recursor it uses</p>

<a name="126316715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126316715" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126316715">Jakob von Raumer (May 09 2018 at 14:21)</a>:</h4>
<p>Do you think this will change in Lean 4?</p>

<a name="126316950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126316950" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126316950">Sebastian Ullrich (May 09 2018 at 14:26)</a>:</h4>
<p>Lean 4 will probably not have any <code>ginductive</code>s</p>

<a name="126322056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126322056" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126322056">Jakob von Raumer (May 09 2018 at 16:16)</a>:</h4>
<p>Care to elaborate?</p>

<a name="126323093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126323093" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126323093">Sebastian Ullrich (May 09 2018 at 16:45)</a>:</h4>
<p>With nested and mutual inductives moving into the kernel, there shouldn't be any need for an abstraction layer. Well, it's still not clear how nested inductives would be represented.</p>

<a name="126323554"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126323554" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126323554">Jakob von Raumer (May 09 2018 at 16:57)</a>:</h4>
<p>Why are they moved into the kernel if they can be reduced outside the kernel?</p>

<a name="126323646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126323646" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126323646">Sebastian Ullrich (May 09 2018 at 17:00)</a>:</h4>
<p>They can't :) . The reduction rules are too weak, that is. Also, it's the most horrible part of the code base.</p>

<a name="126367079"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126367079" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126367079">Jakob von Raumer (May 10 2018 at 14:27)</a>:</h4>
<p>So I'll wait for Lean 4 or try to emulate what cases does for generalizing</p>

<a name="126368002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126368002" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126368002">Jakob von Raumer (May 10 2018 at 14:49)</a>:</h4>
<p>Apparently the part I'm missing is mostly some magical <code>no_confusion</code> applications</p>

<a name="126369196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126369196" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126369196">Jakob von Raumer (May 10 2018 at 15:17)</a>:</h4>
<p>Is it still Daniel who maintains the ginductive compiler?</p>

<a name="126525983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126525983" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126525983">Sebastian Ullrich (May 14 2018 at 07:22)</a>:</h4>
<p>I think it's just Leo, who says he doesn't even understand the code any more</p>

<a name="126544666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cases/near/126544666" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81328cases.html#126544666">Jakob von Raumer (May 14 2018 at 16:03)</a>:</h4>
<p>That's bad news :(</p>


{% endraw %}
