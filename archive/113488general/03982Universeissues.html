---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/03982Universeissues.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html">Universe issues</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="124734232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734232" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734232">Kevin Buzzard (Apr 06 2018 at 19:28)</a>:</h4>
<p>I seem to not understand universes properly, or more precisely how to use them properly. I ran into the following issue with some code:</p>

<a name="124734247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734247" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734247">Kevin Buzzard (Apr 06 2018 at 19:28)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">definition</span> <span class="n">foo</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">),</span> <span class="n">true</span>

<span class="kn">theorem</span> <span class="n">baz</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">bar</span><span class="o">:</span> <span class="n">foo</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:</span> <span class="n">true</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">have</span> <span class="n">H</span> <span class="o">:=</span> <span class="n">bar</span> <span class="n">β</span><span class="o">,</span> <span class="c1">-- error</span>
  <span class="n">admit</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>

<a name="124734249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734249" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734249">Kevin Buzzard (Apr 06 2018 at 19:28)</a>:</h4>
<p>The error was</p>

<a name="124734254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734254" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734254">Kevin Buzzard (Apr 06 2018 at 19:28)</a>:</h4>
<div class="codehilite"><pre><span></span>type mismatch at application
  bar β
term
  β
has type
  Type u_3 : Type (u_3+1)
but is expected to have type
  Type u_2 : Type (u_2+1)
state:
X : Type u_1,
bar : foo X,
β : Type u_3
⊢ true
</pre></div>

<a name="124734270"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734270" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734270">Kevin Buzzard (Apr 06 2018 at 19:29)</a>:</h4>
<p>I figured I'd investigate more, so I next wrote this:</p>

<a name="124734321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734321" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734321">Kevin Buzzard (Apr 06 2018 at 19:30)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">universes</span> <span class="n">u</span> <span class="n">v</span> <span class="n">w</span> <span class="n">x</span>
<span class="kn">set_option</span> <span class="n">pp</span><span class="bp">.</span><span class="n">universes</span> <span class="n">true</span>
<span class="kn">definition</span> <span class="n">foo&#39;</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">),</span> <span class="n">true</span>
<span class="kn">theorem</span> <span class="n">baz&#39;</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">w</span><span class="o">)</span> <span class="o">(</span><span class="n">bar&#39;</span> <span class="o">:</span> <span class="n">foo&#39;</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span> <span class="n">true</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">have</span> <span class="n">H</span> <span class="o">:=</span> <span class="n">bar&#39;</span> <span class="n">β</span><span class="o">,</span> <span class="c1">-- error</span>
  <span class="n">admit</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>

<a name="124734337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734337" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734337">Kevin Buzzard (Apr 06 2018 at 19:30)</a>:</h4>
<p>and this time I got</p>

<a name="124734344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734344" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734344">Kevin Buzzard (Apr 06 2018 at 19:30)</a>:</h4>
<div class="codehilite"><pre><span></span>type mismatch at application
  bar&#39; β
term
  β
has type
  Type x : Type (x+1)
but is expected to have type
  Type u_1 : Type (u_1+1)
state:
X : Type w,
bar&#39; : foo&#39;.{w u_1} X,
β : Type x
⊢ true
</pre></div>

<a name="124734362"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734362" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734362">Kevin Buzzard (Apr 06 2018 at 19:31)</a>:</h4>
<p>This made me realise that I didn't understand what was going on, because there is still this universe <code>u_1</code> mentioned, even though I thought I'd just explicitly written down what universe everything was in.</p>

<a name="124734377"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734377" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734377">Kevin Buzzard (Apr 06 2018 at 19:31)</a>:</h4>
<p>In particular, <code>bar'</code> seems to mention this universe <code>u_1</code> and I'm not sure where this universe got involved.</p>

<a name="124734425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734425" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734425">Kevin Buzzard (Apr 06 2018 at 19:32)</a>:</h4>
<p>Some experimentation led me to something which worked:</p>

<a name="124734429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734429" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734429">Kevin Buzzard (Apr 06 2018 at 19:32)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">definition</span> <span class="n">foo&#39;&#39;</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">),</span> <span class="n">true</span>

<span class="kn">theorem</span> <span class="n">baz&#39;&#39;</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="n">bar&#39;&#39;</span> <span class="o">:</span> <span class="n">foo&#39;&#39;</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">:</span> <span class="n">true</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">have</span> <span class="n">H</span> <span class="o">:=</span> <span class="n">bar&#39;&#39;</span> <span class="n">β</span><span class="o">,</span> <span class="c1">-- works</span>
  <span class="n">exact</span> <span class="n">H</span>
<span class="kn">end</span>
</pre></div>

<a name="124734435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734435" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734435">Kevin Buzzard (Apr 06 2018 at 19:32)</a>:</h4>
<p>i.e. "keep X and beta in the same universe and you'll be fine"</p>

<a name="124734441"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734441" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734441">Kevin Buzzard (Apr 06 2018 at 19:32)</a>:</h4>
<p>But this raises two questions for me:</p>

<a name="124734444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734444" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734444">Kevin Buzzard (Apr 06 2018 at 19:33)</a>:</h4>
<p>1) why wasn't I fine before?</p>

<a name="124734450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734450" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734450">Kevin Buzzard (Apr 06 2018 at 19:33)</a>:</h4>
<p>2) Will this fix cause me problems later?</p>

<a name="124734513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734513" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734513">Kevin Buzzard (Apr 06 2018 at 19:34)</a>:</h4>
<p>In reality, X is a topological space and it is covered by open sets <code>U i</code> where each <code>i</code> has type <code>beta</code></p>

<a name="124734523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734523" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734523">Kevin Buzzard (Apr 06 2018 at 19:34)</a>:</h4>
<p>that is, <code>U : beta -&gt; set X</code></p>

<a name="124734570"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734570" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734570">Kevin Buzzard (Apr 06 2018 at 19:36)</a>:</h4>
<p>My instinct is always to just let everything live in different universes because who cares about universes anyway, that's the joy of type theory</p>

<a name="124734615"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734615" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734615">Kevin Buzzard (Apr 06 2018 at 19:36)</a>:</h4>
<p>In ZFC I would just let X and beta be in Type</p>

<a name="124734623"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734623" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734623">Kevin Buzzard (Apr 06 2018 at 19:36)</a>:</h4>
<p>but that might be a bridge too far</p>

<a name="124734636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734636" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734636">Mario Carneiro (Apr 06 2018 at 19:36)</a>:</h4>
<p>When you defined <code>foo</code>, it had two universe parameters, corresponding to the two <code>Type*</code> instances</p>

<a name="124734672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734672" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734672">Kevin Buzzard (Apr 06 2018 at 19:37)</a>:</h4>
<p>what does that even mean</p>

<a name="124734676"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734676" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734676">Kevin Buzzard (Apr 06 2018 at 19:37)</a>:</h4>
<p>foo is a thing</p>

<a name="124734677"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734677" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734677">Kevin Buzzard (Apr 06 2018 at 19:37)</a>:</h4>
<p>and it has a type</p>

<a name="124734681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734681" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734681">Kevin Buzzard (Apr 06 2018 at 19:37)</a>:</h4>
<p>which lives in a universe</p>

<a name="124734686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734686" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734686">Mario Carneiro (Apr 06 2018 at 19:37)</a>:</h4>
<p>it is universe polymorphic</p>

<a name="124734733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734733" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734733">Mario Carneiro (Apr 06 2018 at 19:38)</a>:</h4>
<p>Think of it as being implicitly a forall over the universe variables</p>

<a name="124734745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734745" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734745">Mario Carneiro (Apr 06 2018 at 19:38)</a>:</h4>
<p>except that lean has no universe variable binders, so it's all just free variables and substitution</p>

<a name="124734749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734749" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734749">Kevin Buzzard (Apr 06 2018 at 19:38)</a>:</h4>
<p><code>foo'</code> mentions a universe I don't even see</p>

<a name="124734760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734760" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734760">Kevin Buzzard (Apr 06 2018 at 19:39)</a>:</h4>
<p>or at least something mentions this universe</p>

<a name="124734763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734763" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734763">Mario Carneiro (Apr 06 2018 at 19:39)</a>:</h4>
<p><code>foo</code> and <code>foo'</code> are the same</p>

<a name="124734774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734774" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734774">Kevin Buzzard (Apr 06 2018 at 19:39)</a>:</h4>
<p>wait</p>

<a name="124734777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734777" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734777">Kevin Buzzard (Apr 06 2018 at 19:39)</a>:</h4>
<p>are they exactly the same?</p>

<a name="124734780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734780" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734780">Mario Carneiro (Apr 06 2018 at 19:39)</a>:</h4>
<p>except <code>foo'</code> is more explicit about the two universe variables, <code>u</code> and <code>v</code></p>

<a name="124734790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734790" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734790">Kevin Buzzard (Apr 06 2018 at 19:39)</a>:</h4>
<p>Should I think that <code>foo'</code> is really "for all universes u, ..."</p>

<a name="124734791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734791" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734791">Mario Carneiro (Apr 06 2018 at 19:39)</a>:</h4>
<p>yes, they are exactly the same as far as lean is concerned</p>

<a name="124734842"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734842" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734842">Mario Carneiro (Apr 06 2018 at 19:40)</a>:</h4>
<p>yes. All universe polymorphic functions are like this</p>

<a name="124734852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734852" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734852">Kevin Buzzard (Apr 06 2018 at 19:40)</a>:</h4>
<p>like when I make variables and then secretly I am writing "for all v..."</p>

<a name="124734853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734853" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734853">Mario Carneiro (Apr 06 2018 at 19:40)</a>:</h4>
<p>exactly</p>

<a name="124734858"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734858" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734858">Kevin Buzzard (Apr 06 2018 at 19:40)</a>:</h4>
<p>But where is this <code>u_1</code> coming from?</p>

<a name="124734860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734860" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734860">Kevin Buzzard (Apr 06 2018 at 19:40)</a>:</h4>
<p>Didn't I name all my universes with <code>foo'</code>?</p>

<a name="124734877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734877" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734877">Mario Carneiro (Apr 06 2018 at 19:41)</a>:</h4>
<p><code>foo'</code> has two universe variables, named <code>u</code> and <code>v</code> in the definition, but since it's like a forall, whenever you use it these variables can be substituted for other things</p>

<a name="124734880"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734880" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734880">Kevin Buzzard (Apr 06 2018 at 19:41)</a>:</h4>
<p>gotcha</p>

<a name="124734925"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734925" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734925">Kevin Buzzard (Apr 06 2018 at 19:42)</a>:</h4>
<p>So <code>foo'</code> is <code>for all universes u and v, [what I wrote]</code></p>

<a name="124734930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734930" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734930">Kevin Buzzard (Apr 06 2018 at 19:42)</a>:</h4>
<p>so why do I get a problem?</p>

<a name="124734932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734932" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734932">Kevin Buzzard (Apr 06 2018 at 19:42)</a>:</h4>
<p>why can't we just do universe unification or something?</p>

<a name="124734940"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734940" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734940">Mario Carneiro (Apr 06 2018 at 19:42)</a>:</h4>
<p><code>u_1</code> is the name of a universe variable in <code>baz'</code>, since you reference <code>foo' X</code> which only fixes its first parameter by unification, lean invents a second variable <code>u_1</code> so it becomes <code>bar' : foo'.{w u_1} X</code></p>

<a name="124734953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734953" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734953">Kevin Buzzard (Apr 06 2018 at 19:43)</a>:</h4>
<p>aah</p>

<a name="124734955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734955" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734955">Kevin Buzzard (Apr 06 2018 at 19:43)</a>:</h4>
<p>yes I just independently realised this</p>

<a name="124734965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124734965" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124734965">Kevin Buzzard (Apr 06 2018 at 19:43)</a>:</h4>
<p>But now <code>bar'</code> should be "for all universes u_1, ..."</p>

<a name="124735011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735011" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735011">Mario Carneiro (Apr 06 2018 at 19:44)</a>:</h4>
<p>it is</p>

<a name="124735027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735027" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735027">Mario Carneiro (Apr 06 2018 at 19:44)</a>:</h4>
<p><code>bar'.{w x u_1}</code> has type <code>forall (X : Type w) (bar' : foo'.{w u_1} X) (β : Type x), true</code></p>

<a name="124735048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735048" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735048">Mario Carneiro (Apr 06 2018 at 19:45)</a>:</h4>
<p>And since <code>u_1</code> and <code>x</code> are separate universe variables being generalized, inside the proof you can't assume they are equal</p>

<a name="124735061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735061" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735061">Mario Carneiro (Apr 06 2018 at 19:45)</a>:</h4>
<p>so <code>bar' β</code> is a type error since <code>bar'</code> accepts a <code>Type u_1</code></p>

<a name="124735108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735108" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735108">Kevin Buzzard (Apr 06 2018 at 19:46)</a>:</h4>
<p>OK so you have convinced me that the underlying way that universes work mean that my initial attempts should not work.</p>

<a name="124735113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735113" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735113">Kevin Buzzard (Apr 06 2018 at 19:46)</a>:</h4>
<p>So now the question is should I try to re-arrange things to make them work?</p>

<a name="124735122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735122" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735122">Mario Carneiro (Apr 06 2018 at 19:47)</a>:</h4>
<p>just write <code>foo'.{w x}</code> instead of <code>foo'</code> in the type of <code>bar'</code></p>

<a name="124735127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735127" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735127">Kevin Buzzard (Apr 06 2018 at 19:47)</a>:</h4>
<p>Or should I go down the "might bite me later and I have no understanding as to whether it will" route of letting all universes be u</p>

<a name="124735130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735130" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735130">Kevin Buzzard (Apr 06 2018 at 19:47)</a>:</h4>
<p>aah, oh great, so I can do what I want to do.</p>

<a name="124735186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735186" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735186">Mario Carneiro (Apr 06 2018 at 19:48)</a>:</h4>
<p>In general, I try to avoid types with "internal universe variables" like <code>foo'</code> here, which has a forall whose universe is not constrained by the input parameters</p>

<a name="124735198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735198" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735198">Kevin Buzzard (Apr 06 2018 at 19:48)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">definition</span>  <span class="n">foo&#39;</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span>  <span class="bp">∀</span> <span class="o">(</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">),</span> <span class="n">true</span>

<span class="kn">theorem</span>  <span class="n">baz&#39;</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">w</span><span class="o">)</span> <span class="o">(</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">bar&#39;</span> <span class="o">:</span> <span class="n">foo&#39;</span><span class="bp">.</span><span class="o">{</span><span class="n">w</span> <span class="n">x</span><span class="o">}</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span> <span class="n">true</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="k">have</span> <span class="n">H</span> <span class="o">:=</span> <span class="n">bar&#39;</span> <span class="n">β</span><span class="o">,</span> <span class="c1">-- works :-)</span>
<span class="n">exact</span> <span class="n">H</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>

<a name="124735206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735206" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735206">Kevin Buzzard (Apr 06 2018 at 19:48)</a>:</h4>
<p>I need to think about the last thing you said</p>

<a name="124735215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735215" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735215">Mario Carneiro (Apr 06 2018 at 19:49)</a>:</h4>
<p>that means to prefer <code>def foo' (X : Type u) := ∀ (β : Type u), true</code> over <code>def foo' (X : Type u) := ∀ (β : Type v), true</code></p>

<a name="124735219"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735219" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735219">Kevin Buzzard (Apr 06 2018 at 19:49)</a>:</h4>
<p>because this is a massively minimised thing and in reality I will have to decide whether I can try to avoid the thing you want me to avoid</p>

<a name="124735225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735225" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735225">Kevin Buzzard (Apr 06 2018 at 19:49)</a>:</h4>
<p>Thanks a lot for the fix and the advice though.</p>

<a name="124735281"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735281" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735281">Kevin Buzzard (Apr 06 2018 at 19:51)</a>:</h4>
<p>How do I know whether the thing you prefer will be safe for me?</p>

<a name="124735290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735290" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735290">Kevin Buzzard (Apr 06 2018 at 19:51)</a>:</h4>
<p>hmm, I need to go and feed children</p>

<a name="124735295"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735295" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735295">Kevin Buzzard (Apr 06 2018 at 19:51)</a>:</h4>
<p>thanks</p>

<a name="124735417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735417" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735417">Mario Carneiro (Apr 06 2018 at 19:54)</a>:</h4>
<p>It is slightly less universe parametric (it requires that two variables be the same), so you may need extra <code>ulift</code>s around, which may or may not be better than the often required <code>.{w x}</code> stuff that arises with this approach</p>

<a name="124735479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735479" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735479">Mario Carneiro (Apr 06 2018 at 19:56)</a>:</h4>
<p>Generally you will have to be "universe conscious" when working with definitions with internal universe variables - lots of things will require annotation. <code>cardinal</code>, <code>ordinal</code>, and <code>Set</code> (the ZFC sets) are like this</p>

<a name="124735490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/124735490" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#124735490">Mario Carneiro (Apr 06 2018 at 19:56)</a>:</h4>
<p><code>category</code> may also be, this exact thing was a point of discussion with Scott a few weeks ago</p>

<a name="126942604"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/126942604" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#126942604">Kevin Buzzard (May 22 2018 at 20:14)</a>:</h4>
<p>What is happening here:</p>

<a name="126942641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/126942641" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#126942641">Kevin Buzzard (May 22 2018 at 20:14)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">universe</span> <span class="n">u</span>

<span class="kn">structure</span> <span class="n">scheme</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span>

<span class="kn">theorem</span> <span class="n">scheme_of_affine_scheme</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:</span> <span class="n">scheme</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">β</span> <span class="o">:=</span> <span class="n">R</span> <span class="c1">-- universe issue</span>
<span class="o">}</span>

<span class="c">/-</span><span class="cm"></span>

<span class="cm">type mismatch at field &#39;β&#39;</span>
<span class="cm">  R</span>
<span class="cm">has type</span>
<span class="cm">  Type u : Type (u+1)</span>
<span class="cm">but is expected to have type</span>
<span class="cm">  Type u_1 : Type (u_1+1)</span>

<span class="cm">-/</span>
</pre></div>

<a name="126942655"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/126942655" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#126942655">Kevin Buzzard (May 22 2018 at 20:14)</a>:</h4>
<p>Seems to me that scheme has decided that it wants to live in a different universe to beta and R</p>

<a name="126942656"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/126942656" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#126942656">Kevin Buzzard (May 22 2018 at 20:14)</a>:</h4>
<p>oh</p>

<a name="126942657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/126942657" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#126942657">Kevin Buzzard (May 22 2018 at 20:14)</a>:</h4>
<p>heh</p>

<a name="126942661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/126942661" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#126942661">Kevin Buzzard (May 22 2018 at 20:15)</a>:</h4>
<p>ignore the irrelevant names</p>

<a name="126942676"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/126942676" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#126942676">Kevin Buzzard (May 22 2018 at 20:15)</a>:</h4>
<p>If I change theorem to definition, it works</p>

<a name="126942682"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/126942682" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#126942682">Kevin Buzzard (May 22 2018 at 20:15)</a>:</h4>
<p>And this works too:</p>

<a name="126942700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/126942700" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#126942700">Kevin Buzzard (May 22 2018 at 20:16)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">scheme_of_affine_scheme</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:</span> <span class="n">scheme</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">β</span> <span class="o">:=</span> <span class="n">R</span> <span class="c1">-- works</span>
<span class="o">}</span>
</pre></div>

<a name="126942731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/126942731" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#126942731">Kevin Buzzard (May 22 2018 at 20:16)</a>:</h4>
<p>OK so maybe the answer is simply "don't use theorem to define something which isn't a Prop"</p>

<a name="126942856"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/126942856" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#126942856">Kevin Buzzard (May 22 2018 at 20:19)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">definition</span> <span class="n">scheme_of_affine_scheme</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:</span> <span class="n">scheme</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">β</span> <span class="o">:=</span> <span class="n">R</span> <span class="c1">-- works</span>
<span class="o">}</span>
</pre></div>

<a name="126942867"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/126942867" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#126942867">Kevin Buzzard (May 22 2018 at 20:19)</a>:</h4>
<p>I guess I don't understand what's going on, but on the other hand I can see I was doing something dumb.</p>

<a name="126943048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/126943048" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#126943048">Chris Hughes (May 22 2018 at 20:22)</a>:</h4>
<p>This gives some small insight.</p>
<div class="codehilite"><pre><span></span><span class="kn">set_option</span> <span class="n">pp</span><span class="bp">.</span><span class="n">universes</span> <span class="n">true</span>
<span class="n">def</span> <span class="n">scheme_of_affine_scheme</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:</span> <span class="n">scheme</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="c1">-- R : Type u</span>
<span class="c1">-- ⊢ scheme.{?l_1}</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">scheme_of_affine_scheme</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:</span> <span class="n">scheme</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="c1">-- R : Type u</span>
<span class="c1">-- ⊢ scheme.{u_1}</span>
<span class="kn">end</span>
</pre></div>

<a name="126943257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/126943257" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#126943257">Kevin Buzzard (May 22 2018 at 20:28)</a>:</h4>
<p>Aah so in the first case scheme is in some universe and Lean isn't too fussed, it will decide later</p>

<a name="126943303"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/126943303" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#126943303">Kevin Buzzard (May 22 2018 at 20:28)</a>:</h4>
<p>but in the second case Lean decided to go for it and make a decision</p>

<a name="126943307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/126943307" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#126943307">Kevin Buzzard (May 22 2018 at 20:28)</a>:</h4>
<p>because it's a lemma so the universe is supposed to be Prop</p>

<a name="126943312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/126943312" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#126943312">Kevin Buzzard (May 22 2018 at 20:28)</a>:</h4>
<p>and it wasn't Prop so Lean panicked</p>

<a name="127406709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/127406709" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#127406709">Chris Hughes (Jun 01 2018 at 08:52)</a>:</h4>
<p>The lemma <code>card_univ</code> below does not work without the <code>.{u}</code> in the <code>fintype</code> instance</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">set</span><span class="bp">.</span><span class="n">finite</span>
<span class="kn">open</span> <span class="n">set</span> <span class="n">fintype</span>
<span class="kn">universe</span> <span class="n">u</span>

<span class="n">def</span> <span class="n">equiv_univ</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:</span> <span class="n">α</span> <span class="err">≃</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">univ</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">mem_univ</span> <span class="bp">_⟩</span><span class="o">,</span>
  <span class="n">inv_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">a</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span>
  <span class="n">left_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">right_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="bp">⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">ha</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">rfl</span> <span class="o">}</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">card_univ</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">fintype</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">univ</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)]:</span>
  <span class="bp">@</span><span class="n">fintype</span><span class="bp">.</span><span class="n">card</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">univ</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="bp">_</span> <span class="bp">=</span> <span class="n">fintype</span><span class="bp">.</span><span class="n">card</span> <span class="n">α</span> <span class="o">:=</span>
<span class="n">eq</span><span class="bp">.</span><span class="n">symm</span> <span class="o">(</span><span class="bp">@</span><span class="n">card_congr</span> <span class="n">α</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">univ</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="bp">_</span> <span class="bp">_</span> <span class="o">(</span><span class="n">equiv_univ</span> <span class="n">α</span><span class="o">))</span>
</pre></div>


<p>The following do not work.</p>
<div class="codehilite"><pre><span></span><span class="kn">set_option</span> <span class="n">pp</span><span class="bp">.</span><span class="n">universes</span> <span class="n">true</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">card_univ</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">fintype</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">univ</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)]:</span>
  <span class="n">fintype</span><span class="bp">.</span><span class="n">card</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">univ</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="n">fintype</span><span class="bp">.</span><span class="n">card</span> <span class="n">α</span> <span class="o">:=</span>
<span class="n">eq</span><span class="bp">.</span><span class="n">symm</span> <span class="o">(</span><span class="n">card_congr</span> <span class="o">(</span><span class="n">equiv_univ</span> <span class="n">α</span><span class="o">))</span>
</pre></div>


<p>Gives the error</p>
<div class="codehilite"><pre><span></span>failed to synthesize type class instance for
α : Type u,
_inst_1 : fintype.{u} α,
_inst_2 : fintype.{?l_1} ↥univ.{u}
⊢ fintype.{u} ↥univ.{u}
</pre></div>


<p>and  </p>
<div class="codehilite"><pre><span></span><span class="kn">set_option</span> <span class="n">pp</span><span class="bp">.</span><span class="n">universes</span> <span class="n">true</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">card_univ</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">f</span> <span class="o">:</span> <span class="n">fintype</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">univ</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)]:</span>
  <span class="bp">@</span><span class="n">fintype</span><span class="bp">.</span><span class="n">card</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">univ</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="n">f</span> <span class="bp">=</span> <span class="n">fintype</span><span class="bp">.</span><span class="n">card</span> <span class="n">α</span> <span class="o">:=</span>
<span class="n">eq</span><span class="bp">.</span><span class="n">symm</span> <span class="o">(</span><span class="bp">@</span><span class="n">card_congr</span> <span class="n">α</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">univ</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="bp">_</span> <span class="n">f</span> <span class="o">(</span><span class="n">equiv_univ</span> <span class="n">α</span><span class="o">))</span>
</pre></div>


<p>Gives the error</p>
<div class="codehilite"><pre><span></span>type mismatch at application
  card_congr.{u u_1} (equiv_univ.{u} α)
term
  equiv_univ.{u} α
has type
  equiv.{u+1 (max 1 (u+1))} α
    (@coe_sort.{(max (u+1) 1) (max 1 (u+1))+1} (set.{u} α) (@set.has_coe_to_sort.{u} α) (@set.univ.{u} α)) : Type u
but is expected to have type
  equiv.{u+1 u_1+1} α
    (@coe_sort.{(max (u+1) 1) (max 1 (u+1))+1} (set.{u} α) (@set.has_coe_to_sort.{u} α)
       (@set.univ.{u} α)) : Type (max (max u u_1) u_1 u)
</pre></div>


<p>What's going on here? And will the <code>.{u}</code> in the fintype instance make the lemma more difficult to use. It worked in my application, but will it always work?</p>

<a name="127406993"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/127406993" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#127406993">Gabriel Ebner (Jun 01 2018 at 09:01)</a>:</h4>
<blockquote>
<p>And will the .{u} in the fintype instance make the lemma more difficult to use.</p>
</blockquote>
<p>No, not at all.  It is the only possible choice, the elaborator just can't figure it out for whatever reason.</p>

<a name="127407052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Universe%20issues/near/127407052" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/03982Universeissues.html#127407052">Gabriel Ebner (Jun 01 2018 at 09:03)</a>:</h4>
<p>(The universe parameter <code>.{u}</code> is always there, whether you write it explicitly or not.)</p>


{% endraw %}
