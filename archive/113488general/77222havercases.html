---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/77222havercases.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html">have rcases</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="168451820"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168451820" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168451820">Patrick Massot (Jun 18 2019 at 20:20)</a>:</h4>
<p>For a very long time, I desired a tactic <code>havec</code> such that </p>
<div class="codehilite"><pre><span></span><span class="n">havec</span> <span class="bp">⟨...⟩</span> <span class="o">:</span> <span class="bp">...</span><span class="o">,</span>
<span class="o">{</span> <span class="bp">...</span> <span class="o">}</span>
</pre></div>


<p>(or <code>havec ⟨...⟩ : ..., from ....</code>) has the effect of</p>
<div class="codehilite"><pre><span></span><span class="k">have</span> <span class="o">:</span> <span class="bp">...</span><span class="o">,</span>
<span class="o">{</span> <span class="bp">...</span> <span class="o">},</span>
<span class="n">rcases</span> <span class="n">this</span> <span class="k">with</span> <span class="bp">⟨...⟩</span>
</pre></div>


<p>And I saw when translating the Hahn-Banach proof that SSReflect has it, and they use it all the time. I could try to hack something, but maybe <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> or <span class="user-mention" data-user-id="110026">@Simon Hudon</span> could do that in two minutes. It would be nice to have it for the <del>philosophy</del> <span aria-label="boxing glove" class="emoji emoji-1f94a" role="img" title="boxing glove">:boxing_glove:</span> talk on Thursday.</p>

<a name="168452351"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168452351" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168452351">Mario Carneiro (Jun 18 2019 at 20:27)</a>:</h4>
<p>We usually call this <code>let</code> in term mode</p>

<a name="168452483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168452483" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168452483">Patrick Massot (Jun 18 2019 at 20:28)</a>:</h4>
<p>I know it works in term mode, I used it during my <a href="https://github.com/leanprover-community/mathlib/pull/1137#issuecomment-502906376" target="_blank" title="https://github.com/leanprover-community/mathlib/pull/1137#issuecomment-502906376">jetlag insomnia</a> last night. But I'd like to get it in tactic mode.</p>

<a name="168452524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168452524" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168452524">Mario Carneiro (Jun 18 2019 at 20:29)</a>:</h4>
<p>I mean maybe <code>havec</code> isn't the most consistent choice of name</p>

<a name="168453011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168453011" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168453011">Patrick Massot (Jun 18 2019 at 20:35)</a>:</h4>
<p>Oh I don't care at all about the name, I'd like to get the tactic!</p>

<a name="168453124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168453124" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168453124">Patrick Massot (Jun 18 2019 at 20:36)</a>:</h4>
<p>But I guess we can't reuse the name <code>let</code></p>

<a name="168453146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168453146" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168453146">Sebastien Gouezel (Jun 18 2019 at 20:37)</a>:</h4>
<p>Johannes mentioned also once something we have in Isabelle:</p>
<div class="codehilite"><pre><span></span><span class="k">have</span> <span class="n">A</span> <span class="o">(</span><span class="n">n</span><span class="o">:</span><span class="n">nat</span><span class="o">)</span> <span class="o">:</span> <span class="bp">...</span>
</pre></div>


<p>which would be the same as</p>
<div class="codehilite"><pre><span></span><span class="k">have</span> <span class="n">A</span> <span class="o">:</span> <span class="err">\</span><span class="k">forall</span> <span class="n">n</span><span class="o">,</span> <span class="bp">...</span>
</pre></div>


<p>without the need to <code>assume n</code> in the proof. Of course, if there is just one variable this is minor, but if there are several it is really handy.</p>

<a name="168453147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168453147" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168453147">Patrick Massot (Jun 18 2019 at 20:37)</a>:</h4>
<p>Otherwise we could have <code>rintros</code> and <code>rcases</code> replacing their weaker analoues</p>

<a name="168453171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168453171" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168453171">Patrick Massot (Jun 18 2019 at 20:37)</a>:</h4>
<p>I noticed SSReflect also has this, but it looks less crucial to me</p>

<a name="168453296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168453296" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168453296">Patrick Massot (Jun 18 2019 at 20:39)</a>:</h4>
<p>(I know Mario seems to be in a good mood today, but let's not ask too much at the same time)</p>

<a name="168453581"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168453581" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168453581">Mario Carneiro (Jun 18 2019 at 20:43)</a>:</h4>
<p>These could replace have/let in principle</p>

<a name="168453646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168453646" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168453646">Mario Carneiro (Jun 18 2019 at 20:44)</a>:</h4>
<p>have/let with args is also something that is available in term mode</p>

<a name="168453714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168453714" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168453714">Patrick Massot (Jun 18 2019 at 20:45)</a>:</h4>
<blockquote>
<p>These could replace have/let in principle</p>
</blockquote>
<p>how?</p>

<a name="168453804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168453804" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168453804">Mario Carneiro (Jun 18 2019 at 20:46)</a>:</h4>
<p>they extend the syntax</p>

<a name="168453832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168453832" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168453832">Mario Carneiro (Jun 18 2019 at 20:46)</a>:</h4>
<p>so you can have <code>have &lt;foo&gt; | &lt;bar&gt; := bla</code> and <code>have &lt;foo&gt; | &lt;bar&gt; : bla := bla</code>  as well</p>

<a name="168453885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168453885" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168453885">Mario Carneiro (Jun 18 2019 at 20:47)</a>:</h4>
<p>although there is no real distinction with <code>let</code> when you are pattern matching</p>

<a name="168453916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168453916" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168453916">Mario Carneiro (Jun 18 2019 at 20:48)</a>:</h4>
<p>if anything, <code>let &lt;foo&gt; := bla in bla</code> is misnamed</p>

<a name="168453992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168453992" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168453992">Patrick Massot (Jun 18 2019 at 20:48)</a>:</h4>
<p>but I guess all this is defined in core, so why not doing a mathlib version that you would call as you wish?</p>

<a name="168454402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168454402" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168454402">Mario Carneiro (Jun 18 2019 at 20:54)</a>:</h4>
<p><span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> How possible / efficient would it be to set up all the interactive core tactics as replacers? That is, they can be changed after the fact, mediated by an attribute or similar</p>

<a name="168454800"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168454800" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168454800">Sebastian Ullrich (Jun 18 2019 at 20:59)</a>:</h4>
<p>If by that you mean that they should do an indirection via an attribute when called, then that wouldn't help with changing their signature, which is encoded in the type, not the body, would it?</p>

<a name="168454898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168454898" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168454898">Mario Carneiro (Jun 18 2019 at 21:00)</a>:</h4>
<p>That's true, but not entirely insurmountable in user code. You can have the tactic argument parser itself be a replacer</p>

<a name="168454941"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168454941" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168454941">Mario Carneiro (Jun 18 2019 at 21:01)</a>:</h4>
<p>Still, I'm thinking more along the lines of core lean support for a pattern like this</p>

<a name="168454955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168454955" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168454955">Sebastian Ullrich (Jun 18 2019 at 21:01)</a>:</h4>
<p>Uhh... that doesn't sound like fun to implement</p>

<a name="168455076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168455076" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168455076">Mario Carneiro (Jun 18 2019 at 21:02)</a>:</h4>
<p>I think you just have to tweak how reading <code>cases</code> in a tactic block translates to looking up the tactic <code>tactic.interactive.cases</code></p>

<a name="168455127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168455127" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168455127">Mario Carneiro (Jun 18 2019 at 21:03)</a>:</h4>
<p>if that lookup mechanism was configurable, we could change it to point at some other definition with a different signature</p>

<a name="168455330"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168455330" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168455330">Sebastian Ullrich (Jun 18 2019 at 21:05)</a>:</h4>
<p>Sure, that sounds much more reasonable than doing the replacement inside the core tactics. I had a PR once that implemented something like that, but it never landed for Lean 3.</p>

<a name="168455387"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/have%20rcases/near/168455387" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/77222havercases.html#168455387">Mario Carneiro (Jun 18 2019 at 21:06)</a>:</h4>
<p>the replacer approach is only for today's lean which doesn't give us any other options</p>


{% endraw %}
