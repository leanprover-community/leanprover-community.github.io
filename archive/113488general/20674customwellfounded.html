---
layout: page
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/20674customwellfounded.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html">custom well-founded</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="125289818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125289818" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125289818">Kenny Lau (Apr 19 2018 at 15:37)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">inductive</span> <span class="n">red</span><span class="bp">.</span><span class="n">step</span> <span class="o">:</span> <span class="n">list</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">bool</span><span class="o">)</span> <span class="bp">→</span> <span class="n">list</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">bool</span><span class="o">)</span> <span class="bp">→</span> <span class="kt">Prop</span>
<span class="bp">|</span> <span class="n">bnot</span> <span class="o">{</span><span class="n">L₁</span> <span class="n">L₂</span> <span class="n">x</span> <span class="n">b</span><span class="o">}</span> <span class="o">:</span> <span class="n">red</span><span class="bp">.</span><span class="n">step</span> <span class="o">(</span><span class="n">L₁</span> <span class="bp">++</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="bp">::</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">bnot</span> <span class="n">b</span><span class="o">)</span> <span class="bp">::</span> <span class="n">L₂</span><span class="o">)</span> <span class="o">(</span><span class="n">L₁</span> <span class="bp">++</span> <span class="n">L₂</span><span class="o">)</span>
</pre></div>


<p>How do I tell Lean that whenever <code>red.step L1 L2</code> is true, it is also true that <code>list.sizeof L2 &lt; list.sizeof L1</code>?</p>

<a name="125289821"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125289821" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125289821">Kenny Lau (Apr 19 2018 at 15:37)</a>:</h4>
<p>I don't want to provide a custom proof at the end of every recursion</p>

<a name="125289871"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125289871" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125289871">Mario Carneiro (Apr 19 2018 at 15:38)</a>:</h4>
<p>You could prove that <code>red.step</code> itself is well-founded...</p>

<a name="125289872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125289872" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125289872">Kenny Lau (Apr 19 2018 at 15:38)</a>:</h4>
<p>it's in the wrong direction though</p>

<a name="125289874"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125289874" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125289874">Mario Carneiro (Apr 19 2018 at 15:38)</a>:</h4>
<p><code>swap red.step</code> then</p>

<a name="125289890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125289890" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125289890">Kenny Lau (Apr 19 2018 at 15:39)</a>:</h4>
<p>what is swap?</p>

<a name="125289892"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125289892" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125289892">Mario Carneiro (Apr 19 2018 at 15:39)</a>:</h4>
<p>exactly what it sounds like</p>

<a name="125289895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125289895" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125289895">Mario Carneiro (Apr 19 2018 at 15:40)</a>:</h4>
<p>it's defined in <code>init.function</code> and swaps a binary operator (aka relation converse)</p>

<a name="125289937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125289937" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125289937">Mario Carneiro (Apr 19 2018 at 15:40)</a>:</h4>
<p>oh, I guess it is in <code>function</code> ns</p>

<a name="125289939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125289939" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125289939">Kenny Lau (Apr 19 2018 at 15:40)</a>:</h4>
<p>right</p>

<a name="125289940"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125289940" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125289940">Kenny Lau (Apr 19 2018 at 15:40)</a>:</h4>
<p>so if I prove that <code>swap red.step</code> is well-founded, then I won't have to worry about anything?</p>

<a name="125289987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125289987" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125289987">Kenny Lau (Apr 19 2018 at 15:42)</a>:</h4>
<p>do you suppose I prove <code>has_well_founded (list (α × bool))</code>?</p>

<a name="125289991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125289991" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125289991">Mario Carneiro (Apr 19 2018 at 15:42)</a>:</h4>
<p>No, except perhaps locally if you like</p>

<a name="125289993"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125289993" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125289993">Kenny Lau (Apr 19 2018 at 15:42)</a>:</h4>
<p>I mean, is it <code>has_well_founded (list (α × bool))</code> that I should prove?</p>

<a name="125289994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125289994" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125289994">Kenny Lau (Apr 19 2018 at 15:42)</a>:</h4>
<p>and then I can use recursion?</p>

<a name="125289995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125289995" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125289995">Mario Carneiro (Apr 19 2018 at 15:42)</a>:</h4>
<p>yes</p>

<a name="125290000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125290000" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125290000">Kenny Lau (Apr 19 2018 at 15:43)</a>:</h4>
<p>because "prove well-founded" is kinda vague of an instruction</p>

<a name="125290004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125290004" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125290004">Mario Carneiro (Apr 19 2018 at 15:43)</a>:</h4>
<p>you can also define a <code>well_founded</code> proof and then refer to it in your wf definition using <code>using_well_founded</code></p>

<a name="125290010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125290010" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125290010">Mario Carneiro (Apr 19 2018 at 15:43)</a>:</h4>
<p>there are several examples of that in mathlib, just look for the keyword</p>

<a name="125290053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125290053" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125290053">Kenny Lau (Apr 19 2018 at 15:44)</a>:</h4>
<p>as I said, I don't want to write a custom proof at the end of every recursion</p>

<a name="125290054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125290054" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125290054">Kenny Lau (Apr 19 2018 at 15:44)</a>:</h4>
<p>I will be doing recurison much</p>

<a name="125290109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125290109" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125290109">Kenny Lau (Apr 19 2018 at 15:46)</a>:</h4>
<p>how would I prove that <code>red.step</code> is well-founded?</p>

<a name="125290113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125290113" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125290113">Kenny Lau (Apr 19 2018 at 15:46)</a>:</h4>
<p>I don't know how to use list lengths to prove that it is well-founded</p>

<a name="125290273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125290273" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125290273">Johannes Hölzl (Apr 19 2018 at 15:53)</a>:</h4>
<p>my first idea would be to use <code>subrelation.wf</code> and <code>inv_image.wf</code>.</p>

<a name="125291560"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125291560" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125291560">Kenny Lau (Apr 19 2018 at 16:35)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">H1</span> <span class="o">:</span> <span class="n">step</span> <span class="n">L₁</span> <span class="n">L₄</span><span class="o">,</span>
<span class="err">⊢</span> <span class="n">function</span><span class="bp">.</span><span class="n">swap</span> <span class="n">step</span> <span class="n">L₄</span> <span class="n">L₁</span>
</pre></div>

<a name="125291563"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125291563" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125291563">Kenny Lau (Apr 19 2018 at 16:35)</a>:</h4>
<p>Lean's automater couldn't match this with "assumption"</p>

<a name="125291564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125291564" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125291564">Kenny Lau (Apr 19 2018 at 16:35)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span></p>

<a name="125291620"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125291620" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125291620">Mario Carneiro (Apr 19 2018 at 16:37)</a>:</h4>
<p>try <code>exact this</code> as the tactic instead</p>

<a name="125291756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125291756" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125291756">Kenny Lau (Apr 19 2018 at 16:40)</a>:</h4>
<p>can I not change the tactic ;_;</p>

<a name="125291845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125291845" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125291845">Kenny Lau (Apr 19 2018 at 16:42)</a>:</h4>
<p>Now I used <code>λ L₁ L₂, red.step L₂ L₁</code> as the well-founded relation instead and Lean is giving me ths ;_;</p>

<a name="125291850"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125291850" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125291850">Kenny Lau (Apr 19 2018 at 16:42)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="k">match</span> <span class="n">failed</span>
<span class="n">state</span><span class="o">:</span>
<span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">,</span>
<span class="n">L₃</span> <span class="o">:</span> <span class="n">list</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">bool</span><span class="o">),</span>
<span class="n">red</span><span class="bp">.</span><span class="n">trans</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="bp">_</span><span class="n">p</span> <span class="o">:</span> <span class="err">Σ&#39;</span> <span class="o">{</span><span class="n">L₁</span> <span class="n">L₂</span> <span class="o">:</span> <span class="n">list</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">bool</span><span class="o">)}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">red</span> <span class="n">L₁</span> <span class="n">L₂</span><span class="o">),</span> <span class="n">red</span> <span class="n">L₂</span> <span class="n">L₃</span><span class="o">),</span> <span class="n">red</span> <span class="o">(</span><span class="bp">_</span><span class="n">p</span><span class="bp">.</span><span class="n">fst</span><span class="o">)</span> <span class="n">L₃</span><span class="o">,</span>
<span class="n">L₁</span> <span class="n">L₂</span> <span class="n">L₄</span> <span class="o">:</span> <span class="n">list</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">bool</span><span class="o">),</span>
<span class="n">H1</span> <span class="o">:</span> <span class="n">step</span> <span class="n">L₁</span> <span class="n">L₄</span><span class="o">,</span>
<span class="n">H2</span> <span class="o">:</span> <span class="n">red</span> <span class="n">L₄</span> <span class="n">L₂</span><span class="o">,</span>
<span class="n">H23</span> <span class="o">:</span> <span class="n">red</span> <span class="n">L₂</span> <span class="n">L₃</span>
<span class="err">⊢</span> <span class="n">step</span> <span class="n">L₁</span> <span class="n">L₄</span>
</pre></div>

<a name="125291860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125291860" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125291860">Kenny Lau (Apr 19 2018 at 16:43)</a>:</h4>
<p>keru mouri</p>

<a name="125291948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125291948" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125291948">Kenny Lau (Apr 19 2018 at 16:45)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> sauva mi</p>

<a name="125291962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125291962" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125291962">Mario Carneiro (Apr 19 2018 at 16:46)</a>:</h4>
<p>You should use <code>using_well_founded</code> like I said</p>

<a name="125291996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125291996" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125291996">Kenny Lau (Apr 19 2018 at 16:46)</a>:</h4>
<p>I don’t want to use it after every single recursion ;_;</p>

<a name="125291997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125291997" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125291997">Mario Carneiro (Apr 19 2018 at 16:46)</a>:</h4>
<p>it's just one line, which you can copy around</p>

<a name="125467953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125467953" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125467953">Chris Hughes (Apr 21 2018 at 07:09)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> </p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">red</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="n">sorry</span>

<span class="kn">axiom</span> <span class="n">red_length</span> <span class="o">(</span><span class="n">l₁</span> <span class="n">l₂</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">red</span> <span class="n">l₁</span> <span class="n">l₂</span> <span class="bp">→</span> <span class="n">l₁</span><span class="bp">.</span><span class="n">length</span> <span class="bp">&lt;</span> <span class="n">l₂</span><span class="bp">.</span><span class="n">length</span>

<span class="kn">lemma</span> <span class="n">red_well_founded</span> <span class="o">:</span> <span class="n">well_founded</span> <span class="o">(</span><span class="bp">@</span><span class="n">red</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="n">subrelation</span><span class="bp">.</span><span class="n">wf</span> <span class="n">red_length</span>
<span class="o">(</span><span class="n">measure_wf</span> <span class="n">list</span><span class="bp">.</span><span class="n">length</span><span class="o">)</span>
</pre></div>


<p>This might help if you haven't already worked it out.</p>

<a name="125473548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125473548" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125473548">Kenny Lau (Apr 21 2018 at 09:51)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span> thanks, but it still bugs me to provide a proof of well-foundedness</p>

<a name="125473597"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/custom%20well-founded/near/125473597" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/20674customwellfounded.html#125473597">Kenny Lau (Apr 21 2018 at 09:52)</a>:</h4>
<p>so in the end I proved</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">red</span><span class="bp">.</span><span class="n">sizeof</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">L₁</span> <span class="n">L₂</span> <span class="o">:</span> <span class="n">list</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">bool</span><span class="o">)},</span> <span class="n">red</span><span class="bp">.</span><span class="n">step</span> <span class="n">L₁</span> <span class="n">L₂</span> <span class="bp">→</span> <span class="n">L₂</span><span class="bp">.</span><span class="n">sizeof</span> <span class="bp">&lt;</span> <span class="n">L₁</span><span class="bp">.</span><span class="n">sizeof</span>
</pre></div>


<p>and then in recursions I do:</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">red</span><span class="bp">.</span><span class="n">append</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">L₁</span> <span class="n">L₂</span> <span class="n">L₃</span> <span class="n">L₄</span> <span class="o">:</span> <span class="n">list</span> <span class="o">(</span><span class="n">α</span> <span class="bp">×</span> <span class="n">bool</span><span class="o">)},</span>
  <span class="n">red</span> <span class="n">L₁</span> <span class="n">L₃</span> <span class="bp">→</span> <span class="n">red</span> <span class="n">L₂</span> <span class="n">L₄</span> <span class="bp">→</span> <span class="n">red</span> <span class="o">(</span><span class="n">L₁</span> <span class="bp">++</span> <span class="n">L₂</span><span class="o">)</span> <span class="o">(</span><span class="n">L₃</span> <span class="bp">++</span> <span class="n">L₄</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">red</span><span class="bp">.</span><span class="n">refl</span> <span class="n">red</span><span class="bp">.</span><span class="n">refl</span> <span class="o">:=</span> <span class="n">red</span><span class="bp">.</span><span class="n">refl</span>
<span class="bp">|</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">red</span><span class="bp">.</span><span class="n">refl</span> <span class="o">(</span><span class="n">red</span><span class="bp">.</span><span class="n">step_trans</span> <span class="n">H3</span> <span class="n">H4</span><span class="o">)</span> <span class="o">:=</span> <span class="k">have</span> <span class="bp">_</span> <span class="o">:=</span> <span class="n">red</span><span class="bp">.</span><span class="n">sizeof</span> <span class="n">H3</span><span class="o">,</span>
  <span class="n">red</span><span class="bp">.</span><span class="n">step_trans</span> <span class="o">(</span><span class="n">red</span><span class="bp">.</span><span class="n">step</span><span class="bp">.</span><span class="n">append_left</span> <span class="n">H3</span><span class="o">)</span> <span class="o">(</span><span class="n">red</span><span class="bp">.</span><span class="n">append</span> <span class="n">red</span><span class="bp">.</span><span class="n">refl</span> <span class="n">H4</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="o">(</span><span class="n">red</span><span class="bp">.</span><span class="n">step_trans</span> <span class="n">H1</span> <span class="n">H2</span><span class="o">)</span> <span class="n">H3</span> <span class="o">:=</span> <span class="k">have</span> <span class="bp">_</span> <span class="o">:=</span> <span class="n">red</span><span class="bp">.</span><span class="n">sizeof</span> <span class="n">H1</span><span class="o">,</span>
  <span class="n">red</span><span class="bp">.</span><span class="n">step_trans</span> <span class="o">(</span><span class="n">red</span><span class="bp">.</span><span class="n">step</span><span class="bp">.</span><span class="n">append_right</span> <span class="n">H1</span><span class="o">)</span> <span class="o">(</span><span class="n">red</span><span class="bp">.</span><span class="n">append</span> <span class="n">H2</span> <span class="n">H3</span><span class="o">)</span>
</pre></div>


{% endraw %}
