---
layout: page
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/13048substathyp.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html">subst at hyp</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="133497289"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133497289" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133497289">Johan Commelin (Sep 07 2018 at 10:31)</a>:</h4>
<p>Could we have <code>subst foobar at hyp</code> for substituting in the hypotheses of the local context? Currently I am using <code>repeat {rw foobar at hyp}</code> which feels a bit verbose...</p>

<a name="133497352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133497352" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133497352">Kenny Lau (Sep 07 2018 at 10:32)</a>:</h4>
<p><code>subst foobar</code></p>

<a name="133497411"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133497411" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133497411">Chris Hughes (Sep 07 2018 at 10:34)</a>:</h4>
<p>What about <code>simp only [foobar] at hyp</code></p>

<a name="133497450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133497450" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133497450">Johan Commelin (Sep 07 2018 at 10:35)</a>:</h4>
<p>aah never mind. <code>subst</code> is only for local constants. I wanted to substitute <code>x = y</code> where <code>x = y</code> was the result of some proposition.</p>

<a name="133497493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133497493" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133497493">Johan Commelin (Sep 07 2018 at 10:36)</a>:</h4>
<p><code>simp only</code> works!</p>

<a name="133497565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133497565" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133497565">Kenny Lau (Sep 07 2018 at 10:38)</a>:</h4>
<p>MWE?</p>

<a name="133497570"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133497570" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133497570">Johan Commelin (Sep 07 2018 at 10:38)</a>:</h4>
<p><a href="https://gist.github.com/jcommelin/2e031b5446ca54089576ea9f66f12abf" target="_blank" title="https://gist.github.com/jcommelin/2e031b5446ca54089576ea9f66f12abf">https://gist.github.com/jcommelin/2e031b5446ca54089576ea9f66f12abf</a></p>

<a name="133497619"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133497619" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133497619">Kenny Lau (Sep 07 2018 at 10:39)</a>:</h4>
<p>?</p>

<a name="133497678"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133497678" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133497678">Johan Commelin (Sep 07 2018 at 10:40)</a>:</h4>
<p>Right, so now you only see the <code>simp</code>s. For the <code>repeat {rw ...}</code> you have to look in the history.</p>

<a name="133497681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133497681" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133497681">Johan Commelin (Sep 07 2018 at 10:40)</a>:</h4>
<p>Basically I'm challenging you to golf it <span class="emoji emoji-1f606" title="lol">:lol:</span></p>

<a name="133497852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133497852" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133497852">Kenny Lau (Sep 07 2018 at 10:44)</a>:</h4>
<p>what import is allowed?</p>

<a name="133497883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133497883" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133497883">Johan Commelin (Sep 07 2018 at 10:45)</a>:</h4>
<p>I don't really care</p>

<a name="133497892"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133497892" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133497892">Johan Commelin (Sep 07 2018 at 10:45)</a>:</h4>
<p>What would you want to use? <code>tidy</code>?</p>

<a name="133497943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133497943" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133497943">Kenny Lau (Sep 07 2018 at 10:46)</a>:</h4>
<p>you didn't import any file from mathlib, so I can't use any mathlib tactic</p>

<a name="133497962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133497962" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133497962">Johan Commelin (Sep 07 2018 at 10:47)</a>:</h4>
<p>Wasnt <code>have ... simp at this ... exact this</code> some sort of idiom that can be golfed into a <code>simpa</code>-oneliner? I tried but failed.</p>

<a name="133498111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133498111" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133498111">Reid Barton (Sep 07 2018 at 10:50)</a>:</h4>
<p><code>simpa using this</code></p>

<a name="133498115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133498115" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133498115">Reid Barton (Sep 07 2018 at 10:51)</a>:</h4>
<p>Or rather <code>simpa using ...</code></p>

<a name="133498231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133498231" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133498231">Johan Commelin (Sep 07 2018 at 10:54)</a>:</h4>
<p>And what do I need to import to get <code>simpa</code>?</p>

<a name="133498273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133498273" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133498273">Reid Barton (Sep 07 2018 at 10:54)</a>:</h4>
<p>My attempt: <a href="https://gist.github.com/rwbarton/b79b804e4bff300a5aa2a4ec2951c55e" target="_blank" title="https://gist.github.com/rwbarton/b79b804e4bff300a5aa2a4ec2951c55e">https://gist.github.com/rwbarton/b79b804e4bff300a5aa2a4ec2951c55e</a></p>

<a name="133498276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133498276" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133498276">Reid Barton (Sep 07 2018 at 10:54)</a>:</h4>
<p>Anything in mathlib, but say <code>tactic.interactive</code></p>

<a name="133498303"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133498303" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133498303">Kenny Lau (Sep 07 2018 at 10:55)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">interactive</span>

<span class="kn">universe</span> <span class="n">u</span>

<span class="kn">namespace</span> <span class="n">eckmann_hilton</span>
<span class="kn">variables</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span>

<span class="n">local</span> <span class="kn">notation</span> <span class="n">a</span> <span class="bp">`&lt;`</span><span class="n">m</span><span class="bp">`&gt;`</span> <span class="n">b</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">has_mul</span><span class="bp">.</span><span class="n">mul</span> <span class="n">X</span> <span class="n">m</span> <span class="n">a</span> <span class="n">b</span>

<span class="n">class</span> <span class="n">is_unital</span> <span class="o">[</span><span class="n">m</span> <span class="o">:</span> <span class="n">has_mul</span> <span class="n">X</span><span class="o">]</span> <span class="o">[</span><span class="n">e</span> <span class="o">:</span> <span class="n">has_one</span> <span class="n">X</span><span class="o">]</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">one_mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">,</span> <span class="o">(</span><span class="n">e</span><span class="bp">.</span><span class="n">one</span> <span class="bp">&lt;</span><span class="n">m</span><span class="bp">&gt;</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span> <span class="n">x</span><span class="o">)</span>
<span class="o">(</span><span class="n">mul_one</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span> <span class="bp">&lt;</span><span class="n">m</span><span class="bp">&gt;</span> <span class="n">e</span><span class="bp">.</span><span class="n">one</span><span class="o">)</span> <span class="bp">=</span> <span class="n">x</span><span class="o">)</span>

<span class="n">attribute</span> <span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="n">is_unital</span><span class="bp">.</span><span class="n">one_mul</span> <span class="n">is_unital</span><span class="bp">.</span><span class="n">mul_one</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">X</span><span class="o">}</span> <span class="o">{</span><span class="n">m₁</span> <span class="o">:</span> <span class="n">has_mul</span> <span class="n">X</span><span class="o">}</span> <span class="o">{</span><span class="n">e₁</span> <span class="o">:</span> <span class="n">has_one</span> <span class="n">X</span><span class="o">}</span> <span class="o">{</span><span class="n">m₂</span> <span class="o">:</span> <span class="n">has_mul</span> <span class="n">X</span><span class="o">}</span> <span class="o">{</span><span class="n">e₂</span> <span class="o">:</span> <span class="n">has_one</span> <span class="n">X</span><span class="o">}</span>
<span class="kn">variables</span> <span class="o">(</span><span class="n">h₁</span> <span class="o">:</span> <span class="bp">@</span><span class="n">is_unital</span> <span class="n">X</span> <span class="n">m₁</span> <span class="n">e₁</span><span class="o">)</span> <span class="o">(</span><span class="n">h₂</span> <span class="o">:</span> <span class="bp">@</span><span class="n">is_unital</span> <span class="n">X</span> <span class="n">m₂</span> <span class="n">e₂</span><span class="o">)</span>
<span class="kn">variables</span> <span class="o">(</span><span class="n">distrib</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">d</span><span class="o">,</span> <span class="o">((</span><span class="n">a</span> <span class="bp">&lt;</span><span class="n">m₂</span><span class="bp">&gt;</span> <span class="n">b</span><span class="o">)</span> <span class="bp">&lt;</span><span class="n">m₁</span><span class="bp">&gt;</span> <span class="o">(</span><span class="n">c</span> <span class="bp">&lt;</span><span class="n">m₂</span><span class="bp">&gt;</span> <span class="n">d</span><span class="o">))</span> <span class="bp">=</span> <span class="o">((</span><span class="n">a</span> <span class="bp">&lt;</span><span class="n">m₁</span><span class="bp">&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="bp">&lt;</span><span class="n">m₂</span><span class="bp">&gt;</span> <span class="o">(</span><span class="n">b</span> <span class="bp">&lt;</span><span class="n">m₁</span><span class="bp">&gt;</span> <span class="n">d</span><span class="o">)))</span>
<span class="n">include</span> <span class="n">h₁</span> <span class="n">h₂</span> <span class="n">distrib</span>

<span class="kn">lemma</span> <span class="n">one</span> <span class="o">:</span> <span class="o">(</span><span class="n">e₁</span><span class="bp">.</span><span class="n">one</span> <span class="bp">=</span> <span class="n">e₂</span><span class="bp">.</span><span class="n">one</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">simpa</span> <span class="kn">using</span> <span class="n">distrib</span> <span class="n">e₂</span><span class="bp">.</span><span class="n">one</span> <span class="n">e₁</span><span class="bp">.</span><span class="n">one</span> <span class="n">e₁</span><span class="bp">.</span><span class="n">one</span> <span class="n">e₂</span><span class="bp">.</span><span class="n">one</span>

<span class="kn">lemma</span> <span class="n">mul</span> <span class="o">:</span> <span class="o">(</span><span class="n">m₁</span><span class="bp">.</span><span class="n">mul</span> <span class="bp">=</span> <span class="n">m₂</span><span class="bp">.</span><span class="n">mul</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">funext</span> <span class="n">a</span> <span class="n">b</span><span class="bp">;</span> <span class="k">have</span> <span class="o">:=</span> <span class="n">distrib</span> <span class="n">a</span> <span class="n">e₁</span><span class="bp">.</span><span class="n">one</span> <span class="n">e₁</span><span class="bp">.</span><span class="n">one</span> <span class="n">b</span><span class="bp">;</span>
<span class="n">simp</span> <span class="n">at</span> <span class="n">this</span><span class="bp">;</span> <span class="n">simpa</span> <span class="o">[</span><span class="n">one</span> <span class="n">h₁</span> <span class="n">h₂</span> <span class="n">distrib</span><span class="o">]</span> <span class="kn">using</span> <span class="n">this</span>

<span class="kn">lemma</span> <span class="n">mul_comm</span> <span class="o">:</span> <span class="n">is_commutative</span> <span class="bp">_</span> <span class="n">m₂</span><span class="bp">.</span><span class="n">mul</span> <span class="o">:=</span>
<span class="bp">⟨λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="k">by</span> <span class="n">simpa</span> <span class="o">[</span><span class="n">mul</span> <span class="n">h₁</span> <span class="n">h₂</span> <span class="n">distrib</span><span class="o">]</span> <span class="kn">using</span> <span class="n">distrib</span> <span class="n">e₂</span><span class="bp">.</span><span class="n">one</span> <span class="n">a</span> <span class="n">b</span> <span class="n">e₂</span><span class="bp">.</span><span class="n">one</span><span class="bp">⟩</span>

<span class="kn">lemma</span> <span class="n">mul_assoc</span> <span class="o">:</span> <span class="n">is_associative</span> <span class="bp">_</span> <span class="n">m₂</span><span class="bp">.</span><span class="n">mul</span> <span class="o">:=</span>
<span class="bp">⟨λ</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span> <span class="k">by</span> <span class="n">simpa</span> <span class="o">[</span><span class="n">mul</span> <span class="n">h₁</span> <span class="n">h₂</span> <span class="n">distrib</span><span class="o">]</span> <span class="kn">using</span> <span class="n">distrib</span> <span class="n">a</span> <span class="n">b</span> <span class="n">e₂</span><span class="bp">.</span><span class="n">one</span> <span class="n">c</span><span class="bp">⟩</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">comm_monoid</span> <span class="n">X</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">mul_comm</span> <span class="o">:=</span> <span class="o">(</span><span class="n">mul_comm</span> <span class="n">h₁</span> <span class="n">h₂</span> <span class="n">distrib</span><span class="o">)</span><span class="bp">.</span><span class="n">comm</span><span class="o">,</span>
  <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="o">(</span><span class="n">mul_assoc</span> <span class="n">h₁</span> <span class="n">h₂</span> <span class="n">distrib</span><span class="o">)</span><span class="bp">.</span><span class="n">assoc</span><span class="o">,</span>
  <span class="bp">..</span><span class="n">m₂</span><span class="o">,</span> <span class="bp">..</span><span class="n">e₂</span><span class="o">,</span> <span class="bp">..</span><span class="n">h₂</span> <span class="o">}</span>

<span class="kn">end</span> <span class="n">eckmann_hilton</span>
</pre></div>

<a name="133498562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133498562" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133498562">Johan Commelin (Sep 07 2018 at 11:00)</a>:</h4>
<p>Well done!</p>

<a name="133498636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133498636" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133498636">Johan Commelin (Sep 07 2018 at 11:02)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> <a href="https://gist.github.com/jcommelin/2e031b5446ca54089576ea9f66f12abf" target="_blank" title="https://gist.github.com/jcommelin/2e031b5446ca54089576ea9f66f12abf">https://gist.github.com/jcommelin/2e031b5446ca54089576ea9f66f12abf</a><br>
I added your name.</p>

<a name="133498642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/subst%20at%20hyp/near/133498642" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/13048substathyp.html#133498642">Kenny Lau (Sep 07 2018 at 11:02)</a>:</h4>
<p>lol</p>


{% endraw %}
