---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/74447leanpkgupgradenolongerworking.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/74447leanpkgupgradenolongerworking.html">`leanpkg upgrade` no longer working?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="127502598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60leanpkg%20upgrade%60%20no%20longer%20working%3F/near/127502598" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74447leanpkgupgradenolongerworking.html#127502598">Scott Morrison (Jun 03 2018 at 13:06)</a>:</h4>
<p>Since I've switched all my repositories to have <code>lean_version = "3.4.1"</code> in the <code>leanpkg.toml</code> file, it seems that <code>leanpkg upgrade</code> no longer has any effect: that is, commits to downstream repositories aren't pulled.</p>

<a name="127502600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60leanpkg%20upgrade%60%20no%20longer%20working%3F/near/127502600" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74447leanpkgupgradenolongerworking.html#127502600">Scott Morrison (Jun 03 2018 at 13:06)</a>:</h4>
<p>Did something change?</p>

<a name="127502608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60leanpkg%20upgrade%60%20no%20longer%20working%3F/near/127502608" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74447leanpkgupgradenolongerworking.html#127502608">Scott Morrison (Jun 03 2018 at 13:07)</a>:</h4>
<p>Can anyone guess what I'm doing wrong? I just want my <code>leanpkg.toml</code> file to be automatically updated to the latest commit of the downstream repos.</p>

<a name="127510205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60leanpkg%20upgrade%60%20no%20longer%20working%3F/near/127510205" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74447leanpkgupgradenolongerworking.html#127510205">Sebastian Ullrich (Jun 03 2018 at 17:57)</a>:</h4>
<p>leanpkg is looking for a branch <code>lean-3.4.1</code>. You should switch to that from <code>master</code> if you only want to support that version. You should not set stable Lean versions on the <code>master</code> branch.</p>

<a name="127519975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60leanpkg%20upgrade%60%20no%20longer%20working%3F/near/127519975" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74447leanpkgupgradenolongerworking.html#127519975">Scott Morrison (Jun 03 2018 at 23:54)</a>:</h4>
<p>Okay --- I'm a bit confused. The <code>leanpkg.toml</code> file in <code>mathlib</code> currently says: <code>lean_version = "3.4.1"</code>, so I'd copied that over into my little chain of dependencies. What should the <code>lean_version</code> in my <code>leanpkg.toml</code> files be?</p>

<a name="127533855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60leanpkg%20upgrade%60%20no%20longer%20working%3F/near/127533855" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74447leanpkgupgradenolongerworking.html#127533855">Sebastian Ullrich (Jun 04 2018 at 08:04)</a>:</h4>
<p>mathlib now keeps the <code>master</code> and a new <code>lean-3.4.1</code> branch in sync, but I'd recommend just moving to the latter altogether <a href="#narrow/stream/113488-general/subject/lean-3.2E4.2E1.20branch/near/127075441" title="#narrow/stream/113488-general/subject/lean-3.2E4.2E1.20branch/near/127075441">https://leanprover.zulipchat.com/#narrow/stream/113488-general/subject/lean-3.2E4.2E1.20branch/near/127075441</a></p>

<a name="127535112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60leanpkg%20upgrade%60%20no%20longer%20working%3F/near/127535112" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74447leanpkgupgradenolongerworking.html#127535112">Scott Morrison (Jun 04 2018 at 08:43)</a>:</h4>
<p>I'm sorry, I still don't understand. What am I meant to do in my repos, so that <code>leanpkg upgrade</code> actually upgrades? Should I set all the <code>lean_version</code> lines back to <code>master</code>?</p>

<a name="127535287"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60leanpkg%20upgrade%60%20no%20longer%20working%3F/near/127535287" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74447leanpkgupgradenolongerworking.html#127535287">Sebastian Ullrich (Jun 04 2018 at 08:49)</a>:</h4>
<p>You should keep <code>lean_version = "3.4.1"</code> but push that as a new branch <code>lean-3.4.1</code> to your repo(s) and use that branch for development against Lean 3.4.1.</p>

<a name="127535465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60leanpkg%20upgrade%60%20no%20longer%20working%3F/near/127535465" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74447leanpkgupgradenolongerworking.html#127535465">Scott Morrison (Jun 04 2018 at 08:54)</a>:</h4>
<p>ooooh. That hadn't even occurred to me. For lame git-newbs like me, it's so much easier to just do everything in the master branch. (Okay, I think I could cope, but I'm not sure <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> could. :-)</p>

<a name="127535529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60leanpkg%20upgrade%60%20no%20longer%20working%3F/near/127535529" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74447leanpkgupgradenolongerworking.html#127535529">Sebastian Ullrich (Jun 04 2018 at 08:56)</a>:</h4>
<p>You can set the default branch on Github to the new branch, then there shouldn't be all that much difference</p>

<a name="127535555"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60leanpkg%20upgrade%60%20no%20longer%20working%3F/near/127535555" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74447leanpkgupgradenolongerworking.html#127535555">Johan Commelin (Jun 04 2018 at 08:57)</a>:</h4>
<p>In his book "Lean for the working mathematician", I think Kevin will have to spend the first 30 pages on "Git for the working mathematician".</p>

<a name="128114390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60leanpkg%20upgrade%60%20no%20longer%20working%3F/near/128114390" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74447leanpkgupgradenolongerworking.html#128114390">Scott Morrison (Jun 15 2018 at 11:00)</a>:</h4>
<p>Is there any possibility of changing the tooling so people can continue developing their repositories on <code>master</code> branches, and still have <code>leanpkg upgrade</code> work?</p>

<a name="128114399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60leanpkg%20upgrade%60%20no%20longer%20working%3F/near/128114399" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74447leanpkgupgradenolongerworking.html#128114399">Scott Morrison (Jun 15 2018 at 11:01)</a>:</h4>
<p>(Sorry to restart a two week old thread --- for quick context, apparently the advice was that if you want to be able to use <code>leanpkg upgrade</code>, you need to work in a branch called <code>lean-3.4.1</code>.)</p>

<a name="128116038"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60leanpkg%20upgrade%60%20no%20longer%20working%3F/near/128116038" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74447leanpkgupgradenolongerworking.html#128116038">Sebastian Ullrich (Jun 15 2018 at 11:51)</a>:</h4>
<p>Well, Lean 3 is frozen. We can add a <code>branch</code> config field to leanpkg.toml dependencies in Lean 4 so that users can stay on non-canonical branches.</p>


{% endraw %}

{% include archive_update.html %}