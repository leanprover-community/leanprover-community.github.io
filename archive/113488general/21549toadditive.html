---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/21549toadditive.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html">to_additive</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="135545903"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/135545903" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#135545903">Patrick Massot (Oct 10 2018 at 14:40)</a>:</h4>
<p>Is there any hope <code>to_additive</code> could be improved to avoid things like <a href="https://github.com/leanprover/mathlib/blob/2594f48f20392f84b0743eb0867c030913eca627/group_theory/quotient_group.lean#L40-L47" target="_blank" title="https://github.com/leanprover/mathlib/blob/2594f48f20392f84b0743eb0867c030913eca627/group_theory/quotient_group.lean#L40-L47">https://github.com/leanprover/mathlib/blob/2594f48f20392f84b0743eb0867c030913eca627/group_theory/quotient_group.lean#L40-L47</a>?</p>

<a name="135612824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/135612824" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#135612824">Mario Carneiro (Oct 11 2018 at 14:41)</a>:</h4>
<p><span class="user-mention" data-user-id="110026">@Simon Hudon</span> Would you like to take a look at this? I am thinking that the <code>to_additive</code> attribute should recursively copy any suffixed versions of the input mapping that happen to be in the term being traversed. For example if you are translating <code>foo =&gt; bar</code> and you run across <code>foo._match_1</code>, and this does not already have a translation, then it should translate <code>foo._match_1 =&gt; bar._match_1</code> and then try again</p>

<a name="135614750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/135614750" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#135614750">Simon Hudon (Oct 11 2018 at 15:06)</a>:</h4>
<p>Interesting! Sure, I'll have a look. I assume at the moment, it only does the <code>foo =&gt; bar</code> translation?</p>

<a name="135614773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/135614773" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#135614773">Mario Carneiro (Oct 11 2018 at 15:07)</a>:</h4>
<p>yes</p>

<a name="135614844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/135614844" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#135614844">Simon Hudon (Oct 11 2018 at 15:08)</a>:</h4>
<p>Cool, I'll look into it.</p>

<a name="135615706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/135615706" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#135615706">Simon Hudon (Oct 11 2018 at 15:19)</a>:</h4>
<p>Do you have an example that's giving you trouble now?</p>

<a name="135618269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/135618269" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#135618269">Mario Carneiro (Oct 11 2018 at 15:59)</a>:</h4>
<p>Well, any definition or theorem that contains (usually autogenerated) sub-definitions. In Patrick's example, it is because it is an instance with a data type and some proofs; in this case the proofs are automatically turned into sub-lemmas. The same sort of thing happens if you use <code>match</code> or <code>\lam &lt;a, b&gt;, ...</code> in a proof, or use the equation compiler</p>

<a name="135618508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/135618508" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#135618508">Simon Hudon (Oct 11 2018 at 16:03)</a>:</h4>
<p>Sorry I missed Patrick's initial comment</p>

<a name="167292586"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167292586" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167292586">Johan Commelin (Jun 04 2019 at 13:27)</a>:</h4>
<p>We have the following code in mathlib:</p>
<div class="codehilite"><pre><span></span><span class="c">/-</span><span class="cm">- An ordered (additive) commutative monoid is a commutative monoid</span>
<span class="cm">  with a partial order such that addition is an order embedding, i.e.</span>
<span class="cm">  `a + b ≤ a + c ↔ b ≤ c`. These monoids are automatically cancellative. -/</span>
<span class="n">class</span> <span class="n">ordered_comm_monoid</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">add_comm_monoid</span> <span class="n">α</span><span class="o">,</span> <span class="n">partial_order</span> <span class="n">α</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">add_le_add_left</span>       <span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="bp">∀</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">c</span> <span class="bp">+</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span>
<span class="o">(</span><span class="n">lt_of_add_lt_add_left</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">c</span><span class="o">)</span>
</pre></div>


<p><a href="https://github.com/leanprover-community/mathlib/blob/0de4bba3208ee0bd8a78adf4396aa5cb083ffdf2/src/algebra/ordered_group.lean#L17-L22" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/0de4bba3208ee0bd8a78adf4396aa5cb083ffdf2/src/algebra/ordered_group.lean#L17-L22">https://github.com/leanprover-community/mathlib/blob/0de4bba3208ee0bd8a78adf4396aa5cb083ffdf2/src/algebra/ordered_group.lean#L17-L22</a></p>
<p>Of course, this is an abomination.</p>

<a name="167292605"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167292605" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167292605">Johan Commelin (Jun 04 2019 at 13:27)</a>:</h4>
<p>So I replaced it with:</p>
<div class="codehilite"><pre><span></span><span class="c">/-</span><span class="cm">- An ordered commutative monoid is a commutative monoid</span>
<span class="cm">  with a partial order such that multiplication is an order embedding, i.e.</span>
<span class="cm">  `a * b ≤ a * c ↔ b ≤ c`. These monoids are automatically cancellative. -/</span>
<span class="bp">@</span><span class="o">[</span><span class="n">to_additive</span> <span class="n">add_ordered_comm_monoid</span><span class="o">]</span>
<span class="n">class</span> <span class="n">ordered_comm_monoid</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">comm_monoid</span> <span class="n">α</span><span class="o">,</span> <span class="n">partial_order</span> <span class="n">α</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">mul_le_mul_left</span>       <span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="bp">∀</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span>
<span class="o">(</span><span class="n">lt_of_mul_lt_mul_left</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">c</span><span class="o">)</span>
</pre></div>

<a name="167292684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167292684" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167292684">Johan Commelin (Jun 04 2019 at 13:28)</a>:</h4>
<p>I was very excited that this didn't give a failure. Being prudent, I wrote:</p>
<div class="codehilite"><pre><span></span><span class="bp">#</span><span class="kn">print</span> <span class="kn">prefix</span> <span class="n">ordered_comm_monoid</span>
<span class="bp">#</span><span class="kn">print</span> <span class="kn">prefix</span> <span class="n">add_ordered_comm_monoid</span>
</pre></div>

<a name="167292715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167292715" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167292715">Johan Commelin (Jun 04 2019 at 13:28)</a>:</h4>
<p>The output of the first command is:</p>
<div class="codehilite"><pre><span></span><span class="n">ordered_comm_monoid</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u_1</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">cases_on</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">{</span><span class="n">C</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">Sort</span> <span class="n">l</span><span class="o">}</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span><span class="o">),</span>
  <span class="o">(</span><span class="bp">Π</span> <span class="o">(</span><span class="n">mul</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">mul_assoc</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">*</span> <span class="o">(</span><span class="n">b</span> <span class="bp">*</span> <span class="n">c</span><span class="o">))</span> <span class="o">(</span><span class="n">one</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span>
   <span class="o">(</span><span class="n">one_mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="mi">1</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">mul_one</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="mi">1</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">mul_comm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">a</span><span class="o">)</span>
   <span class="o">(</span><span class="n">le</span> <span class="n">lt</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">le_refl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">)</span>
   <span class="o">(</span><span class="n">le_trans</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c</span><span class="o">)</span>
   <span class="o">(</span><span class="n">lt_iff_le_not_le</span> <span class="o">:</span>
     <span class="n">auto_param</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span> <span class="bp">↔</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">∧</span> <span class="bp">¬</span><span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">name</span><span class="bp">.</span><span class="n">mk_string</span> <span class="s2">&quot;order_laws_tac&quot;</span> <span class="n">name</span><span class="bp">.</span><span class="n">anonymous</span><span class="o">))</span>
   <span class="o">(</span><span class="n">le_antisymm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">)</span>
   <span class="o">(</span><span class="n">mul_le_mul_left</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span>
   <span class="o">(</span><span class="n">lt_of_mul_lt_mul_left</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">c</span><span class="o">),</span>
     <span class="n">C</span>
       <span class="o">{</span><span class="n">mul</span> <span class="o">:=</span> <span class="n">mul</span><span class="o">,</span>
        <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="n">mul_assoc</span><span class="o">,</span>
        <span class="n">one</span> <span class="o">:=</span> <span class="n">one</span><span class="o">,</span>
        <span class="n">one_mul</span> <span class="o">:=</span> <span class="n">one_mul</span><span class="o">,</span>
        <span class="n">mul_one</span> <span class="o">:=</span> <span class="n">mul_one</span><span class="o">,</span>
        <span class="n">mul_comm</span> <span class="o">:=</span> <span class="n">mul_comm</span><span class="o">,</span>
        <span class="n">le</span> <span class="o">:=</span> <span class="n">le</span><span class="o">,</span>
        <span class="n">lt</span> <span class="o">:=</span> <span class="n">lt</span><span class="o">,</span>
        <span class="n">le_refl</span> <span class="o">:=</span> <span class="n">le_refl</span><span class="o">,</span>
        <span class="n">le_trans</span> <span class="o">:=</span> <span class="n">le_trans</span><span class="o">,</span>
        <span class="n">lt_iff_le_not_le</span> <span class="o">:=</span> <span class="n">lt_iff_le_not_le</span><span class="o">,</span>
        <span class="n">le_antisymm</span> <span class="o">:=</span> <span class="n">le_antisymm</span><span class="o">,</span>
        <span class="n">mul_le_mul_left</span> <span class="o">:=</span> <span class="n">mul_le_mul_left</span><span class="o">,</span>
        <span class="n">lt_of_mul_lt_mul_left</span> <span class="o">:=</span> <span class="n">lt_of_mul_lt_mul_left</span><span class="o">})</span> <span class="bp">→</span>
  <span class="n">C</span> <span class="n">n</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">has_sizeof_inst</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">)</span> <span class="o">[</span><span class="n">α_inst</span> <span class="o">:</span> <span class="n">has_sizeof</span> <span class="n">α</span><span class="o">],</span> <span class="n">has_sizeof</span> <span class="o">(</span><span class="n">ordered_comm_monoid</span> <span class="n">α</span><span class="o">)</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">le</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span><span class="o">],</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">le_antisymm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">le_refl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">a</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">le_trans</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c_1</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">c_1</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c_1</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">lt</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span><span class="o">],</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">lt</span><span class="bp">._</span><span class="n">default</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">},</span> <span class="o">(</span><span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">lt</span><span class="bp">._</span><span class="n">default</span><span class="bp">.</span><span class="n">equations</span><span class="bp">._</span><span class="n">eqn_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="n">le</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">),</span> <span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">lt</span><span class="bp">._</span><span class="n">default</span> <span class="n">le</span> <span class="bp">=</span> <span class="n">id</span> <span class="o">(</span><span class="n">partial_order</span><span class="bp">.</span><span class="n">lt</span><span class="bp">._</span><span class="n">default</span> <span class="n">le</span><span class="o">)</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">lt_iff_le_not_le</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">)</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span><span class="o">],</span>
  <span class="n">auto_param</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span> <span class="bp">↔</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">∧</span> <span class="bp">¬</span><span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">name</span><span class="bp">.</span><span class="n">mk_string</span> <span class="s2">&quot;order_laws_tac&quot;</span> <span class="n">name</span><span class="bp">.</span><span class="n">anonymous</span><span class="o">)</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">lt_of_mul_lt_mul_left</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c_1</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">c_1</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">c_1</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">mk</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="n">mul</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">mul_assoc</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">*</span> <span class="o">(</span><span class="n">b</span> <span class="bp">*</span> <span class="n">c</span><span class="o">))</span> <span class="o">(</span><span class="n">one</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span>
<span class="o">(</span><span class="n">one_mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="mi">1</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">mul_one</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="mi">1</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">mul_comm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="n">le</span> <span class="n">lt</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">le_refl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="n">le_trans</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c</span><span class="o">)</span>
<span class="o">(</span><span class="n">lt_iff_le_not_le</span> <span class="o">:</span>
  <span class="n">auto_param</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span> <span class="bp">↔</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">∧</span> <span class="bp">¬</span><span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">name</span><span class="bp">.</span><span class="n">mk_string</span> <span class="s2">&quot;order_laws_tac&quot;</span> <span class="n">name</span><span class="bp">.</span><span class="n">anonymous</span><span class="o">))</span>
<span class="o">(</span><span class="n">le_antisymm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">),</span>
  <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span> <span class="bp">→</span>
  <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">c</span><span class="o">)</span> <span class="bp">→</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">mk</span><span class="bp">.</span><span class="n">inj</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">{</span><span class="n">mul</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">mul_assoc</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">*</span> <span class="o">(</span><span class="n">b</span> <span class="bp">*</span> <span class="n">c</span><span class="o">)}</span> <span class="o">{</span><span class="n">one</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span>
<span class="o">{</span><span class="n">one_mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="mi">1</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span><span class="o">}</span> <span class="o">{</span><span class="n">mul_one</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="mi">1</span> <span class="bp">=</span> <span class="n">a</span><span class="o">}</span> <span class="o">{</span><span class="n">mul_comm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">a</span><span class="o">}</span>
<span class="o">{</span><span class="n">le</span> <span class="n">lt</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">}</span> <span class="o">{</span><span class="n">le_refl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">}</span>
<span class="o">{</span><span class="n">le_trans</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c</span><span class="o">}</span>
<span class="o">{</span><span class="n">lt_iff_le_not_le</span> <span class="o">:</span>
  <span class="n">auto_param</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span> <span class="bp">↔</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">∧</span> <span class="bp">¬</span><span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">name</span><span class="bp">.</span><span class="n">mk_string</span> <span class="s2">&quot;order_laws_tac&quot;</span> <span class="n">name</span><span class="bp">.</span><span class="n">anonymous</span><span class="o">)}</span>
<span class="o">{</span><span class="n">le_antisymm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">}</span>
<span class="o">{</span><span class="n">mul_le_mul_left</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">b</span><span class="o">}</span>
<span class="o">{</span><span class="n">lt_of_mul_lt_mul_left</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">c</span><span class="o">}</span> <span class="o">{</span><span class="n">mul_1</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">}</span>
<span class="o">{</span><span class="n">mul_assoc_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">*</span> <span class="o">(</span><span class="n">b</span> <span class="bp">*</span> <span class="n">c</span><span class="o">)}</span> <span class="o">{</span><span class="n">one_1</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">one_mul_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="mi">1</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span><span class="o">}</span>
<span class="o">{</span><span class="n">mul_one_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="mi">1</span> <span class="bp">=</span> <span class="n">a</span><span class="o">}</span> <span class="o">{</span><span class="n">mul_comm_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">a</span><span class="o">}</span> <span class="o">{</span><span class="n">le_1</span> <span class="n">lt_1</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">}</span>
<span class="o">{</span><span class="n">le_refl_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">}</span> <span class="o">{</span><span class="n">le_trans_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c</span><span class="o">}</span>
<span class="o">{</span><span class="n">lt_iff_le_not_le_1</span> <span class="o">:</span>
  <span class="n">auto_param</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span> <span class="bp">↔</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">∧</span> <span class="bp">¬</span><span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">name</span><span class="bp">.</span><span class="n">mk_string</span> <span class="s2">&quot;order_laws_tac&quot;</span> <span class="n">name</span><span class="bp">.</span><span class="n">anonymous</span><span class="o">)}</span>
<span class="o">{</span><span class="n">le_antisymm_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">}</span>
<span class="o">{</span><span class="n">mul_le_mul_left_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">b</span><span class="o">}</span>
<span class="o">{</span><span class="n">lt_of_mul_lt_mul_left_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">c</span><span class="o">},</span>
  <span class="o">{</span><span class="n">mul</span> <span class="o">:=</span> <span class="n">mul</span><span class="o">,</span>
     <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="n">mul_assoc</span><span class="o">,</span>
     <span class="n">one</span> <span class="o">:=</span> <span class="n">one</span><span class="o">,</span>
     <span class="n">one_mul</span> <span class="o">:=</span> <span class="n">one_mul</span><span class="o">,</span>
     <span class="n">mul_one</span> <span class="o">:=</span> <span class="n">mul_one</span><span class="o">,</span>
     <span class="n">mul_comm</span> <span class="o">:=</span> <span class="n">mul_comm</span><span class="o">,</span>
     <span class="n">le</span> <span class="o">:=</span> <span class="n">le</span><span class="o">,</span>
     <span class="n">lt</span> <span class="o">:=</span> <span class="n">lt</span><span class="o">,</span>
     <span class="n">le_refl</span> <span class="o">:=</span> <span class="n">le_refl</span><span class="o">,</span>
     <span class="n">le_trans</span> <span class="o">:=</span> <span class="n">le_trans</span><span class="o">,</span>
     <span class="n">lt_iff_le_not_le</span> <span class="o">:=</span> <span class="n">lt_iff_le_not_le</span><span class="o">,</span>
     <span class="n">le_antisymm</span> <span class="o">:=</span> <span class="n">le_antisymm</span><span class="o">,</span>
     <span class="n">mul_le_mul_left</span> <span class="o">:=</span> <span class="n">mul_le_mul_left</span><span class="o">,</span>
     <span class="n">lt_of_mul_lt_mul_left</span> <span class="o">:=</span> <span class="n">lt_of_mul_lt_mul_left</span><span class="o">}</span> <span class="bp">=</span>
    <span class="o">{</span><span class="n">mul</span> <span class="o">:=</span> <span class="n">mul_1</span><span class="o">,</span>
     <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="n">mul_assoc_1</span><span class="o">,</span>
     <span class="n">one</span> <span class="o">:=</span> <span class="n">one_1</span><span class="o">,</span>
     <span class="n">one_mul</span> <span class="o">:=</span> <span class="n">one_mul_1</span><span class="o">,</span>
     <span class="n">mul_one</span> <span class="o">:=</span> <span class="n">mul_one_1</span><span class="o">,</span>
     <span class="n">mul_comm</span> <span class="o">:=</span> <span class="n">mul_comm_1</span><span class="o">,</span>
     <span class="n">le</span> <span class="o">:=</span> <span class="n">le_1</span><span class="o">,</span>
     <span class="n">lt</span> <span class="o">:=</span> <span class="n">lt_1</span><span class="o">,</span>
     <span class="n">le_refl</span> <span class="o">:=</span> <span class="n">le_refl_1</span><span class="o">,</span>
     <span class="n">le_trans</span> <span class="o">:=</span> <span class="n">le_trans_1</span><span class="o">,</span>
     <span class="n">lt_iff_le_not_le</span> <span class="o">:=</span> <span class="n">lt_iff_le_not_le_1</span><span class="o">,</span>
     <span class="n">le_antisymm</span> <span class="o">:=</span> <span class="n">le_antisymm_1</span><span class="o">,</span>
     <span class="n">mul_le_mul_left</span> <span class="o">:=</span> <span class="n">mul_le_mul_left_1</span><span class="o">,</span>
     <span class="n">lt_of_mul_lt_mul_left</span> <span class="o">:=</span> <span class="n">lt_of_mul_lt_mul_left_1</span><span class="o">}</span> <span class="bp">→</span>
  <span class="n">mul</span> <span class="bp">=</span> <span class="n">mul_1</span> <span class="bp">∧</span> <span class="n">one</span> <span class="bp">=</span> <span class="n">one_1</span> <span class="bp">∧</span> <span class="n">le</span> <span class="bp">=</span> <span class="n">le_1</span> <span class="bp">∧</span> <span class="n">lt</span> <span class="bp">=</span> <span class="n">lt_1</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">mk</span><span class="bp">.</span><span class="n">inj_arrow</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">{</span><span class="n">mul</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">mul_assoc</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">*</span> <span class="o">(</span><span class="n">b</span> <span class="bp">*</span> <span class="n">c</span><span class="o">)}</span> <span class="o">{</span><span class="n">one</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span>
<span class="o">{</span><span class="n">one_mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="mi">1</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span><span class="o">}</span> <span class="o">{</span><span class="n">mul_one</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="mi">1</span> <span class="bp">=</span> <span class="n">a</span><span class="o">}</span> <span class="o">{</span><span class="n">mul_comm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">a</span><span class="o">}</span>
<span class="o">{</span><span class="n">le</span> <span class="n">lt</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">}</span> <span class="o">{</span><span class="n">le_refl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">}</span>
<span class="o">{</span><span class="n">le_trans</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c</span><span class="o">}</span>
<span class="o">{</span><span class="n">lt_iff_le_not_le</span> <span class="o">:</span>
  <span class="n">auto_param</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span> <span class="bp">↔</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">∧</span> <span class="bp">¬</span><span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">name</span><span class="bp">.</span><span class="n">mk_string</span> <span class="s2">&quot;order_laws_tac&quot;</span> <span class="n">name</span><span class="bp">.</span><span class="n">anonymous</span><span class="o">)}</span>
<span class="o">{</span><span class="n">le_antisymm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">}</span>
<span class="o">{</span><span class="n">mul_le_mul_left</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">b</span><span class="o">}</span>
<span class="o">{</span><span class="n">lt_of_mul_lt_mul_left</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">c</span><span class="o">}</span> <span class="o">{</span><span class="n">mul_1</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">}</span>
<span class="o">{</span><span class="n">mul_assoc_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">*</span> <span class="o">(</span><span class="n">b</span> <span class="bp">*</span> <span class="n">c</span><span class="o">)}</span> <span class="o">{</span><span class="n">one_1</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">one_mul_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="mi">1</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span><span class="o">}</span>
<span class="o">{</span><span class="n">mul_one_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="mi">1</span> <span class="bp">=</span> <span class="n">a</span><span class="o">}</span> <span class="o">{</span><span class="n">mul_comm_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">a</span><span class="o">}</span> <span class="o">{</span><span class="n">le_1</span> <span class="n">lt_1</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">}</span>
<span class="o">{</span><span class="n">le_refl_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">}</span> <span class="o">{</span><span class="n">le_trans_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c</span><span class="o">}</span>
<span class="o">{</span><span class="n">lt_iff_le_not_le_1</span> <span class="o">:</span>
  <span class="n">auto_param</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span> <span class="bp">↔</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">∧</span> <span class="bp">¬</span><span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">name</span><span class="bp">.</span><span class="n">mk_string</span> <span class="s2">&quot;order_laws_tac&quot;</span> <span class="n">name</span><span class="bp">.</span><span class="n">anonymous</span><span class="o">)}</span>
<span class="o">{</span><span class="n">le_antisymm_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">}</span>
<span class="o">{</span><span class="n">mul_le_mul_left_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">b</span><span class="o">}</span>
<span class="o">{</span><span class="n">lt_of_mul_lt_mul_left_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">c</span><span class="o">},</span>
  <span class="o">{</span><span class="n">mul</span> <span class="o">:=</span> <span class="n">mul</span><span class="o">,</span>
     <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="n">mul_assoc</span><span class="o">,</span>
     <span class="n">one</span> <span class="o">:=</span> <span class="n">one</span><span class="o">,</span>
     <span class="n">one_mul</span> <span class="o">:=</span> <span class="n">one_mul</span><span class="o">,</span>
     <span class="n">mul_one</span> <span class="o">:=</span> <span class="n">mul_one</span><span class="o">,</span>
     <span class="n">mul_comm</span> <span class="o">:=</span> <span class="n">mul_comm</span><span class="o">,</span>
     <span class="n">le</span> <span class="o">:=</span> <span class="n">le</span><span class="o">,</span>
     <span class="n">lt</span> <span class="o">:=</span> <span class="n">lt</span><span class="o">,</span>
     <span class="n">le_refl</span> <span class="o">:=</span> <span class="n">le_refl</span><span class="o">,</span>
     <span class="n">le_trans</span> <span class="o">:=</span> <span class="n">le_trans</span><span class="o">,</span>
     <span class="n">lt_iff_le_not_le</span> <span class="o">:=</span> <span class="n">lt_iff_le_not_le</span><span class="o">,</span>
     <span class="n">le_antisymm</span> <span class="o">:=</span> <span class="n">le_antisymm</span><span class="o">,</span>
     <span class="n">mul_le_mul_left</span> <span class="o">:=</span> <span class="n">mul_le_mul_left</span><span class="o">,</span>
     <span class="n">lt_of_mul_lt_mul_left</span> <span class="o">:=</span> <span class="n">lt_of_mul_lt_mul_left</span><span class="o">}</span> <span class="bp">=</span>
    <span class="o">{</span><span class="n">mul</span> <span class="o">:=</span> <span class="n">mul_1</span><span class="o">,</span>
     <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="n">mul_assoc_1</span><span class="o">,</span>
     <span class="n">one</span> <span class="o">:=</span> <span class="n">one_1</span><span class="o">,</span>
     <span class="n">one_mul</span> <span class="o">:=</span> <span class="n">one_mul_1</span><span class="o">,</span>
     <span class="n">mul_one</span> <span class="o">:=</span> <span class="n">mul_one_1</span><span class="o">,</span>
     <span class="n">mul_comm</span> <span class="o">:=</span> <span class="n">mul_comm_1</span><span class="o">,</span>
     <span class="n">le</span> <span class="o">:=</span> <span class="n">le_1</span><span class="o">,</span>
     <span class="n">lt</span> <span class="o">:=</span> <span class="n">lt_1</span><span class="o">,</span>
     <span class="n">le_refl</span> <span class="o">:=</span> <span class="n">le_refl_1</span><span class="o">,</span>
     <span class="n">le_trans</span> <span class="o">:=</span> <span class="n">le_trans_1</span><span class="o">,</span>
     <span class="n">lt_iff_le_not_le</span> <span class="o">:=</span> <span class="n">lt_iff_le_not_le_1</span><span class="o">,</span>
     <span class="n">le_antisymm</span> <span class="o">:=</span> <span class="n">le_antisymm_1</span><span class="o">,</span>
     <span class="n">mul_le_mul_left</span> <span class="o">:=</span> <span class="n">mul_le_mul_left_1</span><span class="o">,</span>
     <span class="n">lt_of_mul_lt_mul_left</span> <span class="o">:=</span> <span class="n">lt_of_mul_lt_mul_left_1</span><span class="o">}</span> <span class="bp">→</span>
  <span class="bp">Π</span> <span class="o">⦃</span><span class="n">P</span> <span class="o">:</span> <span class="n">Sort</span> <span class="n">l</span><span class="o">⦄,</span> <span class="o">(</span><span class="n">mul</span> <span class="bp">=</span> <span class="n">mul_1</span> <span class="bp">→</span> <span class="n">one</span> <span class="bp">=</span> <span class="n">one_1</span> <span class="bp">→</span> <span class="n">le</span> <span class="bp">=</span> <span class="n">le_1</span> <span class="bp">→</span> <span class="n">lt</span> <span class="bp">=</span> <span class="n">lt_1</span> <span class="bp">→</span> <span class="n">P</span><span class="o">)</span> <span class="bp">→</span> <span class="n">P</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">mk</span><span class="bp">.</span><span class="n">sizeof_spec</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">)</span> <span class="o">[</span><span class="n">α_inst</span> <span class="o">:</span> <span class="n">has_sizeof</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">mul</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span>
<span class="o">(</span><span class="n">mul_assoc</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">*</span> <span class="o">(</span><span class="n">b</span> <span class="bp">*</span> <span class="n">c</span><span class="o">))</span> <span class="o">(</span><span class="n">one</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">one_mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="mi">1</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="n">mul_one</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="mi">1</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">mul_comm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">le</span> <span class="n">lt</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
<span class="o">(</span><span class="n">le_refl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">le_trans</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c</span><span class="o">)</span>
<span class="o">(</span><span class="n">lt_iff_le_not_le</span> <span class="o">:</span>
  <span class="n">auto_param</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span> <span class="bp">↔</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">∧</span> <span class="bp">¬</span><span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">name</span><span class="bp">.</span><span class="n">mk_string</span> <span class="s2">&quot;order_laws_tac&quot;</span> <span class="n">name</span><span class="bp">.</span><span class="n">anonymous</span><span class="o">))</span>
<span class="o">(</span><span class="n">le_antisymm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">)</span>
<span class="o">(</span><span class="n">mul_le_mul_left</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span>
<span class="o">(</span><span class="n">lt_of_mul_lt_mul_left</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="n">c</span><span class="o">),</span>
  <span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">sizeof</span> <span class="n">α</span>
      <span class="o">{</span><span class="n">mul</span> <span class="o">:=</span> <span class="n">mul</span><span class="o">,</span>
       <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="n">mul_assoc</span><span class="o">,</span>
       <span class="n">one</span> <span class="o">:=</span> <span class="n">one</span><span class="o">,</span>
       <span class="n">one_mul</span> <span class="o">:=</span> <span class="n">one_mul</span><span class="o">,</span>
       <span class="n">mul_one</span> <span class="o">:=</span> <span class="n">mul_one</span><span class="o">,</span>
       <span class="n">mul_comm</span> <span class="o">:=</span> <span class="n">mul_comm</span><span class="o">,</span>
       <span class="n">le</span> <span class="o">:=</span> <span class="n">le</span><span class="o">,</span>
       <span class="n">lt</span> <span class="o">:=</span> <span class="n">lt</span><span class="o">,</span>
       <span class="n">le_refl</span> <span class="o">:=</span> <span class="n">le_refl</span><span class="o">,</span>
       <span class="n">le_trans</span> <span class="o">:=</span> <span class="n">le_trans</span><span class="o">,</span>
       <span class="n">lt_iff_le_not_le</span> <span class="o">:=</span> <span class="n">lt_iff_le_not_le</span><span class="o">,</span>
       <span class="n">le_antisymm</span> <span class="o">:=</span> <span class="n">le_antisymm</span><span class="o">,</span>
       <span class="n">mul_le_mul_left</span> <span class="o">:=</span> <span class="n">mul_le_mul_left</span><span class="o">,</span>
       <span class="n">lt_of_mul_lt_mul_left</span> <span class="o">:=</span> <span class="n">lt_of_mul_lt_mul_left</span><span class="o">}</span> <span class="bp">=</span>
    <span class="mi">1</span> <span class="bp">+</span> <span class="n">sizeof</span> <span class="n">one</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">mul</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span><span class="o">],</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">mul_assoc</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c_1</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">c_1</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">*</span> <span class="o">(</span><span class="n">b</span> <span class="bp">*</span> <span class="n">c_1</span><span class="o">)</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">mul_comm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">a</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">mul_le_mul_left</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">c_1</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">c_1</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c_1</span> <span class="bp">*</span> <span class="n">b</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">mul_one</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="mi">1</span> <span class="bp">=</span> <span class="n">a</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">no_confusion</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">{</span><span class="n">P</span> <span class="o">:</span> <span class="n">Sort</span> <span class="n">l</span><span class="o">}</span> <span class="o">{</span><span class="n">v1</span> <span class="n">v2</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span><span class="o">},</span>
  <span class="n">v1</span> <span class="bp">=</span> <span class="n">v2</span> <span class="bp">→</span> <span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">no_confusion_type</span> <span class="n">P</span> <span class="n">v1</span> <span class="n">v2</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">no_confusion_type</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">},</span> <span class="n">Sort</span> <span class="n">l</span> <span class="bp">→</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">Sort</span> <span class="n">l</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">one</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">)</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span><span class="o">],</span> <span class="n">α</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">one_mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="n">c</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="mi">1</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span>
<span class="n">ordered_comm_monoid</span><span class="bp">.</span><span class="n">rec</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">{</span><span class="n">C</span> <span class="o">:</span> <span class="n">ordered_comm_monoid</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">Sort</span> <span class="n">l</span><span class="o">},</span>
  <span class="o">(</span><span class="bp">Π</span> <span class="o">(</span><span class="n">mul</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">mul_assoc</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">*</span> <span class="o">(</span><span class="n">b</span> <span class="bp">*</span> <span class="n">c</span><span class="o">))</span> <span class="o">(</span><span class="n">one</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span>
   <span class="o">(</span><span class="n">one_mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="mi">1</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">mul_one</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="mi">1</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">mul_comm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">a</span><span class="o">)</span>
   <span class="o">(</span><span class="n">le</span> <span class="n">lt</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">le_refl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">)</span>
   <span class="o">(</span><span class="n">le_trans</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">c</span><span class="o">)</span>
   <span class="o">(</span><span class="n">lt_iff_le_not_le</span> <span class="o">:</span>
     <span class="n">auto_param</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span> <span class="bp">↔</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">∧</span> <span class="bp">¬</span><span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">name</span><span class="bp">.</span><span class="n">mk_string</span> <span class="s2">&quot;order_laws_tac&quot;</span> <span class="n">name</span><span class="bp">.</span><span class="n">anonymous</span><span class="o">))</span>
   <span class="o">(</span><span class="n">le_antisymm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span>
</pre></div>

<a name="167292738"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167292738" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167292738">Johan Commelin (Jun 04 2019 at 13:29)</a>:</h4>
<p>The output of the second command is:</p>
<div class="codehilite"><pre><span></span><span class="n">add_ordered_comm_monoid</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u_1</span>
</pre></div>

<a name="167292760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167292760" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167292760">Johan Commelin (Jun 04 2019 at 13:29)</a>:</h4>
<p>/me is <span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span></p>

<a name="167292772"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167292772" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167292772">Johan Commelin (Jun 04 2019 at 13:29)</a>:</h4>
<p>Is there any hope this could be fixed?</p>

<a name="167293105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167293105" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167293105">Chris Hughes (Jun 04 2019 at 13:32)</a>:</h4>
<p>I think for structures you need to just define the second structure separately, and add the attribute afterwards. Also it should be called <code>ordered_add_comm_monoid</code> I think.</p>

<a name="167293213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167293213" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167293213">Johan Commelin (Jun 04 2019 at 13:33)</a>:</h4>
<blockquote>
<p>I think for structures you need to just define the second structure separately, and add the attribute afterwards. Also it should be called <code>ordered_add_comm_monoid</code> I think.</p>
</blockquote>
<p>Ok, I'll rename.</p>

<a name="167293350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167293350" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167293350">Johan Commelin (Jun 04 2019 at 13:34)</a>:</h4>
<p>So... if I add the attribute afterwards... does that match up all those auto-generated things? Or is it ok if those aren't matched up?</p>

<a name="167293414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167293414" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167293414">Chris Hughes (Jun 04 2019 at 13:35)</a>:</h4>
<p>I think so. I guess that's how it works with <code>group</code> and all the other classes.</p>

<a name="167293455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167293455" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167293455">Chris Hughes (Jun 04 2019 at 13:36)</a>:</h4>
<p>It won't match up the auto generated things actually. I misread the question.</p>

<a name="167293758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167293758" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167293758">Johan Commelin (Jun 04 2019 at 13:38)</a>:</h4>
<p>I fear that will cause problems...</p>

<a name="167293919"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167293919" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167293919">Chris Hughes (Jun 04 2019 at 13:39)</a>:</h4>
<p>I think you have to do it by hand.<br>
From <code>algebra/group</code></p>
<div class="codehilite"><pre><span></span><span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_group</span><span class="o">]</span> <span class="n">group</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_group</span><span class="bp">.</span><span class="n">mk</span><span class="o">]</span> <span class="n">group</span><span class="bp">.</span><span class="n">mk</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_group</span><span class="bp">.</span><span class="n">to_has_neg</span><span class="o">]</span> <span class="n">group</span><span class="bp">.</span><span class="n">to_has_inv</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_group</span><span class="bp">.</span><span class="n">to_add_monoid</span><span class="o">]</span> <span class="n">group</span><span class="bp">.</span><span class="n">to_monoid</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_group</span><span class="bp">.</span><span class="n">add_left_neg</span><span class="o">]</span> <span class="n">group</span><span class="bp">.</span><span class="n">mul_left_inv</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_group</span><span class="bp">.</span><span class="n">add</span><span class="o">]</span> <span class="n">group</span><span class="bp">.</span><span class="n">mul</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_group</span><span class="bp">.</span><span class="n">add_assoc</span><span class="o">]</span> <span class="n">group</span><span class="bp">.</span><span class="n">mul_assoc</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_group</span><span class="bp">.</span><span class="n">zero</span><span class="o">]</span> <span class="n">group</span><span class="bp">.</span><span class="n">one</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_group</span><span class="bp">.</span><span class="n">zero_add</span><span class="o">]</span> <span class="n">group</span><span class="bp">.</span><span class="n">one_mul</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_group</span><span class="bp">.</span><span class="n">add_zero</span><span class="o">]</span> <span class="n">group</span><span class="bp">.</span><span class="n">mul_one</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_group</span><span class="bp">.</span><span class="n">neg</span><span class="o">]</span> <span class="n">group</span><span class="bp">.</span><span class="n">inv</span>
</pre></div>

<a name="167294153"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167294153" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167294153">Patrick Massot (Jun 04 2019 at 13:41)</a>:</h4>
<p>Unfortunately, Simon never managed to complete <a href="https://github.com/leanprover-community/mathlib/pull/431" target="_blank" title="https://github.com/leanprover-community/mathlib/pull/431">https://github.com/leanprover-community/mathlib/pull/431</a></p>

<a name="167295711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167295711" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167295711">Johan Commelin (Jun 04 2019 at 13:54)</a>:</h4>
<p>I dumped the output of that print command into a file called <code>test.out</code>.<br>
And then</p>
<div class="codehilite"><pre><span></span>cat test.out<span class="p">|</span> ./to_additive.sh ordered_comm_monoid ordered_add_comm_monoid
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.cases_on<span class="o">]</span> ordered_comm_monoid.cases_on
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.has_sizeof_inst<span class="o">]</span> ordered_comm_monoid.has_sizeof_inst
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.le<span class="o">]</span> ordered_comm_monoid.le
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.le_antisymm<span class="o">]</span> ordered_comm_monoid.le_antisymm
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.le_refl<span class="o">]</span> ordered_comm_monoid.le_refl
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.le_trans<span class="o">]</span> ordered_comm_monoid.le_trans
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.lt<span class="o">]</span> ordered_comm_monoid.lt
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.lt._default<span class="o">]</span> ordered_comm_monoid.lt._default
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.lt._default.equations._eqn_1<span class="o">]</span> ordered_comm_monoid.lt._default.equations._eqn_1
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.lt_iff_le_not_le<span class="o">]</span> ordered_comm_monoid.lt_iff_le_not_le
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.lt_of_mul_lt_mul_left<span class="o">]</span> ordered_comm_monoid.lt_of_mul_lt_mul_left
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.mk<span class="o">]</span> ordered_comm_monoid.mk
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.mk.inj<span class="o">]</span> ordered_comm_monoid.mk.inj
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.mk.inj_arrow<span class="o">]</span> ordered_comm_monoid.mk.inj_arrow
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.mk.sizeof_spec<span class="o">]</span> ordered_comm_monoid.mk.sizeof_spec
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.mul<span class="o">]</span> ordered_comm_monoid.mul
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.mul_assoc<span class="o">]</span> ordered_comm_monoid.mul_assoc
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.mul_comm<span class="o">]</span> ordered_comm_monoid.mul_comm
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.mul_le_mul_left<span class="o">]</span> ordered_comm_monoid.mul_le_mul_left
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.mul_one<span class="o">]</span> ordered_comm_monoid.mul_one
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.no_confusion<span class="o">]</span> ordered_comm_monoid.no_confusion
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.no_confusion_type<span class="o">]</span> ordered_comm_monoid.no_confusion_type
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.one<span class="o">]</span> ordered_comm_monoid.one
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.one_mul<span class="o">]</span> ordered_comm_monoid.one_mul
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.rec<span class="o">]</span> ordered_comm_monoid.rec
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.rec_on<span class="o">]</span> ordered_comm_monoid.rec_on
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.sizeof<span class="o">]</span> ordered_comm_monoid.sizeof
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.to_comm_monoid<span class="o">]</span> ordered_comm_monoid.to_comm_monoid
attribute <span class="o">[</span>to_additive ordered_add_comm_monoid.to_partial_order<span class="o">]</span> ordered_comm_monoid.to_partial_order
</pre></div>

<a name="167295768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167295768" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167295768">Johan Commelin (Jun 04 2019 at 13:55)</a>:</h4>
<div class="codehilite"><pre><span></span>cat to_additive.sh
<span class="c1">#!/bin/bash</span>

<span class="nv">MUL</span><span class="o">=</span><span class="nv">$1</span>
<span class="nv">ADD</span><span class="o">=</span><span class="nv">$2</span>

grep <span class="s2">&quot;^</span><span class="nv">$MUL</span><span class="s2">&quot;</span> <span class="p">|</span> sed <span class="s2">&quot;/</span><span class="nv">$MUL</span><span class="s2"> : .*/d;s/</span><span class="nv">$MUL</span><span class="s2">.\([^ ]*\) : .*/attribute [to_additive </span><span class="nv">$ADD</span><span class="s2">.\1] </span><span class="nv">$MUL</span><span class="s2">.\1/&quot;</span>
</pre></div>

<a name="167295825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167295825" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167295825">Johan Commelin (Jun 04 2019 at 13:55)</a>:</h4>
<p>That might be a snippet that we want to keep around as long as <code>to_additive</code> doesn't do this by itself.</p>

<a name="167296030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167296030" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167296030">Johan Commelin (Jun 04 2019 at 13:57)</a>:</h4>
<p>Except that it is hopelessly broken <span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span> I need recursion.</p>

<a name="167296045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167296045" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167296045">Johan Commelin (Jun 04 2019 at 13:57)</a>:</h4>
<p>This is certainly not a stable approach</p>

<a name="167303161"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167303161" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167303161">Mario Carneiro (Jun 04 2019 at 15:04)</a>:</h4>
<p>I tried setting up <code>to_additive</code> to do this automatically, but it's too slow</p>

<a name="167303197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167303197" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167303197">Mario Carneiro (Jun 04 2019 at 15:05)</a>:</h4>
<p><code>#print prefix</code> is about as fast as printing all definitions in the environment</p>

<a name="167318226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167318226" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167318226">Johan Commelin (Jun 04 2019 at 17:41)</a>:</h4>
<p>That is really very sad...<br>
Can we have <code>to_additive?</code> that will trace the block of <code>to_additive</code> statements?<br>
It would be quite helpful, I guess.</p>

<a name="167367501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167367501" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167367501">Johan Commelin (Jun 05 2019 at 08:23)</a>:</h4>
<p>This example has been posted many times:</p>
<div class="codehilite"><pre><span></span><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">semigroup</span><span class="bp">._</span><span class="n">proof_1</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span>
<span class="n">term</span>
  <span class="bp">_</span><span class="n">inst_1</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">add_semigroup</span> <span class="n">α</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">semigroup</span> <span class="n">α</span>
</pre></div>

<a name="167367520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167367520" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167367520">Johan Commelin (Jun 05 2019 at 08:23)</a>:</h4>
<p>My question is: what is <code>semigroup._proof_1</code>?</p>

<a name="167367544"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167367544" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167367544">Johan Commelin (Jun 05 2019 at 08:23)</a>:</h4>
<p>If I try to <code>#print</code> it, I get <code>unknown identifier semigroup._proof_1</code>.</p>

<a name="167368315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167368315" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167368315">Sebastian Ullrich (Jun 05 2019 at 08:35)</a>:</h4>
<p>It's a proof abstracted (extracted) from a definition</p>

<a name="167368451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167368451" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167368451">Sebastian Ullrich (Jun 05 2019 at 08:37)</a>:</h4>
<p>This is done for all "non-trivial" proofs (i.e. terms of type <code>Prop</code>) inside a definition</p>

<a name="167368463"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167368463" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167368463">Johan Commelin (Jun 05 2019 at 08:37)</a>:</h4>
<p>But it's not a "known identifier"</p>

<a name="167368574"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167368574" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167368574">Sebastian Ullrich (Jun 05 2019 at 08:39)</a>:</h4>
<p>Yes, it's a hidden auxiliary definition. Users are not supposed to interact with it, though I suppose meta programs may still have to.</p>

<a name="167368710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167368710" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167368710">Johan Commelin (Jun 05 2019 at 08:41)</a>:</h4>
<p><code>to_additive</code> has a hard time interacting with it...<br>
I can't write</p>
<div class="codehilite"><pre><span></span><span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_semigroup</span><span class="bp">._</span><span class="n">proof_1</span><span class="o">]</span> <span class="n">semigroup</span><span class="bp">._</span><span class="n">proof_1</span>
</pre></div>

<a name="167383041"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/167383041" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#167383041">Mario Carneiro (Jun 05 2019 at 12:29)</a>:</h4>
<p>You should be able to see the definition. Possibly the error is causing the theorem to not be generated in the first place</p>

<a name="171677632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/171677632" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#171677632">Kevin Buzzard (Jul 25 2019 at 09:55)</a>:</h4>
<p>I think it would be great to have a <code>to_additive</code> thing. There has been some talk about this recently. The current system is a bore:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">group</span><span class="bp">.</span><span class="n">to_additive</span>

<span class="kn">structure</span> <span class="n">monoid_hom</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">N</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">N</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">to_fun</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→</span> <span class="n">N</span><span class="o">)</span>
<span class="o">(</span><span class="n">map_one</span> <span class="o">:</span> <span class="n">to_fun</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span>
<span class="o">(</span><span class="n">map_mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">to_fun</span> <span class="o">(</span><span class="n">x</span> <span class="bp">*</span> <span class="n">y</span><span class="o">)</span> <span class="bp">=</span> <span class="n">to_fun</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">to_fun</span> <span class="n">y</span><span class="o">)</span>

<span class="kn">infixr</span> <span class="bp">`</span> <span class="bp">→*</span> <span class="bp">`</span><span class="o">:</span><span class="mi">25</span> <span class="o">:=</span> <span class="n">monoid_hom</span>

<span class="kn">structure</span> <span class="n">add_monoid_hom</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">N</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">add_monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">add_monoid</span> <span class="n">N</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">to_fun</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→</span> <span class="n">N</span><span class="o">)</span>
<span class="o">(</span><span class="n">map_zero</span> <span class="o">:</span> <span class="n">to_fun</span> <span class="mi">0</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span>
<span class="o">(</span><span class="n">map_add</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">to_fun</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">y</span><span class="o">)</span> <span class="bp">=</span> <span class="n">to_fun</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">to_fun</span> <span class="n">y</span><span class="o">)</span>

<span class="kn">infixr</span> <span class="bp">`</span> <span class="bp">→+</span> <span class="bp">`</span><span class="o">:</span><span class="mi">25</span> <span class="o">:=</span> <span class="n">add_monoid_hom</span>

<span class="c1">-- #print prefix monoid_hom says this is everything (I think; it was generated manually)</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_monoid_hom</span><span class="o">]</span> <span class="n">monoid_hom</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_monoid_hom</span><span class="bp">.</span><span class="n">cases_on</span><span class="o">]</span> <span class="n">monoid_hom</span><span class="bp">.</span><span class="n">cases_on</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_monoid_hom</span><span class="bp">.</span><span class="n">has_sizeof_inst</span><span class="o">]</span> <span class="n">monoid_hom</span><span class="bp">.</span><span class="n">has_sizeof_inst</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_monoid_hom</span><span class="bp">.</span><span class="n">map_add</span><span class="o">]</span> <span class="n">monoid_hom</span><span class="bp">.</span><span class="n">map_mul</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_monoid_hom</span><span class="bp">.</span><span class="n">map_zero</span><span class="o">]</span> <span class="n">monoid_hom</span><span class="bp">.</span><span class="n">map_one</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_monoid_hom</span><span class="bp">.</span><span class="n">mk</span><span class="o">]</span> <span class="n">monoid_hom</span><span class="bp">.</span><span class="n">mk</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_monoid_hom</span><span class="bp">.</span><span class="n">mk</span><span class="bp">.</span><span class="n">inj</span><span class="o">]</span> <span class="n">monoid_hom</span><span class="bp">.</span><span class="n">mk</span><span class="bp">.</span><span class="n">inj</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_monoid_hom</span><span class="bp">.</span><span class="n">mk</span><span class="bp">.</span><span class="n">inj_arrow</span><span class="o">]</span> <span class="n">monoid_hom</span><span class="bp">.</span><span class="n">mk</span><span class="bp">.</span><span class="n">inj_arrow</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_monoid_hom</span><span class="bp">.</span><span class="n">mk</span><span class="bp">.</span><span class="n">inj_eq</span><span class="o">]</span> <span class="n">monoid_hom</span><span class="bp">.</span><span class="n">mk</span><span class="bp">.</span><span class="n">inj_eq</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_monoid_hom</span><span class="bp">.</span><span class="n">mk</span><span class="bp">.</span><span class="n">sizeof_spec</span><span class="o">]</span> <span class="n">monoid_hom</span><span class="bp">.</span><span class="n">mk</span><span class="bp">.</span><span class="n">sizeof_spec</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_monoid_hom</span><span class="bp">.</span><span class="n">no_confusion</span><span class="o">]</span> <span class="n">monoid_hom</span><span class="bp">.</span><span class="n">no_confusion</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_monoid_hom</span><span class="bp">.</span><span class="n">no_confusion_type</span><span class="o">]</span> <span class="n">monoid_hom</span><span class="bp">.</span><span class="n">no_confusion_type</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_monoid_hom</span><span class="bp">.</span><span class="n">rec</span><span class="o">]</span> <span class="n">monoid_hom</span><span class="bp">.</span><span class="n">rec</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_monoid_hom</span><span class="bp">.</span><span class="n">rec_on</span><span class="o">]</span> <span class="n">monoid_hom</span><span class="bp">.</span><span class="n">rec_on</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_monoid_hom</span><span class="bp">.</span><span class="n">sizeof</span><span class="o">]</span> <span class="n">monoid_hom</span><span class="bp">.</span><span class="n">sizeof</span>
<span class="n">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="n">add_monoid_hom</span><span class="bp">.</span><span class="n">to_fun</span><span class="o">]</span> <span class="n">monoid_hom</span><span class="bp">.</span><span class="n">to_fun</span>

<span class="kn">namespace</span> <span class="n">monoid_hom</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">N</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">N</span><span class="o">]</span>

<span class="bp">@</span><span class="o">[</span><span class="n">to_additive</span> <span class="n">add_monoid_hom</span><span class="bp">.</span><span class="n">id</span><span class="o">]</span> <span class="c1">-- the line causing the problem</span>
<span class="n">def</span> <span class="n">id</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→*</span> <span class="n">M</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">to_fun</span> <span class="o">:=</span> <span class="n">id</span><span class="o">,</span>
  <span class="n">map_one</span> <span class="o">:=</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">map_mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">,</span> <span class="n">rfl</span> <span class="o">}</span>
<span class="c">/-</span><span class="cm"></span>
<span class="cm">type mismatch at application</span>
<span class="cm">  id._proof_1 M _inst_3</span>
<span class="cm">term</span>
<span class="cm">  _inst_3</span>
<span class="cm">has type</span>
<span class="cm">  add_monoid M</span>
<span class="cm">but is expected to have type</span>
<span class="cm">  monoid M</span>
<span class="cm">-/</span>

  <span class="kn">end</span> <span class="n">monoid_hom</span>
</pre></div>


<p>Can I just not expect definitions to work automatically? I don't know how to debug the error. Does it just say "you can't do this -- you're going to have to make that definition manually and then do another bunch of <code>to_additive </code>stuff"?</p>

<a name="174455045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/174455045" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#174455045">Johan Commelin (Aug 29 2019 at 13:44)</a>:</h4>
<p><span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span> Thanks for you amazing work. One little issue:<br>
<a href="https://github.com/leanprover-community/mathlib/blob/c5128756d54f1f5207da88c6509647bbf1c57c2c/src/topology/algebra/open_subgroup.lean#L122" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/c5128756d54f1f5207da88c6509647bbf1c57c2c/src/topology/algebra/open_subgroup.lean#L122">https://github.com/leanprover-community/mathlib/blob/c5128756d54f1f5207da88c6509647bbf1c57c2c/src/topology/algebra/open_subgroup.lean#L122</a><br>
When I write <code>V.prod</code>, it says</p>
<div class="codehilite"><pre><span></span>/home/jmc/data/math/lean-perfectoid-spaces/src/for_mathlib/nonarchimedean/basic.lean:101:10: error:
invalid field notation, &#39;prod&#39; is not a valid &quot;field&quot; because environment does not contain &#39;open_add_subgroup.prod&#39;
</pre></div>

<a name="174455436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/174455436" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#174455436">Johan Commelin (Aug 29 2019 at 13:49)</a>:</h4>
<p>I'm not sure where <code>open_add_subgroup.prod</code> went.</p>

<a name="174455472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/174455472" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#174455472">Johan Commelin (Aug 29 2019 at 13:50)</a>:</h4>
<p>Aaah! The auto-naming turned <code>prod</code> into <code>sum</code>.</p>

<a name="174455522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/174455522" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#174455522">Johan Commelin (Aug 29 2019 at 13:50)</a>:</h4>
<p>I'm not sure if that is what we want here.</p>

<a name="174455601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/174455601" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#174455601">Patrick Massot (Aug 29 2019 at 13:51)</a>:</h4>
<p>Can't you state by hand the additive translation and tag it afterwards?</p>

<a name="174455636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/174455636" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#174455636">Patrick Massot (Aug 29 2019 at 13:51)</a>:</h4>
<p>I sometimes do that when <code>to_additive</code> transform <code>x*y⁻¹</code> into <code>x + -y</code> instead of <code>x-y</code></p>

<a name="174456064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/174456064" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#174456064">Johan Commelin (Aug 29 2019 at 13:56)</a>:</h4>
<p>I need to relearn how to use it (-;</p>

<a name="174456076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/174456076" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#174456076">Johan Commelin (Aug 29 2019 at 13:56)</a>:</h4>
<p>How do I pass it a name nowadays?</p>

<a name="174456270"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/174456270" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#174456270">Johan Commelin (Aug 29 2019 at 13:58)</a>:</h4>
<p>If I just type something after <code>to_additive</code> I get the following warning:</p>
<div class="codehilite"><pre><span></span>`to_additive topological_group.nhds_translation_mul_inv_left`: remove `name` argument
</pre></div>

<a name="174456291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/174456291" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#174456291">Johan Commelin (Aug 29 2019 at 13:58)</a>:</h4>
<p>Coming from the following code:</p>
<div class="codehilite"><pre><span></span>@[to_additive nhds_translation_add_neg_left]
lemma nhds_translation_mul_inv_left (g : G) :
</pre></div>

<a name="174456339"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/to_additive/near/174456339" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/21549toadditive.html#174456339">Patrick Massot (Aug 29 2019 at 13:59)</a>:</h4>
<p>The commit message from <a href="https://github.com/leanprover-community/mathlib/commit/c5128756d54f1f5207da88c6509647bbf1c57c2c" target="_blank" title="https://github.com/leanprover-community/mathlib/commit/c5128756d54f1f5207da88c6509647bbf1c57c2c">https://github.com/leanprover-community/mathlib/commit/c5128756d54f1f5207da88c6509647bbf1c57c2c</a> is not very encouraging</p>


{% endraw %}

{% include archive_update.html %}