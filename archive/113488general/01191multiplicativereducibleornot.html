---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/01191multiplicativereducibleornot.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html">`multiplicative`: reducible or not?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="192215609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192215609" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192215609">Yury G. Kudryashov (Mar 30 2020 at 06:31)</a>:</h4>
<p>I started playing with the possibility to make <code>multiplicative</code> irreducible. What pros and cons I see:</p>
<ul>
<li>without <code>irreducible</code> it's much easier to define structures / transport theorems;</li>
<li>with <code>irreducible</code> it should be easier to deal with specific types like <code>multiplicative nat</code> without guessing "does this <code>*</code> mean multiplication or addition?"</li>
</ul>
<p>Another possibility is to define <code>to_mul</code>, <code>of_mul</code>, <code>to_add</code>, <code>of_add</code>, use them in definitions but don't make type tags irreducible.</p>
<p>What do you think? Will it work?</p>

<a name="192215708"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192215708" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192215708">Mario Carneiro (Mar 30 2020 at 06:33)</a>:</h4>
<p>The reason I originally wrote <code>multiplicative</code> was so that I could do proofs like this one from <code>group_power</code>:</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">pow_mul_comm&#39;</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">M</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span><span class="err">^</span><span class="n">n</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">a</span><span class="err">^</span><span class="n">n</span> <span class="o">:=</span> <span class="bp">...</span>
<span class="kn">theorem</span> <span class="n">smul_add_comm&#39;</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="n">n</span><span class="err">•</span><span class="n">a</span> <span class="bp">+</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">n</span><span class="err">•</span><span class="n">a</span> <span class="o">:=</span>
<span class="bp">@</span><span class="n">pow_mul_comm&#39;</span> <span class="o">(</span><span class="n">multiplicative</span> <span class="n">A</span><span class="o">)</span> <span class="bp">_</span>
</pre></div>

<a name="192215722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192215722" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192215722">Mario Carneiro (Mar 30 2020 at 06:33)</a>:</h4>
<p>making <code>multiplicative</code> irreducible will break this proof</p>

<a name="192215804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192215804" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192215804">Mario Carneiro (Mar 30 2020 at 06:34)</a>:</h4>
<p>Note that this is a more efficient way to transfer theorems than what <code>to_additive</code> does, which is to translate the entire proof</p>

<a name="192215820"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192215820" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192215820">Mario Carneiro (Mar 30 2020 at 06:35)</a>:</h4>
<p>this is much closer to what the mathematician would expect; we are applying one theorem to prove the other</p>

<a name="192216045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192216045" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192216045">Mario Carneiro (Mar 30 2020 at 06:39)</a>:</h4>
<p>(The reason making <code>multiplicative</code> irreducible would break this is because we are translating a forall statement; the target theorem has <code>\all (a:A)</code> and the theorem being applied has <code>\all (a:multiplicative A)</code>, so unless <code>A</code> is defeq to <code>multiplicative A</code> this will fail to unify. In that case, we would have to apply a theorem about transferring a forall quantifier a la <code>rel_forall_of_total</code>, and at that point nothing is defeq anymore so you need a tactic to orchestrate the whole thing.)</p>

<a name="192216254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192216254" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192216254">Yury G. Kudryashov (Mar 30 2020 at 06:43)</a>:</h4>
<p>OK, I'm not making it irreducible (at least for now).</p>

<a name="192216266"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192216266" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192216266">Mario Carneiro (Mar 30 2020 at 06:43)</a>:</h4>
<p>That said, this is a rather specific use case, and I don't mind having to be more explicit in order to use <code>multiplicative</code> in this way. I think we might need to hack lean to make this work, but it would be nice if there was a <code>exact_unfolding_irreducible</code> tactic that bypasses the elaborator</p>

<a name="192216469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192216469" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192216469">Yury G. Kudryashov (Mar 30 2020 at 06:47)</a>:</h4>
<p>As far as I understand, the fact that <code>multiplicative</code> is not irreducible stopped <span class="user-mention" data-user-id="110087">@Scott Morrison</span> from using <code>polynomial R := monoid_algebra R (multiplicative nat)</code> instead of <code>polynomial R := add_monoid_algebra R nat</code>.</p>

<a name="192216551"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192216551" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192216551">Yury G. Kudryashov (Mar 30 2020 at 06:48)</a>:</h4>
<p>Probably we should just create an irreducible <code>nat* := multiplicative nat</code>.</p>

<a name="192216632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192216632" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192216632">Yury G. Kudryashov (Mar 30 2020 at 06:50)</a>:</h4>
<p>with <code>mnat.of_nat</code>, <code>mnat.to_nat</code> and <code>simp</code> lemmas.</p>

<a name="192216652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192216652" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192216652">Yury G. Kudryashov (Mar 30 2020 at 06:50)</a>:</h4>
<p>This way there will be no collision between to multiplications on <code>multiplicative nat</code>.</p>

<a name="192216774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192216774" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192216774">Mario Carneiro (Mar 30 2020 at 06:53)</a>:</h4>
<p><code>multiplicative nat</code> does seem to come up a lot</p>

<a name="192216783"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192216783" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192216783">Mario Carneiro (Mar 30 2020 at 06:53)</a>:</h4>
<p>I haven't heard people try to make anything else multiplicative</p>

<a name="192216898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192216898" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192216898">Yury G. Kudryashov (Mar 30 2020 at 06:55)</a>:</h4>
<p><code>mv_polynomial</code> is the monoid algebra of <code>multiplicative (multiset α)</code> (a.k.a. <code>free_comm_monoid α</code>).</p>

<a name="192216987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192216987" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192216987">Mario Carneiro (Mar 30 2020 at 06:56)</a>:</h4>
<p>why not have <code>monoid_algebra</code> take an <code>add_monoid</code>?</p>

<a name="192217024"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192217024" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192217024">Mario Carneiro (Mar 30 2020 at 06:57)</a>:</h4>
<p>I mean, it's supposed to be pretending to be exponents with addition anyway, right?</p>

<a name="192217097"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192217097" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192217097">Yury G. Kudryashov (Mar 30 2020 at 06:58)</a>:</h4>
<p>I prefer to think about it as the monoid of allowed monomials.</p>

<a name="192217238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192217238" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192217238">Yury G. Kudryashov (Mar 30 2020 at 07:00)</a>:</h4>
<p>Then <code>aeval</code> (and <code>eval₂</code>) for an <code>mv_polynomial</code> means the following: first you lift <code>g : σ → M</code> to <code>g' : free_comm_monoid σ →* M</code>, then lift it to an algebra homomorphism.</p>

<a name="192217277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192217277" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192217277">Yury G. Kudryashov (Mar 30 2020 at 07:01)</a>:</h4>
<p>The last step is much more natural if you don't care about the monoid of allowed monomials.</p>

<a name="192217329"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192217329" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192217329">Yury G. Kudryashov (Mar 30 2020 at 07:01)</a>:</h4>
<p>E.g., it will work for quasi-polynomials with monomials <code>x^ne^{ax}</code>.</p>

<a name="192217330"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192217330" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192217330">Johan Commelin (Mar 30 2020 at 07:01)</a>:</h4>
<p>Can we make it <code>irreducible</code> and then locally make it <code>semireducible</code> when we make definitions like Mario's <code>smul_add_monoid</code> example?</p>

<a name="192217430"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192217430" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192217430">Yury G. Kudryashov (Mar 30 2020 at 07:02)</a>:</h4>
<p>More-or-less we want it to be semireducible whenever we transfer definitions / theorems and irreducible whenever we deal with specific types.</p>

<a name="192217437"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192217437" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192217437">Yury G. Kudryashov (Mar 30 2020 at 07:03)</a>:</h4>
<p>Don't know how to achieve this.</p>

<a name="192217538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192217538" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192217538">Johan Commelin (Mar 30 2020 at 07:04)</a>:</h4>
<p>Transferring definitions / theorems happens in bounded parts of files. Whereas applying it to specific types is the "generic" usage. (Even though the applications might be fewer in number.)</p>

<a name="192217565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192217565" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192217565">Johan Commelin (Mar 30 2020 at 07:04)</a>:</h4>
<p>So I would make it <code>irreducible</code> by default, and then make it semireducible in every basic file that uses it to transfer stuff.</p>

<a name="192217576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192217576" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192217576">Johan Commelin (Mar 30 2020 at 07:05)</a>:</h4>
<p>But maybe this is idealistic daydreaming.</p>

<a name="192217693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192217693" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192217693">Yury G. Kudryashov (Mar 30 2020 at 07:06)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> What do you think? Would it work?</p>

<a name="192217731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192217731" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192217731">Mario Carneiro (Mar 30 2020 at 07:07)</a>:</h4>
<p>does that actually work? I've never tried</p>

<a name="192217749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192217749" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192217749">Yury G. Kudryashov (Mar 30 2020 at 07:07)</a>:</h4>
<p>I can try.</p>

<a name="192218220"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192218220" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192218220">Yury G. Kudryashov (Mar 30 2020 at 07:13)</a>:</h4>
<p>Seems to work</p>

<a name="192218337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192218337" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192218337">Yury G. Kudryashov (Mar 30 2020 at 07:15)</a>:</h4>
<p>Partial success...</p>

<a name="192218582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192218582" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192218582">Scott Morrison (Mar 30 2020 at 07:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113488-general/topic/.60multiplicative.60.3A.20reducible.20or.20not.3F/near/192216987" title="#narrow/stream/113488-general/topic/.60multiplicative.60.3A.20reducible.20or.20not.3F/near/192216987">said</a>:</p>
<blockquote>
<p>why not have <code>monoid_algebra</code> take an <code>add_monoid</code>?</p>
</blockquote>
<p>The group ring <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo stretchy="false">[</mo><mi>G</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">k[G]</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">[</span><span class="mord mathdefault">G</span><span class="mclose">]</span></span></span></span> is an essential example of a monoid algebra, which we need to do representation theory, and for which the monoid is certainly multiplicative (and probably non-commutative).</p>

<a name="192218856"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192218856" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192218856">Mario Carneiro (Mar 30 2020 at 07:21)</a>:</h4>
<p>I don't know why everyone thinks it's so important that add_monoids be commutative</p>

<a name="192218887"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192218887" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192218887">Mario Carneiro (Mar 30 2020 at 07:21)</a>:</h4>
<p>it's a group. with a + notation. get over it</p>

<a name="192218953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192218953" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192218953">Mario Carneiro (Mar 30 2020 at 07:22)</a>:</h4>
<p>it would have saved most of the <code>to_additive</code> work</p>

<a name="192219043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219043" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219043">Yury G. Kudryashov (Mar 30 2020 at 07:23)</a>:</h4>
<p><code>monoid_algebra R M</code> takes a multiplicative monoid <code>M</code>, and returns an algebra over <code>R</code>.</p>

<a name="192219050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219050" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219050">Johan Commelin (Mar 30 2020 at 07:23)</a>:</h4>
<p>Mario, in the group algebra you want <code>a * (g * h) = (a * g) * h</code>. The <code>(g * h)</code> is multiplication in the monoid.</p>

<a name="192219160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219160" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219160">Johan Commelin (Mar 30 2020 at 07:24)</a>:</h4>
<p>You also want <code>a * (g + h) = a * g + a * h</code>, but now the <code>+</code> is addition in the algebra.</p>

<a name="192219163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219163" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219163">Mario Carneiro (Mar 30 2020 at 07:24)</a>:</h4>
<p>meh, I have high tolerance for that kind of notational dissonance if it means proofs get shorter</p>

<a name="192219198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219198" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219198">Yury G. Kudryashov (Mar 30 2020 at 07:24)</a>:</h4>
<p>Here is what fails: <a href="https://github.com/leanprover-community/mathlib/runs/544653780" title="https://github.com/leanprover-community/mathlib/runs/544653780">https://github.com/leanprover-community/mathlib/runs/544653780</a></p>

<a name="192219270"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219270" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219270">Yury G. Kudryashov (Mar 30 2020 at 07:25)</a>:</h4>
<p>I define structure on <code>with_top</code> using <code>local attribute [semireducible] multiplicative additive</code>, then it failes to find <code>a + _</code> once section is closed.</p>

<a name="192219355"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219355" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219355">Yury G. Kudryashov (Mar 30 2020 at 07:27)</a>:</h4>
<p>(deleted)</p>

<a name="192219379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219379" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219379">Mario Carneiro (Mar 30 2020 at 07:27)</a>:</h4>
<p>your replacement proof is not correct</p>

<a name="192219440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219440" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219440">Yury G. Kudryashov (Mar 30 2020 at 07:28)</a>:</h4>
<p>The original proof didn't work too.</p>

<a name="192219441"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219441" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219441">Mario Carneiro (Mar 30 2020 at 07:28)</a>:</h4>
<div class="codehilite"><pre><span></span>  lemma with_top.add_lt_add_iff_right
    {a b c : with_top α} : a &lt; ⊤ → (c + a &lt; b + a ↔ c &lt; b) :=
<span class="gd">- by simpa [add_comm] using @with_top.add_lt_add_iff_left _ _ a b c</span>
<span class="gi">+ have _ := @with_top.add_lt_add_iff_left _ _ a b c,</span>
<span class="gi">+ by rwa [add_comm a] at this</span>
</pre></div>

<a name="192219450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219450" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219450">Mario Carneiro (Mar 30 2020 at 07:28)</a>:</h4>
<p>you need to rewrite twice</p>

<a name="192219458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219458" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219458">Yury G. Kudryashov (Mar 30 2020 at 07:28)</a>:</h4>
<p>It fails to rewrite even once</p>

<a name="192219534"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219534" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219534">Mario Carneiro (Mar 30 2020 at 07:29)</a>:</h4>
<p>it's looking for <code>a + ?</code> but the goal has <code>c + a</code> and <code>b + a</code></p>

<a name="192219573"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219573" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219573">Yury G. Kudryashov (Mar 30 2020 at 07:29)</a>:</h4>
<p>It's rewriting at this</p>

<a name="192219576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219576" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219576">Mario Carneiro (Mar 30 2020 at 07:29)</a>:</h4>
<p>oh wait, nvm</p>

<a name="192219707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219707" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219707">Mario Carneiro (Mar 30 2020 at 07:31)</a>:</h4>
<p>what's the problem then? It's not an <code>add_comm_semigroup</code> so I don't see why <code>add_comm</code> should work</p>

<a name="192219731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219731" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219731">Mario Carneiro (Mar 30 2020 at 07:31)</a>:</h4>
<p>I'm a little confused at your setup</p>

<a name="192219887"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219887" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219887">Mario Carneiro (Mar 30 2020 at 07:33)</a>:</h4>
<p>how is <code>multiplicative</code> involved here?</p>

<a name="192219935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192219935" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192219935">Yury G. Kudryashov (Mar 30 2020 at 07:33)</a>:</h4>
<p><code>add_monoid</code> structure on <code>with_top α</code> is defined using a dirty trick.</p>

<a name="192220039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192220039" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192220039">Mario Carneiro (Mar 30 2020 at 07:34)</a>:</h4>
<p>is the dirty trick getting unfolded here?</p>

<a name="192220117"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192220117" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192220117">Yury G. Kudryashov (Mar 30 2020 at 07:35)</a>:</h4>
<p>More precisely: <code>add</code> and <code>zero</code> fields are provided explicitly, but the proofs come from <code>with_zero.semigroup</code> etc.</p>

<a name="192220130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192220130" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192220130">Yury G. Kudryashov (Mar 30 2020 at 07:35)</a>:</h4>
<p>Same file, around line 220</p>

<a name="192220212"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192220212" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192220212">Mario Carneiro (Mar 30 2020 at 07:36)</a>:</h4>
<p>I think this instance is wrong:</p>
<div class="codehilite"><pre><span></span><span class="kn">instance</span> <span class="o">[</span><span class="n">add_comm_semigroup</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">add_comm_semigroup</span> <span class="o">(</span><span class="n">with_top</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="bp">..@</span><span class="n">additive</span><span class="bp">.</span><span class="n">add_comm_semigroup</span> <span class="bp">_</span> <span class="err">$</span>
    <span class="bp">@</span><span class="n">with_zero</span><span class="bp">.</span><span class="n">comm_semigroup</span> <span class="o">(</span><span class="n">multiplicative</span> <span class="n">α</span><span class="o">)</span> <span class="bp">_</span> <span class="o">}</span>
</pre></div>

<a name="192220244"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192220244" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192220244">Mario Carneiro (Mar 30 2020 at 07:36)</a>:</h4>
<p>It should be like the monoid instance after it</p>
<div class="codehilite"><pre><span></span><span class="kn">instance</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">add_comm_monoid</span> <span class="o">(</span><span class="n">with_top</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">zero</span> <span class="o">:=</span> <span class="mi">0</span><span class="o">,</span>
  <span class="n">add</span> <span class="o">:=</span> <span class="o">(</span><span class="bp">+</span><span class="o">),</span>
  <span class="bp">..@</span><span class="n">additive</span><span class="bp">.</span><span class="n">add_comm_monoid</span> <span class="bp">_</span> <span class="err">$</span>
    <span class="bp">@</span><span class="n">with_zero</span><span class="bp">.</span><span class="n">comm_monoid</span> <span class="o">(</span><span class="n">multiplicative</span> <span class="n">α</span><span class="o">)</span> <span class="bp">_</span> <span class="o">}</span>
</pre></div>

<a name="192220287"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192220287" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192220287">Mario Carneiro (Mar 30 2020 at 07:37)</a>:</h4>
<p>that way, when the instance gets unfolded you get <code>0</code> and <code>+</code> instead of <code>@1 (multiplicative _)</code></p>

<a name="192220313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192220313" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192220313">Yury G. Kudryashov (Mar 30 2020 at 07:37)</a>:</h4>
<p>Thank you!!</p>

<a name="192224744"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192224744" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192224744">Kevin Buzzard (Mar 30 2020 at 08:25)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> said:</p>
<blockquote>
<p>I don't know why everyone thinks it's so important that add_monoids be commutative</p>
</blockquote>
<p>This is about notation. Mathematicians have got a highly sophisticated notational set-up with various conventions many of which you have never even seen because they are domain specific -- and some of which conflict with each other ( eg <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span></span></span></span> is a projection for an algebraic geometer and a real number for a harmonic analyst). Ordinals are not part of "generic mathematics" (my current attempt at the description of analysis, topology, geometry etc) and this is the only reason that addition is allowed to be noncommutative in this case -- because we don't care what logicians want to do with ordinals. Addition is commutative by universal convention (or domain convention where the domain is generic mathematics) and it's an extremely useful one from where I'm sitting even if it gets in the way of foundational set-ups. That's why addition is commutative, because it's useful.</p>

<a name="192224837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192224837" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192224837">Mario Carneiro (Mar 30 2020 at 08:26)</a>:</h4>
<p>We're also writing in unicode and not rendered latex. Sometimes you have to make concessions to the machine</p>

<a name="192224909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192224909" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192224909">Mario Carneiro (Mar 30 2020 at 08:27)</a>:</h4>
<p>there are a hundred ways lean falls short of human maths</p>

<a name="192224979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192224979" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192224979">Mario Carneiro (Mar 30 2020 at 08:28)</a>:</h4>
<p>to me, using <code>+</code> for groups is the least of my worries</p>

<a name="192225035"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192225035" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192225035">Yury G. Kudryashov (Mar 30 2020 at 08:29)</a>:</h4>
<p>It causes troubles when you have both <code>+</code> and <code>*</code>, or even worse two <code>*</code> (one from <code>multiplicative</code>, one from original semiring).</p>

<a name="192225052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192225052" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192225052">Kevin Buzzard (Mar 30 2020 at 08:29)</a>:</h4>
<p>Rings are a thing</p>

<a name="192225104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192225104" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192225104">Kevin Buzzard (Mar 30 2020 at 08:29)</a>:</h4>
<p>(deleted)</p>

<a name="192225163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192225163" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192225163">Yury G. Kudryashov (Mar 30 2020 at 08:30)</a>:</h4>
<p>fixed</p>

<a name="192225267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192225267" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192225267">Mario Carneiro (Mar 30 2020 at 08:31)</a>:</h4>
<p>I maintain that the to_additive problem would be a lot simpler if group theory were done with <code>+</code> and <code>ring A</code> extended <code>group A</code> and <code>monoid (multiplicative A)</code></p>

<a name="192225295"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192225295" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192225295">Mario Carneiro (Mar 30 2020 at 08:31)</a>:</h4>
<p>unfortunately it's tricky to make this kind of setup work in lean</p>

<a name="192225404"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192225404" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192225404">Kevin Buzzard (Mar 30 2020 at 08:32)</a>:</h4>
<p>Then you'd have two conflicting monoid structures on equal types</p>

<a name="192225418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192225418" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192225418">Kevin Buzzard (Mar 30 2020 at 08:33)</a>:</h4>
<p>Is that ok?</p>

<a name="192225428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192225428" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192225428">Mario Carneiro (Mar 30 2020 at 08:33)</a>:</h4>
<p>they are different types</p>

<a name="192225445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192225445" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192225445">Kevin Buzzard (Mar 30 2020 at 08:33)</a>:</h4>
<p>Sure but they're <code>eq</code> aren't they?</p>

<a name="192225534"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192225534" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192225534">Kevin Buzzard (Mar 30 2020 at 08:34)</a>:</h4>
<p>You will certainly need to be able to transport terms from one to the other</p>

<a name="192225596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192225596" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192225596">Mario Carneiro (Mar 30 2020 at 08:34)</a>:</h4>
<p>It could be a newtype or irreducible synonym like Yury suggested</p>

<a name="192225679"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192225679" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192225679">Mario Carneiro (Mar 30 2020 at 08:35)</a>:</h4>
<p>and then you would define <code>a * b = of_mult (to_mult a + to_mult b)</code></p>

<a name="192225782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192225782" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192225782">Yury G. Kudryashov (Mar 30 2020 at 08:36)</a>:</h4>
<p>Then you need to transfer all group theory to this <code>(*)</code>.</p>

<a name="192226000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192226000" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192226000">Mario Carneiro (Mar 30 2020 at 08:39)</a>:</h4>
<p>not all of it, just the calculational lemmas</p>

<a name="192226103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192226103" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192226103">Mario Carneiro (Mar 30 2020 at 08:40)</a>:</h4>
<p>and you can limit yourself to rings</p>

<a name="192226116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192226116" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192226116">Mario Carneiro (Mar 30 2020 at 08:40)</a>:</h4>
<p>or whatever the weakest +/* structure is</p>

<a name="192226126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192226126" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192226126">Mario Carneiro (Mar 30 2020 at 08:40)</a>:</h4>
<p>semirings</p>

<a name="192226163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192226163" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192226163">Mario Carneiro (Mar 30 2020 at 08:40)</a>:</h4>
<p>(I'm actually just describing how this is done in metamath)</p>

<a name="192226258"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192226258" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192226258">Mario Carneiro (Mar 30 2020 at 08:41)</a>:</h4>
<p>you don't need the of_mult and to_mult functions there though, which makes the theorems a literal application of the corresponding group theorem</p>

<a name="192226364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192226364" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192226364">Mario Carneiro (Mar 30 2020 at 08:42)</a>:</h4>
<p>much like the <code>@foo (multiplicative _)</code> transfer theorems I mentioned at the start</p>

<a name="192226487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192226487" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192226487">Yury G. Kudryashov (Mar 30 2020 at 08:44)</a>:</h4>
<p>Can <code>structure ... extends</code> rename fields?</p>

<a name="192226522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192226522" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192226522">Mario Carneiro (Mar 30 2020 at 08:45)</a>:</h4>
<p>that's a good question. I was going to say no but I recall <code>renaming</code> coming up somewhere</p>

<a name="192226629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192226629" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192226629">Mario Carneiro (Mar 30 2020 at 08:46)</a>:</h4>
<p>Using an "old style" structure, it is trivial to do so since you are unpacking all the fields and reassembling them</p>

<a name="192226652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192226652" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192226652">Mario Carneiro (Mar 30 2020 at 08:46)</a>:</h4>
<p>but I think right now lean always tries to merge fields with the same name</p>

<a name="192226794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192226794" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192226794">Gabriel Ebner (Mar 30 2020 at 08:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="214703">Yury G. Kudryashov</span> <a href="#narrow/stream/113488-general/topic/.60multiplicative.60.3A.20reducible.20or.20not.3F/near/192215609" title="#narrow/stream/113488-general/topic/.60multiplicative.60.3A.20reducible.20or.20not.3F/near/192215609">said</a>:</p>
<blockquote>
<p>I started playing with the possibility to make <code>multiplicative</code> irreducible. What pros and cons I see:</p>
</blockquote>
<p>Another pro of making <code>multiplicative</code> irreducible is that the current <code>multiplicative</code> setup (and also <code>order_dual</code>) causes lots of issues with typeclasses (we've had to remove a lot of instances for <code>multiplicative</code> in the 3.7 migration because they loop) and the simplifier (e.g. <a href="https://github.com/leanprover-community/mathlib/issues/2026" title="https://github.com/leanprover-community/mathlib/issues/2026">#2026</a>).  The common theme is that with <code>multiplicative</code>, you ask Lean one the hand to treat a term <code>a : α</code> as having the type <code>multiplicative α</code> while on the other hand rely on Lean not to unify <code>α</code> and <code>multiplicative α</code>.  This seems to be mutually exclusive in practice.<br>
Even if <code>multiplicative</code> is not made irreducible, at the very least we should use explicit coercions from <code>α</code> to <code>multiplicative α</code>, so that the terms type-check without unfolding <code>multiplicative</code>.</p>

<a name="192227010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192227010" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192227010">Yury G. Kudryashov (Mar 30 2020 at 08:50)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">structure</span> <span class="n">ring2</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">monoid</span> <span class="n">α</span><span class="o">,</span> <span class="n">group</span> <span class="o">(</span><span class="n">multiplicative</span> <span class="n">α</span><span class="o">)</span>
  <span class="kn">renaming</span> <span class="n">mul</span> <span class="bp">-&gt;</span> <span class="n">add&#39;</span> <span class="n">mul_assoc</span> <span class="bp">-&gt;</span> <span class="n">add_assoc&#39;</span> <span class="n">one</span> <span class="bp">-&gt;</span> <span class="n">zero&#39;</span> <span class="n">one_mul</span> <span class="bp">-&gt;</span> <span class="n">zero_add&#39;</span> <span class="n">mul_one</span> <span class="bp">-&gt;</span> <span class="n">add_zero&#39;</span>
</pre></div>


<p>compiles. Didn't try to use it.</p>

<a name="192227239"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192227239" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192227239">Yury G. Kudryashov (Mar 30 2020 at 08:53)</a>:</h4>
<p>It's <code>add'</code> because <code>add x y = of_mult (add' (to_mult x) (to_mult y))</code></p>

<a name="192227366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192227366" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192227366">Yury G. Kudryashov (Mar 30 2020 at 08:54)</a>:</h4>
<p>What are the downsides of this approach?</p>

<a name="192227805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192227805" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192227805">Mario Carneiro (Mar 30 2020 at 08:58)</a>:</h4>
<p>Probably the defeq for <code>add'</code> is not nice in concrete situations</p>

<a name="192228410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192228410" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192228410">Yury G. Kudryashov (Mar 30 2020 at 09:05)</a>:</h4>
<p>Could you please explain?</p>

<a name="192228774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192228774" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192228774">Mario Carneiro (Mar 30 2020 at 09:09)</a>:</h4>
<p>When giving a ring structure on e.g. <code>int</code>, you will have to provide <code>add'</code>, which you will presumably do like <code>add' := \fun mx my, to_mult (int.add mx.1 my.1)</code>. Now <code>add x y</code> will be <code>of_mult (to_mult (int.add (to_mult x).1 (to_mult y).1))</code> which is defeq to <code>of_mult (to_mult (int.add x y))</code></p>

<a name="192228889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60multiplicative%60%3A%20reducible%20or%20not%3F/near/192228889" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/01191multiplicativereducibleornot.html#192228889">Mario Carneiro (Mar 30 2020 at 09:10)</a>:</h4>
<p>as long as both <code>of_mult (to_mult x) = x</code> and <code>to_mult (of_mult x) = x</code> are defeq it works out, but a newtype structure doesn't have that</p>


{% endraw %}

{% include archive_update.html %}