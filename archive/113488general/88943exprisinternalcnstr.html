---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/88943exprisinternalcnstr.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/88943exprisinternalcnstr.html">expr.is_internal_cnstr</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="135479383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/expr.is_internal_cnstr/near/135479383" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88943exprisinternalcnstr.html#135479383">Edward Ayers (Oct 09 2018 at 15:52)</a>:</h4>
<p>What does <code>expr.is_internal_cnstr</code> do?</p>

<a name="135479414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/expr.is_internal_cnstr/near/135479414" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88943exprisinternalcnstr.html#135479414">Edward Ayers (Oct 09 2018 at 15:53)</a>:</h4>
<p>I've fiddled around with it but I can't get it to return anything except <code>none</code>.</p>

<a name="135479658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/expr.is_internal_cnstr/near/135479658" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88943exprisinternalcnstr.html#135479658">Edward Ayers (Oct 09 2018 at 15:57)</a>:</h4>
<p>In the C++ it looks like it's just checking if the expr is a constant and checking that the name of the constant ends with <code>_cnstr</code>. What would be an example of that?</p>

<a name="135480278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/expr.is_internal_cnstr/near/135480278" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88943exprisinternalcnstr.html#135480278">Edward Ayers (Oct 09 2018 at 16:07)</a>:</h4>
<p>Also <code>get_nat_value</code>, extracts a nat from a "nat value macro". But I can't see where nat value macros are used.</p>

<a name="135480811"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/expr.is_internal_cnstr/near/135480811" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88943exprisinternalcnstr.html#135480811">Edward Ayers (Oct 09 2018 at 16:16)</a>:</h4>
<p>What do I need to do to get rid of the <code>failed to synthesize type class instance for ⊢ reflected e</code> error?</p>
<div class="codehilite"><pre><span></span><span class="n">universes</span> <span class="n">u</span> <span class="n">v</span>
<span class="n">def</span> <span class="n">e</span> <span class="o">:=</span> <span class="bp">Π</span> <span class="n">a</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">,</span> <span class="bp">Π</span> <span class="n">b</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">,</span> <span class="n">a</span> <span class="bp">×</span> <span class="n">b</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">e</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="n">to_string</span> <span class="err">$</span> <span class="n">expr</span><span class="bp">.</span><span class="n">collect_univ_params</span> <span class="err">$</span> <span class="bp">`</span><span class="o">(</span><span class="n">e</span><span class="o">)</span>
</pre></div>

<a name="135493468"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/expr.is_internal_cnstr/near/135493468" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88943exprisinternalcnstr.html#135493468">Simon Hudon (Oct 09 2018 at 19:43)</a>:</h4>
<p>I think <code>is_internal_cnstr</code> will rarely give you an answer. When it does, your expression will likely give you a bunch of trouble and that's why I wrote <code>tactic.pis</code> in mathlib to replace <code>expr.pis</code>.</p>

<a name="135493562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/expr.is_internal_cnstr/near/135493562" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88943exprisinternalcnstr.html#135493562">Simon Hudon (Oct 09 2018 at 19:45)</a>:</h4>
<blockquote>
<p>What do I need to do to get rid of the <code>failed to synthesize type class instance for ⊢ reflected e</code> error?</p>
<div class="codehilite"><pre><span></span><span class="n">universes</span> <span class="n">u</span> <span class="n">v</span>
<span class="n">def</span> <span class="n">e</span> <span class="o">:=</span> <span class="bp">Π</span> <span class="n">a</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">,</span> <span class="bp">Π</span> <span class="n">b</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">,</span> <span class="n">a</span> <span class="bp">×</span> <span class="n">b</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">e</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="n">to_string</span> <span class="err">$</span> <span class="n">expr</span><span class="bp">.</span><span class="n">collect_univ_params</span> <span class="err">$</span> <span class="bp">`</span><span class="o">(</span><span class="n">e</span><span class="o">)</span>
</pre></div>


</blockquote>
<p>I don't know if there is a <code>reflected</code> instance for types in general. You may have to go through <code>to_expr</code></p>


{% endraw %}

{% include archive_update.html %}