---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/70566visualizations.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html">visualizations</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="177675847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177675847" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177675847">Daniel Selsam (Oct 09 2019 at 02:00)</a>:</h4>
<p>Here is a visualization of the Mathlib instance graph, courtesy of <span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> :<br>
<a href="/user_uploads/3121/dDiHJfmKIDWc1DZ89USvowFl/mathlib_instances_alt3.png" target="_blank" title="mathlib_instances_alt3.png">mathlib_instances_alt3.png</a> <br>
There are many visualization parameters that we haven't gotten to experiment with yet.</p>
<div class="message_inline_image"><a href="/user_uploads/3121/dDiHJfmKIDWc1DZ89USvowFl/mathlib_instances_alt3.png" target="_blank" title="mathlib_instances_alt3.png"><img src="/user_uploads/3121/dDiHJfmKIDWc1DZ89USvowFl/mathlib_instances_alt3.png"></a></div>

<a name="177676265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177676265" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177676265">Mario Carneiro (Oct 09 2019 at 02:11)</a>:</h4>
<p>that is cool for reasons entirely unrelated to the mathlib instance hierarchy</p>

<a name="177693906"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177693906" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177693906">Rob Lewis (Oct 09 2019 at 08:51)</a>:</h4>
<p>These never got posted to a public channel here, but Patrick and I were experimenting with some graphs last week.<br>
<a href="https://zulip-uploads.s3.amazonaws.com/3121/Vqgd9SI4NxEKwYyfZLGvvGEG/reduced_imports.pdf?Signature=D14e1arJW3c%2BxJQYnlwPtr6vtBE%3D&amp;Expires=1570610618&amp;AWSAccessKeyId=AKIAIEVMBCAT2WD3M5KQ" target="_blank" title="https://zulip-uploads.s3.amazonaws.com/3121/Vqgd9SI4NxEKwYyfZLGvvGEG/reduced_imports.pdf?Signature=D14e1arJW3c%2BxJQYnlwPtr6vtBE%3D&amp;Expires=1570610618&amp;AWSAccessKeyId=AKIAIEVMBCAT2WD3M5KQ">mathlib import hierarchy, tactic and meta folders removed</a><br>
<a href="https://zulip-uploads.s3.amazonaws.com/3121/g3iNpH6yzxUs3Majam54hngZ/graph_experiments_no_meta.pdf?Signature=TLPgfn1QXe1%2FVvIzu7qtSyrgYeo%3D&amp;Expires=1570610798&amp;AWSAccessKeyId=AKIAIEVMBCAT2WD3M5KQ" target="_blank" title="https://zulip-uploads.s3.amazonaws.com/3121/g3iNpH6yzxUs3Majam54hngZ/graph_experiments_no_meta.pdf?Signature=TLPgfn1QXe1%2FVvIzu7qtSyrgYeo%3D&amp;Expires=1570610798&amp;AWSAccessKeyId=AKIAIEVMBCAT2WD3M5KQ">same thing, different display</a><br>
<a href="https://zulip-uploads.s3.amazonaws.com/3121/d8_8jioot4ntr6AsJw9KKP5L/graph_experiments_directed.pdf?Signature=54%2BxfOgVUnAqQ%2Fl0zgC7ZlDQnRc%3D&amp;Expires=1570610953&amp;AWSAccessKeyId=AKIAIEVMBCAT2WD3M5KQ" target="_blank" title="https://zulip-uploads.s3.amazonaws.com/3121/d8_8jioot4ntr6AsJw9KKP5L/graph_experiments_directed.pdf?Signature=54%2BxfOgVUnAqQ%2Fl0zgC7ZlDQnRc%3D&amp;Expires=1570610953&amp;AWSAccessKeyId=AKIAIEVMBCAT2WD3M5KQ">full mathlib import hierarchy, how Mathematica thinks it should be clustered</a><br>
<a href="https://zulip-uploads.s3.amazonaws.com/3121/7feFKK6vmfpLSz45pflS26Y7/mathlib.png?Signature=SQVfz8y4ps5lScdiPHG1FJjSIao%3D&amp;Expires=1570611048&amp;AWSAccessKeyId=AKIAIEVMBCAT2WD3M5KQ" target="_blank" title="https://zulip-uploads.s3.amazonaws.com/3121/7feFKK6vmfpLSz45pflS26Y7/mathlib.png?Signature=SQVfz8y4ps5lScdiPHG1FJjSIao%3D&amp;Expires=1570611048&amp;AWSAccessKeyId=AKIAIEVMBCAT2WD3M5KQ">Patrick's visualization of that</a><br>
<a href="https://zulip-uploads.s3.amazonaws.com/3121/wVHutiUCjbkfFxM4U5CCtpGg/mathlib_structures_patrick.pdf?Signature=0PuPPR9s%2FbYVUG8veebLhnLOX%2Fc%3D&amp;Expires=1570610858&amp;AWSAccessKeyId=AKIAIEVMBCAT2WD3M5KQ" target="_blank" title="https://zulip-uploads.s3.amazonaws.com/3121/wVHutiUCjbkfFxM4U5CCtpGg/mathlib_structures_patrick.pdf?Signature=0PuPPR9s%2FbYVUG8veebLhnLOX%2Fc%3D&amp;Expires=1570610858&amp;AWSAccessKeyId=AKIAIEVMBCAT2WD3M5KQ">an approximation to the "structure hierarchy", not the same as the instance graph</a><br>
<a href="https://zulip-uploads.s3.amazonaws.com/3121/LzwNQzMxBDiJoEGONYkhPzAt/mathlib_structures.pdf?Signature=wAkrgkJbJ3sLRj8bXCFHtUV8odM%3D&amp;Expires=1570610909&amp;AWSAccessKeyId=AKIAIEVMBCAT2WD3M5KQ" target="_blank" title="https://zulip-uploads.s3.amazonaws.com/3121/LzwNQzMxBDiJoEGONYkhPzAt/mathlib_structures.pdf?Signature=wAkrgkJbJ3sLRj8bXCFHtUV8odM%3D&amp;Expires=1570610909&amp;AWSAccessKeyId=AKIAIEVMBCAT2WD3M5KQ">a different approximation to the same thing</a></p>

<a name="177694288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177694288" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177694288">Sebastian Ullrich (Oct 09 2019 at 08:56)</a>:</h4>
<p><span class="user-mention" data-user-id="110596">@Rob Lewis</span> Attachments shared privately are not accessible from other channels</p>

<a name="177694713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177694713" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177694713">Rob Lewis (Oct 09 2019 at 09:02)</a>:</h4>
<p>Oops, Zulip has better security than I expected. Fixed?</p>

<a name="177695493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177695493" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177695493">Sebastian Ullrich (Oct 09 2019 at 09:13)</a>:</h4>
<p><span class="user-mention" data-user-id="110596">@Rob Lewis</span> Yes!</p>

<a name="177696468"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177696468" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177696468">Sebastian Ullrich (Oct 09 2019 at 09:25)</a>:</h4>
<p>What were your approximations for the structure hierarchy?</p>

<a name="177696885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177696885" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177696885">Rob Lewis (Oct 09 2019 at 09:31)</a>:</h4>
<p>The first one is from <span class="user-mention" data-user-id="110031">@Patrick Massot</span> . "meta-programming to get all classes and all instances. And then grep to guess which instances are extensions." The second is mine, it's all and only uses of the <code>extends</code> keyword.</p>

<a name="177701434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177701434" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177701434">Sebastian Ullrich (Oct 09 2019 at 10:44)</a>:</h4>
<p>Interesting. So yours is naturally diamond-free. I believe the best-effort approximation would be to only include edges from instances of the form <code>[A xs] : B ys</code> where <code>xs</code> is a subset of <code>ys</code>. That excludes undesired edges like <code>monad -&gt; alternative</code> from <code>monad m -&gt; alternative (option_t m)</code></p>

<a name="177702026"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177702026" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177702026">Rob Lewis (Oct 09 2019 at 10:55)</a>:</h4>
<p>Mine is an underapproximation, and Patrick's is an overapproximation because it has some edges like that. The problem is I don't know exactly what we're trying to approximate. That sounds like a reasonable heuristic.</p>

<a name="177702406"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177702406" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177702406">Mario Carneiro (Oct 09 2019 at 11:01)</a>:</h4>
<p>using <code>extends</code> isn't naturally diamond free unless you never use old structure commands, and we usually use old structure command when we are about to make a diamond...</p>

<a name="177702514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177702514" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177702514">Mario Carneiro (Oct 09 2019 at 11:03)</a>:</h4>
<p>It's also obviously not diamond free</p>

<a name="177702520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177702520" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177702520">Rob Lewis (Oct 09 2019 at 11:03)</a>:</h4>
<p>Indeed, you can see diamonds in both my and Patrick's graphs.</p>

<a name="177703022"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177703022" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177703022">Sebastian Ullrich (Oct 09 2019 at 11:12)</a>:</h4>
<p>Ah, right...</p>

<a name="177708582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177708582" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177708582">Patrick Massot (Oct 09 2019 at 12:34)</a>:</h4>
<p>More details about my method:</p>
<ul>
<li>run the <code>make_all.sh</code> script</li>
<li>change the master <code>all.lean</code> to  <a href="/user_uploads/3121/P0ZqV8wTCTD_Nd7qrDPuT4kq/all.lean" target="_blank" title="all.lean">all.lean</a></li>
<li>run <code>lean all.lean 2&gt; mathlib.yaml</code>, get <a href="/user_uploads/3121/Gxvw2FRrknPjGx5-Msm4AmtY/mathlib.yaml" target="_blank" title="mathlib.yaml">mathlib.yaml</a></li>
<li>run <a href="/user_uploads/3121/YFM8FNi8dE78SKZf2X7gnGeB/instance_graph.py" target="_blank" title="instance_graph.py">instance_graph.py</a>,  get <a href="/user_uploads/3121/80hv2dOEQvquKJZub3Fr1wwY/instances.graphml" target="_blank" title="instances.graphml">instances.graphml</a> </li>
</ul>
<p>See <a href="https://www.yworks.com/yed-live/?file=https://gist.githubusercontent.com/PatrickMassot/1f0d0f74661d43489379b2c464a798e8/raw/instances" target="_blank" title="https://www.yworks.com/yed-live/?file=https://gist.githubusercontent.com/PatrickMassot/1f0d0f74661d43489379b2c464a798e8/raw/instances">https://www.yworks.com/yed-live/?file=https://gist.githubusercontent.com/PatrickMassot/1f0d0f74661d43489379b2c464a798e8/raw/instances</a></p>

<a name="177728409"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177728409" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177728409">Patrick Massot (Oct 09 2019 at 15:58)</a>:</h4>
<p>Mathematical components visualization at: <a href="https://math-comp.github.io/math-comp/htmldoc/libgraph.html" target="_blank" title="https://math-comp.github.io/math-comp/htmldoc/libgraph.html">https://math-comp.github.io/math-comp/htmldoc/libgraph.html</a></p>

<a name="177900580"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177900580" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177900580">Sebastian Ullrich (Oct 11 2019 at 12:05)</a>:</h4>
<p>Okay, here is my version of the class inheritance graph: <a href="/user_uploads/3121/yKkbcfVZLynWe5UaZ33TYTvq/mathlib-coercions.svg" target="_blank" title="mathlib-coercions.svg">mathlib-coercions.svg</a><br>
With 320 edges, it has still a few more than the other versions. Fun fact: the highest number of distincts paths between two classes is <strong>407</strong> between <code>discrete_linear_ordered_field</code> and <code>has_add</code>. Which are actually all in core, not mathlib.</p>

<a name="177901326"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177901326" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177901326">Patrick Massot (Oct 11 2019 at 12:17)</a>:</h4>
<p>Nice!</p>

<a name="177906711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177906711" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177906711">Mario Carneiro (Oct 11 2019 at 13:30)</a>:</h4>
<p>wow, that's less than I expected</p>

<a name="177906731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177906731" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177906731">Mario Carneiro (Oct 11 2019 at 13:31)</a>:</h4>
<p>but it explains why the exponential blowup problem hasn't hit us that hard</p>

<a name="177909446"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177909446" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177909446">Sebastian Ullrich (Oct 11 2019 at 14:02)</a>:</h4>
<p>On the other hand, this is just the class hierarchy. If we look at actual resolution problems, the number of steps (tried instances) goes much higher...</p>
<div class="codehilite"><pre><span></span>[
  {
    &quot;type&quot;: &quot;decidable (has_mem.mem.{u_1 u_1} (set.{u_1} α) (set.{u_1} (set.{u_1} α)) (set.has_mem.{u_1} (set.{u_1} α)) (set_of.{u_1} α (fun (a : α), (not (eq.{1} ennreal (has_coe_to_fun.coe.{(max (u_1+1) 1) (max (u_1+1) 1)} (measure_theory.simple_func.{u_1 0} α (measure_theory.measure_space.to_measurable_space.{u_1} α _inst_1) ennreal) (measure_theory.simple_func.has_coe_to_fun.{u_1 0} α ennreal (measure_theory.measure_space.to_measurable_space.{u_1} α _inst_1)) s a) (lattice.has_top.top.{0} ennreal (lattice.order_top.to_has_top.{0} ennreal (lattice.bounded_lattice.to_order_top.{0} ennreal (lattice.complete_lattice.to_bounded_lattice.{0} ennreal (lattice.complete_linear_order.to_complete_lattice.{0} ennreal ennreal.lattice.complete_linear_order))))))))) (filter.sets.{u_1} α (measure_theory.measure.a_e.{u_1} α (measure_theory.measure_space.to_measurable_space.{u_1} α _inst_1) (measure_theory.measure_space.μ.{u_1} α _inst_1))))&quot;,
    &quot;max_depth&quot;: 10,
    &quot;steps&quot;: 22567
  },
  {
    &quot;type&quot;: &quot;has_scalar.{0 u_1} real α&quot;,
    &quot;max_depth&quot;: 12,
    &quot;steps&quot;: 39150
  },
  {
    &quot;type&quot;: &quot;has_scalar.{0 u_1} real α&quot;,
    &quot;max_depth&quot;: 12,
    &quot;steps&quot;: 39155
  },
  {
    &quot;type&quot;: &quot;has_scalar.{0 u} real α&quot;,
    &quot;max_depth&quot;: 12,
    &quot;steps&quot;: 39155
  },
  {
    &quot;type&quot;: &quot;has_scalar.{0 u_1} real α&quot;,
    &quot;max_depth&quot;: 12,
    &quot;steps&quot;: 39158
  },
  {
    &quot;type&quot;: &quot;has_scalar.{0 u_2} real F&quot;,
    &quot;max_depth&quot;: 12,
    &quot;steps&quot;: 39158
  },
  {
    &quot;type&quot;: &quot;has_scalar.{0 u_4} real G&quot;,
    &quot;max_depth&quot;: 12,
    &quot;steps&quot;: 39158
  },
  {
    &quot;type&quot;: &quot;has_scalar.{0 u_1} real E&quot;,
    &quot;max_depth&quot;: 12,
    &quot;steps&quot;: 39164
  },
  {
    &quot;type&quot;: &quot;has_scalar.{0 u_1} real γ&quot;,
    &quot;max_depth&quot;: 12,
    &quot;steps&quot;: 39182
  },
  {
    &quot;type&quot;: &quot;has_scalar.{u_2 (max u u_1)} K (α -&gt; γ)&quot;,
    &quot;max_depth&quot;: 13,
    &quot;steps&quot;: 59428
  }
]
</pre></div>

<a name="177909485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177909485" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177909485">Sebastian Ullrich (Oct 11 2019 at 14:03)</a>:</h4>
<p>I didn't record source locations unfortunately, but perhaps you can guess</p>

<a name="177914910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177914910" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177914910">Floris van Doorn (Oct 11 2019 at 14:59)</a>:</h4>
<p>Are these the highest numbers in mathlib, or a random sample with a high number of steps?</p>

<a name="177915791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177915791" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177915791">Sebastian Ullrich (Oct 11 2019 at 15:06)</a>:</h4>
<p>These are the top 10 in stdlib + mathlib (I guess they are all in mathlib)</p>

<a name="177929006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177929006" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177929006">Kevin Buzzard (Oct 11 2019 at 17:25)</a>:</h4>
<p>Can I post one or more of these on Twitter or on my blog? Or maybe Sebastian should as he has actually had something to do with them?  I could steal them, host them locally, link to them and give the correct attribution, but of course people are not happy with this then I'm open to other suggestions. The reason I'm interested is that I got all our first year undergraduates to do a concept map of mathematics, which basically looks like the sort of thing which is being posted here, and I think it would be cool to say that "this is what Lean's concept map of mathematics currently looks like. I'm getting a lot of hits at the minute and I think that this is cool material which would have general appeal. But obviously I didn't have anything to do with any of it so there needs to be a discussion about how I do it, if indeed I do it at all.</p>

<a name="177930051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177930051" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177930051">Rob Lewis (Oct 11 2019 at 17:36)</a>:</h4>
<p>Feel free to post any of mine.</p>

<a name="177952357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177952357" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177952357">Jeremy Avigad (Oct 11 2019 at 21:42)</a>:</h4>
<p><span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> I have recently started worrying that our coding of the algebraic hierarchy is getting out of hand, e.g. compared to the mathematical components library, which is designed to find the relevant structure with essentially no search.  There are certainly ways we could code the hierarchy to avoid the crazy number of steps between discrete-linear-ordered-field and has_add. Do you think it will be a problem if the algebraic hierarchy continues to grow, or do you think it will block efficient automation?</p>

<a name="177955082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177955082" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177955082">Daniel Selsam (Oct 11 2019 at 22:27)</a>:</h4>
<p><span class="user-mention" data-user-id="110865">@Jeremy Avigad</span> the 407 number is the number of distinct paths between the two, not the length of one of the paths between the two. The former is large because of diamonds. Our new procedure solves this problem.</p>

<a name="177976923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177976923" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177976923">Kevin Buzzard (Oct 12 2019 at 07:59)</a>:</h4>
<blockquote>
<p>Feel free to post any of mine.</p>
</blockquote>
<p>Thanks Rob. <a href="https://twitter.com/XenaProject/status/1182928366753718273?s=20" target="_blank" title="https://twitter.com/XenaProject/status/1182928366753718273?s=20">https://twitter.com/XenaProject/status/1182928366753718273?s=20</a></p>
<div class="inline-preview-twitter"><div class="twitter-tweet"><a href="https://twitter.com/XenaProject/status/1182928366753718273?s=20" target="_blank"><img class="twitter-avatar" src="https://pbs.twimg.com/profile_images/1130953085952712704/PqL5txUs_normal.png"></a><p>In class I got all our first year undergraduates to draw a concept map of mathematics. Several people on the Lean chat have been drawing graphs of Lean's maths library and I was struck by the similarity. Here's  one of Rob Lewis' representations. <a href="https://t.co/mB8Y5ov4d1" target="_blank" title="https://t.co/mB8Y5ov4d1">http://wwwf.imperial.ac.uk/~buzzard/docs/Rob_Lewis_mathlib_concept_map.pdf</a></p><span>- The Xena Project (@XenaProject)</span></div></div>

<a name="177988322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177988322" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177988322">Jeremy Avigad (Oct 12 2019 at 13:18)</a>:</h4>
<p><span class="user-mention" data-user-id="230999">@Daniel Selsam</span> I know, but even a chain of ten instances to unravel a "+" sounds like it could cause problems ofr elaboration and unification. But if you tell me not to worry about it, I won't.</p>

<a name="177991525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177991525" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177991525">Kevin Buzzard (Oct 12 2019 at 14:38)</a>:</h4>
<p><span class="user-mention" data-user-id="230999">@Daniel Selsam</span> <span class="user-mention" data-user-id="110865">@Jeremy Avigad</span> Working on the perfectoid project this morning I had a max class instance resolution error, and if I increased the instance search level it turned into a timeout error. After some time staring at trace outputs and seeing exactly what <code>by apply_instance</code> could do, I managed to discover that I had managed to construct a ring <code>B</code> for which the type class inference structure could construct an instance of <code>comm_ring B</code> but not an instance of <code>ring B</code> (this was where the timeout occurred). The ring B was a "normal mathematical ring" -- it was a quotient of a subring of a field -- but the debugging was troublesome and the traces were gigantic and terrifying. I fixed the problem by giving <code>comm_ring.to_ring</code> a local priority of 1000 (this was the smallest number that worked). Looking at the traces, it really hit home what a phenomenally difficult job Lean has trying to solve these problems, but it was equally absolutely clear that the vast majority of what it was trying was really crazy. I just wanted to put my hands on Lean's shoulders and say "we are doing abstract ring theory here, stop thinking about int.ring and all these other silly ideas". Here, the issue didn't seem so much to be the loops in the inference graph but simply that it was so darn big and it was hard to highlight the manifestly important part of it.</p>

<a name="177991868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177991868" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177991868">Mario Carneiro (Oct 12 2019 at 14:46)</a>:</h4>
<p>I think the issue is still the loops in the inference graph, it's just that since stuff like <code>int.ring</code> appears at the leaves it's going to appear a significant fraction of the time</p>

<a name="177991951"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177991951" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177991951">Mario Carneiro (Oct 12 2019 at 14:48)</a>:</h4>
<p>Does it help to <code>letI := comm_ring B</code> in the proof / statement?</p>

<a name="177991983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177991983" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177991983">Mario Carneiro (Oct 12 2019 at 14:49)</a>:</h4>
<p><span class="user-mention" data-user-id="230999">@Daniel Selsam</span> Is the new instance algorithm back-portable to lean 3, or does it depend on significantly different architecture?</p>

<a name="177994277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994277" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994277">Kevin Buzzard (Oct 12 2019 at 15:45)</a>:</h4>
<p>It does not help. In tactic mode I managed to get myself in a situation where <code>letI : comm_ring B := by apply_instance</code> succeeded and then on the next line <code>letI : ring B := by apply_instance</code> failed.</p>

<a name="177994293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994293" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994293">Kevin Buzzard (Oct 12 2019 at 15:45)</a>:</h4>
<p>Once I had isolated this I could then fix the problem by fudging the instance priority.</p>

<a name="177994347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994347" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994347">Mario Carneiro (Oct 12 2019 at 15:46)</a>:</h4>
<p>hm, I thought local instances always had the highest priority</p>

<a name="177994359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994359" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994359">Kevin Buzzard (Oct 12 2019 at 15:46)</a>:</h4>
<div class="codehilite"><pre><span></span> <span class="k">let</span> <span class="n">B</span> <span class="o">:=</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span> <span class="n">A</span><span class="o">,</span>
  <span class="n">letI</span> <span class="o">:</span> <span class="n">comm_ring</span> <span class="n">B</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span><span class="o">,</span> <span class="c1">-- works fine</span>
  <span class="n">letI</span> <span class="o">:</span> <span class="n">ring</span> <span class="n">B</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span><span class="o">,</span> <span class="c1">-- max class instance reached!</span>
</pre></div>


<p>(from a PM to Patrick and Johan earlier today)</p>

<a name="177994364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994364" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994364">Reid Barton (Oct 12 2019 at 15:46)</a>:</h4>
<p>But first we have to figure out to apply <code>comm_ring.to_ring</code>, right? and that doesn't have highest priority</p>

<a name="177994375"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994375" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994375">Mario Carneiro (Oct 12 2019 at 15:47)</a>:</h4>
<p>that's true, but are there a lot of other options?</p>

<a name="177994383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994383" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994383">Kevin Buzzard (Oct 12 2019 at 15:47)</a>:</h4>
<p>[this is in the middle of a complicated thing, A is a subring of a perfectoid field, I couldn't minimise (indeed that was part of the problem)]</p>

<a name="177994390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994390" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994390">Mario Carneiro (Oct 12 2019 at 15:47)</a>:</h4>
<p>I guess it went to division ring and then to field and wandered off</p>

<a name="177994443"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994443" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994443">Mario Carneiro (Oct 12 2019 at 15:48)</a>:</h4>
<p><code>  letI : ring B := comm_ring.to_ring</code> should presumably work</p>

<a name="177994454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994454" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994454">Kevin Buzzard (Oct 12 2019 at 15:49)</a>:</h4>
<p><code>local attribute [instance, priority 1000] comm_ring.to_ring</code> beforehand fixed everything. 999 was not enough.</p>

<a name="177994460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994460" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994460">Mario Carneiro (Oct 12 2019 at 15:49)</a>:</h4>
<p>aha</p>

<a name="177994463"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994463" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994463">Mario Carneiro (Oct 12 2019 at 15:49)</a>:</h4>
<p>that must be the priority of local instances</p>

<a name="177994548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994548" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994548">Mario Carneiro (Oct 12 2019 at 15:51)</a>:</h4>
<p>no, it's default priority</p>

<a name="177994560"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994560" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994560">Kevin Buzzard (Oct 12 2019 at 15:51)</a>:</h4>
<p>comm_ring.to_ring definitely had smaller priority than that, because I checked! I think it was 100? Not at Lean right now</p>

<a name="177994628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994628" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994628">Reid Barton (Oct 12 2019 at 15:52)</a>:</h4>
<p>yes, it's 100</p>

<a name="177994817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994817" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994817">Mario Carneiro (Oct 12 2019 at 15:57)</a>:</h4>
<p>I'm looking at the code, and it seems like they should be 1000 by default</p>

<a name="177994864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994864" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994864">Mario Carneiro (Oct 12 2019 at 15:58)</a>:</h4>
<p>oh, the core lean files set the default_priority lower when algebraic structures are defined</p>

<a name="177994968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177994968" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177994968">Kevin Buzzard (Oct 12 2019 at 16:00)</a>:</h4>
<p>ha ha so we have a random too-low priority in the algebraic hierarchy and then wonder why Lean is always going in the wrong direction? We should move this chat to Jeremy's thread.</p>

<a name="177995047"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177995047" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177995047">Mario Carneiro (Oct 12 2019 at 16:02)</a>:</h4>
<p>no, the priority is low for a reason</p>

<a name="177995067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177995067" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177995067">Mario Carneiro (Oct 12 2019 at 16:03)</a>:</h4>
<p>I'm not sure what it's competing against, but it's probably mathlib's fault for not setting priority on some instance</p>

<a name="177999192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/177999192" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#177999192">Daniel Selsam (Oct 12 2019 at 17:46)</a>:</h4>
<blockquote>
<p><span class="user-mention silent" data-user-id="230999">Daniel Selsam</span> Is the new instance algorithm back-portable to lean 3, or does it depend on significantly different architecture?</p>
</blockquote>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> It would be a nightmare, because the new procedure relies on suspending and resuming the temporary metavariable contexts, which are implemented in  <code>type_context.cpp</code> in an imperative style with only <code>push_scope</code> and <code>pop_scope</code>. It would require a big refactor in C++.</p>

<a name="178084921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/178084921" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#178084921">Sebastian Ullrich (Oct 14 2019 at 08:52)</a>:</h4>
<blockquote>
<p>Can I post one or more of these on Twitter or on my blog?</p>
</blockquote>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> Of course, feel free to share mine.</p>

<a name="178099214"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/178099214" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#178099214">Daniel Selsam (Oct 14 2019 at 12:42)</a>:</h4>
<blockquote>
<p>Can I post one or more of these on Twitter or on my blog?</p>
</blockquote>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> Of course, feel free to share the one I posted as well.</p>

<a name="178113228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/178113228" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#178113228">Kevin Buzzard (Oct 14 2019 at 15:31)</a>:</h4>
<p>Thanks all! I will (when I have a minute)</p>

<a name="178373092"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/178373092" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#178373092">Sebastian Ullrich (Oct 17 2019 at 11:50)</a>:</h4>
<p>I took a closer look at a <code>has_scalar A B</code> example <span class="user-mention" data-user-id="110596">@Rob Lewis</span> gave me that fails after 47000 steps. It turns out that perhaps the most problematic instance is <code>[comm_ring A] [ring B] [algebra A B] : has_scalar A B</code>. In Rob's specific example, <code>[comm_ring A]</code> quickly succeeds, but <code>[ring B]</code> fails (slowly). So Lean 3's inference backtracks, finds another instance for <code>[comm_ring A]</code>, <em>and tries again to find a <code>[ring B]</code></em> (which "obviously" fails again). In the end, the number of steps after which <code>[ring B]</code> fails (~400) is multiplied by the number of (not necessarily non-defeq) instances of <code>[comm_ring A]</code> (~100).</p>

<a name="178373109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/178373109" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#178373109">Sebastian Ullrich (Oct 17 2019 at 11:50)</a>:</h4>
<p>Fortunately, <span class="user-mention" data-user-id="230999">@Daniel Selsam</span>'s algorithm should eat this example for breakfast</p>

<a name="178373178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/178373178" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#178373178">Johan Commelin (Oct 17 2019 at 11:51)</a>:</h4>
<p>/me usually takes &gt; 15 minutes for eating his breakfast <span aria-label="worried" class="emoji emoji-1f61f" role="img" title="worried">:worried:</span></p>

<a name="178373789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/178373789" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#178373789">Rob Lewis (Oct 17 2019 at 12:00)</a>:</h4>
<p>Thanks for looking! This kind of repeated search turns up regularly, most memorably in </p>
<div class="codehilite"><pre><span></span><span class="n">int</span><span class="bp">.</span><span class="n">cast_coe</span> <span class="o">:</span>
  <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">[</span><span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">has_neg</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="bp">_</span><span class="n">inst_2</span> <span class="o">:</span> <span class="n">has_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="bp">_</span><span class="n">inst_3</span> <span class="o">:</span> <span class="n">has_one</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="bp">_</span><span class="n">inst_4</span> <span class="o">:</span> <span class="n">has_add</span> <span class="n">α</span><span class="o">],</span>
    <span class="n">has_coe</span> <span class="bp">ℤ</span> <span class="n">α</span>
</pre></div>


<p>Before we moved the <code>has_neg</code> instance to the front, this would take ages to fail to find a coercion from <code>nat</code> to <code>int</code>.</p>
<p>Rearranging the instances here doesn't look like it will help much. But it's good to know the root cause.</p>

<a name="182551974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/182551974" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#182551974">Rob Lewis (Dec 04 2019 at 12:48)</a>:</h4>
<p>For another fun kind of visualization: I just learned about the tool <code>gitstats</code>. <a href="https://leanprover-community.github.io/mathlib_stats/index.html" target="_blank" title="https://leanprover-community.github.io/mathlib_stats/index.html">https://leanprover-community.github.io/mathlib_stats/index.html</a></p>

<a name="182552516"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/182552516" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#182552516">Johan Commelin (Dec 04 2019 at 12:54)</a>:</h4>
<p>Yeah, that's a nice tool. But I hadn't yet had the courage to run it on mathlib. How long does it take to run?</p>

<a name="182552561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/182552561" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#182552561">Rob Lewis (Dec 04 2019 at 12:55)</a>:</h4>
<p>Not long enough to care. More than 5 seconds, less than 30?</p>

<a name="182552641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/182552641" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#182552641">Johan Commelin (Dec 04 2019 at 12:56)</a>:</h4>
<p>Ooh, ok. Your computer is faster than mine (-;</p>

<a name="182554021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/182554021" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#182554021">Patrick Massot (Dec 04 2019 at 13:14)</a>:</h4>
<p>Looks perfect for a 17 minutes talk about mathlib.</p>

<a name="182571756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/visualizations/near/182571756" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/70566visualizations.html#182571756">Kevin Buzzard (Dec 04 2019 at 16:25)</a>:</h4>
<p>rofl I have committed barely anything to mathlib but I'm <a href="https://github.com/leanprover-community/mathlib/issues/15" target="_blank" title="https://github.com/leanprover-community/mathlib/issues/15">#15</a> on the list of commits, because every PR I make is so bad that it always takes ten more commits to fix up all the problems everyone else points out! <span aria-label="rolling on the floor laughing" class="emoji emoji-1f923" role="img" title="rolling on the floor laughing">:rolling_on_the_floor_laughing:</span></p>


{% endraw %}

{% include archive_update.html %}