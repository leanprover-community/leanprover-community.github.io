---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/39173avoidwritingsomesimprfllemmas.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/39173avoidwritingsomesimprfllemmas.html">avoid writing (some?) simp-rfl lemmas</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="148623451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/avoid%20writing%20%28some%3F%29%20simp-rfl%20lemmas/near/148623451" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/39173avoidwritingsomesimprfllemmas.html#148623451">Johan Commelin (Nov 27 2018 at 08:09)</a>:</h4>
<p>I've brought this up before, but I'dd really hope that there is a way to get rid of blocks like this:</p>
<div class="codehilite"><pre><span></span><span class="kn">section</span> <span class="n">simp</span>

<span class="kn">section</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="n">comma</span> <span class="n">L₂</span> <span class="n">R</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="err">⟶</span> <span class="n">Y</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">L₁</span> <span class="err">⟹</span> <span class="n">L₂</span><span class="o">}</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">map_left_obj_left</span>  <span class="o">:</span> <span class="o">((</span><span class="n">map_left</span> <span class="n">R</span> <span class="n">l</span><span class="o">)</span><span class="bp">.</span><span class="n">obj</span> <span class="n">X</span><span class="o">)</span><span class="bp">.</span><span class="n">left</span>  <span class="bp">=</span> <span class="n">X</span><span class="bp">.</span><span class="n">left</span>                <span class="o">:=</span> <span class="n">rfl</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">map_left_obj_right</span> <span class="o">:</span> <span class="o">((</span><span class="n">map_left</span> <span class="n">R</span> <span class="n">l</span><span class="o">)</span><span class="bp">.</span><span class="n">obj</span> <span class="n">X</span><span class="o">)</span><span class="bp">.</span><span class="n">right</span> <span class="bp">=</span> <span class="n">X</span><span class="bp">.</span><span class="n">right</span>               <span class="o">:=</span> <span class="n">rfl</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">map_left_obj_hom</span>   <span class="o">:</span> <span class="o">((</span><span class="n">map_left</span> <span class="n">R</span> <span class="n">l</span><span class="o">)</span><span class="bp">.</span><span class="n">obj</span> <span class="n">X</span><span class="o">)</span><span class="bp">.</span><span class="n">hom</span>   <span class="bp">=</span> <span class="n">l</span><span class="bp">.</span><span class="n">app</span> <span class="n">X</span><span class="bp">.</span><span class="n">left</span> <span class="err">≫</span> <span class="n">X</span><span class="bp">.</span><span class="n">hom</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">map_left_map_left</span>  <span class="o">:</span> <span class="o">((</span><span class="n">map_left</span> <span class="n">R</span> <span class="n">l</span><span class="o">)</span><span class="bp">.</span><span class="n">map</span> <span class="n">f</span><span class="o">)</span><span class="bp">.</span><span class="n">left</span>  <span class="bp">=</span> <span class="n">f</span><span class="bp">.</span><span class="n">left</span>                <span class="o">:=</span> <span class="n">rfl</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">map_left_map_right</span> <span class="o">:</span> <span class="o">((</span><span class="n">map_left</span> <span class="n">R</span> <span class="n">l</span><span class="o">)</span><span class="bp">.</span><span class="n">map</span> <span class="n">f</span><span class="o">)</span><span class="bp">.</span><span class="n">right</span> <span class="bp">=</span> <span class="n">f</span><span class="bp">.</span><span class="n">right</span>               <span class="o">:=</span> <span class="n">rfl</span>
<span class="kn">end</span>

<span class="kn">section</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="n">comma</span> <span class="n">L</span> <span class="n">R₁</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="err">⟶</span> <span class="n">Y</span><span class="o">}</span> <span class="o">{</span><span class="n">r</span> <span class="o">:</span> <span class="n">R₁</span> <span class="err">⟹</span> <span class="n">R₂</span><span class="o">}</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">map_right_obj_left</span>  <span class="o">:</span> <span class="o">((</span><span class="n">map_right</span> <span class="n">L</span> <span class="n">r</span><span class="o">)</span><span class="bp">.</span><span class="n">obj</span> <span class="n">X</span><span class="o">)</span><span class="bp">.</span><span class="n">left</span>  <span class="bp">=</span> <span class="n">X</span><span class="bp">.</span><span class="n">left</span>                 <span class="o">:=</span> <span class="n">rfl</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">map_right_obj_right</span> <span class="o">:</span> <span class="o">((</span><span class="n">map_right</span> <span class="n">L</span> <span class="n">r</span><span class="o">)</span><span class="bp">.</span><span class="n">obj</span> <span class="n">X</span><span class="o">)</span><span class="bp">.</span><span class="n">right</span> <span class="bp">=</span> <span class="n">X</span><span class="bp">.</span><span class="n">right</span>                <span class="o">:=</span> <span class="n">rfl</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">map_right_obj_hom</span>   <span class="o">:</span> <span class="o">((</span><span class="n">map_right</span> <span class="n">L</span> <span class="n">r</span><span class="o">)</span><span class="bp">.</span><span class="n">obj</span> <span class="n">X</span><span class="o">)</span><span class="bp">.</span><span class="n">hom</span>   <span class="bp">=</span> <span class="n">X</span><span class="bp">.</span><span class="n">hom</span> <span class="err">≫</span> <span class="n">r</span><span class="bp">.</span><span class="n">app</span> <span class="n">X</span><span class="bp">.</span><span class="n">right</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">map_right_map_left</span>  <span class="o">:</span> <span class="o">((</span><span class="n">map_right</span> <span class="n">L</span> <span class="n">r</span><span class="o">)</span><span class="bp">.</span><span class="n">map</span> <span class="n">f</span><span class="o">)</span><span class="bp">.</span><span class="n">left</span>  <span class="bp">=</span> <span class="n">f</span><span class="bp">.</span><span class="n">left</span>                 <span class="o">:=</span> <span class="n">rfl</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">map_right_map_right</span> <span class="o">:</span> <span class="o">((</span><span class="n">map_right</span> <span class="n">L</span> <span class="n">r</span><span class="o">)</span><span class="bp">.</span><span class="n">map</span> <span class="n">f</span><span class="o">)</span><span class="bp">.</span><span class="n">right</span> <span class="bp">=</span> <span class="n">f</span><span class="bp">.</span><span class="n">right</span>                <span class="o">:=</span> <span class="n">rfl</span>
<span class="kn">end</span>

<span class="kn">end</span> <span class="n">simp</span>
</pre></div>

<a name="148623511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/avoid%20writing%20%28some%3F%29%20simp-rfl%20lemmas/near/148623511" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/39173avoidwritingsomesimprfllemmas.html#148623511">Johan Commelin (Nov 27 2018 at 08:10)</a>:</h4>
<p>You define a new category, and afterwards you have to state pages of trivialities. There must be some structure to this, which we can abuse, so that automation just does this for us. Has there been any thought in this direction?</p>

<a name="148635044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/avoid%20writing%20%28some%3F%29%20simp-rfl%20lemmas/near/148635044" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/39173avoidwritingsomesimprfllemmas.html#148635044">Reid Barton (Nov 27 2018 at 12:36)</a>:</h4>
<p>You can put <code>@[simp]</code> on the thing you defined (I guess <code>map_left</code>, <code>map_right</code>)</p>

<a name="148635271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/avoid%20writing%20%28some%3F%29%20simp-rfl%20lemmas/near/148635271" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/39173avoidwritingsomesimprfllemmas.html#148635271">Johan Commelin (Nov 27 2018 at 12:41)</a>:</h4>
<p>Is that good practice? I thought it was some how considered evil, because it marked too much as <code>simp</code>?</p>

<a name="148635344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/avoid%20writing%20%28some%3F%29%20simp-rfl%20lemmas/near/148635344" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/39173avoidwritingsomesimprfllemmas.html#148635344">Mario Carneiro (Nov 27 2018 at 12:43)</a>:</h4>
<p>it's probably not what you want, because then it will unfold even when it is not being projected</p>

<a name="148635439"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/avoid%20writing%20%28some%3F%29%20simp-rfl%20lemmas/near/148635439" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/39173avoidwritingsomesimprfllemmas.html#148635439">Johan Commelin (Nov 27 2018 at 12:45)</a>:</h4>
<p>Aha, so I want <code>derive simp-projections</code></p>

<a name="148635440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/avoid%20writing%20%28some%3F%29%20simp-rfl%20lemmas/near/148635440" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/39173avoidwritingsomesimprfllemmas.html#148635440">Johan Commelin (Nov 27 2018 at 12:45)</a>:</h4>
<p>Is that possible?</p>

<a name="148635603"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/avoid%20writing%20%28some%3F%29%20simp-rfl%20lemmas/near/148635603" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/39173avoidwritingsomesimprfllemmas.html#148635603">Mario Carneiro (Nov 27 2018 at 12:49)</a>:</h4>
<p>in theory</p>

<a name="148635672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/avoid%20writing%20%28some%3F%29%20simp-rfl%20lemmas/near/148635672" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/39173avoidwritingsomesimprfllemmas.html#148635672">Mario Carneiro (Nov 27 2018 at 12:50)</a>:</h4>
<p>it gets complicated with nested structures, but you could inspect the definition for a structure instance and extract the parts</p>

<a name="148635680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/avoid%20writing%20%28some%3F%29%20simp-rfl%20lemmas/near/148635680" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/39173avoidwritingsomesimprfllemmas.html#148635680">Mario Carneiro (Nov 27 2018 at 12:50)</a>:</h4>
<p>this would basically be the same thing that the equation compiler does</p>

<a name="148635832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/avoid%20writing%20%28some%3F%29%20simp-rfl%20lemmas/near/148635832" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/39173avoidwritingsomesimprfllemmas.html#148635832">Johan Commelin (Nov 27 2018 at 12:54)</a>:</h4>
<p>I see. I hope someone with a lot of tactic-fu will pop up and write something like this (-;</p>


{% endraw %}

{% include archive_update.html %}