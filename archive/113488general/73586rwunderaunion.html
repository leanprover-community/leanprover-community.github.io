---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/73586rwunderaunion.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html">rw under a union</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="126553772"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126553772" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126553772">Kevin Buzzard (May 14 2018 at 19:31)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">set</span>
<span class="kn">example</span> <span class="o">(</span><span class="n">α</span> <span class="n">γ</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span>  <span class="o">(</span><span class="n">F</span> <span class="n">G</span> <span class="o">:</span> <span class="n">γ</span> <span class="bp">→</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">γ</span><span class="o">),</span> <span class="n">F</span> <span class="n">i</span> <span class="bp">=</span> <span class="n">G</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="err">⋃</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">γ</span><span class="o">),</span> <span class="n">F</span> <span class="n">i</span><span class="o">)</span>  <span class="bp">=</span> <span class="err">⋃</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">γ</span><span class="o">),</span> <span class="n">G</span> <span class="n">i</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">refine</span> <span class="n">set</span><span class="bp">.</span><span class="n">subset</span><span class="bp">.</span><span class="n">antisymm</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">set</span><span class="bp">.</span><span class="n">Union_subset_Union</span><span class="o">,</span>
    <span class="n">intro</span> <span class="n">i</span><span class="o">,</span><span class="n">rw</span> <span class="o">(</span><span class="n">H</span> <span class="n">i</span><span class="o">),</span>
  <span class="o">},</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">set</span><span class="bp">.</span><span class="n">Union_subset_Union</span><span class="o">,</span>
    <span class="n">intro</span> <span class="n">i</span><span class="o">,</span><span class="n">rw</span> <span class="o">(</span><span class="n">H</span> <span class="n">i</span><span class="o">),</span>
  <span class="o">},</span>
<span class="kn">end</span>
</pre></div>

<a name="126553840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126553840" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126553840">Kevin Buzzard (May 14 2018 at 19:32)</a>:</h4>
<p>Is there a more sensible method to prove that if <code>F i = G i</code> for all <code>i</code> then the union of the <code>F i</code> equals the union of the <code>G i</code>? I couldn't figure out how to rewrite within the union.</p>

<a name="126553854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126553854" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126553854">Kevin Buzzard (May 14 2018 at 19:32)</a>:</h4>
<p>Sorry, the Union.</p>

<a name="126553895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126553895" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126553895">Chris Hughes (May 14 2018 at 19:33)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">(</span><span class="n">α</span> <span class="n">γ</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span>  <span class="o">(</span><span class="n">F</span> <span class="n">G</span> <span class="o">:</span> <span class="n">γ</span> <span class="bp">→</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">γ</span><span class="o">),</span> <span class="n">F</span> <span class="n">i</span> <span class="bp">=</span> <span class="n">G</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="err">⋃</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">γ</span><span class="o">),</span> <span class="n">F</span> <span class="n">i</span><span class="o">)</span>  <span class="bp">=</span> <span class="err">⋃</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">γ</span><span class="o">),</span> <span class="n">G</span> <span class="n">i</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">rw</span> <span class="n">funext</span> <span class="n">H</span>
</pre></div>

<a name="126553981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126553981" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126553981">Kevin Buzzard (May 14 2018 at 19:35)</a>:</h4>
<p>ha ha that's clever :-)</p>

<a name="126554007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554007" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554007">Patrick Massot (May 14 2018 at 19:35)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">(</span><span class="n">α</span> <span class="n">γ</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span>  <span class="o">(</span><span class="n">F</span> <span class="n">G</span> <span class="o">:</span> <span class="n">γ</span> <span class="bp">→</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">γ</span><span class="o">),</span> <span class="n">F</span> <span class="n">i</span> <span class="bp">=</span> <span class="n">G</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="err">⋃</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">γ</span><span class="o">),</span> <span class="n">F</span> <span class="n">i</span><span class="o">)</span>  <span class="bp">=</span> <span class="err">⋃</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">γ</span><span class="o">),</span> <span class="n">G</span> <span class="n">i</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">finish</span>
</pre></div>

<a name="126554017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554017" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554017">Patrick Massot (May 14 2018 at 19:36)</a>:</h4>
<p>Use automation Luke</p>

<a name="126554071"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554071" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554071">Kevin Buzzard (May 14 2018 at 19:36)</a>:</h4>
<p>What does <code>finish</code> do?</p>

<a name="126554073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554073" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554073">Patrick Massot (May 14 2018 at 19:36)</a>:</h4>
<p>It finishes the proof</p>

<a name="126554074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554074" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554074">Kevin Buzzard (May 14 2018 at 19:36)</a>:</h4>
<p>every time??</p>

<a name="126554079"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554079" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554079">Patrick Massot (May 14 2018 at 19:36)</a>:</h4>
<p>Yes, nobody told you?</p>

<a name="126554083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554083" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554083">Patrick Massot (May 14 2018 at 19:36)</a>:</h4>
<p>You could also use <code>congr</code> here</p>

<a name="126554095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554095" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554095">Kevin Buzzard (May 14 2018 at 19:37)</a>:</h4>
<p>I've seen <code>congr</code> do rewrites I couldn't do before, I should have tried this</p>

<a name="126554101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554101" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554101">Kevin Buzzard (May 14 2018 at 19:37)</a>:</h4>
<p>I tried <code>conv</code> but I couldn't get that to work either</p>

<a name="126554103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554103" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554103">Kevin Buzzard (May 14 2018 at 19:37)</a>:</h4>
<p>and it was the last line of a 250 line proof :-)</p>

<a name="126554104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554104" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554104">Kevin Buzzard (May 14 2018 at 19:37)</a>:</h4>
<p>so I cheated and asked here.</p>

<a name="126554107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554107" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554107">Kevin Buzzard (May 14 2018 at 19:37)</a>:</h4>
<p>I should be marking Chris' exam script!</p>

<a name="126554147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554147" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554147">Kevin Buzzard (May 14 2018 at 19:38)</a>:</h4>
<p>But I am sick of affine schemes not being schemes</p>

<a name="126554151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554151" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554151">Patrick Massot (May 14 2018 at 19:38)</a>:</h4>
<p>Recently I got to this situation where the goal is <code>a = a</code> (but not if <code>pp.all</code>) and <code>congr</code> alone finished the proof</p>

<a name="126554164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554164" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554164">Patrick Massot (May 14 2018 at 19:38)</a>:</h4>
<p>You should have made that formalization the exam</p>

<a name="126554192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554192" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554192">Kevin Buzzard (May 14 2018 at 19:40)</a>:</h4>
<p>next year</p>

<a name="126554243"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554243" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554243">Kevin Buzzard (May 14 2018 at 19:40)</a>:</h4>
<p>What would I do without this chat. Things would go so much more slowly.</p>

<a name="126554551"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554551" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554551">Patrick Massot (May 14 2018 at 19:47)</a>:</h4>
<p>I'm always fighting the temptation to post every lemma I need here</p>

<a name="126554597"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554597" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554597">Patrick Massot (May 14 2018 at 19:48)</a>:</h4>
<p>I hope to reduce my dependence a bit</p>

<a name="126554609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554609" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554609">Patrick Massot (May 14 2018 at 19:49)</a>:</h4>
<p>But I'm still interested in learning better ways. Here are two lemmas I proved tonight. Usual questions: are there already there? What is the proof from the book?</p>

<a name="126554618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554618" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554618">Patrick Massot (May 14 2018 at 19:49)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">foldr_ext</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">f&#39;</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">β</span><span class="o">)</span>
  <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="err">∈</span> <span class="n">l</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">b</span> <span class="o">:</span> <span class="n">β</span><span class="o">,</span> <span class="n">f</span> <span class="n">a</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">f&#39;</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">foldr</span> <span class="n">f</span> <span class="n">s</span> <span class="n">l</span> <span class="bp">=</span> <span class="n">foldr</span> <span class="n">f&#39;</span> <span class="n">s</span> <span class="n">l</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">induction</span> <span class="n">l</span> <span class="k">with</span> <span class="n">h</span> <span class="n">t</span> <span class="n">IH</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">},</span>
  <span class="o">{</span> <span class="k">have</span> <span class="n">H&#39;</span> <span class="o">:=</span> <span class="n">H</span> <span class="n">h</span> <span class="o">(</span><span class="k">by</span> <span class="n">simp</span><span class="o">),</span>
    <span class="n">suffices</span> <span class="o">:</span> <span class="n">foldr</span> <span class="n">f</span> <span class="n">s</span> <span class="n">t</span> <span class="bp">=</span> <span class="n">foldr</span> <span class="n">f&#39;</span> <span class="n">s</span> <span class="n">t</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">H&#39;</span><span class="o">,</span> <span class="n">this</span><span class="o">],</span>
    <span class="n">apply</span> <span class="n">IH</span><span class="o">,</span>
    <span class="n">intros</span> <span class="n">a</span> <span class="n">a_t</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">H</span> <span class="n">a</span> <span class="o">(</span><span class="k">by</span> <span class="n">simp</span><span class="o">[</span><span class="n">a_t</span><span class="o">])</span> <span class="o">}</span>
<span class="kn">end</span>
</pre></div>

<a name="126554683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554683" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554683">Patrick Massot (May 14 2018 at 19:50)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">filter_ext</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">r</span><span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">P</span> <span class="n">P&#39;</span><span class="o">)</span> <span class="o">[</span><span class="n">decidable_pred</span> <span class="n">P</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_pred</span> <span class="n">P&#39;</span><span class="o">]</span>
  <span class="o">(</span><span class="n">HP</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="err">∈</span> <span class="n">r</span><span class="o">,</span> <span class="n">P</span> <span class="n">i</span> <span class="bp">=</span> <span class="n">P&#39;</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">P</span> <span class="n">r</span> <span class="bp">=</span> <span class="n">filter</span> <span class="n">P&#39;</span> <span class="n">r</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">induction</span> <span class="n">r</span> <span class="k">with</span> <span class="n">h</span> <span class="n">t</span> <span class="n">IH</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">},</span>
  <span class="o">{</span> <span class="k">have</span> <span class="n">HPh</span> <span class="o">:</span> <span class="n">P</span> <span class="n">h</span> <span class="bp">=</span> <span class="n">P&#39;</span> <span class="n">h</span> <span class="o">:=</span> <span class="n">HP</span> <span class="n">h</span> <span class="o">(</span><span class="k">by</span> <span class="n">simp</span><span class="o">),</span>
    <span class="k">have</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">i</span> <span class="err">∈</span> <span class="n">t</span> <span class="bp">→</span> <span class="n">P</span> <span class="n">i</span> <span class="bp">=</span> <span class="n">P&#39;</span> <span class="n">i</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">i</span> <span class="n">i_t</span><span class="o">,</span>
      <span class="n">exact</span> <span class="o">(</span><span class="n">HP</span> <span class="n">i</span> <span class="err">$</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">i_t</span><span class="o">])</span> <span class="o">},</span>
    <span class="n">by_cases</span> <span class="n">H</span> <span class="o">:</span> <span class="n">P</span> <span class="n">h</span><span class="o">,</span>
    <span class="o">{</span> <span class="k">have</span> <span class="n">H&#39;</span> <span class="o">:</span> <span class="n">P&#39;</span> <span class="n">h</span> <span class="o">:=</span> <span class="n">HPh</span> <span class="bp">▸</span> <span class="n">H</span><span class="o">,</span>
      <span class="n">simp</span> <span class="o">[</span><span class="n">H</span><span class="o">,</span> <span class="n">H&#39;</span><span class="o">,</span> <span class="n">IH</span> <span class="n">this</span><span class="o">]</span> <span class="o">},</span>
    <span class="o">{</span> <span class="k">have</span> <span class="n">H&#39;</span> <span class="o">:</span> <span class="bp">¬</span> <span class="n">P&#39;</span> <span class="n">h</span> <span class="o">:=</span> <span class="n">HPh</span> <span class="bp">▸</span> <span class="n">H</span><span class="o">,</span>
      <span class="n">simp</span> <span class="o">[</span><span class="n">H</span><span class="o">,</span> <span class="n">H&#39;</span><span class="o">,</span> <span class="n">IH</span> <span class="n">this</span><span class="o">]</span> <span class="o">}</span> <span class="o">}</span>
<span class="kn">end</span>
</pre></div>

<a name="126554698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554698" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554698">Patrick Massot (May 14 2018 at 19:51)</a>:</h4>
<p>I haven't tried to obfuscate the proofs</p>

<a name="126554707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554707" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554707">Kevin Buzzard (May 14 2018 at 19:51)</a>:</h4>
<p>ha ha can you do the first one with Chris' trick?</p>

<a name="126554754"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554754" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554754">Patrick Massot (May 14 2018 at 19:52)</a>:</h4>
<p>But I'm sure two lines are enough</p>

<a name="126554775"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554775" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554775">Patrick Massot (May 14 2018 at 19:53)</a>:</h4>
<p>I don't think so, you must not forget we have informations only on elements of the list</p>

<a name="126554779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554779" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554779">Kevin Buzzard (May 14 2018 at 19:53)</a>:</h4>
<p>oh yes</p>

<a name="126554780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554780" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554780">Patrick Massot (May 14 2018 at 19:53)</a>:</h4>
<p>This condition seems a bit too specific</p>

<a name="126554786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554786" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554786">Patrick Massot (May 14 2018 at 19:54)</a>:</h4>
<p>For instance, start with <code>congr</code> and you loose</p>

<a name="126554788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554788" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554788">Kevin Buzzard (May 14 2018 at 19:54)</a>:</h4>
<p>Do I need an import for these? I just this minute upgraded mathlib in my project and I'm re-building it</p>

<a name="126554829"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554829" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554829">Kevin Buzzard (May 14 2018 at 19:54)</a>:</h4>
<p>so maybe I just have to wait</p>

<a name="126554831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554831" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554831">Kevin Buzzard (May 14 2018 at 19:54)</a>:</h4>
<p>but I have complaints about foldr currently</p>

<a name="126554836"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554836" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554836">Patrick Massot (May 14 2018 at 19:54)</a>:</h4>
<p><code>import data.list.basic</code></p>

<a name="126554837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126554837" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126554837">Patrick Massot (May 14 2018 at 19:54)</a>:</h4>
<p>sorry</p>

<a name="126555316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126555316" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126555316">Kevin Buzzard (May 14 2018 at 20:03)</a>:</h4>
<p><code>list.foldr_hom</code> is too strong</p>

<a name="126555384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126555384" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126555384">Patrick Massot (May 14 2018 at 20:04)</a>:</h4>
<p>Too strong?</p>

<a name="126555393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126555393" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126555393">Kevin Buzzard (May 14 2018 at 20:04)</a>:</h4>
<p>For your application</p>

<a name="126555398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126555398" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126555398">Kevin Buzzard (May 14 2018 at 20:05)</a>:</h4>
<p>like Chris' idea</p>

<a name="126555403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126555403" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126555403">Kevin Buzzard (May 14 2018 at 20:05)</a>:</h4>
<p>Same problem</p>

<a name="126555410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126555410" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126555410">Patrick Massot (May 14 2018 at 20:05)</a>:</h4>
<p>right</p>

<a name="126555898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126555898" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126555898">Chris Hughes (May 14 2018 at 20:14)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">foldr_ext</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">f&#39;</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">β</span><span class="o">)</span>
  <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="err">∈</span> <span class="n">l</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">b</span> <span class="o">:</span> <span class="n">β</span><span class="o">,</span> <span class="n">f</span> <span class="n">a</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">f&#39;</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">foldr</span> <span class="n">f</span> <span class="n">s</span> <span class="n">l</span> <span class="bp">=</span> <span class="n">foldr</span> <span class="n">f&#39;</span> <span class="n">s</span> <span class="n">l</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">induction</span> <span class="n">l</span><span class="bp">;</span> <span class="n">simp</span> <span class="bp">*</span> <span class="o">{</span><span class="n">contextual</span> <span class="o">:=</span> <span class="n">tt</span><span class="o">}</span>
</pre></div>

<a name="126555909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126555909" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126555909">Patrick Massot (May 14 2018 at 20:14)</a>:</h4>
<p><span class="emoji emoji-1f62e" title="open mouth">:open_mouth:</span></p>

<a name="126555923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126555923" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126555923">Kenny Lau (May 14 2018 at 20:15)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span> can you derive normal and curvature for r=xi+f(x)j?</p>

<a name="126555943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126555943" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126555943">Patrick Massot (May 14 2018 at 20:15)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> is this the mechanics exam running joke again?</p>

<a name="126555948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126555948" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126555948">Kenny Lau (May 14 2018 at 20:15)</a>:</h4>
<p>is it a joke when the exam is tomorrow?</p>

<a name="126556102"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556102" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556102">Patrick Massot (May 14 2018 at 20:18)</a>:</h4>
<p>Thank you Chris for not revising mechanics</p>

<a name="126556105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556105" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556105">Patrick Massot (May 14 2018 at 20:18)</a>:</h4>
<p>I disapprove of course</p>

<a name="126556108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556108" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556108">Patrick Massot (May 14 2018 at 20:18)</a>:</h4>
<p>But I still take your proof</p>

<a name="126556116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556116" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556116">Chris Hughes (May 14 2018 at 20:19)</a>:</h4>
<p>I can as of today. <span class="user-mention" data-user-id="110064">@Kenny Lau</span></p>

<a name="126556133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556133" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556133">Kenny Lau (May 14 2018 at 20:19)</a>:</h4>
<p>ok you win</p>

<a name="126556183"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556183" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556183">Chris Hughes (May 14 2018 at 20:20)</a>:</h4>
<p>curvature is dn / ds, where s is arc length I think.</p>

<a name="126556192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556192" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556192">Chris Hughes (May 14 2018 at 20:20)</a>:</h4>
<p>and n is normal</p>

<a name="126556199"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556199" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556199">Patrick Massot (May 14 2018 at 20:20)</a>:</h4>
<p>He can golf <em>and</em> compute curvature. What a man!</p>

<a name="126556397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556397" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556397">Kevin Buzzard (May 14 2018 at 20:25)</a>:</h4>
<p>So what is going on with Chris' proof? I feel like I can learn something important here</p>

<a name="126556399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556399" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556399">Kevin Buzzard (May 14 2018 at 20:25)</a>:</h4>
<p>Induction -- sure. Simp does the base case</p>

<a name="126556403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556403" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556403">Kevin Buzzard (May 14 2018 at 20:25)</a>:</h4>
<p>simp doesn't do the inductive step.</p>

<a name="126556405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556405" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556405">Kevin Buzzard (May 14 2018 at 20:25)</a>:</h4>
<p>by itself.</p>

<a name="126556407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556407" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556407">Kenny Lau (May 14 2018 at 20:25)</a>:</h4>
<p>it's a semicolon</p>

<a name="126556450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556450" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556450">Kenny Lau (May 14 2018 at 20:26)</a>:</h4>
<p><code>simp</code> is simultaneously applied to both goals</p>

<a name="126556451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556451" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556451">Kenny Lau (May 14 2018 at 20:26)</a>:</h4>
<p>the base case and the inductive step</p>

<a name="126556453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556453" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556453">Patrick Massot (May 14 2018 at 20:26)</a>:</h4>
<p><code>contextual</code> seems to do the magic trick</p>

<a name="126556457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556457" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556457">Kenny Lau (May 14 2018 at 20:26)</a>:</h4>
<p>what does <code>contextual</code> do?</p>

<a name="126556461"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556461" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556461">Patrick Massot (May 14 2018 at 20:26)</a>:</h4>
<p>uses context</p>

<a name="126556465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556465" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556465">Kenny Lau (May 14 2018 at 20:27)</a>:</h4>
<p>isn't that <code>simp *</code>?</p>

<a name="126556496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556496" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556496">Patrick Massot (May 14 2018 at 20:27)</a>:</h4>
<p>I hate natural number arithmetic, so I'm cheating for this one. Who could prove me <code>b &lt; a</code> implies <code>b + 1 - a = 0</code>?</p>

<a name="126556576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556576" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556576">Kevin Buzzard (May 14 2018 at 20:29)</a>:</h4>
<p>maybe b &lt; a -&gt; (b + 1) &lt;= a</p>

<a name="126556581"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556581" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556581">Kenny Lau (May 14 2018 at 20:29)</a>:</h4>
<p>they are equivalent</p>

<a name="126556584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556584" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556584">Kenny Lau (May 14 2018 at 20:29)</a>:</h4>
<p>definitionally</p>

<a name="126556587"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556587" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556587">Patrick Massot (May 14 2018 at 20:29)</a>:</h4>
<p>That could be a step yes</p>

<a name="126556590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556590" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556590">Kevin Buzzard (May 14 2018 at 20:29)</a>:</h4>
<p>oh they are defeq right? ;-)</p>

<a name="126556596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556596" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556596">Kenny Lau (May 14 2018 at 20:29)</a>:</h4>
<p>so something like <code>sub_le_zero_of_le</code>?</p>

<a name="126556601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556601" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556601">Kenny Lau (May 14 2018 at 20:29)</a>:</h4>
<p>(deleted)</p>

<a name="126556649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556649" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556649">Kenny Lau (May 14 2018 at 20:30)</a>:</h4>
<p>oh wait nothing</p>

<a name="126556657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556657" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556657">Kenny Lau (May 14 2018 at 20:30)</a>:</h4>
<p>maybe you want <code>nat.eq_zero_of_le_zero</code> if it exists</p>

<a name="126556661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556661" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556661">Kevin Buzzard (May 14 2018 at 20:30)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">list</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">open</span> <span class="n">list</span>
<span class="kn">lemma</span> <span class="n">foldr_ext</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">f&#39;</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">β</span><span class="o">)</span>
  <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="err">∈</span> <span class="n">l</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">b</span> <span class="o">:</span> <span class="n">β</span><span class="o">,</span> <span class="n">f</span> <span class="n">a</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">f&#39;</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">foldr</span> <span class="n">f</span> <span class="n">s</span> <span class="n">l</span> <span class="bp">=</span> <span class="n">foldr</span> <span class="n">f&#39;</span> <span class="n">s</span> <span class="n">l</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">induction</span> <span class="n">l</span> <span class="k">with</span> <span class="n">h</span> <span class="n">t</span> <span class="n">IH</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">},</span>
  <span class="n">simp</span> <span class="bp">*</span> <span class="o">{</span><span class="n">contextual</span> <span class="o">:=</span> <span class="n">tt</span><span class="o">},</span>
<span class="kn">end</span>
</pre></div>

<a name="126556663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556663" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556663">Kevin Buzzard (May 14 2018 at 20:30)</a>:</h4>
<p>The semicolon isn't important</p>

<a name="126556664"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556664" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556664">Kenny Lau (May 14 2018 at 20:30)</a>:</h4>
<p>it is, because it allows you to apply <code>simp</code> to both goals</p>

<a name="126556669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556669" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556669">Kevin Buzzard (May 14 2018 at 20:30)</a>:</h4>
<p>but the contextual is</p>

<a name="126556671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556671" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556671">Kenny Lau (May 14 2018 at 20:30)</a>:</h4>
<p>without the semicolon you need to write it twice</p>

<a name="126556674"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556674" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556674">Kevin Buzzard (May 14 2018 at 20:30)</a>:</h4>
<p>sure</p>

<a name="126556684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556684" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556684">Kevin Buzzard (May 14 2018 at 20:31)</a>:</h4>
<p>Oh I see what you're saying -- what I am saying is trivial.</p>

<a name="126556688"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556688" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556688">Kevin Buzzard (May 14 2018 at 20:31)</a>:</h4>
<p>I'm just unravelling the semicolon</p>

<a name="126556692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556692" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556692">Kevin Buzzard (May 14 2018 at 20:31)</a>:</h4>
<p>the contextual isn't important for the base case but for the inductive step we have an inductive hypothesis which needs to be used</p>

<a name="126556700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556700" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556700">Kenny Lau (May 14 2018 at 20:32)</a>:</h4>
<p>does <code>simp [*]</code> work?</p>

<a name="126556778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556778" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556778">Gabriel Ebner (May 14 2018 at 20:33)</a>:</h4>
<p>Contextual does not refer to context as in "induction hypothesis" but to the left-hand side of implications: in <code>a = b -&gt; P a</code>, contextual allows simp to use the equation <code>a=b</code> to simplify <code>P a</code>.</p>

<a name="126556780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556780" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556780">Kenny Lau (May 14 2018 at 20:33)</a>:</h4>
<p>oh</p>

<a name="126556790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556790" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556790">Kevin Buzzard (May 14 2018 at 20:33)</a>:</h4>
<p><code>nat.sub_eq_zero_iff_le</code></p>

<a name="126556860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556860" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556860">Kevin Buzzard (May 14 2018 at 20:35)</a>:</h4>
<p><code>example (a b : ℕ) : b &lt; a → b + 1 - a = 0 := nat.sub_eq_zero_of_le</code></p>

<a name="126556865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556865" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556865">Kenny Lau (May 14 2018 at 20:35)</a>:</h4>
<p>aha</p>

<a name="126556867"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556867" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556867">Kevin Buzzard (May 14 2018 at 20:35)</a>:</h4>
<p>using the trick that b &lt; a is by definition b+1 &lt;= a</p>

<a name="126556869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556869" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556869">Kevin Buzzard (May 14 2018 at 20:35)</a>:</h4>
<p>as Kenny pointed out</p>

<a name="126556916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556916" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556916">Kevin Buzzard (May 14 2018 at 20:36)</a>:</h4>
<p>(see <code>#print nat.lt</code>)</p>

<a name="126556928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556928" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556928">Patrick Massot (May 14 2018 at 20:36)</a>:</h4>
<p>Thank you very much</p>

<a name="126556989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556989" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556989">Kevin Buzzard (May 14 2018 at 20:38)</a>:</h4>
<p>This <code>contextual</code> thing is not documented in my simp docs -- I looked through the source or the docs (I don't remember, maybe the source), saw it was there and mentioned it but basically also said I didn't know what it di.</p>

<a name="126556990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126556990" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126556990">Kevin Buzzard (May 14 2018 at 20:38)</a>:</h4>
<p>d</p>

<a name="126557009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126557009" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126557009">Kevin Buzzard (May 14 2018 at 20:38)</a>:</h4>
<p>I don't quite understand Gabriel's explanation -- is <code>a = b -&gt; P a</code> supposed to be a hypothesis or a goal?</p>

<a name="126557013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126557013" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126557013">Kenny Lau (May 14 2018 at 20:39)</a>:</h4>
<p>goal</p>

<a name="126557022"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126557022" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126557022">Kenny Lau (May 14 2018 at 20:39)</a>:</h4>
<p>hmm, but the goal is not an implication</p>

<a name="126557030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126557030" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126557030">Kevin Buzzard (May 14 2018 at 20:39)</a>:</h4>
<blockquote>
<p>does <code>simp [*]</code> work?</p>
</blockquote>
<p>no</p>

<a name="126557125"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126557125" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126557125">Kevin Buzzard (May 14 2018 at 20:41)</a>:</h4>
<p>right -- the implications are in the hypotheses</p>

<a name="126557127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126557127" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126557127">Kevin Buzzard (May 14 2018 at 20:41)</a>:</h4>
<p>Maybe it's just magic</p>

<a name="126557131"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126557131" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126557131">Kevin Buzzard (May 14 2018 at 20:41)</a>:</h4>
<p>"Lean does not do magic" -- K. Lau, a couple of months ago</p>

<a name="126557175"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126557175" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126557175">Kevin Buzzard (May 14 2018 at 20:42)</a>:</h4>
<p>The comment inspired me to start really thinking about how some of the techniques I had picked up actually worked</p>

<a name="126557393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126557393" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126557393">Mario Carneiro (May 14 2018 at 20:47)</a>:</h4>
<div class="codehilite"><pre><span></span>lemma filter_congr {p q : α → Prop} [decidable_pred p] [decidable_pred q]
  : ∀ {l : list α}, (∀ x ∈ l, p x ↔ q x) → filter p l = filter q l
| [] _     := rfl
| (a::l) h := by simp at h; by_cases pa : p a;
  [simp [pa, h.1.1 pa, filter_congr h.2],
   simp [pa, mt h.1.2 pa, filter_congr h.2]]
</pre></div>


<p>Regarding naming: A theorem of the form <code>a = b -&gt; F a = F b</code> is a "congruence" theorem, named with <code>congr</code> at the end. An "extensionality" theorem has the form <code>F a = F b -&gt; a = b</code> where <code>F</code> is some appropriate (collection of) projection-like operations</p>

<a name="126557415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126557415" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126557415">Mario Carneiro (May 14 2018 at 20:47)</a>:</h4>
<p><code>map_congr</code> exists in <code>list.basic</code> but not all list theorems have congr theorems stated for them</p>

<a name="126557583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126557583" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126557583">Patrick Massot (May 14 2018 at 20:50)</a>:</h4>
<p>Thanks!</p>

<a name="126557592"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126557592" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126557592">Patrick Massot (May 14 2018 at 20:50)</a>:</h4>
<p>Is there any difference between my <code>p x = q x</code> and your <code>p x ↔ q x</code> here?</p>

<a name="126557609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126557609" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126557609">Mario Carneiro (May 14 2018 at 20:51)</a>:</h4>
<p>No, given <code>propext</code>, but mathlib convention is to use <code>iff</code> instead of <code>eq</code> for equivalent propositions</p>

<a name="126557632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126557632" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126557632">Mario Carneiro (May 14 2018 at 20:52)</a>:</h4>
<p>Otherwise you have to face weird theorems like <code>(a = b) = c = b</code></p>

<a name="126557712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126557712" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126557712">Chris Hughes (May 14 2018 at 20:53)</a>:</h4>
<p>It more or less does <code>intros; simp *</code> I think</p>

<a name="126557713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126557713" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126557713">Chris Hughes (May 14 2018 at 20:53)</a>:</h4>
<p>But I just realise that can't be what it does, because my example didn't have anything to intro.</p>

<a name="126557714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126557714" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126557714">Chris Hughes (May 14 2018 at 20:53)</a>:</h4>
<p>and <code>simp *</code> doesn't work</p>

<a name="126558301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126558301" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126558301">Patrick Massot (May 14 2018 at 21:06)</a>:</h4>
<p>Going from = to iff broke a magic <code>finish</code> success</p>

<a name="126558311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126558311" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126558311">Patrick Massot (May 14 2018 at 21:06)</a>:</h4>
<p>Probably by breaking a magic <code>cc</code> under the hood</p>

<a name="126558380"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126558380" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126558380">Patrick Massot (May 14 2018 at 21:08)</a>:</h4>
<p>This natural number substraction is really a nightmare. Now I want <code>b + k + 1 - (a + k) = b + 1 - a</code>. It's almost the same I had a couple of days ago. But I'm stuck again...</p>

<a name="126558463"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126558463" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126558463">Patrick Massot (May 14 2018 at 21:10)</a>:</h4>
<p>It seems like I really need <code>omega</code> in the end</p>

<a name="126558972"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126558972" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126558972">Patrick Massot (May 14 2018 at 21:23)</a>:</h4>
<p>Is there any hope to use Coq to tell me a proof Lean could understand?</p>

<a name="126559159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126559159" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126559159">Andrew Ashworth (May 14 2018 at 21:27)</a>:</h4>
<p>No, in general the names of the lemmas used in Coq would be different</p>

<a name="126559200"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126559200" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126559200">Patrick Massot (May 14 2018 at 21:28)</a>:</h4>
<p>But can you get the sequence of Coq lemmas used by omega?</p>

<a name="126559219"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126559219" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126559219">Andrew Ashworth (May 14 2018 at 21:28)</a>:</h4>
<p>I do not have a Coq installation in front of me to look at the output of omega, so I don't know</p>

<a name="126559407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126559407" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126559407">Andrew Ashworth (May 14 2018 at 21:32)</a>:</h4>
<p>What I did when i had a lot of similar problems was write down a cheat sheet of relevant cancellation lemmas in my notebook... looking them all up was my biggest hurdle</p>

<a name="126559611"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126559611" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126559611">Patrick Massot (May 14 2018 at 21:37)</a>:</h4>
<p>Now I need <code>H : a ≤ b ⊢ 2 * a + (b + 1 - a) - i - 1 = a - i + b</code>. I give up for today</p>

<a name="126559664"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126559664" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126559664">Patrick Massot (May 14 2018 at 21:38)</a>:</h4>
<p>I have four proofs stuck because of such stupid goals</p>

<a name="126559670"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126559670" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126559670">Kenny Lau (May 14 2018 at 21:38)</a>:</h4>
<p>I understand your feeling</p>

<a name="126563181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126563181" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126563181">Kevin Buzzard (May 14 2018 at 22:58)</a>:</h4>
<blockquote>
<p>Going from = to iff broke a magic <code>finish</code> success</p>
</blockquote>
<p>You can just deduce your old version from Mario's version of course...</p>

<a name="126563201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126563201" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126563201">Kevin Buzzard (May 14 2018 at 22:59)</a>:</h4>
<blockquote>
<p>This natural number substraction is really a nightmare. Now I want <code>b + k + 1 - (a + k) = b + 1 - a</code>. It's almost the same I had a couple of days ago. But I'm stuck again...</p>
</blockquote>
<p>I really like doing these. Patrick -- just type nat.sub and then ctrl-space escape ctrl-space to see what Lean has, you can just browse through stuff.</p>

<a name="126563696"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126563696" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126563696">Kevin Buzzard (May 14 2018 at 23:08)</a>:</h4>
<p>Actually I don't understand how ctrl-space works at all. I just managed to type <code>nat.sub</code> and get it to display <code>nat.add_sub_add_left</code> (which is useful for you) and then after esc ctrl-space I don't see it any more</p>

<a name="126563797"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126563797" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126563797">Kevin Buzzard (May 14 2018 at 23:10)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">k</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">+</span> <span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">-</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">k</span><span class="o">)</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">a</span> <span class="o">:=</span> <span class="k">calc</span>
<span class="n">b</span> <span class="bp">+</span> <span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">-</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">k</span><span class="o">)</span> <span class="bp">=</span> <span class="n">k</span> <span class="bp">+</span> <span class="o">(</span><span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">-</span> <span class="o">(</span><span class="n">k</span> <span class="bp">+</span> <span class="n">a</span><span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">add_assoc</span><span class="o">,</span><span class="n">add_comm</span><span class="o">]</span>
<span class="bp">...</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">a</span> <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">nat</span><span class="bp">.</span><span class="n">add_sub_add_left</span>
</pre></div>

<a name="126563842"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126563842" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126563842">Kevin Buzzard (May 14 2018 at 23:11)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">k</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">+</span> <span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">-</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">k</span><span class="o">)</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">a</span> <span class="o">:=</span> <span class="k">calc</span>
<span class="n">b</span> <span class="bp">+</span> <span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">-</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">k</span><span class="o">)</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">+</span> <span class="n">k</span> <span class="bp">-</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">k</span><span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">simp</span>
<span class="bp">...</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">a</span> <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">nat</span><span class="bp">.</span><span class="n">add_sub_add_right</span>
</pre></div>

<a name="126564406"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126564406" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126564406">Kevin Buzzard (May 14 2018 at 23:22)</a>:</h4>
<blockquote>
<p>Now I need <code>H : a ≤ b ⊢ 2 * a + (b + 1 - a) - i - 1 = a - i + b</code>. I give up for today</p>
</blockquote>
<p>If <code>i &gt; a</code> but <code>i &lt;= a + b</code> then this one won't be true, because <code>a - i + b</code> is <code>(a - i) + b</code></p>

<a name="126564613"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126564613" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126564613">Kevin Buzzard (May 14 2018 at 23:28)</a>:</h4>
<p>Here's some true version:</p>

<a name="126564616"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126564616" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126564616">Kevin Buzzard (May 14 2018 at 23:28)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">i</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">+</span> <span class="o">(</span><span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">a</span><span class="o">)</span> <span class="bp">-</span> <span class="n">i</span> <span class="bp">-</span> <span class="mi">1</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">-</span> <span class="n">i</span> <span class="o">:=</span>
<span class="k">calc</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">+</span> <span class="o">(</span><span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">a</span><span class="o">)</span> <span class="bp">-</span> <span class="n">i</span> <span class="bp">-</span> <span class="mi">1</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="o">(</span><span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">a</span><span class="o">))</span> <span class="bp">-</span> <span class="n">i</span> <span class="bp">-</span> <span class="mi">1</span> <span class="o">:</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">two_mul</span><span class="o">]</span>
<span class="bp">...</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="o">(</span><span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">-</span> <span class="n">i</span> <span class="bp">-</span> <span class="mi">1</span> <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">nat</span><span class="bp">.</span><span class="n">add_sub_of_le</span> <span class="o">(</span><span class="n">le_trans</span> <span class="n">H</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">le_succ</span> <span class="bp">_</span><span class="o">))</span>
<span class="bp">...</span> <span class="bp">=</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">-</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span>  <span class="o">:</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">add_assoc</span><span class="o">,</span><span class="n">nat</span><span class="bp">.</span><span class="n">sub_sub</span><span class="o">]</span>
<span class="bp">...</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">-</span> <span class="n">i</span> <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">nat</span><span class="bp">.</span><span class="n">add_sub_add_right</span>
</pre></div>

<a name="126564908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126564908" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126564908">Andrew Ashworth (May 14 2018 at 23:37)</a>:</h4>
<blockquote>
<blockquote>
<p>This natural number substraction is really a nightmare. Now I want <code>b + k + 1 - (a + k) = b + 1 - a</code>. It's almost the same I had a couple of days ago. But I'm stuck again...</p>
</blockquote>
<p>I really like doing these. Patrick -- just type nat.sub and then ctrl-space escape ctrl-space to see what Lean has, you can just browse through stuff.</p>
</blockquote>
<p>Ctrl-T and typing sub brings up lemmas with sub inside</p>

<a name="126574769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126574769" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126574769">Mario Carneiro (May 15 2018 at 04:35)</a>:</h4>
<p>By the way patrick, your "stupid goals" are exactly why I wrote <code>range'</code> to take a start and length instead of start and end. Remember, the value of a good modeling decision is not in the beauty of the statements but in the beauty of the proofs. When things are done right, the proof is like everything is given to you just as you need it, but when you write things in a cumbersome way the proofs become orders of magnitude more cumbersome.</p>

<a name="126574827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126574827" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126574827">Mario Carneiro (May 15 2018 at 04:37)</a>:</h4>
<p>If your desire for clean statements overrides this concern, then just have two versions and write from the "porcelain" version (which looks nice but is hard to work with) to the "plumbing" version (optimized for proofs) before proving anything, and just translate back at the end.</p>

<a name="126575178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126575178" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126575178">Mario Carneiro (May 15 2018 at 04:51)</a>:</h4>
<p>But cumbersome is as cumbersome does, here's a proof:</p>
<div class="codehilite"><pre><span></span>example (a b k : ℕ) : b + k + 1 - (a + k) = b + 1 - a :=
by rw [add_comm a, ← nat.sub_sub, add_right_comm, nat.add_sub_cancel]
</pre></div>


<p>and a counterexample:</p>
<div class="codehilite"><pre><span></span>#eval do
  a ← list.range 3,
  b ← list.range 3,
  i ← list.range 3,
  return $ to_bool (∀ (_:a ≤ b), 2 * a + (b + 1 - a) - i - 1 = a - i + b)
 -- [tt, tt, tt, tt, ff, ff, tt, ff, ff, tt, tt, tt, tt, tt, ff, tt, tt, ff, tt, tt, tt, tt, tt, tt, tt, tt, tt]
</pre></div>


<p>That's my version of isabelle quickcheck - I just evaluated the theorem at some small numbers and it sometimes fails.</p>

<a name="126575374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126575374" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126575374">Mario Carneiro (May 15 2018 at 04:59)</a>:</h4>
<p>Assuming you don't want to learn the beautiful theory of monus on the naturals, but just want to pretend it's regular subtraction, I recommend you treat it like a partial function, in the sense that you never state a theorem about <code>-</code> unless the fact that the RHS is less or equal to the LHS is in the context or otherwise deducible. Your second theorem fails this, since it has a variable <code>i</code> being subtracted from stuff even though there is no upper bound on it.</p>

<a name="126575537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126575537" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126575537">Mario Carneiro (May 15 2018 at 05:04)</a>:</h4>
<p>hm, maybe this is a slightly nicer quickcheck:</p>
<div class="codehilite"><pre><span></span>#eval do
  a ← list.range 5,
  b ← list.range 5,
  i ← list.range 5,
  guardb (a ≤ b),
  guardb (2 * a + (b + 1 - a) - i - 1 ≠ a - i + b),
  return (a, b, i)
</pre></div>


<p>it returns a list of counterexample triples</p>

<a name="126579115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579115" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579115">Chris Hughes (May 15 2018 at 07:12)</a>:</h4>
<blockquote>
<p>hmm, but the goal is not an implication</p>
</blockquote>
<p>I think it's because some of the hypotheses are an implication</p>

<a name="126579186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579186" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579186">Gabriel Ebner (May 15 2018 at 07:15)</a>:</h4>
<p>Indeed, look at the (condition of the) induction hypothesis.</p>

<a name="126579580"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579580" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579580">Patrick Massot (May 15 2018 at 07:29)</a>:</h4>
<p>Sorry I messed up the last statement. What I really need is <code>2 * a + (b + 1 - a) - i - 1 = a+b-i</code> assuming <code>a ≤ b</code> and <code>i ∈ range' a (b + 1 - a)</code></p>

<a name="126579628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579628" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579628">Patrick Massot (May 15 2018 at 07:30)</a>:</h4>
<p>I do have all the right bounds, that's what my <code>foldr_congr</code> and <code>filter_ext</code> are made for</p>

<a name="126579681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579681" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579681">Patrick Massot (May 15 2018 at 07:32)</a>:</h4>
<p>But I should probably think about first proving stuff with cumbersome statements and then try to deduce the natural statements from their twisted versions</p>

<a name="126579683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579683" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579683">Kevin Buzzard (May 15 2018 at 07:32)</a>:</h4>
<p>Patrick I proved what you wanted, right?</p>

<a name="126579684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579684" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579684">Patrick Massot (May 15 2018 at 07:32)</a>:</h4>
<p>This is all about summing for n from a to b, instead of n from a to a+k</p>

<a name="126579691"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579691" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579691">Patrick Massot (May 15 2018 at 07:33)</a>:</h4>
<p>You proved one of the things I wanted, thank you very much to you and Mario, but this is another one</p>

<a name="126579692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579692" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579692">Kevin Buzzard (May 15 2018 at 07:33)</a>:</h4>
<p>The "true version" above</p>

<a name="126579695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579695" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579695">Kevin Buzzard (May 15 2018 at 07:33)</a>:</h4>
<p>I thought I'd done everything for oyu</p>

<a name="126579696"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579696" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579696">Kevin Buzzard (May 15 2018 at 07:33)</a>:</h4>
<p>what is missing?</p>

<a name="126579697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579697" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579697">Patrick Massot (May 15 2018 at 07:33)</a>:</h4>
<p>Oh sorry</p>

<a name="126579699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579699" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579699">Kevin Buzzard (May 15 2018 at 07:33)</a>:</h4>
<p>:-)</p>

<a name="126579701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579701" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579701">Patrick Massot (May 15 2018 at 07:33)</a>:</h4>
<p>I missed that one</p>

<a name="126579739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579739" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579739">Kevin Buzzard (May 15 2018 at 07:34)</a>:</h4>
<p>I can believe that these things are not to everyone's tastes. I only did it because I quite like them.</p>

<a name="126579742"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579742" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579742">Patrick Massot (May 15 2018 at 07:34)</a>:</h4>
<p>I'm glad you're such a pervert</p>

<a name="126579744"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579744" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579744">Patrick Massot (May 15 2018 at 07:34)</a>:</h4>
<p>Thank you very much</p>

<a name="126579746"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579746" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579746">Kevin Buzzard (May 15 2018 at 07:34)</a>:</h4>
<p>What I especially like is that Mario's proof is only about 30% shorter :-)</p>

<a name="126579755"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579755" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579755">Kevin Buzzard (May 15 2018 at 07:35)</a>:</h4>
<p>[and that I was aware that something like this would probably work after I finished mine...]</p>

<a name="126579799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579799" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579799">Kevin Buzzard (May 15 2018 at 07:36)</a>:</h4>
<blockquote>
<p>Indeed, look at the (condition of the) induction hypothesis.</p>
</blockquote>
<p>Right -- that's what I'm unclear about. Explicitly -- <code>simp * {contextual := tt}</code> does something different to <code>simp</code> in a situation where there is a _hypothesis_ of the form <code>X -&gt; Y</code>, in which case it does...what?</p>

<a name="126579815"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579815" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579815">Kevin Buzzard (May 15 2018 at 07:37)</a>:</h4>
<p>Oh -- maybe I do understand.</p>

<a name="126579858"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579858" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579858">Chris Hughes (May 15 2018 at 07:38)</a>:</h4>
<p>It's hard to tell because trace.simplify doesn't show you where the rewrites are happening.</p>

<a name="126579860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579860" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579860">Kenny Lau (May 15 2018 at 07:39)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span> can you derive Kepler's laws?</p>

<a name="126579865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579865" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579865">Kevin Buzzard (May 15 2018 at 07:39)</a>:</h4>
<p>Where are the mods? Honestly, this place is going down the pan</p>

<a name="126579919"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579919" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579919">Mario Carneiro (May 15 2018 at 07:40)</a>:</h4>
<p>Hi there, it's your friendly neighborhood mod</p>

<a name="126579927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579927" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579927">Patrick Massot (May 15 2018 at 07:41)</a>:</h4>
<p>Are we still rewriting under a union?</p>

<a name="126579932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579932" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579932">Mario Carneiro (May 15 2018 at 07:41)</a>:</h4>
<p>It's all connected, I'm sure</p>

<a name="126579933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579933" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579933">Patrick Massot (May 15 2018 at 07:41)</a>:</h4>
<p>What about this one: <code>lemma reverse_range' (a b : ℕ) : reverse (range' a b) = map (λ i, 2*a+b-i-1) (range' a b) </code>?</p>

<a name="126579935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579935" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579935">Mario Carneiro (May 15 2018 at 07:41)</a>:</h4>
<p>even Kepler's laws get involved in some rewrites</p>

<a name="126579936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579936" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579936">Patrick Massot (May 15 2018 at 07:41)</a>:</h4>
<p>I need a topic "I hate natural numbers"</p>

<a name="126579979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579979" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579979">Mario Carneiro (May 15 2018 at 07:42)</a>:</h4>
<p>That statement reminds me a lot of Kevin's theorem on reversing sums</p>

<a name="126579982"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579982" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579982">Patrick Massot (May 15 2018 at 07:42)</a>:</h4>
<p>Of course this is what I'm doing</p>

<a name="126579985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579985" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579985">Patrick Massot (May 15 2018 at 07:43)</a>:</h4>
<p>I'm working on my big_op project</p>

<a name="126579992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579992" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579992">Patrick Massot (May 15 2018 at 07:43)</a>:</h4>
<p>And this statement is partly what motivated my <code>nth_le_map</code> question</p>

<a name="126579997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126579997" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126579997">Patrick Massot (May 15 2018 at 07:43)</a>:</h4>
<p>I wanted to use <code>ext_le</code> on that one</p>

<a name="126580039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580039" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580039">Mario Carneiro (May 15 2018 at 07:44)</a>:</h4>
<p>suggestion: don't use <code>2*a+b-i-1</code>, use <code>a-(b+1-a)-i</code></p>

<a name="126580049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580049" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580049">Mario Carneiro (May 15 2018 at 07:45)</a>:</h4>
<p>otherwise you will spend the whole proof showing that the first thing rewrites to the second</p>

<a name="126580050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580050" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580050">Patrick Massot (May 15 2018 at 07:45)</a>:</h4>
<p>That's part of the nightmare: each time I change my mind on something like this, I must redo all the natural numbers computations lemmas</p>

<a name="126580096"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580096" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580096">Patrick Massot (May 15 2018 at 07:46)</a>:</h4>
<p>With <code>2*a+b-i-1</code> I can use what Kevin proved last night down the road. Otherwise I return to having nothing</p>

<a name="126580103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580103" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580103">Mario Carneiro (May 15 2018 at 07:46)</a>:</h4>
<p>We call that cruft</p>

<a name="126580112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580112" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580112">Mario Carneiro (May 15 2018 at 07:47)</a>:</h4>
<p>Here's a suggestion: write the theorem so as to minimize the number of rewrites. That is, as soon as you get something technically the same as what you want (in this case, <code>range' a b = map ... (range' a b)</code>), go with it, even if it's written in a kind of weird way</p>

<a name="126580116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580116" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580116">Mario Carneiro (May 15 2018 at 07:47)</a>:</h4>
<p>if you do that for two or three theorems the idioms will stand out</p>

<a name="126580156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580156" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580156">Mario Carneiro (May 15 2018 at 07:48)</a>:</h4>
<p>like in this case keeping <code>b+1-a</code> together as a unit</p>

<a name="126580158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580158" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580158">Kevin Buzzard (May 15 2018 at 07:48)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">list</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">open</span> <span class="n">list</span>
<span class="kn">lemma</span> <span class="n">foldr_ext</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">f&#39;</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">β</span><span class="o">)</span>
  <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="err">∈</span> <span class="n">l</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">b</span> <span class="o">:</span> <span class="n">β</span><span class="o">,</span> <span class="n">f</span> <span class="n">a</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">f&#39;</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">foldr</span> <span class="n">f</span> <span class="n">s</span> <span class="n">l</span> <span class="bp">=</span> <span class="n">foldr</span> <span class="n">f&#39;</span> <span class="n">s</span> <span class="n">l</span> <span class="o">:=</span>
<span class="k">begin</span> <span class="n">induction</span> <span class="n">l</span> <span class="k">with</span> <span class="n">A</span> <span class="n">B</span> <span class="n">C</span><span class="o">,</span> <span class="o">{</span><span class="n">simp</span><span class="o">},</span> <span class="c1">-- base case}</span>
  <span class="n">simp</span> <span class="n">at</span> <span class="n">H</span> <span class="o">{</span><span class="n">contextual</span> <span class="o">:=</span> <span class="n">tt</span><span class="o">},</span>
  <span class="n">sorry</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>

<a name="126580159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580159" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580159">Kevin Buzzard (May 15 2018 at 07:48)</a>:</h4>
<p>I have isolated <code>contextual := tt</code> doing something</p>

<a name="126580165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580165" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580165">Gabriel Ebner (May 15 2018 at 07:48)</a>:</h4>
<blockquote>
<p>Right -- that's what I'm unclear about. Explicitly -- <code>simp * {contextual := tt}</code> does something different to <code>simp</code> in a situation where there is a _hypothesis_ of the form <code>X -&gt; Y</code>, in which case it does...what?</p>
</blockquote>
<p>Oh no, there is no difference in how simp treats implications in assumptions.  If you have a simp lemma/assumption <code>forall x, p x -&gt; f x=g x</code>, then <code>simp</code> will try to prove <code>p a</code> before rewriting <code>f a</code> to <code>g a</code>.  And it proves this condition using <code>simp</code> itself!  Small demo:</p>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="o">{</span><span class="n">q</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">}</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">n</span><span class="bp">=</span><span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">n</span><span class="bp">*</span><span class="n">n</span><span class="bp">=</span><span class="n">n</span> <span class="bp">→</span> <span class="n">q</span><span class="o">)</span> <span class="o">:</span> <span class="n">q</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">simp</span> <span class="bp">*</span>
</pre></div>


<p>Here <code>simp</code> first proves the condition <code>n*n = n</code> (using <code>simp</code>) before rewriting <code>q</code> to <code>true</code>.</p>

<a name="126580167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580167" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580167">Kevin Buzzard (May 15 2018 at 07:49)</a>:</h4>
<p>darn no I haven't</p>

<a name="126580178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580178" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580178">Kevin Buzzard (May 15 2018 at 07:49)</a>:</h4>
<p>but Gabriel has. Thanks!</p>

<a name="126580221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580221" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580221">Kevin Buzzard (May 15 2018 at 07:50)</a>:</h4>
<p>Wait -- there is no <code>contextual</code> here?</p>

<a name="126580229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580229" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580229">Gabriel Ebner (May 15 2018 at 07:51)</a>:</h4>
<p>No, <code>simp</code> can use conditional simp lemmas without <code>contextual:=tt</code>.  It uses <code>simp</code> to prove the condition.</p>

<a name="126580233"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580233" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580233">Patrick Massot (May 15 2018 at 07:51)</a>:</h4>
<p>Mario, the trouble is I want to prove </p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">big</span><span class="bp">.</span><span class="n">range_anti_mph</span> <span class="o">{</span><span class="n">φ</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">P</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">[</span><span class="n">decidable_pred</span> <span class="n">P</span><span class="o">]</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span>
  <span class="o">(</span><span class="n">Hop</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">R</span><span class="o">,</span> <span class="n">φ</span> <span class="o">(</span><span class="n">a</span> <span class="err">◆</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span> <span class="n">φ</span> <span class="n">b</span> <span class="err">◆</span> <span class="n">φ</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">Hnil</span> <span class="o">:</span> <span class="n">φ</span> <span class="n">nil</span> <span class="bp">=</span> <span class="n">nil</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">φ</span> <span class="o">(</span><span class="n">big</span><span class="o">[(</span><span class="err">◆</span><span class="o">)</span><span class="bp">/</span><span class="n">nil</span><span class="o">]</span><span class="bp">_</span><span class="o">(</span><span class="n">i</span><span class="bp">=</span><span class="n">a</span><span class="bp">..</span><span class="n">b</span> <span class="bp">|</span> <span class="o">(</span><span class="n">P</span> <span class="n">i</span><span class="o">))</span> <span class="n">F</span> <span class="n">i</span><span class="o">)</span> <span class="bp">=</span> <span class="n">big</span><span class="o">[(</span><span class="err">◆</span><span class="o">)</span><span class="bp">/</span><span class="n">nil</span><span class="o">]</span><span class="bp">_</span><span class="o">(</span><span class="n">i</span><span class="bp">=</span><span class="n">a</span><span class="bp">..</span><span class="n">b</span> <span class="bp">|</span> <span class="o">(</span><span class="n">P</span> <span class="o">(</span><span class="n">a</span><span class="bp">+</span><span class="n">b</span><span class="bp">-</span><span class="n">i</span><span class="o">)))</span> <span class="n">φ</span> <span class="o">(</span><span class="n">F</span> <span class="o">(</span><span class="n">a</span><span class="bp">+</span><span class="n">b</span><span class="bp">-</span><span class="n">i</span><span class="o">))</span>
</pre></div>


<p>I don't want the <code>a+b-i</code> in the conclusion to be some weird formula which is the same after a dozen rewrites</p>

<a name="126580245"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580245" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580245">Kevin Buzzard (May 15 2018 at 07:52)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">list</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">open</span> <span class="n">list</span>
<span class="kn">lemma</span> <span class="n">foldr_ext</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">f&#39;</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">β</span><span class="o">)</span>
  <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="err">∈</span> <span class="n">l</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">b</span> <span class="o">:</span> <span class="n">β</span><span class="o">,</span> <span class="n">f</span> <span class="n">a</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">f&#39;</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">foldr</span> <span class="n">f</span> <span class="n">s</span> <span class="n">l</span> <span class="bp">=</span> <span class="n">foldr</span> <span class="n">f&#39;</span> <span class="n">s</span> <span class="n">l</span> <span class="o">:=</span>
<span class="k">begin</span> <span class="n">induction</span> <span class="n">l</span> <span class="k">with</span> <span class="n">A</span> <span class="n">B</span> <span class="n">C</span><span class="o">,</span> <span class="o">{</span><span class="n">simp</span><span class="o">},</span> <span class="c1">-- base case}</span>
  <span class="n">simp</span> <span class="n">at</span> <span class="n">H</span><span class="o">,</span>
  <span class="n">simp</span> <span class="bp">*</span><span class="o">,</span>
  <span class="c1">-- dammit simp, prove it without using contextual</span>
  <span class="n">simp</span> <span class="bp">*</span> <span class="o">{</span><span class="n">contextual</span> <span class="o">:=</span> <span class="n">tt</span><span class="o">},</span> <span class="c1">-- what just happened?</span>
<span class="kn">end</span>
</pre></div>

<a name="126580277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580277" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580277">Kevin Buzzard (May 15 2018 at 07:52)</a>:</h4>
<p>That's what I don't get</p>

<a name="126580283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580283" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580283">Mario Carneiro (May 15 2018 at 07:52)</a>:</h4>
<p>I don't either. But I don't see that <code>2*a+whatever</code> anywhere in the statement either</p>

<a name="126580284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580284" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580284">Kevin Buzzard (May 15 2018 at 07:52)</a>:</h4>
<p>Can I break that last line down into simpler steps?</p>

<a name="126580286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580286" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580286">Patrick Massot (May 15 2018 at 07:52)</a>:</h4>
<p>Knowing of course that I proved</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">big</span><span class="bp">.</span><span class="n">anti_mph</span> <span class="o">{</span><span class="n">φ</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">R</span><span class="o">}</span>
  <span class="o">(</span><span class="n">Hop</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">R</span><span class="o">,</span> <span class="n">φ</span> <span class="o">(</span><span class="n">a</span> <span class="err">◆</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span> <span class="n">φ</span> <span class="n">b</span> <span class="err">◆</span> <span class="n">φ</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">Hnil</span> <span class="o">:</span> <span class="n">φ</span> <span class="n">nil</span> <span class="bp">=</span> <span class="n">nil</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">φ</span> <span class="o">(</span><span class="n">big</span><span class="o">[(</span><span class="err">◆</span><span class="o">)</span><span class="bp">/</span><span class="n">nil</span><span class="o">]</span><span class="bp">_</span><span class="o">(</span><span class="n">i</span> <span class="err">∈</span> <span class="n">r</span> <span class="bp">|</span> <span class="o">(</span><span class="n">P</span> <span class="n">i</span><span class="o">))</span> <span class="n">F</span> <span class="n">i</span><span class="o">)</span> <span class="bp">=</span> <span class="n">big</span><span class="o">[(</span><span class="err">◆</span><span class="o">)</span><span class="bp">/</span><span class="n">nil</span><span class="o">]</span><span class="bp">_</span><span class="o">(</span><span class="n">i</span> <span class="err">∈</span> <span class="n">r</span><span class="bp">.</span><span class="n">reverse</span> <span class="bp">|</span> <span class="o">(</span><span class="n">P</span> <span class="n">i</span><span class="o">))</span> <span class="n">φ</span> <span class="o">(</span><span class="n">F</span> <span class="n">i</span><span class="o">)</span>
</pre></div>


<p>a long time ago</p>

<a name="126580300"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580300" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580300">Patrick Massot (May 15 2018 at 07:53)</a>:</h4>
<p>I'm only fighting the <code>range'</code> stuff</p>

<a name="126580345"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580345" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580345">Patrick Massot (May 15 2018 at 07:54)</a>:</h4>
<p>And I have </p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">big</span><span class="bp">.</span><span class="n">map</span> <span class="o">{</span><span class="n">J</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">I</span> <span class="bp">→</span> <span class="n">J</span><span class="o">)</span> <span class="o">(</span><span class="n">P</span> <span class="o">:</span> <span class="n">J</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">[</span><span class="n">decidable_pred</span> <span class="n">P</span><span class="o">]</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">J</span> <span class="bp">→</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">big</span><span class="o">[(</span><span class="err">◆</span><span class="o">)</span><span class="bp">/</span><span class="n">nil</span><span class="o">]</span><span class="bp">_</span><span class="o">(</span><span class="n">j</span> <span class="err">∈</span> <span class="n">map</span> <span class="n">f</span> <span class="n">r</span> <span class="bp">|</span> <span class="o">(</span><span class="n">P</span> <span class="n">j</span><span class="o">))</span> <span class="o">(</span><span class="n">F</span> <span class="n">j</span><span class="o">))</span> <span class="bp">=</span> <span class="o">(</span><span class="n">big</span><span class="o">[(</span><span class="err">◆</span><span class="o">)</span><span class="bp">/</span><span class="n">nil</span><span class="o">]</span><span class="bp">_</span><span class="o">(</span><span class="n">i</span> <span class="err">∈</span> <span class="n">r</span> <span class="bp">|</span> <span class="o">(</span><span class="n">P</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)))</span> <span class="o">(</span><span class="n">F</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)))</span>
</pre></div>

<a name="126580348"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580348" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580348">Patrick Massot (May 15 2018 at 07:54)</a>:</h4>
<p>So I wanted to write <code>reverse (range' ...)</code> as a <code>map ... (range' ...)</code></p>

<a name="126580357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580357" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580357">Mario Carneiro (May 15 2018 at 07:55)</a>:</h4>
<p>What are you going to do with the <code>map</code> once you have it?</p>

<a name="126580362"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580362" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580362">Gabriel Ebner (May 15 2018 at 07:55)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span>  Look at the left-hand side of the implication in the induction hypothesis in foldr_ext.  Contextual simplification makes a difference here: simp then has the additional assumption <code>a ∈ l</code>, which it can use to apply <code>H</code>.</p>

<a name="126580404"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580404" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580404">Mario Carneiro (May 15 2018 at 07:56)</a>:</h4>
<p>Okay I think it is time to split this convo in two</p>

<a name="126580405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580405" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580405">Patrick Massot (May 15 2018 at 07:56)</a>:</h4>
<p>Yes sorry</p>

<a name="126580428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580428" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580428">Kevin Buzzard (May 15 2018 at 07:57)</a>:</h4>
<blockquote>
<p>Okay I think it is time to split this convo in two</p>
</blockquote>
<p>...given that neither thread is about the topic name ;-)</p>

<a name="126580490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580490" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580490">Gabriel Ebner (May 15 2018 at 07:59)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">case</span> <span class="n">list</span><span class="bp">.</span><span class="n">cons</span>
<span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">,</span>
<span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_2</span><span class="o">,</span>
<span class="n">f</span> <span class="n">f&#39;</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">β</span><span class="o">,</span>
<span class="n">s</span> <span class="o">:</span> <span class="n">β</span><span class="o">,</span>
<span class="n">h</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span>
<span class="n">t</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">,</span>
<span class="n">IH</span> <span class="o">:</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="err">∈</span> <span class="n">t</span> <span class="bp">→</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">β</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">f&#39;</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="bp">→</span> <span class="n">foldr</span> <span class="n">f</span> <span class="n">s</span> <span class="n">t</span> <span class="bp">=</span> <span class="n">foldr</span> <span class="n">f&#39;</span> <span class="n">s</span> <span class="n">t</span><span class="o">,</span>
<span class="n">H</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="err">∈</span> <span class="n">h</span> <span class="bp">::</span> <span class="n">t</span> <span class="bp">→</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">β</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">f&#39;</span> <span class="n">a</span> <span class="n">b</span>
<span class="err">⊢</span> <span class="n">foldr</span> <span class="n">f</span> <span class="n">s</span> <span class="o">(</span><span class="n">h</span> <span class="bp">::</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">foldr</span> <span class="n">f&#39;</span> <span class="n">s</span> <span class="o">(</span><span class="n">h</span> <span class="bp">::</span> <span class="n">t</span><span class="o">)</span>
</pre></div>


<p>This is the case for cons. ^^   In order to apply <code>IH</code>, you need to prove its left-hand side using <code>H</code>.  And to prove <code>a ∈ h :: t</code>, you need the <code>a ∈ t</code> from <code>IH</code>.</p>

<a name="126580729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580729" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580729">Kevin Buzzard (May 15 2018 at 08:07)</a>:</h4>
<p>I am beginning to understand now. I'm writing out the proof in full, and I have to apply <code>IH</code> and then apply <code>H</code>.</p>

<a name="126580768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580768" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580768">Kevin Buzzard (May 15 2018 at 08:08)</a>:</h4>
<p>So everything is there but somehow it's all in a bit of a tangle</p>

<a name="126580909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580909" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580909">Kevin Buzzard (May 15 2018 at 08:13)</a>:</h4>
<p>I think I have it now</p>

<a name="126580911"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580911" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580911">Kevin Buzzard (May 15 2018 at 08:13)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">got_it</span> <span class="o">(</span><span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">IH</span> <span class="o">:</span> <span class="o">(</span><span class="n">P</span> <span class="bp">→</span> <span class="n">R</span><span class="o">)</span> <span class="bp">→</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">H0</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">→</span> <span class="n">Q</span><span class="o">)</span> <span class="o">(</span><span class="n">H&#39;</span> <span class="o">:</span> <span class="n">Q</span> <span class="bp">→</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="n">S</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="c1">--simp *, -- fails</span>
<span class="n">simp</span> <span class="bp">*</span> <span class="o">{</span><span class="n">contextual</span> <span class="o">:=</span> <span class="n">tt</span><span class="o">},</span>
<span class="kn">end</span>
</pre></div>

<a name="126580956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580956" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580956">Kevin Buzzard (May 15 2018 at 08:14)</a>:</h4>
<p>I want to use <code>IH</code> to prove <code>S</code> but the hypothesis of <code>IH</code> isn't immediately true; however simp can prove it using other hypotheses.</p>

<a name="126580975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126580975" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126580975">Kevin Buzzard (May 15 2018 at 08:16)</a>:</h4>
<p>Thanks Gabriel. To show your time isn't being wasted here I'll add it to the simp docs (once I've done another 8 hours of marking..)</p>

<a name="126581149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126581149" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126581149">Kevin Buzzard (May 15 2018 at 08:20)</a>:</h4>
<p>All of these conversations (threads about what simp does and doesn't do, threads about how to make type class inference work etc) -- it's in some sense sad that they just appear here and then disappear. The type class inference thread especially contains some really useful tips (in the sense that I was genuinely stuck about three times and then got unstucked by the contents of that thread). I will try to write some notes on that thread too, but I have so much marking at the minute and I have decided that it is time to prove an affine scheme is a scheme so I spend all my spare time on that. I am using the zulip "star" functionality a lot at the minute -- star meaning "get back to this later and write it up properly".</p>

<a name="126581151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126581151" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126581151">Kevin Buzzard (May 15 2018 at 08:20)</a>:</h4>
<p>Thanks to all as ever.</p>

<a name="126581273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126581273" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126581273">Patrick Massot (May 15 2018 at 08:24)</a>:</h4>
<p>Next year Lean will mark all this for you</p>

<a name="126581275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126581275" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126581275">Kevin Buzzard (May 15 2018 at 08:24)</a>:</h4>
<p>That's the plan!</p>

<a name="126718080"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126718080" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126718080">Patrick Massot (May 17 2018 at 20:55)</a>:</h4>
<p>Because this <code>{contextual := true}</code> discussion I'm back to beginner level. Except that, instead of trying <code>simp</code> whatever the goal and hope for the best, I try <code>simp * at * { contextual := true}</code></p>

<a name="126718124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/126718124" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#126718124">Patrick Massot (May 17 2018 at 20:56)</a>:</h4>
<p>And often it works!</p>

<a name="163577441"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/163577441" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#163577441">Kevin Buzzard (Apr 17 2019 at 16:29)</a>:</h4>
<blockquote>
<p>This natural number substraction is really a nightmare. Now I want <code>b + k + 1 - (a + k) = b + 1 - a</code>. It's almost the same I had a couple of days ago. But I'm stuck again...</p>
</blockquote>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">omega</span>
<span class="kn">example</span> <span class="o">(</span><span class="n">k</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">+</span> <span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">-</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">k</span><span class="o">)</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">a</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">omega</span>
</pre></div>


<p>It works! It works!</p>

<a name="163577634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/rw%20under%20a%20union/near/163577634" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/73586rwunderaunion.html#163577634">Kevin Buzzard (Apr 17 2019 at 16:31)</a>:</h4>
<p>ha ha it's also referring to a question that was about 100 posts before the answer :D</p>


{% endraw %}
