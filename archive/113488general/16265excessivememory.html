---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/16265excessivememory.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html">excessive memory</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="134535868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134535868" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134535868">Johan Commelin (Sep 24 2018 at 16:06)</a>:</h4>
<p>On my laptop I get the following error pretty often:</p>
<div class="codehilite"><pre><span></span>excessive memory consumption detected at &#39;replace&#39; (potential solution: increase memory consumption threshold)
</pre></div>

<a name="134535884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134535884" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134535884">Kenny Lau (Sep 24 2018 at 16:06)</a>:</h4>
<p>maybe you should increase memory consumption threshold</p>

<a name="134535887"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134535887" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134535887">Johan Commelin (Sep 24 2018 at 16:06)</a>:</h4>
<p>I also see in <code>top</code> that there are 8 processes of VScode open, whereas I just <code>kill -9</code>ed all of them.</p>

<a name="134535895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134535895" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134535895">Johan Commelin (Sep 24 2018 at 16:06)</a>:</h4>
<p>This is on an almost empty file</p>

<a name="134535903"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134535903" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134535903">Johan Commelin (Sep 24 2018 at 16:07)</a>:</h4>
<p>I just killed all Lean and VScodes</p>

<a name="134535922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134535922" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134535922">Johan Commelin (Sep 24 2018 at 16:07)</a>:</h4>
<p>Does this just mean that my laptop is too old for Lean?</p>

<a name="134536066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134536066" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134536066">Johan Commelin (Sep 24 2018 at 16:09)</a>:</h4>
<p>Hmm.. if I close the VScode window, all the processes are gone in <code>top</code>. I don't know why VScode spawns so many subprocesses if I have only one file open.</p>

<a name="134536204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134536204" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134536204">Johan Commelin (Sep 24 2018 at 16:11)</a>:</h4>
<p>I have at least 2.5 GB of unused RAM on this box. I wish that would be enough.</p>

<a name="134536228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134536228" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134536228">Johan Commelin (Sep 24 2018 at 16:11)</a>:</h4>
<p>Maybe I should try a reinstall of VScode. But this feels like cargo-cult troubleshooting.</p>

<a name="134536373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134536373" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134536373">Reid Barton (Sep 24 2018 at 16:13)</a>:</h4>
<p>Were they really different processes? Do you have 8 cpus?</p>

<a name="134536388"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134536388" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134536388">Reid Barton (Sep 24 2018 at 16:13)</a>:</h4>
<p>I guess probably not if your laptop is 11 years old</p>

<a name="134536454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134536454" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134536454">Johan Commelin (Sep 24 2018 at 16:14)</a>:</h4>
<p>I have two single thread cpu's I think</p>

<a name="134536484"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134536484" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134536484">Johan Commelin (Sep 24 2018 at 16:14)</a>:</h4>
<p>One socket with 2 cores; and 1 thread per core.</p>

<a name="134536505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134536505" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134536505">Johan Commelin (Sep 24 2018 at 16:15)</a>:</h4>
<p>They had different process id's</p>

<a name="134536515"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134536515" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134536515">Reid Barton (Sep 24 2018 at 16:15)</a>:</h4>
<p>Ah, okay</p>

<a name="134536625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134536625" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134536625">Reid Barton (Sep 24 2018 at 16:16)</a>:</h4>
<p>I think "excessive memory" means Lean hit a limit it set for itself, though. Not "the machine is out of memory".</p>

<a name="134536641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134536641" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134536641">Reid Barton (Sep 24 2018 at 16:16)</a>:</h4>
<p>I see this error a lot and just restart lean</p>

<a name="134536649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134536649" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134536649">Johan Commelin (Sep 24 2018 at 16:16)</a>:</h4>
<p>But it is annoying when you get it right at startup</p>

<a name="134536668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134536668" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134536668">Johan Commelin (Sep 24 2018 at 16:17)</a>:</h4>
<p>If I'dd get it once a day I could live with it.</p>

<a name="134579407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134579407" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134579407">Kevin Buzzard (Sep 25 2018 at 07:17)</a>:</h4>
<p>It's a shame. So many people here, serious people, talk about issues with compile times and stuff like this. I use Lean on a 2-year-old PC with 8 cores and 16 gigs of ram, and mathlib compiles in 6 minutes. I think we need to crowd fund for better hardware for the community. I should edit the mathoverflow post -- "instead of upvoting, consider a $5 donation to the Lean Hardware Hardship fund"</p>

<a name="134580139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134580139" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134580139">Scott Morrison (Sep 25 2018 at 07:35)</a>:</h4>
<p>On the subject of hardware, I managed to install a version of CoCalc inside Docker yesterday, running on my hardware.</p>

<a name="134580140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134580140" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134580140">Scott Morrison (Sep 25 2018 at 07:35)</a>:</h4>
<p>It's at &lt;<a href="https://54.91.0.213:8080/app" target="_blank" title="https://54.91.0.213:8080/app">https://54.91.0.213:8080/app</a>&gt; for now (no promises about uptime yet!)</p>

<a name="134580182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134580182" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134580182">Scott Morrison (Sep 25 2018 at 07:36)</a>:</h4>
<p>(and apologies that it is over https but there's no certificate; you may have to click through a warning, depending on your browser)</p>

<a name="134580183"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134580183" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134580183">Scott Morrison (Sep 25 2018 at 07:36)</a>:</h4>
<p>I think for now anyone can create an account there.</p>

<a name="134580184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134580184" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134580184">Scott Morrison (Sep 25 2018 at 07:36)</a>:</h4>
<p>It's running on quite fast hardware.</p>

<a name="134580201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134580201" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134580201">Scott Morrison (Sep 25 2018 at 07:37)</a>:</h4>
<p>Unfortunately <code>cocalc</code> by default seems to kill long-running processes, so I can't actually run <code>leanpkg build</code> on mathlib to time it...</p>

<a name="134580202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134580202" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134580202">Scott Morrison (Sep 25 2018 at 07:37)</a>:</h4>
<p>Hopefully there is a setting somewhere to disable this, but I haven't found it.</p>

<a name="134581116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134581116" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134581116">Kevin Buzzard (Sep 25 2018 at 08:00)</a>:</h4>
<p>You might have to pay. I will learn more about this today (cocalc admin is on my list). I think the idea is that I get some credits for a project, and one of the things I can spend credits on is leaving processes to run for longer.</p>

<a name="134590013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134590013" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134590013">Reid Barton (Sep 25 2018 at 11:33)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span>, in case you're unfamiliar with it, <a href="https://certbot.eff.org/" target="_blank" title="https://certbot.eff.org/">https://certbot.eff.org/</a> is a very easy way to set up a properly-signed SSL certificate, at least on Ubuntu systems or similar.</p>

<a name="134590071"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134590071" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134590071">Reid Barton (Sep 25 2018 at 11:34)</a>:</h4>
<p>Though if you have some strange firewall setup, it might be a bit more complicated.</p>

<a name="134590794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134590794" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134590794">Patrick Massot (Sep 25 2018 at 11:49)</a>:</h4>
<p>I created an account and tried to use Lean but it doesn't seem to work.</p>

<a name="134686294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134686294" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134686294">William Stein (Sep 26 2018 at 16:12)</a>:</h4>
<blockquote>
<p>Unfortunately <code>cocalc</code> by default seems to kill long-running processes, so I can't actually run <code>leanpkg build</code> on mathlib to time it...</p>
</blockquote>
<p>Send me a link to your project (or open a support request by clicking Help with your project open in cocalc) and I'll increase the "idle timeout" from the default (30 minutes) to something much longer.</p>

<a name="134686311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134686311" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134686311">William Stein (Sep 26 2018 at 16:12)</a>:</h4>
<blockquote>
<p>You might have to pay. I will learn more about this today (cocalc admin is on my list). I think the idea is that I get some credits for a project, and one of the things I can spend credits on is leaving processes to run for longer.</p>
</blockquote>
<p>Yep, that's the "idle timeout" quota.</p>

<a name="134691657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134691657" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134691657">Reid Barton (Sep 26 2018 at 17:47)</a>:</h4>
<p>But Scott is running the CoCalc software on his own server, right? So Scott needs to make that idle timeout change in his own copy</p>

<a name="134705207"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134705207" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134705207">Scott Morrison (Sep 26 2018 at 21:42)</a>:</h4>
<p>Yes, <span class="user-mention" data-user-id="116034">@William Stein</span>, this was a question about cocalc in Docker.</p>
<p>(Don't worry, I'm not being distracted by Docker; I'm working on getting courses signed up to the real cocalc too. :-)</p>
<p>At least in docker, the processes are being killed (exit code 137) much faster than every 30 minutes; it's more like 3 minutes.</p>

<a name="134707301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/excessive%20memory/near/134707301" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/16265excessivememory.html#134707301">William Stein (Sep 26 2018 at 22:25)</a>:</h4>
<blockquote>
<p>At least in docker, the processes are being killed (exit code 137) much faster than every 30 minutes; it's more like 3 minutes.</p>
</blockquote>
<p>OK, that's weird.  By default, I don't think anything is ever killed by cocalc in Docker, since there are no quotas/upgrades/etc. for docker-cocalc.  Also, CoCalc doesn't kill processes when something is idle -- it kills entire projects.  So it may be something particular to your Docker setup.   What's the simplest example that I can try to reproduce of what you're observing?</p>


{% endraw %}
