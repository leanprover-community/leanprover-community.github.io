---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/65824liftingcompletelattices.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/65824liftingcompletelattices.html">lifting complete lattices</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="188938782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lifting%20complete%20lattices/near/188938782" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65824liftingcompletelattices.html#188938782">Johan Commelin (Feb 24 2020 at 16:00)</a>:</h4>
<p>It seems to me that lifting a complete lattice gives you very very bad definitional equalities for <code>supr</code> and <code>infi</code>. I haven't really built an MWE, and I need to run to my train now. But a quasi-MWE is here: <a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20order.galois_connection%20data.set.lattice%0A%0Auniverse%20variables%20u%20u'%0A%0Avariables%20%7BE%20%3A%20Type*%7D%20%7Bs%20%3A%20set%20E%7D%0A%0Aopen%20set%20lattice%0A%0A--%20Move%20this!!%20--%20this%20is%20some%20where%20in%20filter.lean%20but%20should%20be%20in%20a%20more%20general%20file%0Anamespace%20lattice%0Avariables%20%7B%CE%B1%20%3A%20Type%20u%7D%0A%0Adef%20complete_lattice.copy%20%28c%20%3A%20complete_lattice%20%CE%B1%29%0A%20%20%28le%20%3A%20%CE%B1%20%E2%86%92%20%CE%B1%20%E2%86%92%20Prop%29%20%28eq_le%20%3A%20le%20%3D%20%40complete_lattice.le%20%CE%B1%20c%29%0A%20%20%28top%20%3A%20%CE%B1%29%20%28eq_top%20%3A%20top%20%3D%20%40complete_lattice.top%20%CE%B1%20c%29%0A%20%20%28bot%20%3A%20%CE%B1%29%20%28eq_bot%20%3A%20bot%20%3D%20%40complete_lattice.bot%20%CE%B1%20c%29%0A%20%20%28sup%20%3A%20%CE%B1%20%E2%86%92%20%CE%B1%20%E2%86%92%20%CE%B1%29%20%28eq_sup%20%3A%20sup%20%3D%20%40complete_lattice.sup%20%CE%B1%20c%29%0A%20%20%28inf%20%3A%20%CE%B1%20%E2%86%92%20%CE%B1%20%E2%86%92%20%CE%B1%29%20%28eq_inf%20%3A%20inf%20%3D%20%40complete_lattice.inf%20%CE%B1%20c%29%0A%20%20%28Sup%20%3A%20set%20%CE%B1%20%E2%86%92%20%CE%B1%29%20%28eq_Sup%20%3A%20Sup%20%3D%20%40complete_lattice.Sup%20%CE%B1%20c%29%0A%20%20%28Inf%20%3A%20set%20%CE%B1%20%E2%86%92%20%CE%B1%29%20%28eq_Inf%20%3A%20Inf%20%3D%20%40complete_lattice.Inf%20%CE%B1%20c%29%20%3A%0A%20%20complete_lattice%20%CE%B1%20%3A%3D%0Abegin%0A%20%20refine%20%7B%20le%20%3A%3D%20le%2C%20top%20%3A%3D%20top%2C%20bot%20%3A%3D%20bot%2C%20sup%20%3A%3D%20sup%2C%20inf%20%3A%3D%20inf%2C%20Sup%20%3A%3D%20Sup%2C%20Inf%20%3A%3D%20Inf%2C%20..%7D%3B%0A%20%20%20%20subst_vars%2C%0A%20%20exact%20%40complete_lattice.le_refl%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_trans%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_antisymm%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_sup_left%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_sup_right%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.sup_le%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.inf_le_left%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.inf_le_right%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_inf%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_top%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.bot_le%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_Sup%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.Sup_le%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.Inf_le%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_Inf%20%CE%B1%20c%0Aend%0A%0Aend%20lattice%0A%0Adef%20tmp%20%28s%20%3A%20set%20E%29%20%3A%20%40galois_insertion%20%28order_dual%20%28set%20E%29%29%20%28order_dual%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%20_%20_%0A%20%20%28%CE%BB%20%28s'%20%3A%20set%20E%29%2C%20%28%E2%9F%A8s%20%E2%88%A9%20s'%2C%20inter_subset_left%20s%20s'%E2%9F%A9%20%3A%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%29%0A%20%20%28%CE%BB%20%28s'%20%3A%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%2C%20%28s'%20%3A%20set%20E%29%29%20%3A%3D%0A%7B%20choice%20%3A%3D%20%CE%BB%20x%20hx%2C%20%E2%9F%A8x%2C%20subset.trans%20hx%20%24%20inter_subset_left%20_%20_%E2%9F%A9%2C%0A%20%20gc%20%3A%3D%20%CE%BB%20%28x%20%3A%20set%20E%29%20%28s'%20%3A%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%2C%20show%20s'%20%E2%89%A4%20%E2%9F%A8s%20%E2%88%A9%20x%2C%20_%E2%9F%A9%20%E2%86%94%20%E2%86%91s'%20%E2%89%A4%20x%2C%0A%20%20%20%20from%20%E2%9F%A8%CE%BB%20h%2C%20le_trans%20h%20%24%20inter_subset_right%20_%20_%2C%20subset_inter%20s'.property%E2%9F%A9%2C%0A%20%20le_l_u%20%3A%3D%20%CE%BB%20s'%2C%20inter_subset_right%20_%20_%2C%0A%20%20choice_eq%20%3A%3D%20%CE%BB%20%28x%20%3A%20set%20E%29%20h%2C%20subtype.ext.2%20%24%20subset.antisymm%20h%20%24%20inter_subset_right%20_%20_%20%7D%0A%0Adef%20tmpi%20%3A%20complete_lattice%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%20%3A%3D%0A%40order_dual.lattice.complete_lattice%20%28order_dual%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%20%24%0Agalois_insertion.lift_complete_lattice%20%28tmp%20s%29%0A%0Ainstance%20tmpii%20%3A%20complete_lattice%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%20%3A%3D%20tmpi.copy%0A%2F-%20le%20%20-%2F%20%28%E2%89%A4%29%20rfl%0A%2F-%20top%20-%2F%20%E2%9F%A8s%2C%20subset.refl%20s%E2%9F%A9%20%28subtype.coe_ext.mpr%20%24%20show%20s%20%3D%20s%20%E2%88%A9%20univ%2C%20from%20%28inter_univ%20s%29.symm%29%0A%2F-%20bot%20-%2F%20%E2%9F%A8%E2%88%85%2C%20_%E2%9F%A9%20rfl%0A%2F-%20sup%20-%2F%20%28%CE%BB%20s%E2%82%81%20s%E2%82%82%2C%20%E2%9F%A8s%E2%82%81%20%E2%88%AA%20s%E2%82%82%2C%20_%E2%9F%A9%29%20rfl%0A%2F-%20inf%20-%2F%20%28%CE%BB%20s%E2%82%81%20s%E2%82%82%2C%20%E2%9F%A8s%E2%82%81%20%E2%88%A9%20s%E2%82%82%2C%20subset.trans%20%28inter_subset_left%20_%20_%29%20s%E2%82%81.2%E2%9F%A9%29%0A%28by%20%7B%20ext%20s%E2%82%81%20s%E2%82%82%2C%20rw%20subtype.coe_ext%2C%20show%20%28s%E2%82%81%20%3A%20set%20E%29%20%E2%88%A9%20s%E2%82%82%20%3D%20s%20%E2%88%A9%20%28s%E2%82%81%20%E2%88%A9%20s%E2%82%82%29%2C%0A%20%20refine%20%28inter_eq_self_of_subset_right%20_%29.symm%2C%20exact%20subset.trans%20%28inter_subset_left%20_%20_%29%20s%E2%82%81.2%20%7D%29%0A%2F-%20Sup%20-%2F%20%28%CE%BB%20S%2C%20%E2%9F%A8%28%E2%8B%83%20s%20%E2%88%88%20S%2C%20%28s%20%3A%20set%20E%29%29%2C%20_%E2%9F%A9%29%20rfl%0A%2F-%20Inf%20-%2F%20%28%CE%BB%20S%2C%20%E2%9F%A8s%20%E2%88%A9%20%28%E2%8B%82%20s%20%E2%88%88%20S%2C%20%28s%20%3A%20set%20E%29%29%2C%20inter_subset_left%20_%20_%E2%9F%A9%29%20rfl%0A%0A%2F-%0ATODO%3A%0A--%20Lifting%20a%20complete%20lattice%20along%20a%20galois%20insertion%20gives%20horrible%0A--%20%60supr%60%20and%20%60infi%60%20as%20can%20be%20seen%20in%20the%20example%20below.%0A--%20TODO%3A%20Fix%20this%20in%20general%0A-%2F%0A%0Alemma%20help%20%7B%CE%B9%20%3A%20Sort%20u'%7D%20%28f%20%3A%20%CE%B9%20%E2%86%92%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%20%3A%0A%20%20%28%28%28%E2%A8%85%20i%2C%20f%20i%29%20%3A%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%20%3A%20set%20E%29%20%3D%20s%20%E2%88%A9%20%28%E2%8B%82%20i%2C%20%28f%20i%20%3A%20set%20E%29%29%20%3A%3D%0Abegin%0A%20%20have%20%3A%3D%20%28tmp%20s%29.gc.l_supr%2C%0A%20%20swap%203%2C%20exact%20%CE%BB%20%28i%3A%CE%B9%29%2C%20%28f%20i%20%3A%20set%20E%29%2C%0A%20%20rw%20subtype.coe_ext%20at%20this%2C%0A%20%20dsimp%20at%20this%2C%0A%20%20convert%20this%2C%0A%20%20show%20s%20%E2%88%A9%20_%20%3D%20s%20%E2%88%A9%20_%2C%0A%20%20sorry%0A%20%20--%20apply%20subset.antisymm%2C%0A%20%20--%20%7B%20sorry%20%7D%2C%0A%20%20--%20%7B%20refine%20%28tmp%20s%29.gc.l_supr%2C%20%7D%2C%0Aend" target="_blank" title="https://leanprover-community.github.io/lean-web-editor/#code=import%20order.galois_connection%20data.set.lattice%0A%0Auniverse%20variables%20u%20u'%0A%0Avariables%20%7BE%20%3A%20Type*%7D%20%7Bs%20%3A%20set%20E%7D%0A%0Aopen%20set%20lattice%0A%0A--%20Move%20this!!%20--%20this%20is%20some%20where%20in%20filter.lean%20but%20should%20be%20in%20a%20more%20general%20file%0Anamespace%20lattice%0Avariables%20%7B%CE%B1%20%3A%20Type%20u%7D%0A%0Adef%20complete_lattice.copy%20%28c%20%3A%20complete_lattice%20%CE%B1%29%0A%20%20%28le%20%3A%20%CE%B1%20%E2%86%92%20%CE%B1%20%E2%86%92%20Prop%29%20%28eq_le%20%3A%20le%20%3D%20%40complete_lattice.le%20%CE%B1%20c%29%0A%20%20%28top%20%3A%20%CE%B1%29%20%28eq_top%20%3A%20top%20%3D%20%40complete_lattice.top%20%CE%B1%20c%29%0A%20%20%28bot%20%3A%20%CE%B1%29%20%28eq_bot%20%3A%20bot%20%3D%20%40complete_lattice.bot%20%CE%B1%20c%29%0A%20%20%28sup%20%3A%20%CE%B1%20%E2%86%92%20%CE%B1%20%E2%86%92%20%CE%B1%29%20%28eq_sup%20%3A%20sup%20%3D%20%40complete_lattice.sup%20%CE%B1%20c%29%0A%20%20%28inf%20%3A%20%CE%B1%20%E2%86%92%20%CE%B1%20%E2%86%92%20%CE%B1%29%20%28eq_inf%20%3A%20inf%20%3D%20%40complete_lattice.inf%20%CE%B1%20c%29%0A%20%20%28Sup%20%3A%20set%20%CE%B1%20%E2%86%92%20%CE%B1%29%20%28eq_Sup%20%3A%20Sup%20%3D%20%40complete_lattice.Sup%20%CE%B1%20c%29%0A%20%20%28Inf%20%3A%20set%20%CE%B1%20%E2%86%92%20%CE%B1%29%20%28eq_Inf%20%3A%20Inf%20%3D%20%40complete_lattice.Inf%20%CE%B1%20c%29%20%3A%0A%20%20complete_lattice%20%CE%B1%20%3A%3D%0Abegin%0A%20%20refine%20%7B%20le%20%3A%3D%20le%2C%20top%20%3A%3D%20top%2C%20bot%20%3A%3D%20bot%2C%20sup%20%3A%3D%20sup%2C%20inf%20%3A%3D%20inf%2C%20Sup%20%3A%3D%20Sup%2C%20Inf%20%3A%3D%20Inf%2C%20..%7D%3B%0A%20%20%20%20subst_vars%2C%0A%20%20exact%20%40complete_lattice.le_refl%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_trans%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_antisymm%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_sup_left%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_sup_right%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.sup_le%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.inf_le_left%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.inf_le_right%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_inf%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_top%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.bot_le%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_Sup%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.Sup_le%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.Inf_le%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_Inf%20%CE%B1%20c%0Aend%0A%0Aend%20lattice%0A%0Adef%20tmp%20%28s%20%3A%20set%20E%29%20%3A%20%40galois_insertion%20%28order_dual%20%28set%20E%29%29%20%28order_dual%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%20_%20_%0A%20%20%28%CE%BB%20%28s'%20%3A%20set%20E%29%2C%20%28%E2%9F%A8s%20%E2%88%A9%20s'%2C%20inter_subset_left%20s%20s'%E2%9F%A9%20%3A%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%29%0A%20%20%28%CE%BB%20%28s'%20%3A%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%2C%20%28s'%20%3A%20set%20E%29%29%20%3A%3D%0A%7B%20choice%20%3A%3D%20%CE%BB%20x%20hx%2C%20%E2%9F%A8x%2C%20subset.trans%20hx%20%24%20inter_subset_left%20_%20_%E2%9F%A9%2C%0A%20%20gc%20%3A%3D%20%CE%BB%20%28x%20%3A%20set%20E%29%20%28s'%20%3A%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%2C%20show%20s'%20%E2%89%A4%20%E2%9F%A8s%20%E2%88%A9%20x%2C%20_%E2%9F%A9%20%E2%86%94%20%E2%86%91s'%20%E2%89%A4%20x%2C%0A%20%20%20%20from%20%E2%9F%A8%CE%BB%20h%2C%20le_trans%20h%20%24%20inter_subset_right%20_%20_%2C%20subset_inter%20s'.property%E2%9F%A9%2C%0A%20%20le_l_u%20%3A%3D%20%CE%BB%20s'%2C%20inter_subset_right%20_%20_%2C%0A%20%20choice_eq%20%3A%3D%20%CE%BB%20%28x%20%3A%20set%20E%29%20h%2C%20subtype.ext.2%20%24%20subset.antisymm%20h%20%24%20inter_subset_right%20_%20_%20%7D%0A%0Adef%20tmpi%20%3A%20complete_lattice%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%20%3A%3D%0A%40order_dual.lattice.complete_lattice%20%28order_dual%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%20%24%0Agalois_insertion.lift_complete_lattice%20%28tmp%20s%29%0A%0Ainstance%20tmpii%20%3A%20complete_lattice%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%20%3A%3D%20tmpi.copy%0A%2F-%20le%20%20-%2F%20%28%E2%89%A4%29%20rfl%0A%2F-%20top%20-%2F%20%E2%9F%A8s%2C%20subset.refl%20s%E2%9F%A9%20%28subtype.coe_ext.mpr%20%24%20show%20s%20%3D%20s%20%E2%88%A9%20univ%2C%20from%20%28inter_univ%20s%29.symm%29%0A%2F-%20bot%20-%2F%20%E2%9F%A8%E2%88%85%2C%20_%E2%9F%A9%20rfl%0A%2F-%20sup%20-%2F%20%28%CE%BB%20s%E2%82%81%20s%E2%82%82%2C%20%E2%9F%A8s%E2%82%81%20%E2%88%AA%20s%E2%82%82%2C%20_%E2%9F%A9%29%20rfl%0A%2F-%20inf%20-%2F%20%28%CE%BB%20s%E2%82%81%20s%E2%82%82%2C%20%E2%9F%A8s%E2%82%81%20%E2%88%A9%20s%E2%82%82%2C%20subset.trans%20%28inter_subset_left%20_%20_%29%20s%E2%82%81.2%E2%9F%A9%29%0A%28by%20%7B%20ext%20s%E2%82%81%20s%E2%82%82%2C%20rw%20subtype.coe_ext%2C%20show%20%28s%E2%82%81%20%3A%20set%20E%29%20%E2%88%A9%20s%E2%82%82%20%3D%20s%20%E2%88%A9%20%28s%E2%82%81%20%E2%88%A9%20s%E2%82%82%29%2C%0A%20%20refine%20%28inter_eq_self_of_subset_right%20_%29.symm%2C%20exact%20subset.trans%20%28inter_subset_left%20_%20_%29%20s%E2%82%81.2%20%7D%29%0A%2F-%20Sup%20-%2F%20%28%CE%BB%20S%2C%20%E2%9F%A8%28%E2%8B%83%20s%20%E2%88%88%20S%2C%20%28s%20%3A%20set%20E%29%29%2C%20_%E2%9F%A9%29%20rfl%0A%2F-%20Inf%20-%2F%20%28%CE%BB%20S%2C%20%E2%9F%A8s%20%E2%88%A9%20%28%E2%8B%82%20s%20%E2%88%88%20S%2C%20%28s%20%3A%20set%20E%29%29%2C%20inter_subset_left%20_%20_%E2%9F%A9%29%20rfl%0A%0A%2F-%0ATODO%3A%0A--%20Lifting%20a%20complete%20lattice%20along%20a%20galois%20insertion%20gives%20horrible%0A--%20%60supr%60%20and%20%60infi%60%20as%20can%20be%20seen%20in%20the%20example%20below.%0A--%20TODO%3A%20Fix%20this%20in%20general%0A-%2F%0A%0Alemma%20help%20%7B%CE%B9%20%3A%20Sort%20u'%7D%20%28f%20%3A%20%CE%B9%20%E2%86%92%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%20%3A%0A%20%20%28%28%28%E2%A8%85%20i%2C%20f%20i%29%20%3A%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%20%3A%20set%20E%29%20%3D%20s%20%E2%88%A9%20%28%E2%8B%82%20i%2C%20%28f%20i%20%3A%20set%20E%29%29%20%3A%3D%0Abegin%0A%20%20have%20%3A%3D%20%28tmp%20s%29.gc.l_supr%2C%0A%20%20swap%203%2C%20exact%20%CE%BB%20%28i%3A%CE%B9%29%2C%20%28f%20i%20%3A%20set%20E%29%2C%0A%20%20rw%20subtype.coe_ext%20at%20this%2C%0A%20%20dsimp%20at%20this%2C%0A%20%20convert%20this%2C%0A%20%20show%20s%20%E2%88%A9%20_%20%3D%20s%20%E2%88%A9%20_%2C%0A%20%20sorry%0A%20%20--%20apply%20subset.antisymm%2C%0A%20%20--%20%7B%20sorry%20%7D%2C%0A%20%20--%20%7B%20refine%20%28tmp%20s%29.gc.l_supr%2C%20%7D%2C%0Aend">https://leanprover-community.github.io/lean-web-editor/#code=import%20order.galois_connection%20data.set.lattice%0A%0Auniverse%20variables%20u%20u'%0A%0Avariables%20%7BE%20%3A%20Type*%7D%20%7Bs%20%3A%20set%20E%7D%0A%0Aopen%20set%20lattice%0A%0A--%20Move%20this!!%20--%20this%20is%20some%20where%20in%20filter.lean%20but%20should%20be%20in%20a%20more%20general%20file%0Anamespace%20lattice%0Avariables%20%7B%CE%B1%20%3A%20Type%20u%7D%0A%0Adef%20complete_lattice.copy%20%28c%20%3A%20complete_lattice%20%CE%B1%29%0A%20%20%28le%20%3A%20%CE%B1%20%E2%86%92%20%CE%B1%20%E2%86%92%20Prop%29%20%28eq_le%20%3A%20le%20%3D%20%40complete_lattice.le%20%CE%B1%20c%29%0A%20%20%28top%20%3A%20%CE%B1%29%20%28eq_top%20%3A%20top%20%3D%20%40complete_lattice.top%20%CE%B1%20c%29%0A%20%20%28bot%20%3A%20%CE%B1%29%20%28eq_bot%20%3A%20bot%20%3D%20%40complete_lattice.bot%20%CE%B1%20c%29%0A%20%20%28sup%20%3A%20%CE%B1%20%E2%86%92%20%CE%B1%20%E2%86%92%20%CE%B1%29%20%28eq_sup%20%3A%20sup%20%3D%20%40complete_lattice.sup%20%CE%B1%20c%29%0A%20%20%28inf%20%3A%20%CE%B1%20%E2%86%92%20%CE%B1%20%E2%86%92%20%CE%B1%29%20%28eq_inf%20%3A%20inf%20%3D%20%40complete_lattice.inf%20%CE%B1%20c%29%0A%20%20%28Sup%20%3A%20set%20%CE%B1%20%E2%86%92%20%CE%B1%29%20%28eq_Sup%20%3A%20Sup%20%3D%20%40complete_lattice.Sup%20%CE%B1%20c%29%0A%20%20%28Inf%20%3A%20set%20%CE%B1%20%E2%86%92%20%CE%B1%29%20%28eq_Inf%20%3A%20Inf%20%3D%20%40complete_lattice.Inf%20%CE%B1%20c%29%20%3A%0A%20%20complete_lattice%20%CE%B1%20%3A%3D%0Abegin%0A%20%20refine%20%7B%20le%20%3A%3D%20le%2C%20top%20%3A%3D%20top%2C%20bot%20%3A%3D%20bot%2C%20sup%20%3A%3D%20sup%2C%20inf%20%3A%3D%20inf%2C%20Sup%20%3A%3D%20Sup%2C%20Inf%20%3A%3D%20Inf%2C%20..%7D%3B%0A%20%20%20%20subst_vars%2C%0A%20%20exact%20%40complete_lattice.le_refl%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_trans%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_antisymm%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_sup_left%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_sup_right%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.sup_le%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.inf_le_left%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.inf_le_right%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_inf%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_top%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.bot_le%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_Sup%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.Sup_le%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.Inf_le%20%CE%B1%20c%2C%0A%20%20exact%20%40complete_lattice.le_Inf%20%CE%B1%20c%0Aend%0A%0Aend%20lattice%0A%0Adef%20tmp%20%28s%20%3A%20set%20E%29%20%3A%20%40galois_insertion%20%28order_dual%20%28set%20E%29%29%20%28order_dual%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%20_%20_%0A%20%20%28%CE%BB%20%28s'%20%3A%20set%20E%29%2C%20%28%E2%9F%A8s%20%E2%88%A9%20s'%2C%20inter_subset_left%20s%20s'%E2%9F%A9%20%3A%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%29%0A%20%20%28%CE%BB%20%28s'%20%3A%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%2C%20%28s'%20%3A%20set%20E%29%29%20%3A%3D%0A%7B%20choice%20%3A%3D%20%CE%BB%20x%20hx%2C%20%E2%9F%A8x%2C%20subset.trans%20hx%20%24%20inter_subset_left%20_%20_%E2%9F%A9%2C%0A%20%20gc%20%3A%3D%20%CE%BB%20%28x%20%3A%20set%20E%29%20%28s'%20%3A%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%2C%20show%20s'%20%E2%89%A4%20%E2%9F%A8s%20%E2%88%A9%20x%2C%20_%E2%9F%A9%20%E2%86%94%20%E2%86%91s'%20%E2%89%A4%20x%2C%0A%20%20%20%20from%20%E2%9F%A8%CE%BB%20h%2C%20le_trans%20h%20%24%20inter_subset_right%20_%20_%2C%20subset_inter%20s'.property%E2%9F%A9%2C%0A%20%20le_l_u%20%3A%3D%20%CE%BB%20s'%2C%20inter_subset_right%20_%20_%2C%0A%20%20choice_eq%20%3A%3D%20%CE%BB%20%28x%20%3A%20set%20E%29%20h%2C%20subtype.ext.2%20%24%20subset.antisymm%20h%20%24%20inter_subset_right%20_%20_%20%7D%0A%0Adef%20tmpi%20%3A%20complete_lattice%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%20%3A%3D%0A%40order_dual.lattice.complete_lattice%20%28order_dual%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%20%24%0Agalois_insertion.lift_complete_lattice%20%28tmp%20s%29%0A%0Ainstance%20tmpii%20%3A%20complete_lattice%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%20%3A%3D%20tmpi.copy%0A%2F-%20le%20%20-%2F%20%28%E2%89%A4%29%20rfl%0A%2F-%20top%20-%2F%20%E2%9F%A8s%2C%20subset.refl%20s%E2%9F%A9%20%28subtype.coe_ext.mpr%20%24%20show%20s%20%3D%20s%20%E2%88%A9%20univ%2C%20from%20%28inter_univ%20s%29.symm%29%0A%2F-%20bot%20-%2F%20%E2%9F%A8%E2%88%85%2C%20_%E2%9F%A9%20rfl%0A%2F-%20sup%20-%2F%20%28%CE%BB%20s%E2%82%81%20s%E2%82%82%2C%20%E2%9F%A8s%E2%82%81%20%E2%88%AA%20s%E2%82%82%2C%20_%E2%9F%A9%29%20rfl%0A%2F-%20inf%20-%2F%20%28%CE%BB%20s%E2%82%81%20s%E2%82%82%2C%20%E2%9F%A8s%E2%82%81%20%E2%88%A9%20s%E2%82%82%2C%20subset.trans%20%28inter_subset_left%20_%20_%29%20s%E2%82%81.2%E2%9F%A9%29%0A%28by%20%7B%20ext%20s%E2%82%81%20s%E2%82%82%2C%20rw%20subtype.coe_ext%2C%20show%20%28s%E2%82%81%20%3A%20set%20E%29%20%E2%88%A9%20s%E2%82%82%20%3D%20s%20%E2%88%A9%20%28s%E2%82%81%20%E2%88%A9%20s%E2%82%82%29%2C%0A%20%20refine%20%28inter_eq_self_of_subset_right%20_%29.symm%2C%20exact%20subset.trans%20%28inter_subset_left%20_%20_%29%20s%E2%82%81.2%20%7D%29%0A%2F-%20Sup%20-%2F%20%28%CE%BB%20S%2C%20%E2%9F%A8%28%E2%8B%83%20s%20%E2%88%88%20S%2C%20%28s%20%3A%20set%20E%29%29%2C%20_%E2%9F%A9%29%20rfl%0A%2F-%20Inf%20-%2F%20%28%CE%BB%20S%2C%20%E2%9F%A8s%20%E2%88%A9%20%28%E2%8B%82%20s%20%E2%88%88%20S%2C%20%28s%20%3A%20set%20E%29%29%2C%20inter_subset_left%20_%20_%E2%9F%A9%29%20rfl%0A%0A%2F-%0ATODO%3A%0A--%20Lifting%20a%20complete%20lattice%20along%20a%20galois%20insertion%20gives%20horrible%0A--%20%60supr%60%20and%20%60infi%60%20as%20can%20be%20seen%20in%20the%20example%20below.%0A--%20TODO%3A%20Fix%20this%20in%20general%0A-%2F%0A%0Alemma%20help%20%7B%CE%B9%20%3A%20Sort%20u'%7D%20%28f%20%3A%20%CE%B9%20%E2%86%92%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%20%3A%0A%20%20%28%28%28%E2%A8%85%20i%2C%20f%20i%29%20%3A%20%7Bs'%20%2F%2F%20s'%20%E2%8A%86%20s%7D%29%20%3A%20set%20E%29%20%3D%20s%20%E2%88%A9%20%28%E2%8B%82%20i%2C%20%28f%20i%20%3A%20set%20E%29%29%20%3A%3D%0Abegin%0A%20%20have%20%3A%3D%20%28tmp%20s%29.gc.l_supr%2C%0A%20%20swap%203%2C%20exact%20%CE%BB%20%28i%3A%CE%B9%29%2C%20%28f%20i%20%3A%20set%20E%29%2C%0A%20%20rw%20subtype.coe_ext%20at%20this%2C%0A%20%20dsimp%20at%20this%2C%0A%20%20convert%20this%2C%0A%20%20show%20s%20%E2%88%A9%20_%20%3D%20s%20%E2%88%A9%20_%2C%0A%20%20sorry%0A%20%20--%20apply%20subset.antisymm%2C%0A%20%20--%20%7B%20sorry%20%7D%2C%0A%20%20--%20%7B%20refine%20%28tmp%20s%29.gc.l_supr%2C%20%7D%2C%0Aend</a></p>

<a name="188938861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lifting%20complete%20lattices/near/188938861" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65824liftingcompletelattices.html#188938861">Johan Commelin (Feb 24 2020 at 16:01)</a>:</h4>
<p>Code:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">order</span><span class="bp">.</span><span class="n">galois_connection</span> <span class="n">data</span><span class="bp">.</span><span class="n">set</span><span class="bp">.</span><span class="n">lattice</span>

<span class="kn">universe</span> <span class="kn">variables</span> <span class="n">u</span> <span class="n">u&#39;</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">E</span><span class="o">}</span>

<span class="kn">open</span> <span class="n">set</span> <span class="n">lattice</span>

<span class="c1">-- Move this!! -- this is some where in filter.lean but should be in a more general file</span>
<span class="kn">namespace</span> <span class="n">lattice</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span>

<span class="n">def</span> <span class="n">complete_lattice</span><span class="bp">.</span><span class="n">copy</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">complete_lattice</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">le</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">eq_le</span> <span class="o">:</span> <span class="n">le</span> <span class="bp">=</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le</span> <span class="n">α</span> <span class="n">c</span><span class="o">)</span>
  <span class="o">(</span><span class="n">top</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">eq_top</span> <span class="o">:</span> <span class="n">top</span> <span class="bp">=</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">top</span> <span class="n">α</span> <span class="n">c</span><span class="o">)</span>
  <span class="o">(</span><span class="n">bot</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">eq_bot</span> <span class="o">:</span> <span class="n">bot</span> <span class="bp">=</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">bot</span> <span class="n">α</span> <span class="n">c</span><span class="o">)</span>
  <span class="o">(</span><span class="n">sup</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">eq_sup</span> <span class="o">:</span> <span class="n">sup</span> <span class="bp">=</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">sup</span> <span class="n">α</span> <span class="n">c</span><span class="o">)</span>
  <span class="o">(</span><span class="n">inf</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">eq_inf</span> <span class="o">:</span> <span class="n">inf</span> <span class="bp">=</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">inf</span> <span class="n">α</span> <span class="n">c</span><span class="o">)</span>
  <span class="o">(</span><span class="n">Sup</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">eq_Sup</span> <span class="o">:</span> <span class="n">Sup</span> <span class="bp">=</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">Sup</span> <span class="n">α</span> <span class="n">c</span><span class="o">)</span>
  <span class="o">(</span><span class="n">Inf</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">eq_Inf</span> <span class="o">:</span> <span class="n">Inf</span> <span class="bp">=</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">Inf</span> <span class="n">α</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">complete_lattice</span> <span class="n">α</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">refine</span> <span class="o">{</span> <span class="n">le</span> <span class="o">:=</span> <span class="n">le</span><span class="o">,</span> <span class="n">top</span> <span class="o">:=</span> <span class="n">top</span><span class="o">,</span> <span class="n">bot</span> <span class="o">:=</span> <span class="n">bot</span><span class="o">,</span> <span class="n">sup</span> <span class="o">:=</span> <span class="n">sup</span><span class="o">,</span> <span class="n">inf</span> <span class="o">:=</span> <span class="n">inf</span><span class="o">,</span> <span class="n">Sup</span> <span class="o">:=</span> <span class="n">Sup</span><span class="o">,</span> <span class="n">Inf</span> <span class="o">:=</span> <span class="n">Inf</span><span class="o">,</span> <span class="bp">..</span><span class="o">}</span><span class="bp">;</span>
    <span class="n">subst_vars</span><span class="o">,</span>
  <span class="n">exact</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le_refl</span> <span class="n">α</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">exact</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le_trans</span> <span class="n">α</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">exact</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le_antisymm</span> <span class="n">α</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">exact</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le_sup_left</span> <span class="n">α</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">exact</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le_sup_right</span> <span class="n">α</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">exact</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">sup_le</span> <span class="n">α</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">exact</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">inf_le_left</span> <span class="n">α</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">exact</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">inf_le_right</span> <span class="n">α</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">exact</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le_inf</span> <span class="n">α</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">exact</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le_top</span> <span class="n">α</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">exact</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">bot_le</span> <span class="n">α</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">exact</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le_Sup</span> <span class="n">α</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">exact</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">Sup_le</span> <span class="n">α</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">exact</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">Inf_le</span> <span class="n">α</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">exact</span> <span class="bp">@</span><span class="n">complete_lattice</span><span class="bp">.</span><span class="n">le_Inf</span> <span class="n">α</span> <span class="n">c</span>
<span class="kn">end</span>

<span class="kn">end</span> <span class="n">lattice</span>

<span class="n">def</span> <span class="n">tmp</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">E</span><span class="o">)</span> <span class="o">:</span> <span class="bp">@</span><span class="n">galois_insertion</span> <span class="o">(</span><span class="n">order_dual</span> <span class="o">(</span><span class="n">set</span> <span class="n">E</span><span class="o">))</span> <span class="o">(</span><span class="n">order_dual</span> <span class="o">{</span><span class="n">s&#39;</span> <span class="bp">//</span> <span class="n">s&#39;</span> <span class="err">⊆</span> <span class="n">s</span><span class="o">})</span> <span class="bp">_</span> <span class="bp">_</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">s&#39;</span> <span class="o">:</span> <span class="n">set</span> <span class="n">E</span><span class="o">),</span> <span class="o">(</span><span class="bp">⟨</span><span class="n">s</span> <span class="err">∩</span> <span class="n">s&#39;</span><span class="o">,</span> <span class="n">inter_subset_left</span> <span class="n">s</span> <span class="n">s&#39;</span><span class="bp">⟩</span> <span class="o">:</span> <span class="o">{</span><span class="n">s&#39;</span> <span class="bp">//</span> <span class="n">s&#39;</span> <span class="err">⊆</span> <span class="n">s</span><span class="o">}))</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">s&#39;</span> <span class="o">:</span> <span class="o">{</span><span class="n">s&#39;</span> <span class="bp">//</span> <span class="n">s&#39;</span> <span class="err">⊆</span> <span class="n">s</span><span class="o">}),</span> <span class="o">(</span><span class="n">s&#39;</span> <span class="o">:</span> <span class="n">set</span> <span class="n">E</span><span class="o">))</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">choice</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">subset</span><span class="bp">.</span><span class="n">trans</span> <span class="n">hx</span> <span class="err">$</span> <span class="n">inter_subset_left</span> <span class="bp">_</span> <span class="bp">_⟩</span><span class="o">,</span>
  <span class="n">gc</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">set</span> <span class="n">E</span><span class="o">)</span> <span class="o">(</span><span class="n">s&#39;</span> <span class="o">:</span> <span class="o">{</span><span class="n">s&#39;</span> <span class="bp">//</span> <span class="n">s&#39;</span> <span class="err">⊆</span> <span class="n">s</span><span class="o">}),</span> <span class="k">show</span> <span class="n">s&#39;</span> <span class="bp">≤</span> <span class="bp">⟨</span><span class="n">s</span> <span class="err">∩</span> <span class="n">x</span><span class="o">,</span> <span class="bp">_⟩</span> <span class="bp">↔</span> <span class="err">↑</span><span class="n">s&#39;</span> <span class="bp">≤</span> <span class="n">x</span><span class="o">,</span>
    <span class="k">from</span> <span class="bp">⟨λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">le_trans</span> <span class="n">h</span> <span class="err">$</span> <span class="n">inter_subset_right</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">,</span> <span class="n">subset_inter</span> <span class="n">s&#39;</span><span class="bp">.</span><span class="n">property</span><span class="bp">⟩</span><span class="o">,</span>
  <span class="n">le_l_u</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">s&#39;</span><span class="o">,</span> <span class="n">inter_subset_right</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">,</span>
  <span class="n">choice_eq</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">set</span> <span class="n">E</span><span class="o">)</span> <span class="n">h</span><span class="o">,</span> <span class="n">subtype</span><span class="bp">.</span><span class="n">ext</span><span class="bp">.</span><span class="mi">2</span> <span class="err">$</span> <span class="n">subset</span><span class="bp">.</span><span class="n">antisymm</span> <span class="n">h</span> <span class="err">$</span> <span class="n">inter_subset_right</span> <span class="bp">_</span> <span class="bp">_</span> <span class="o">}</span>

<span class="n">def</span> <span class="n">tmpi</span> <span class="o">:</span> <span class="n">complete_lattice</span> <span class="o">{</span><span class="n">s&#39;</span> <span class="bp">//</span> <span class="n">s&#39;</span> <span class="err">⊆</span> <span class="n">s</span><span class="o">}</span> <span class="o">:=</span>
<span class="bp">@</span><span class="n">order_dual</span><span class="bp">.</span><span class="n">lattice</span><span class="bp">.</span><span class="n">complete_lattice</span> <span class="o">(</span><span class="n">order_dual</span> <span class="o">{</span><span class="n">s&#39;</span> <span class="bp">//</span> <span class="n">s&#39;</span> <span class="err">⊆</span> <span class="n">s</span><span class="o">})</span> <span class="err">$</span>
<span class="n">galois_insertion</span><span class="bp">.</span><span class="n">lift_complete_lattice</span> <span class="o">(</span><span class="n">tmp</span> <span class="n">s</span><span class="o">)</span>

<span class="kn">instance</span> <span class="n">tmpii</span> <span class="o">:</span> <span class="n">complete_lattice</span> <span class="o">{</span><span class="n">s&#39;</span> <span class="bp">//</span> <span class="n">s&#39;</span> <span class="err">⊆</span> <span class="n">s</span><span class="o">}</span> <span class="o">:=</span> <span class="n">tmpi</span><span class="bp">.</span><span class="n">copy</span>
<span class="c">/-</span><span class="cm"> le  -/</span> <span class="o">(</span><span class="bp">≤</span><span class="o">)</span> <span class="n">rfl</span>
<span class="c">/-</span><span class="cm"> top -/</span> <span class="bp">⟨</span><span class="n">s</span><span class="o">,</span> <span class="n">subset</span><span class="bp">.</span><span class="n">refl</span> <span class="n">s</span><span class="bp">⟩</span> <span class="o">(</span><span class="n">subtype</span><span class="bp">.</span><span class="n">coe_ext</span><span class="bp">.</span><span class="n">mpr</span> <span class="err">$</span> <span class="k">show</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">s</span> <span class="err">∩</span> <span class="n">univ</span><span class="o">,</span> <span class="k">from</span> <span class="o">(</span><span class="n">inter_univ</span> <span class="n">s</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">)</span>
<span class="c">/-</span><span class="cm"> bot -/</span> <span class="bp">⟨</span><span class="err">∅</span><span class="o">,</span> <span class="bp">_⟩</span> <span class="n">rfl</span>
<span class="c">/-</span><span class="cm"> sup -/</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">s₁</span> <span class="n">s₂</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">s₁</span> <span class="err">∪</span> <span class="n">s₂</span><span class="o">,</span> <span class="bp">_⟩</span><span class="o">)</span> <span class="n">rfl</span>
<span class="c">/-</span><span class="cm"> inf -/</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">s₁</span> <span class="n">s₂</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">s₁</span> <span class="err">∩</span> <span class="n">s₂</span><span class="o">,</span> <span class="n">subset</span><span class="bp">.</span><span class="n">trans</span> <span class="o">(</span><span class="n">inter_subset_left</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span> <span class="n">s₁</span><span class="bp">.</span><span class="mi">2</span><span class="bp">⟩</span><span class="o">)</span>
<span class="o">(</span><span class="k">by</span> <span class="o">{</span> <span class="n">ext</span> <span class="n">s₁</span> <span class="n">s₂</span><span class="o">,</span> <span class="n">rw</span> <span class="n">subtype</span><span class="bp">.</span><span class="n">coe_ext</span><span class="o">,</span> <span class="k">show</span> <span class="o">(</span><span class="n">s₁</span> <span class="o">:</span> <span class="n">set</span> <span class="n">E</span><span class="o">)</span> <span class="err">∩</span> <span class="n">s₂</span> <span class="bp">=</span> <span class="n">s</span> <span class="err">∩</span> <span class="o">(</span><span class="n">s₁</span> <span class="err">∩</span> <span class="n">s₂</span><span class="o">),</span>
  <span class="n">refine</span> <span class="o">(</span><span class="n">inter_eq_self_of_subset_right</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span> <span class="n">exact</span> <span class="n">subset</span><span class="bp">.</span><span class="n">trans</span> <span class="o">(</span><span class="n">inter_subset_left</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span> <span class="n">s₁</span><span class="bp">.</span><span class="mi">2</span> <span class="o">})</span>
<span class="c">/-</span><span class="cm"> Sup -/</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">S</span><span class="o">,</span> <span class="bp">⟨</span><span class="o">(</span><span class="err">⋃</span> <span class="n">s</span> <span class="err">∈</span> <span class="n">S</span><span class="o">,</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">E</span><span class="o">)),</span> <span class="bp">_⟩</span><span class="o">)</span> <span class="n">rfl</span>
<span class="c">/-</span><span class="cm"> Inf -/</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">S</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">s</span> <span class="err">∩</span> <span class="o">(</span><span class="err">⋂</span> <span class="n">s</span> <span class="err">∈</span> <span class="n">S</span><span class="o">,</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">E</span><span class="o">)),</span> <span class="n">inter_subset_left</span> <span class="bp">_</span> <span class="bp">_⟩</span><span class="o">)</span> <span class="n">rfl</span>

<span class="c">/-</span><span class="cm"></span>
<span class="cm">TODO:</span>
<span class="cm">-- Lifting a complete lattice along a galois insertion gives horrible</span>
<span class="cm">-- `supr` and `infi` as can be seen in the example below.</span>
<span class="cm">-- TODO: Fix this in general</span>
<span class="cm">-/</span>

<span class="kn">lemma</span> <span class="kn">help</span> <span class="o">{</span><span class="n">ι</span> <span class="o">:</span> <span class="n">Sort</span> <span class="n">u&#39;</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="o">{</span><span class="n">s&#39;</span> <span class="bp">//</span> <span class="n">s&#39;</span> <span class="err">⊆</span> <span class="n">s</span><span class="o">})</span> <span class="o">:</span>
  <span class="o">(((</span><span class="err">⨅</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="o">{</span><span class="n">s&#39;</span> <span class="bp">//</span> <span class="n">s&#39;</span> <span class="err">⊆</span> <span class="n">s</span><span class="o">})</span> <span class="o">:</span> <span class="n">set</span> <span class="n">E</span><span class="o">)</span> <span class="bp">=</span> <span class="n">s</span> <span class="err">∩</span> <span class="o">(</span><span class="err">⋂</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span> <span class="o">:</span> <span class="n">set</span> <span class="n">E</span><span class="o">))</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="o">(</span><span class="n">tmp</span> <span class="n">s</span><span class="o">)</span><span class="bp">.</span><span class="n">gc</span><span class="bp">.</span><span class="n">l_supr</span><span class="o">,</span>
  <span class="n">swap</span> <span class="mi">3</span><span class="o">,</span> <span class="n">exact</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">i</span><span class="o">:</span><span class="n">ι</span><span class="o">),</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span> <span class="o">:</span> <span class="n">set</span> <span class="n">E</span><span class="o">),</span>
  <span class="n">rw</span> <span class="n">subtype</span><span class="bp">.</span><span class="n">coe_ext</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">dsimp</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">convert</span> <span class="n">this</span><span class="o">,</span>
  <span class="k">show</span> <span class="n">s</span> <span class="err">∩</span> <span class="bp">_</span> <span class="bp">=</span> <span class="n">s</span> <span class="err">∩</span> <span class="bp">_</span><span class="o">,</span>
  <span class="n">sorry</span>
  <span class="c1">-- apply subset.antisymm,</span>
  <span class="c1">-- { sorry },</span>
  <span class="c1">-- { refine (tmp s).gc.l_supr, },</span>
<span class="kn">end</span>
</pre></div>

<a name="188938928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lifting%20complete%20lattices/near/188938928" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65824liftingcompletelattices.html#188938928">Johan Commelin (Feb 24 2020 at 16:02)</a>:</h4>
<p>If I'm doing something stupid, I would love to be enlightened</p>

<a name="188939936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lifting%20complete%20lattices/near/188939936" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65824liftingcompletelattices.html#188939936">Johan Commelin (Feb 24 2020 at 16:13)</a>:</h4>
<p>Walking to the train helped.</p>

<a name="188939967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lifting%20complete%20lattices/near/188939967" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65824liftingcompletelattices.html#188939967">Johan Commelin (Feb 24 2020 at 16:14)</a>:</h4>
<p>I think this has nothing to do with lifting the lattice structure</p>

<a name="188940042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lifting%20complete%20lattices/near/188940042" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65824liftingcompletelattices.html#188940042">Johan Commelin (Feb 24 2020 at 16:14)</a>:</h4>
<p>What is really the problem is that some useful lemmas for how <code>galois_insertion</code> interacts with <code>supr</code> are missing.</p>

<a name="188954814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lifting%20complete%20lattices/near/188954814" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65824liftingcompletelattices.html#188954814">Mario Carneiro (Feb 24 2020 at 18:59)</a>:</h4>
<p>The function <code>complete_lattice.copy</code> is there to fix up any bad definitional equalities caused by another definition</p>

<a name="188955327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lifting%20complete%20lattices/near/188955327" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65824liftingcompletelattices.html#188955327">Johan Commelin (Feb 24 2020 at 19:04)</a>:</h4>
<p>Yes, but it doesn't help here. Because <code>supr</code> and <code>infi</code> are defined in terms of range.</p>

<a name="188955397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lifting%20complete%20lattices/near/188955397" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65824liftingcompletelattices.html#188955397">Johan Commelin (Feb 24 2020 at 19:04)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="kn">help</span> <span class="o">{</span><span class="n">ι</span> <span class="o">:</span> <span class="n">Sort</span> <span class="n">u&#39;</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="o">{</span><span class="n">s&#39;</span> <span class="bp">//</span> <span class="n">s&#39;</span> <span class="err">⊆</span> <span class="n">s</span><span class="o">})</span> <span class="o">:</span>
  <span class="o">(((</span><span class="err">⨅</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="o">{</span><span class="n">s&#39;</span> <span class="bp">//</span> <span class="n">s&#39;</span> <span class="err">⊆</span> <span class="n">s</span><span class="o">})</span> <span class="o">:</span> <span class="n">set</span> <span class="n">E</span><span class="o">)</span> <span class="bp">=</span> <span class="n">s</span> <span class="err">∩</span> <span class="o">(</span><span class="err">⋂</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span> <span class="o">:</span> <span class="n">set</span> <span class="n">E</span><span class="o">))</span> <span class="o">:=</span>
</pre></div>


<p>looks like it should be a triviality, but it isn't.</p>

<a name="188955440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lifting%20complete%20lattices/near/188955440" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65824liftingcompletelattices.html#188955440">Johan Commelin (Feb 24 2020 at 19:05)</a>:</h4>
<p>And I now realised that this has nothing to do with <code>complete_lattice.copy</code> or <code>lift_complete_lattice</code>. It's just an inherent problem with <code>supr</code> and <code>infi</code>.</p>

<a name="188963015"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lifting%20complete%20lattices/near/188963015" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65824liftingcompletelattices.html#188963015">Mario Carneiro (Feb 24 2020 at 20:32)</a>:</h4>
<p>yes</p>

<a name="188963026"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lifting%20complete%20lattices/near/188963026" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65824liftingcompletelattices.html#188963026">Mario Carneiro (Feb 24 2020 at 20:32)</a>:</h4>
<p>you have to use lemmas to get the version you want</p>

<a name="188963088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lifting%20complete%20lattices/near/188963088" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65824liftingcompletelattices.html#188963088">Mario Carneiro (Feb 24 2020 at 20:33)</a>:</h4>
<p>it's impossible to put <code>supr</code> and <code>infi</code> with the "right" definitional equality in the structure, because that would involve quantifying over all universes</p>

<a name="188963585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lifting%20complete%20lattices/near/188963585" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65824liftingcompletelattices.html#188963585">Johan Commelin (Feb 24 2020 at 20:39)</a>:</h4>
<p>I know. But this is still very unfortunate (-;</p>

<a name="188963667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lifting%20complete%20lattices/near/188963667" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/65824liftingcompletelattices.html#188963667">Johan Commelin (Feb 24 2020 at 20:40)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">l_supr_u</span> <span class="o">[</span><span class="n">complete_lattice</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">complete_lattice</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">gi</span> <span class="o">:</span> <span class="n">galois_insertion</span> <span class="n">l</span> <span class="n">u</span><span class="o">)</span>
  <span class="o">{</span><span class="n">ι</span> <span class="o">:</span> <span class="n">Sort</span> <span class="n">x</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">l</span> <span class="o">(</span><span class="err">⨆</span> <span class="n">i</span><span class="o">,</span> <span class="n">u</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="bp">=</span> <span class="err">⨆</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">calc</span> <span class="n">l</span> <span class="o">(</span><span class="err">⨆</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">u</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="bp">=</span> <span class="err">⨆</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">l</span> <span class="o">(</span><span class="n">u</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="o">:</span> <span class="n">gi</span><span class="bp">.</span><span class="n">gc</span><span class="bp">.</span><span class="n">l_supr</span>
                        <span class="bp">...</span> <span class="bp">=</span> <span class="err">⨆</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">f</span> <span class="n">i</span> <span class="o">:</span> <span class="n">congr_arg</span> <span class="bp">_</span> <span class="err">$</span> <span class="n">funext</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">gi</span><span class="bp">.</span><span class="n">l_u_eq</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span>

<span class="kn">lemma</span> <span class="n">l_supr_of_ul</span> <span class="o">[</span><span class="n">complete_lattice</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">complete_lattice</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">gi</span> <span class="o">:</span> <span class="n">galois_insertion</span> <span class="n">l</span> <span class="n">u</span><span class="o">)</span>
  <span class="o">{</span><span class="n">ι</span> <span class="o">:</span> <span class="n">Sort</span> <span class="n">x</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">u</span> <span class="o">(</span><span class="n">l</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">l</span> <span class="o">(</span><span class="err">⨆</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="bp">=</span> <span class="err">⨆</span> <span class="n">i</span><span class="o">,</span> <span class="n">l</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">calc</span> <span class="n">l</span> <span class="o">(</span><span class="err">⨆</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="bp">=</span> <span class="n">l</span> <span class="err">⨆</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="o">(</span><span class="n">u</span> <span class="o">(</span><span class="n">l</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)))</span> <span class="o">:</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">hf</span><span class="o">]</span>
                        <span class="bp">...</span> <span class="bp">=</span> <span class="err">⨆</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">l</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="n">gi</span><span class="bp">.</span><span class="n">l_supr_u</span> <span class="bp">_</span>

<span class="kn">lemma</span> <span class="n">l_infi_u</span> <span class="o">[</span><span class="n">complete_lattice</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">complete_lattice</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">gi</span> <span class="o">:</span> <span class="n">galois_insertion</span> <span class="n">l</span> <span class="n">u</span><span class="o">)</span>
  <span class="o">{</span><span class="n">ι</span> <span class="o">:</span> <span class="n">Sort</span> <span class="n">x</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">l</span> <span class="o">(</span><span class="err">⨅</span> <span class="n">i</span><span class="o">,</span> <span class="n">u</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="bp">=</span> <span class="err">⨅</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">calc</span> <span class="n">l</span> <span class="o">(</span><span class="err">⨅</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">u</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="bp">=</span> <span class="n">l</span> <span class="o">(</span><span class="n">u</span> <span class="o">(</span><span class="err">⨅</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)))</span> <span class="o">:</span> <span class="n">congr_arg</span> <span class="n">l</span> <span class="n">gi</span><span class="bp">.</span><span class="n">gc</span><span class="bp">.</span><span class="n">u_infi</span><span class="bp">.</span><span class="n">symm</span>
                        <span class="bp">...</span> <span class="bp">=</span> <span class="err">⨅</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">f</span> <span class="n">i</span> <span class="o">:</span> <span class="n">gi</span><span class="bp">.</span><span class="n">l_u_eq</span> <span class="bp">_</span>

<span class="kn">lemma</span> <span class="n">l_infi_of_ul</span> <span class="o">[</span><span class="n">complete_lattice</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">complete_lattice</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">gi</span> <span class="o">:</span> <span class="n">galois_insertion</span> <span class="n">l</span> <span class="n">u</span><span class="o">)</span>
  <span class="o">{</span><span class="n">ι</span> <span class="o">:</span> <span class="n">Sort</span> <span class="n">x</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">u</span> <span class="o">(</span><span class="n">l</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">l</span> <span class="o">(</span><span class="err">⨅</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="bp">=</span> <span class="err">⨅</span> <span class="n">i</span><span class="o">,</span> <span class="n">l</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">calc</span> <span class="n">l</span> <span class="o">(</span><span class="err">⨅</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="bp">=</span>  <span class="n">l</span> <span class="err">⨅</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="o">(</span><span class="n">u</span> <span class="o">(</span><span class="n">l</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)))</span> <span class="o">:</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">hf</span><span class="o">]</span>
                <span class="bp">...</span> <span class="bp">=</span> <span class="err">⨅</span> <span class="n">i</span><span class="o">,</span> <span class="n">l</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="n">gi</span><span class="bp">.</span><span class="n">l_infi_u</span> <span class="bp">_</span>
</pre></div>


<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> We are missing things like <span aria-label="up" class="emoji emoji-2b06" role="img" title="up">:up:</span></p>


{% endraw %}

{% include archive_update.html %}