---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/07663mathlibimportgraph.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html">mathlib import graph</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="192182495"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192182495" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192182495">Patrick Massot (Mar 29 2020 at 16:31)</a>:</h4>
<p>Yesterday, <span class="user-mention" data-user-id="110087">@Scott Morrison</span> asked for the current mathlib import graph, without having to install anything. This is available at  <a href="https://www.yworks.com/yed-live/?file=https://gist.githubusercontent.com/PatrickMassot/a23fb34e1b26409f10013de07525ece8/raw/ae80aec753cbf37b36ca683c94db08b99f0cf36b/import_graph" title="https://www.yworks.com/yed-live/?file=https://gist.githubusercontent.com/PatrickMassot/a23fb34e1b26409f10013de07525ece8/raw/ae80aec753cbf37b36ca683c94db08b99f0cf36b/import_graph">https://www.yworks.com/yed-live/?file=https://gist.githubusercontent.com/PatrickMassot/a23fb34e1b26409f10013de07525ece8/raw/ae80aec753cbf37b36ca683c94db08b99f0cf36b/import_graph</a>, but this will require your web browser to be patient.</p>

<a name="192182782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192182782" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192182782">Yury G. Kudryashov (Mar 29 2020 at 16:37)</a>:</h4>
<p>Do you have it in some text format (e.g., graphviz)?</p>

<a name="192182790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192182790" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192182790">Patrick Massot (Mar 29 2020 at 16:37)</a>:</h4>
<p>Sure.</p>

<a name="192182800"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192182800" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192182800">Patrick Massot (Mar 29 2020 at 16:37)</a>:</h4>
<p><a href="/user_uploads/3121/B8xqOu3E-LLZT1PPoy9c_NND/import_graph.dot" title="import_graph.dot">import_graph.dot</a></p>

<a name="192182802"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192182802" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192182802">Yury G. Kudryashov (Mar 29 2020 at 16:37)</a>:</h4>
<p>Thank you!</p>

<a name="192182853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192182853" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192182853">Yury G. Kudryashov (Mar 29 2020 at 16:38)</a>:</h4>
<p>Do we have any tool to determine unneeded <code>import</code>s?</p>

<a name="192182862"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192182862" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192182862">Patrick Massot (Mar 29 2020 at 16:38)</a>:</h4>
<p>I think we used to have something testing that in CI, but it was driving people crazy.</p>

<a name="192182881"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192182881" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192182881">Gabriel Ebner (Mar 29 2020 at 16:39)</a>:</h4>
<p>The <code>category_theory.limits.shapes.constructions.sums</code> module doesn't have any edges: <a href="https://github.com/leanprover-community/mathlib/blob/38544f14662d9d1fd97bd1fb132213c546292025/src/category_theory/limits/shapes/constructions/sums.lean" title="https://github.com/leanprover-community/mathlib/blob/38544f14662d9d1fd97bd1fb132213c546292025/src/category_theory/limits/shapes/constructions/sums.lean">https://github.com/leanprover-community/mathlib/blob/38544f14662d9d1fd97bd1fb132213c546292025/src/category_theory/limits/shapes/constructions/sums.lean</a></p>

<a name="192182943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192182943" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192182943">Patrick Massot (Mar 29 2020 at 16:40)</a>:</h4>
<p>Yes, this is among the most sober files in mathlib.</p>

<a name="192182957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192182957" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192182957">Patrick Massot (Mar 29 2020 at 16:41)</a>:</h4>
<p>I think this was already noticed when writing the mathlib paper, but somehow it was decided not to fix it.</p>

<a name="192182965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192182965" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192182965">Patrick Massot (Mar 29 2020 at 16:41)</a>:</h4>
<p>Probably it's meant as a placeholder</p>

<a name="192183028"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192183028" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192183028">Patrick Massot (Mar 29 2020 at 16:42)</a>:</h4>
<p>There are 648 nodes in this graph (and 1764 edges), we can afford a couple of empty nodes.</p>

<a name="192183065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192183065" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192183065">Patrick Massot (Mar 29 2020 at 16:43)</a>:</h4>
<p>But note that <a href="https://github.com/leanprover-community/mathlib/blob/38544f14662d9d1fd97bd1fb132213c546292025/src/category_theory/limits/shapes/constructions/finite_products.lean" title="https://github.com/leanprover-community/mathlib/blob/38544f14662d9d1fd97bd1fb132213c546292025/src/category_theory/limits/shapes/constructions/finite_products.lean">https://github.com/leanprover-community/mathlib/blob/38544f14662d9d1fd97bd1fb132213c546292025/src/category_theory/limits/shapes/constructions/finite_products.lean</a> is conceptually closely related to that file, it almost counts as an edge.</p>

<a name="192184455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192184455" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192184455">Kevin Buzzard (Mar 29 2020 at 17:14)</a>:</h4>
<p>I didn't know this was allowed! It reminds me of all the directories <a href="https://github.com/HoTT/HoTT/tree/master/coq/theories" title="https://github.com/HoTT/HoTT/tree/master/coq/theories">here</a> (when I was recently trying to figure out what maths has been done in HoTT theories)</p>

<a name="192184480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192184480" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192184480">Patrick Massot (Mar 29 2020 at 17:15)</a>:</h4>
<p>This not really allowed, this is more like overlooked.</p>

<a name="192185236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192185236" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192185236">Rob Lewis (Mar 29 2020 at 17:34)</a>:</h4>
<blockquote>
<p>I think this was already noticed when writing the mathlib paper, but somehow it was decided not to fix it.</p>
</blockquote>
<p>Was it decided or just forgotten? The "placeholder" has been empty for 7 months, I think a PR deleting empty files would be welcome.</p>

<a name="192185249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192185249" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192185249">Rob Lewis (Mar 29 2020 at 17:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="214703">Yury G. Kudryashov</span> <a href="#narrow/stream/113488-general/topic/mathlib.20import.20graph/near/192182853" title="#narrow/stream/113488-general/topic/mathlib.20import.20graph/near/192182853">said</a>:</p>
<blockquote>
<p>Do we have any tool to determine unneeded <code>import</code>s?</p>
</blockquote>
<p>Simon and Mario's olean-rs tool does this, iirc</p>

<a name="192185255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192185255" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192185255">Patrick Massot (Mar 29 2020 at 17:34)</a>:</h4>
<p>This is why I wrote it was more overlooked than allowed.</p>

<a name="192185626"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192185626" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192185626">Kevin Buzzard (Mar 29 2020 at 17:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="214703">Yury G. Kudryashov</span> <a href="#narrow/stream/113488-general/topic/mathlib.20import.20graph/near/192182853" title="#narrow/stream/113488-general/topic/mathlib.20import.20graph/near/192182853">said</a>:</p>
<blockquote>
<p>Do we have any tool to determine unneeded <code>import</code>s?</p>
</blockquote>
<p>ooh found one <a href="/user_uploads/3121/dJVN2wfhPTgjeCphoiC1JxbT/import.png" title="import.png">import.png</a> Might take a while to do it by hand though</p>
<div class="message_inline_image"><a href="/user_uploads/3121/dJVN2wfhPTgjeCphoiC1JxbT/import.png" title="import.png"><img src="/user_uploads/3121/dJVN2wfhPTgjeCphoiC1JxbT/import.png"></a></div>

<a name="192185681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192185681" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192185681">Patrick Massot (Mar 29 2020 at 17:44)</a>:</h4>
<p>I'm not sure this is what Yury wanted.</p>

<a name="192185686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192185686" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192185686">Patrick Massot (Mar 29 2020 at 17:44)</a>:</h4>
<p>But maybe it is.</p>

<a name="192185687"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192185687" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192185687">Kevin Buzzard (Mar 29 2020 at 17:44)</a>:</h4>
<p>Oh -- imports which aren't used?</p>

<a name="192185704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192185704" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192185704">Patrick Massot (Mar 29 2020 at 17:45)</a>:</h4>
<p>There are two kinds of useless imports. Those which are unused and those which would be imported by transitivity anyway.</p>

<a name="192185705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192185705" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192185705">Kevin Buzzard (Mar 29 2020 at 17:45)</a>:</h4>
<p>I guess that is the more important issue. I should imagine that the loop above makes no difference to anything.</p>

<a name="192186095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192186095" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192186095">Yury G. Kudryashov (Mar 29 2020 at 17:55)</a>:</h4>
<p>I was talking about something like <a href="https://github.com/leanprover-community/mathlib/pull/2282/files#diff-66f08ece38e86b3511a0261beaa7dc87" title="https://github.com/leanprover-community/mathlib/pull/2282/files#diff-66f08ece38e86b3511a0261beaa7dc87">this</a></p>

<a name="192187632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192187632" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192187632">Patrick Massot (Mar 29 2020 at 18:30)</a>:</h4>
<p>I just opened <a href="https://github.com/leanprover-community/mathlib-tools/pull/38" title="https://github.com/leanprover-community/mathlib-tools/pull/38">https://github.com/leanprover-community/mathlib-tools/pull/38</a> for people interested in import graphs. It's purely about imports, not things being actually used.</p>

<a name="192205845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192205845" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192205845">Scott Morrison (Mar 30 2020 at 02:32)</a>:</h4>
<p>I just wrote (I thought I should remember how to write python) <code>lean-deps</code>, which you use as follows.</p>
<p>Let's look at the dependency tree for <code>src/category_theory/types.lean</code>, restricting to import chains ending within <code>src/category_theory</code>:</p>
<div class="codehilite"><pre><span></span>$ ./lean-deps src/category_theory/types.lean src/category_theory/
src/category_theory/types.lean
├── src/category_theory/functor_category.lean
│   └── src/category_theory/natural_transformation.lean
│       └── src/category_theory/functor.lean
│           ├── src/category_theory/category/default.lean
│           └── src/tactic/reassoc_axiom.lean
│               └── ≪ src/category_theory/category/default.lean ≫
└── src/category_theory/fully_faithful.lean
    └── src/category_theory/isomorphism.lean
        └── ≪ src/category_theory/functor.lean ≫
</pre></div>


<p>Dependencies which occur multiple times are shown wrapped in <code>≪ ... ≫</code>, and their further transitive dependencies are omitted. (You can omit repeats entirely using <code>lean-deps -o</code>, or show their dependencies too with <code>lean-deps -a</code>.</p>
<p>Without a second argument, <code>lean-deps</code> shows dependencies all the way down. It takes a few seconds on files deep in the hierarchy, but seems usable. You can also specify one or more specific files as second arguments, so we can analyze the somewhat surprising dependency of the Hahn-Banach theorem theorem on the category theory library as follows:</p>
<div class="codehilite"><pre><span></span>$ ./lean-deps -o src/analysis/normed_space/hahn_banach.lean src/category_theory/category/default.lean
src/analysis/normed_space/hahn_banach.lean
└── src/analysis/normed_space/operator_norm.lean
    └── src/topology/metric_space/lipschitz.lean
        └── src/category_theory/endomorphism.lean
            └── src/category_theory/category/default.lean
</pre></div>

<a name="192205933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192205933" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192205933">Scott Morrison (Mar 30 2020 at 02:35)</a>:</h4>
<p>This seems pretty duplicative, of course, with what Patrick has done, but I find the text mode output very satisfying.</p>

<a name="192205936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192205936" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192205936">Yury G. Kudryashov (Mar 30 2020 at 02:35)</a>:</h4>
<p>I prove that <code>list.prod</code> of Lipschitz <code>End</code>s is Lipschitz.</p>

<a name="192205977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192205977" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192205977">Scott Morrison (Mar 30 2020 at 02:36)</a>:</h4>
<p>Perhaps we could just combine the two, so <code>leanproject import-graph -from XXX</code> but with no filename prints an ASCII tree on stdout</p>

<a name="192205988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192205988" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192205988">Scott Morrison (Mar 30 2020 at 02:37)</a>:</h4>
<p>Also, I think <code>leanproject import-graph</code> doesn't yet support using both <code>-from</code> and <code>-to</code>, which I think is very helpful for understanding a particular chain.</p>

<a name="192206045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192206045" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192206045">Scott Morrison (Mar 30 2020 at 02:38)</a>:</h4>
<p>My code is at <a href="https://gist.github.com/semorrison/d27e35ed5eac96b0dec939f72fada56d" title="https://gist.github.com/semorrison/d27e35ed5eac96b0dec939f72fada56d">https://gist.github.com/semorrison/d27e35ed5eac96b0dec939f72fada56d</a>.</p>

<a name="192206050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192206050" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192206050">Scott Morrison (Mar 30 2020 at 02:38)</a>:</h4>
<p>I think I'll stop playing with it until hearing from Patrick.</p>

<a name="192207779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192207779" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192207779">Mario Carneiro (Mar 30 2020 at 03:25)</a>:</h4>
<p>I think this also duplicates functionality in <code>olean-rs</code></p>

<a name="192207822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192207822" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192207822">Mario Carneiro (Mar 30 2020 at 03:26)</a>:</h4>
<p>you have to calculate this info in order to read any lean file</p>

<a name="192207836"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192207836" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192207836">Mario Carneiro (Mar 30 2020 at 03:27)</a>:</h4>
<p>it should be a lot faster than a few seconds too ('cause Rust and all that)</p>

<a name="192207944"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192207944" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192207944">Mario Carneiro (Mar 30 2020 at 03:31)</a>:</h4>
<p>oh I see, you are calling lean a bunch of times to process the files. Yeah, <code>olean-rs</code> will be a lot faster, since it just does the same thing lean does but without the text processing and elaboration</p>

<a name="192208010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192208010" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192208010">Mario Carneiro (Mar 30 2020 at 03:33)</a>:</h4>
<p>The dependencies of an olean file are all literally written in the first line</p>

<a name="192209170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192209170" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192209170">Scott Morrison (Mar 30 2020 at 04:05)</a>:</h4>
<p>I just want ASCII trees, in a tool whose installation procedure is already covered by <code>pip install mathlib-tools</code>. :-)</p>

<a name="192209501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192209501" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192209501">Mario Carneiro (Mar 30 2020 at 04:13)</a>:</h4>
<p>how feasible is it to link an olean-rs library build to a python project? I would guess it's possible, not sure about how distribution works</p>

<a name="192230774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192230774" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192230774">Gabriel Ebner (Mar 30 2020 at 09:29)</a>:</h4>
<p><code>lean --deps</code> is much faster than running lean.  It doesn't import anything, it just parses the first command in the file and outputs the imported files.</p>

<a name="192277178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192277178" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192277178">Patrick Massot (Mar 30 2020 at 16:00)</a>:</h4>
<p>I worked a bit on this, see <a href="https://github.com/leanprover-community/mathlib-tools/pull/38/commits/6a94d737f54fd259d7ee228e2ef56b5b4f997a45" title="https://github.com/leanprover-community/mathlib-tools/pull/38/commits/6a94d737f54fd259d7ee228e2ef56b5b4f997a45">https://github.com/leanprover-community/mathlib-tools/pull/38/commits/6a94d737f54fd259d7ee228e2ef56b5b4f997a45</a>. The motivation for adding ascii art output is very low for me, but feel free to add a commit to this PR. I also just realized I didn't interpret "support using both <code>--from</code> and <code>--to</code>" in the same way as Scott. I added this possibility, but it return the intersection of the subgraphs that each option would have generated, whereas Scott's example suggest generating only the shortest path from one file to the other. For comparison, here is the current output of </p>
<div class="codehilite"><pre><span></span>leanproject import-graph --to analysis.normed_space.hahn_banach --from category_theory.category.default hb.pdf
</pre></div>


<p><a href="/user_uploads/3121/oMG7VwMiOT61e9YWTIrcskk5/hb.pdf" title="hb.pdf">hb.pdf</a></p>

<a name="192277805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192277805" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192277805">Patrick Massot (Mar 30 2020 at 16:05)</a>:</h4>
<p>Note that my version clearly points out the culprit: <code>topology.metric_space.lipschitz</code> randomly imports two category theory files.</p>

<a name="192278001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192278001" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192278001">Patrick Massot (Mar 30 2020 at 16:06)</a>:</h4>
<p>which are used in three isolated lemmas in the middle of the file.</p>

<a name="192288339"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192288339" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192288339">Yury G. Kudryashov (Mar 30 2020 at 17:20)</a>:</h4>
<p>Is there something bad with importing category theory files?</p>

<a name="192288398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192288398" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192288398">Yury G. Kudryashov (Mar 30 2020 at 17:20)</a>:</h4>
<p>How else should I argue about long compositions of self-maps?</p>

<a name="192288562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192288562" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192288562">Patrick Massot (Mar 30 2020 at 17:21)</a>:</h4>
<p>This was described as "somewhat surprising", not bad (especially coming from Scott).</p>

<a name="192288662"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192288662" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192288662">Patrick Massot (Mar 30 2020 at 17:22)</a>:</h4>
<p>Then there is the question of optimizing the import graph, but this is a complicated question.</p>

<a name="192329030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192329030" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192329030">Scott Morrison (Mar 30 2020 at 23:16)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span>, how do I run <code>leanproject</code> from a branch of mathlib-tools?</p>

<a name="192329146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192329146" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192329146">Scott Morrison (Mar 30 2020 at 23:17)</a>:</h4>
<p>I tried:</p>
<ul>
<li>checkout the git repository on branch <code>imports</code></li>
<li>locate <code>leanproject.py</code> in <code>mathlibtools</code></li>
<li>try running it, get "permission denied"</li>
<li><code>chmod u+x ...</code></li>
<li>run it, get error message</li>
</ul>
<div class="codehilite"><pre><span></span>import: delegate library support not built-in &#39;&#39; (X11) @ error/import.c/ImportImageCommand/1282.
./leanproject.py: line 13: syntax error near unexpected token `(&#39;
./leanproject.py: line 13: `from mathlibtools.lib import (LeanProject, log, LeanDirtyRepo,&#39;
</pre></div>


<p>after the usual help text.</p>
<p>Am I meant to instead be using <code>pip</code> to install the branch version?</p>

<a name="192329224"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192329224" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192329224">Scott Morrison (Mar 30 2020 at 23:18)</a>:</h4>
<p>(Actually, not after the usual help text: instead it prints help text from ImageMagick...)</p>

<a name="192365579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192365579" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192365579">Patrick Massot (Mar 31 2020 at 09:36)</a>:</h4>
<p>Using <code>leanproject</code> without installing the mathlibtools package is definitely not supported, even when developing it. The correct workflow is </p>
<div class="codehilite"><pre><span></span>git checkout imports
pip install .
</pre></div>


<p>If you are modifying it you can <code>pip install -e .</code> to avoid constantly running <code>pip install</code>.</p>

<a name="192365760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192365760" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192365760">Patrick Massot (Mar 31 2020 at 09:38)</a>:</h4>
<p>The ImageMagick thing is hilarious, I wonder what your shell is trying to launch <code>leanproject.py</code> directly (this file has no shebang indicating this should be ran using python).</p>

<a name="192366154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192366154" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192366154">Patrick Massot (Mar 31 2020 at 09:41)</a>:</h4>
<p>Since you don't seem to be familiar with python packaging, let me point out that the name similarity between the user-facing script <code>leanproject</code> and the file <code>leanproject.py</code> is not what create the user facing script, which comes from <a href="https://github.com/leanprover-community/mathlib-tools/blob/master/setup.py#L15-L18" title="https://github.com/leanprover-community/mathlib-tools/blob/master/setup.py#L15-L18">https://github.com/leanprover-community/mathlib-tools/blob/master/setup.py#L15-L18</a>.</p>

<a name="192976415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192976415" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192976415">Patrick Massot (Apr 05 2020 at 20:22)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> what is the status of this thread? Do you still want to contribute to <a href="https://github.com/leanprover-community/mathlib-tools/pull/38" title="https://github.com/leanprover-community/mathlib-tools/pull/38">https://github.com/leanprover-community/mathlib-tools/pull/38</a> or should we merge it?</p>

<a name="192988425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192988425" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192988425">Scott Morrison (Apr 06 2020 at 01:51)</a>:</h4>
<p>I added some documentation to what you'd done. My attempts to add text mode output failed, so I added some comments to the PR in case anyone else wants to take this up again.</p>

<a name="192988433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/192988433" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#192988433">Scott Morrison (Apr 06 2020 at 01:51)</a>:</h4>
<p>I'll use my <a href="https://gist.github.com/semorrison/d27e35ed5eac96b0dec939f72fada56d" title="https://gist.github.com/semorrison/d27e35ed5eac96b0dec939f72fada56d"><code>lean-deps</code></a> script myself for the "dependencies between X and Y" question.</p>

<a name="193016891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/193016891" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#193016891">Patrick Massot (Apr 06 2020 at 09:38)</a>:</h4>
<p>I still don't understand the specification here. What do you mean by "dependencies between X and Y" ? Why isn't my version the answer?</p>

<a name="193017045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/193017045" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#193017045">Patrick Massot (Apr 06 2020 at 09:40)</a>:</h4>
<p>Remember the answer of my version is <a href="user_uploads/3121/oMG7VwMiOT61e9YWTIrcskk5/hb.pdf" title="user_uploads/3121/oMG7VwMiOT61e9YWTIrcskk5/hb.pdf">https://leanprover.zulipchat.com/user_uploads/3121/oMG7VwMiOT61e9YWTIrcskk5/hb.pdf</a></p>

<a name="193020111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/193020111" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#193020111">Scott Morrison (Apr 06 2020 at 10:10)</a>:</h4>
<p>Oh, I see, that's great. I just never managed to run it locally (because I only worked out today that I needed to install graphviz for anything to work), and missed the link you provided to the PDF.</p>

<a name="193020169"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/193020169" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#193020169">Scott Morrison (Apr 06 2020 at 10:11)</a>:</h4>
<p>I saw in the code the line </p>
<div class="codehilite"><pre><span></span>    if to and from_:
        G = graph.path(start=from_, end=to)
</pre></div>


<p>and made an (incorrect) assumption about what it was doing.</p>

<a name="193020689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/193020689" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#193020689">Kevin Buzzard (Apr 06 2020 at 10:16)</a>:</h4>
<p><code>topology.metric_space.antilipschitz</code> imports <code>topology.metric_space.lipschitz</code> ;-)</p>

<a name="193020868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/193020868" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#193020868">Patrick Massot (Apr 06 2020 at 10:18)</a>:</h4>
<p>I'm sorry I thought the doc was clear. Please feel free to clarify it. It's still not quite true that graphviz is required. You can output graphml or gexf and look at them using yed or Gephi for instance.</p>

<a name="193020891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/193020891" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#193020891">Patrick Massot (Apr 06 2020 at 10:19)</a>:</h4>
<p>But it's true you need some graph visualization software to see the graph.</p>

<a name="193021179"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/193021179" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#193021179">Patrick Massot (Apr 06 2020 at 10:22)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> what is this timing stuff you added in the import graph branch?</p>

<a name="193021221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/193021221" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#193021221">Patrick Massot (Apr 06 2020 at 10:22)</a>:</h4>
<p>I guess this is a git accident.</p>

<a name="193027185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/193027185" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#193027185">Scott Morrison (Apr 06 2020 at 11:23)</a>:</h4>
<p>git accident!</p>

<a name="193027343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/193027343" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#193027343">Kevin Buzzard (Apr 06 2020 at 11:24)</a>:</h4>
<p>/me looks it up in the git manual</p>

<a name="193031987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/193031987" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#193031987">Patrick Massot (Apr 06 2020 at 12:14)</a>:</h4>
<p>Ok, I cleanup up and forced push. I'm afraid you lost the authorship here, but I hope it's not too bad.</p>

<a name="193037255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20import%20graph/near/193037255" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07663mathlibimportgraph.html#193037255">Scott Morrison (Apr 06 2020 at 13:00)</a>:</h4>
<p>no worries :-)</p>


{% endraw %}

{% include archive_update.html %}