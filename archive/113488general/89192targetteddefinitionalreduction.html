---
layout: page
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/89192targetteddefinitionalreduction.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html">targetted definitional reduction</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="127246965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127246965" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127246965">Kevin Buzzard (May 29 2018 at 21:36)</a>:</h4>
<p>The history of this question is the following: I had a complicated goal which could be reduced using a definitional unfolding which for some reason wasn't happening -- "unfold" wouldn't work</p>

<a name="127246970"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127246970" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127246970">Kevin Buzzard (May 29 2018 at 21:36)</a>:</h4>
<p>I wanted to do the unfold manually with a rw so I asked the name of the theorem that <code>{a := x, b := y}.a = x</code></p>

<a name="127246972"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127246972" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127246972">Kevin Buzzard (May 29 2018 at 21:37)</a>:</h4>
<p>and I was told that this theorem had no name</p>

<a name="127246978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127246978" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127246978">Kevin Buzzard (May 29 2018 at 21:37)</a>:</h4>
<p>because it was true by refl</p>

<a name="127246982"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127246982" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127246982">Kevin Buzzard (May 29 2018 at 21:37)</a>:</h4>
<p>On the other hand, browsing through the library I see a bunch of things with names whose proof is rfl</p>

<a name="127247027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247027" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247027">Kevin Buzzard (May 29 2018 at 21:38)</a>:</h4>
<p>All the other suggestions for what to do were not good for me.</p>

<a name="127247039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247039" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247039">Kevin Buzzard (May 29 2018 at 21:38)</a>:</h4>
<p>"Change it yourself with show" -- yeah but this is a PITA because my structure is a very complicated structure with a very long name and it is being constructed using very long terms</p>

<a name="127247045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247045" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247045">Kevin Buzzard (May 29 2018 at 21:38)</a>:</h4>
<p>and I know <em>precisely</em> how I want <em>this precise term</em> to unfold and I don't want to do anything else to the goal</p>

<a name="127247059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247059" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247059">Kevin Buzzard (May 29 2018 at 21:39)</a>:</h4>
<p>If I change it myself with show then I have to work out what I want the goal to be using pencil and paper! It's 2018!</p>

<a name="127247065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247065" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247065">Kevin Buzzard (May 29 2018 at 21:39)</a>:</h4>
<p>I _need_ to change it because rw is really fussy, it won't rw something defeq to what you want sometimes -- it sometimes needs help</p>

<a name="127247067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247067" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247067">Kevin Buzzard (May 29 2018 at 21:39)</a>:</h4>
<p>and the line after my show line was a complicated rw</p>

<a name="127247110"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247110" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247110">Kevin Buzzard (May 29 2018 at 21:40)</a>:</h4>
<p>Here's what I want to do</p>

<a name="127247115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247115" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247115">Kevin Buzzard (May 29 2018 at 21:40)</a>:</h4>
<p>I want to zoom in to the area I am interested in using conv</p>

<a name="127247120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247120" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247120">Kevin Buzzard (May 29 2018 at 21:40)</a>:</h4>
<p>and I want to run dsimp or some such thing just on that one term</p>

<a name="127247121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247121" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247121">Kevin Buzzard (May 29 2018 at 21:40)</a>:</h4>
<p>Is this possible?</p>

<a name="127247122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247122" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247122">Kevin Buzzard (May 29 2018 at 21:40)</a>:</h4>
<p>I don't think so.</p>

<a name="127247125"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247125" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247125">Kevin Buzzard (May 29 2018 at 21:40)</a>:</h4>
<p>conv offers me exciting commands such as "to_lhs"</p>

<a name="127247130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247130" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247130">Kevin Buzzard (May 29 2018 at 21:41)</a>:</h4>
<p>what about "to 3rd input of this function"?</p>

<a name="127247136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247136" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247136">Kevin Buzzard (May 29 2018 at 21:41)</a>:</h4>
<p>Can conv do that?</p>

<a name="127247142"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247142" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247142">Kevin Buzzard (May 29 2018 at 21:41)</a>:</h4>
<p>Can I do dsimp in conv?</p>

<a name="127247151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247151" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247151">Kevin Buzzard (May 29 2018 at 21:41)</a>:</h4>
<p>I use tactic mode precisely because I like the precise control I have over what is going on</p>

<a name="127247154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247154" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247154">Kevin Buzzard (May 29 2018 at 21:41)</a>:</h4>
<p>but as I get older and wiser and understand more about what is happening, I want more precise tools</p>

<a name="127247202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247202" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247202">Kevin Buzzard (May 29 2018 at 21:42)</a>:</h4>
<p>I can do dsimp in conv mode :-)</p>

<a name="127247203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247203" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247203">Kevin Buzzard (May 29 2018 at 21:42)</a>:</h4>
<p>so my question becomes how to access the 3rd input to a function</p>

<a name="127247207"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247207" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247207">Kevin Buzzard (May 29 2018 at 21:42)</a>:</h4>
<p>goal is <code>f x y = g z</code></p>

<a name="127247212"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247212" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247212">Kevin Buzzard (May 29 2018 at 21:43)</a>:</h4>
<p>and I want to run dsimp on y only</p>

<a name="127247213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247213" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247213">Kevin Buzzard (May 29 2018 at 21:43)</a>:</h4>
<p>how do I do that?</p>

<a name="127247218"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247218" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247218">Kevin Buzzard (May 29 2018 at 21:43)</a>:</h4>
<p>Ok I just thought of a solution which again will work in many cases</p>

<a name="127247222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247222" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247222">Kevin Buzzard (May 29 2018 at 21:43)</a>:</h4>
<p>just define exactly the rewrite I want, call it H, and rw H</p>

<a name="127247224"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247224" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247224">Kevin Buzzard (May 29 2018 at 21:43)</a>:</h4>
<p>This gets me back to the original problem though</p>

<a name="127247226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247226" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247226">Kevin Buzzard (May 29 2018 at 21:43)</a>:</h4>
<p>I do not want to run dsimp in my head</p>

<a name="127247229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247229" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247229">Kevin Buzzard (May 29 2018 at 21:43)</a>:</h4>
<p>I am too lazy</p>

<a name="127247271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247271" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247271">Kevin Buzzard (May 29 2018 at 21:44)</a>:</h4>
<p>I am a big boy now</p>

<a name="127247273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247273" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247273">Mario Carneiro (May 29 2018 at 21:44)</a>:</h4>
<p>what's wrong with <code>dsimp</code>?</p>

<a name="127247277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247277" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247277">Kevin Buzzard (May 29 2018 at 21:44)</a>:</h4>
<p>simplifies too much</p>

<a name="127247279"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247279" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247279">Kevin Buzzard (May 29 2018 at 21:44)</a>:</h4>
<p>that's the wrong question</p>

<a name="127247281"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247281" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247281">Mario Carneiro (May 29 2018 at 21:44)</a>:</h4>
<p>no, that's the standard solution</p>

<a name="127247284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247284" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247284">Kevin Buzzard (May 29 2018 at 21:44)</a>:</h4>
<p>unless you are genuinely convinced that I really never want to run dsimp on just a subterm</p>

<a name="127247288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247288" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247288">Kevin Buzzard (May 29 2018 at 21:45)</a>:</h4>
<p>Let me go back to my usage case</p>

<a name="127247296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127247296" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127247296">Mario Carneiro (May 29 2018 at 21:45)</a>:</h4>
<p>you can use <code>dsimp only</code> or other such tricks to limit the unnecessary simping</p>

<a name="127257747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127257747" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127257747">Chris Hughes (May 30 2018 at 01:35)</a>:</h4>
<p><code>unfold structure.a</code> sometimes works for me in these situations.</p>

<a name="127266078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127266078" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127266078">Kevin Buzzard (May 30 2018 at 04:29)</a>:</h4>
<p>In my usage case, dsimp doesn't do anything at all</p>

<a name="127266492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127266492" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127266492">Kevin Buzzard (May 30 2018 at 04:37)</a>:</h4>
<p>the goal is (function x y z).F H -&gt; Z`</p>

<a name="127266501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127266501" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127266501">Kevin Buzzard (May 30 2018 at 04:37)</a>:</h4>
<p>and <code>function x y z</code> creates a structure</p>

<a name="127266505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127266505" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127266505">Kevin Buzzard (May 30 2018 at 04:37)</a>:</h4>
<p>by saying what all the bits and pieces are</p>

<a name="127266508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127266508" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127266508">Kevin Buzzard (May 30 2018 at 04:37)</a>:</h4>
<p>including F</p>

<a name="127266511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127266511" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127266511">Kevin Buzzard (May 30 2018 at 04:37)</a>:</h4>
<p>dsimp does nothing</p>

<a name="127266515"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127266515" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127266515">Kevin Buzzard (May 30 2018 at 04:38)</a>:</h4>
<p>I can't get conv to get to it</p>

<a name="127266577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127266577" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127266577">Kevin Buzzard (May 30 2018 at 04:38)</a>:</h4>
<p>is it because it's a pi type?</p>

<a name="127266622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127266622" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127266622">Kevin Buzzard (May 30 2018 at 04:39)</a>:</h4>
<p>In the end I copied the context, scrolled to the end of the proof, pasted it, changed <code>X : y,</code> to <code>(X : y)</code> about ten times and made them all variables, and then used <code>#reduce</code> and then cut and pasted the answer back in the proof and wrote "show" in front of it, and then farted around with some pp.proof on to get it to work and I was done</p>

<a name="127266624"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127266624" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127266624">Kevin Buzzard (May 30 2018 at 04:39)</a>:</h4>
<p>That can't be the best way</p>

<a name="127266676"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127266676" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127266676">Kevin Buzzard (May 30 2018 at 04:40)</a>:</h4>
<p>that's not even true</p>

<a name="127266680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127266680" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127266680">Kevin Buzzard (May 30 2018 at 04:40)</a>:</h4>
<p>#reduce didn't do it</p>

<a name="127266684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127266684" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127266684">Kevin Buzzard (May 30 2018 at 04:40)</a>:</h4>
<p>no wait</p>

<a name="127266686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127266686" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127266686">Kevin Buzzard (May 30 2018 at 04:40)</a>:</h4>
<p>it half did it</p>

<a name="127266689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127266689" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127266689">Kevin Buzzard (May 30 2018 at 04:40)</a>:</h4>
<p>it did enough of it</p>

<a name="127266699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127266699" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127266699">Kevin Buzzard (May 30 2018 at 04:40)</a>:</h4>
<p>it unfolded (function x y z).F into (some function of x y and z)</p>

<a name="127266711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127266711" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127266711">Kevin Buzzard (May 30 2018 at 04:41)</a>:</h4>
<p>Why did this cause me such pain? What did I miss?</p>

<a name="127267136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127267136" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127267136">Kevin Buzzard (May 30 2018 at 04:50)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">topology</span><span class="bp">.</span><span class="n">topological_space</span> <span class="n">scheme</span>

<span class="kn">set_option</span> <span class="n">pp</span><span class="bp">.</span><span class="n">proofs</span> <span class="n">true</span>

<span class="kn">theorem</span> <span class="n">presheaves_iso</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">H</span> <span class="o">:</span> <span class="n">topological_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">presheaf_of_types</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span>
<span class="n">are_isomorphic_presheaves_of_types</span>
    <span class="o">(</span><span class="n">presheaf_of_types_pullback_under_open_immersion</span> <span class="n">F</span> <span class="n">id</span>
      <span class="o">(</span><span class="n">topological_space</span><span class="bp">.</span><span class="n">open_immersion_id</span> <span class="bp">_</span><span class="o">))</span>
    <span class="n">F</span>
<span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">constructor</span><span class="o">,</span><span class="n">tactic</span><span class="bp">.</span><span class="n">swap</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">constructor</span><span class="o">,</span><span class="n">tactic</span><span class="bp">.</span><span class="n">swap</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">U</span> <span class="n">HU</span><span class="o">,</span>
      <span class="k">have</span> <span class="n">Hid</span> <span class="o">:=</span> <span class="n">topological_space</span><span class="bp">.</span><span class="n">open_immersion_id</span> <span class="n">X</span><span class="o">,</span>
      <span class="c1">-- goal now</span>
      <span class="k">show</span> <span class="o">(</span><span class="n">presheaf_of_types_pullback_under_open_immersion</span> <span class="n">F</span> <span class="n">id</span> <span class="n">Hid</span><span class="o">)</span><span class="bp">.</span><span class="n">F</span> <span class="n">HU</span> <span class="bp">→</span> <span class="n">F</span><span class="bp">.</span><span class="n">F</span> <span class="n">HU</span><span class="o">,</span>
      <span class="c1">--unfold presheaf_of_types_pullback_under_open_immersion, -- fails</span>
      <span class="k">show</span> <span class="o">(</span><span class="n">F</span><span class="bp">.</span><span class="n">F</span> <span class="o">((</span><span class="n">Hid</span><span class="bp">.</span><span class="n">fopens</span> <span class="n">U</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="n">HU</span><span class="o">))</span> <span class="bp">→</span> <span class="n">F</span><span class="bp">.</span><span class="n">F</span> <span class="n">HU</span><span class="o">,</span> <span class="c1">-- obtained by &quot;#reduce&quot; calculation below</span>
      <span class="k">show</span> <span class="o">(</span><span class="n">F</span><span class="bp">.</span><span class="n">F</span> <span class="o">(</span><span class="bp">_</span> <span class="o">:</span> <span class="n">is_open</span> <span class="o">(</span><span class="n">id</span> <span class="err">&#39;&#39;</span> <span class="n">U</span><span class="o">))</span> <span class="bp">→</span> <span class="n">F</span><span class="bp">.</span><span class="n">F</span> <span class="n">HU</span><span class="o">),</span> <span class="c1">-- obtained by more out-of-proof unravelling</span>

      <span class="n">sorry</span>
    <span class="o">},</span><span class="n">sorry</span><span class="o">,</span>

  <span class="o">},</span>
  <span class="n">sorry</span>
<span class="kn">end</span>
<span class="kn">variables</span>
<span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span>
<span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">topological_space</span> <span class="n">X</span><span class="o">)</span>
<span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">presheaf_of_types</span> <span class="n">X</span><span class="o">)</span>
<span class="o">(</span><span class="n">U</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">)</span>
<span class="o">(</span><span class="n">HU</span> <span class="o">:</span> <span class="n">topological_space</span><span class="bp">.</span><span class="n">is_open</span> <span class="n">H</span> <span class="n">U</span><span class="o">)</span>
<span class="o">(</span><span class="n">Hid</span> <span class="o">:</span> <span class="n">topological_space</span><span class="bp">.</span><span class="n">open_immersion</span> <span class="o">(</span><span class="bp">@</span><span class="n">id</span> <span class="n">X</span><span class="o">))</span>

<span class="bp">#</span><span class="n">reduce</span> <span class="o">(</span><span class="n">presheaf_of_types_pullback_under_open_immersion</span> <span class="n">F</span> <span class="n">id</span> <span class="n">Hid</span><span class="o">)</span><span class="bp">.</span><span class="n">F</span>
<span class="c1">-- λ (U : X → Prop) (HU : topological_space.is_open H U), F.F ((Hid.fopens U).mp HU)</span>
<span class="bp">#</span><span class="kn">check</span> <span class="o">(</span><span class="n">Hid</span><span class="bp">.</span><span class="n">fopens</span> <span class="n">U</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="c1">-- is_open U → is_open (id &#39;&#39; U)</span>


<span class="bp">#</span><span class="kn">exit</span>
</pre></div>

<a name="127267142"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127267142" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127267142">Kevin Buzzard (May 30 2018 at 04:50)</a>:</h4>
<p>What my code looks like</p>

<a name="127267540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127267540" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127267540">Kevin Buzzard (May 30 2018 at 04:58)</a>:</h4>
<p>It doesn't run for people who don't have my repo because it needs scheme.lean but I hope it explicitly shows the problem. I don't know how to get Lean to unfold <code>(presheaf_of_types_pullback_under_open_immersion F id Hid).F</code>, possibily because it's in a lambda, but it is defeq to something much simpler which I work out outside the proof after some copying of context (IRL the context was huge and I just did the unravelling using cut and paste)</p>

<a name="127267590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127267590" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127267590">Mario Carneiro (May 30 2018 at 04:59)</a>:</h4>
<p>You should have a simp lemma for the value of <code>.F</code></p>

<a name="127267671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127267671" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127267671">Mario Carneiro (May 30 2018 at 05:00)</a>:</h4>
<p>alternatively, you can <code>dsimp [function]</code> to unfold it</p>

<a name="127278172"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127278172" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127278172">Kevin Buzzard (May 30 2018 at 08:37)</a>:</h4>
<blockquote>
<p>You should have a simp lemma for the value of <code>.F</code></p>
</blockquote>
<p>Talking through pnat was very instructional. I realise that I have a very poor feeling about what should be a simp lemma. I made that structure though -- these lemmas aren't automatically added when I make the structure? What is added to the simp machine?</p>

<a name="127278180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127278180" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127278180">Kevin Buzzard (May 30 2018 at 08:37)</a>:</h4>
<blockquote>
<p>alternatively, you can <code>dsimp [function]</code> to unfold it</p>
</blockquote>
<p>This is what I needed to know :-) Thanks!</p>

<a name="127278221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127278221" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127278221">Kevin Buzzard (May 30 2018 at 08:38)</a>:</h4>
<p>Even though my function isn't a simp lemma :-)</p>

<a name="127278222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127278222" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127278222">Mario Carneiro (May 30 2018 at 08:38)</a>:</h4>
<p><code>simp</code>  will reduce terms that look like <code>&lt;a, b, c&gt;.2</code></p>

<a name="127278229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127278229" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127278229">Mario Carneiro (May 30 2018 at 08:38)</a>:</h4>
<p>where <code>&lt;&gt;</code> is the builtin structure constructor and <code>.2</code> is a builtin projection</p>

<a name="127278241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127278241" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127278241">Mario Carneiro (May 30 2018 at 08:39)</a>:</h4>
<p>If there are any definitions shielding the redex from looking like that, simp won't find it</p>

<a name="127278246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127278246" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127278246">Kevin Buzzard (May 30 2018 at 08:39)</a>:</h4>
<p>like <code>(f x y z).F</code></p>

<a name="127278247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/targetted%20definitional%20reduction/near/127278247" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/89192targetteddefinitionalreduction.html#127278247">Mario Carneiro (May 30 2018 at 08:39)</a>:</h4>
<p>right</p>


{% endraw %}
