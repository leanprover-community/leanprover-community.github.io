---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/59087replacer.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html">replacer</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="133700764"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133700764" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133700764">Mario Carneiro (Sep 11 2018 at 00:53)</a>:</h4>
<p>By the suggestion of Simon, I've extended <code>replacer</code> to support parameters in its type. That is, you can define a replaceable definition <code>foo : A -&gt; tactic B</code> where you have arbitrary input and output, rather than just <code>tactic unit</code>. Incidentally, implementing this required my first attempt at meta-metaprogramming, since the defined tactics are written programmatically.</p>

<a name="133700886"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133700886" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133700886">Simon Hudon (Sep 11 2018 at 00:55)</a>:</h4>
<p>Does it accept any number of parameters?</p>

<a name="133700888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133700888" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133700888">Mario Carneiro (Sep 11 2018 at 00:55)</a>:</h4>
<p>yes</p>

<a name="133700895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133700895" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133700895">Mario Carneiro (Sep 11 2018 at 00:55)</a>:</h4>
<p>just one output, but we always bundle that anyway</p>

<a name="133700963"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133700963" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133700963">Mario Carneiro (Sep 11 2018 at 00:57)</a>:</h4>
<p>It doesn't support monads other than <code>tactic</code>, and the prev tactic access does not allow changing parameters</p>

<a name="133701331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133701331" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133701331">Simon Hudon (Sep 11 2018 at 01:04)</a>:</h4>
<p>This supercalifragilisticexpialidocious!</p>

<a name="133701427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133701427" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133701427">Simon Hudon (Sep 11 2018 at 01:06)</a>:</h4>
<p>To let other people in on the idea, I wanted this so that we can write a tactic at the same as we write a proof, even if the tactic is a core tactic, we can put them in the same file and stop recompiling everything every time we change the tactic</p>

<a name="133701435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133701435" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133701435">Simon Hudon (Sep 11 2018 at 01:06)</a>:</h4>
<p>This is a bit similar to hot code loading</p>

<a name="133701521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133701521" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133701521">Mario Carneiro (Sep 11 2018 at 01:08)</a>:</h4>
<p>you don't mean "core" as in "core lean" though. Like time travel, you can't go back before the time machine was invented</p>

<a name="133701529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133701529" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133701529">Simon Hudon (Sep 11 2018 at 01:08)</a>:</h4>
<p>That is correct :)</p>

<a name="133701549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133701549" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133701549">Simon Hudon (Sep 11 2018 at 01:09)</a>:</h4>
<p>You can only replace definitions in files where you can import this replacer tactic.</p>

<a name="133701974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133701974" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133701974">Simon Hudon (Sep 11 2018 at 01:18)</a>:</h4>
<p>What do you use from <code>tactic.basic</code>?</p>

<a name="133702266"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133702266" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133702266">Mario Carneiro (Sep 11 2018 at 01:24)</a>:</h4>
<p>just the <code>has_reflect</code> instance for binder_info</p>

<a name="133702353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133702353" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133702353">Simon Hudon (Sep 11 2018 at 01:26)</a>:</h4>
<p>Cool, I left you a comment on the commit. I think it should be moved to <code>tactic.replacer</code> so that <code>tactic.basic</code> can import <code>tactic.replacer</code> (since it's a tool for writing tactics)</p>

<a name="133702529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133702529" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133702529">Mario Carneiro (Sep 11 2018 at 01:31)</a>:</h4>
<p>I don't think anything in mathlib uses it though</p>

<a name="133702652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133702652" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133702652">Simon Hudon (Sep 11 2018 at 01:35)</a>:</h4>
<p>That's ok. What i intend to do with it when I write tactics for mathlib is to temporarily have <code>tactic.basic</code> import <code>tactic.replacer</code>, make all the routines I use replaceable, go write an example and, next to it, keep a version of the functions and tactics that I modify. When I'm done, I remove the <code>def_replacers</code> and the <code>import tactic.basic</code> statement.</p>

<a name="133703035"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133703035" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133703035">Simon Hudon (Sep 11 2018 at 01:46)</a>:</h4>
<p>Btw, there is a way we could go back in time passed the creation of our machine: using meta programming, we create a <code>dynamic</code> namespace in which we copy all the visible declarations that depend on what we want to replace and and we rewrite their definitions to insert the replacer instead of the original definition.</p>

<a name="133703136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133703136" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133703136">Mario Carneiro (Sep 11 2018 at 01:50)</a>:</h4>
<p>that's more like alternate universe time travel</p>

<a name="133703163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/replacer/near/133703163" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/59087replacer.html#133703163">Simon Hudon (Sep 11 2018 at 01:51)</a>:</h4>
<p>I'm happy with multi-universe interpretations</p>


{% endraw %}

{% include archive_update.html %}