---
layout: page
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/84025mkapp.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html">`mk_app`</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="131231220"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231220" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231220">Edward Ayers (Aug 10 2018 at 13:16)</a>:</h4>
<p>How does the <code>mk_app</code> tactic work?</p>

<a name="131231293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231293" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231293">Edward Ayers (Aug 10 2018 at 13:19)</a>:</h4>
<p>What does it apply to what? What name does it return?</p>

<a name="131231495"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231495" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231495">Mario Carneiro (Aug 10 2018 at 13:24)</a>:</h4>
<p>It constructs an application of a theorem given by name, to a list of arguments</p>

<a name="131231506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231506" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231506">Mario Carneiro (Aug 10 2018 at 13:25)</a>:</h4>
<p>i.e. <code>mk_app ``eq [a, b]</code> will construct the term <code>%%a = %%b</code></p>

<a name="131231508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231508" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231508">Mario Carneiro (Aug 10 2018 at 13:25)</a>:</h4>
<p>where <code>a b : expr</code></p>

<a name="131231513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231513" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231513">Edward Ayers (Aug 10 2018 at 13:25)</a>:</h4>
<p>What does %% mean?</p>

<a name="131231522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231522" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231522">Mario Carneiro (Aug 10 2018 at 13:26)</a>:</h4>
<p>I mean that it's not <code>a</code> itself that is equal to <code>b</code>, it is the expression <code>a</code> represents</p>

<a name="131231565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231565" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231565">Mario Carneiro (Aug 10 2018 at 13:26)</a>:</h4>
<p>it's antiquotation but I'm using it schematically there</p>

<a name="131231570"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231570" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231570">Edward Ayers (Aug 10 2018 at 13:26)</a>:</h4>
<p>ok</p>

<a name="131231576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231576" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231576">Edward Ayers (Aug 10 2018 at 13:26)</a>:</h4>
<p>whats the difference between <code>pexpr</code> and <code>expr</code>?</p>

<a name="131231587"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231587" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231587">Edward Ayers (Aug 10 2018 at 13:27)</a>:</h4>
<p>What do I type to get the expr representing <code>ℕ</code>?</p>

<a name="131231601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231601" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231601">Mario Carneiro (Aug 10 2018 at 13:27)</a>:</h4>
<p><code> `(ℕ)</code> is the easy way</p>

<a name="131231642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231642" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231642">Edward Ayers (Aug 10 2018 at 13:28)</a>:</h4>
<p>are the braces necessary?</p>

<a name="131231647"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231647" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231647">Mario Carneiro (Aug 10 2018 at 13:28)</a>:</h4>
<p>yes, without parens the backquote quotes <code>name</code>s</p>

<a name="131231649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231649" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231649">Mario Carneiro (Aug 10 2018 at 13:28)</a>:</h4>
<p>the parens signal an <code>expr</code> quotation</p>

<a name="131231670"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231670" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231670">Edward Ayers (Aug 10 2018 at 13:29)</a>:</h4>
<p>ok so<br>
- <code> `(X) </code> means <code>expr</code> of<br>
- <code> `X </code> means the name of<br>
- <code> ``X  </code> means the <code>name</code>of with automatic namespace resolution<br>
- <code>```X</code> means ?</p>

<a name="131231717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231717" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231717">Mario Carneiro (Aug 10 2018 at 13:30)</a>:</h4>
<p>Another way to get the expr for N is <code>mk_const `nat</code></p>

<a name="131231729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231729" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231729">Edward Ayers (Aug 10 2018 at 13:30)</a>:</h4>
<p>I can't get the backticks to work but the 3rd item in the list is supposed to have 2 backticks</p>

<a name="131231739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231739" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231739">Mario Carneiro (Aug 10 2018 at 13:30)</a>:</h4>
<p>you have to put more quotes around the code block than are in it</p>

<a name="131231749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231749" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231749">Mario Carneiro (Aug 10 2018 at 13:31)</a>:</h4>
<p>like <code> ``x `n `` </code></p>

<a name="131231831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231831" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231831">Mario Carneiro (Aug 10 2018 at 13:33)</a>:</h4>
<p>see an earlier cheat sheet: <a href="#narrow/stream/113488-general/subject/Programming.20in.20Lean/near/129467739" title="#narrow/stream/113488-general/subject/Programming.20in.20Lean/near/129467739">https://leanprover.zulipchat.com/#narrow/stream/113488-general/subject/Programming.20in.20Lean/near/129467739</a></p>

<a name="131231900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231900" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231900">Edward Ayers (Aug 10 2018 at 13:35)</a>:</h4>
<p>what is a <code>pexpr</code>?</p>

<a name="131231910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231910" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231910">Mario Carneiro (Aug 10 2018 at 13:35)</a>:</h4>
<p>a pre-expression, which is the output of the parser</p>

<a name="131231921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231921" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231921">Mario Carneiro (Aug 10 2018 at 13:35)</a>:</h4>
<p>the difference between it and <code>expr</code> is the implicit arguments and other well typed data</p>

<a name="131231924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231924" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231924">Edward Ayers (Aug 10 2018 at 13:36)</a>:</h4>
<p>ok.</p>

<a name="131231967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231967" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231967">Edward Ayers (Aug 10 2018 at 13:36)</a>:</h4>
<p>can I make an <code>expr</code> with an invalid type?</p>

<a name="131231969"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231969" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231969">Mario Carneiro (Aug 10 2018 at 13:36)</a>:</h4>
<p>yes</p>

<a name="131231974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231974" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231974">Edward Ayers (Aug 10 2018 at 13:36)</a>:</h4>
<p>so its just a syntax tree with implicit args etc</p>

<a name="131231989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231989" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231989">Mario Carneiro (Aug 10 2018 at 13:36)</a>:</h4>
<p>the tactics try to check stuff as they build exprs, for efficiency</p>

<a name="131231997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131231997" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131231997">Edward Ayers (Aug 10 2018 at 13:37)</a>:</h4>
<p>is there a fast way of writing <code>unit.star</code>?</p>

<a name="131232003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131232003" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131232003">Mario Carneiro (Aug 10 2018 at 13:37)</a>:</h4>
<p><code>()</code></p>

<a name="131232018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131232018" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131232018">Mario Carneiro (Aug 10 2018 at 13:37)</a>:</h4>
<p>for example, <code>mk_app</code> will tell you if the application you build is not well typed, but <code>expr.app</code> will not</p>

<a name="131232068"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131232068" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131232068">Edward Ayers (Aug 10 2018 at 13:38)</a>:</h4>
<p>ah ok that makes sense.</p>

<a name="131232085"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131232085" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131232085">Mario Carneiro (Aug 10 2018 at 13:38)</a>:</h4>
<p>an <code>expr</code> is a bit more than a syntax tree, it is more like a full proof term, but it is not guaranteed to be correct</p>

<a name="131232091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131232091" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131232091">Mario Carneiro (Aug 10 2018 at 13:39)</a>:</h4>
<p><code>pexpr</code> is more like a syntax tree</p>

<a name="131232176"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131232176" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131232176">Edward Ayers (Aug 10 2018 at 13:40)</a>:</h4>
<p>is a <code>name</code> just the <code>namespace1.namespace2.foo</code> string stack?</p>

<a name="131232241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131232241" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131232241">Edward Ayers (Aug 10 2018 at 13:42)</a>:</h4>
<p>If I am inside a lambda expression with variable <code>x</code> and running a tactic, what would it's name be? <code>anonymous</code>?</p>

<a name="131232535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131232535" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131232535">Edward Ayers (Aug 10 2018 at 13:50)</a>:</h4>
<p>Also please could you help me untangle my misconceptions about how metavariables work in the following example:</p>
<div class="codehilite"><pre><span></span><span class="n">meta</span> <span class="n">def</span> <span class="n">scratch_tac</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="n">do</span>
    <span class="n">v</span> <span class="bp">&lt;-</span> <span class="n">mk_meta_var</span> <span class="bp">`</span><span class="o">(</span><span class="bp">ℕ</span><span class="o">),</span>
    <span class="n">e</span> <span class="bp">&lt;-</span> <span class="n">mk_app</span> <span class="bp">``</span><span class="n">eq</span> <span class="o">[</span><span class="n">v</span><span class="o">,</span> <span class="n">v</span><span class="o">],</span>
    <span class="n">set_goals</span> <span class="o">[</span><span class="n">e</span><span class="o">],</span>
    <span class="n">return</span> <span class="o">()</span>

<span class="kn">variables</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="kt">Prop</span>
<span class="kn">example</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">-&gt;</span> <span class="o">(</span><span class="n">a</span> <span class="bp">-&gt;</span> <span class="n">b</span><span class="o">)</span> <span class="bp">-&gt;</span> <span class="n">c</span> <span class="bp">-&gt;</span> <span class="n">b</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span> <span class="n">h1</span> <span class="n">h2</span> <span class="n">h3</span><span class="o">,</span>
  <span class="n">scratch_tac</span><span class="o">,</span>
  <span class="n">sorry</span>
<span class="kn">end</span>
</pre></div>


<p>Which errors on <code>scratch_tac</code> with <code>invalid set_goals tactic, expressions must be meta-variables that have been declared in the current tactic_state</code></p>

<a name="131232558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131232558" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131232558">Edward Ayers (Aug 10 2018 at 13:51)</a>:</h4>
<p>I want to add a new goal which is <code>?x = ?x</code> where I don't know what <code>?x</code> is yet. If that makes sense</p>

<a name="131232741"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131232741" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131232741">Edward Ayers (Aug 10 2018 at 13:55)</a>:</h4>
<p>Are there any docs which tell me what is in <code>tactic_state</code>?</p>

<a name="131232857"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131232857" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131232857">Mario Carneiro (Aug 10 2018 at 13:57)</a>:</h4>
<blockquote>
<p>is a name just the namespace1.namespace2.foo string stack?</p>
</blockquote>
<p>yes</p>
<blockquote>
<p>If I am inside a lambda expression with variable x and running a tactic, what would it's name be? anonymous?</p>
</blockquote>
<p>It depends on whether the lambda has been abstracted or not. If the variable <code>x</code> is currently in the local context (i.e. left of the turnstile) then <code>x</code> will be represented in expressions as a <code>expr.local_const</code>. If <code>x</code> is bound in an expression, then it is nameless, <code>var 0</code> or such</p>

<a name="131233720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131233720" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131233720">Mario Carneiro (Aug 10 2018 at 14:16)</a>:</h4>
<p>I think this is what you want:</p>
<div class="codehilite"><pre><span></span><span class="n">meta</span> <span class="n">def</span> <span class="n">scratch_tac</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="n">do</span> <span class="n">v</span> <span class="err">←</span> <span class="n">mk_meta_var</span> <span class="bp">`</span><span class="o">(</span><span class="bp">ℕ</span><span class="o">),</span>
   <span class="n">e</span> <span class="err">←</span> <span class="n">mk_app</span> <span class="bp">``</span><span class="n">eq</span> <span class="o">[</span><span class="n">v</span><span class="o">,</span> <span class="n">v</span><span class="o">],</span>
   <span class="n">h</span> <span class="err">←</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">assert</span> <span class="bp">`</span><span class="n">h</span> <span class="n">e</span><span class="o">,</span>
   <span class="n">skip</span>
</pre></div>

<a name="131243121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131243121" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131243121">Edward Ayers (Aug 10 2018 at 17:05)</a>:</h4>
<p>so re: names, I have <code>local_const : name → name → binder_info → expr → expr</code>, What do these entries correspond to?</p>

<a name="131243187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131243187" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131243187">Mario Carneiro (Aug 10 2018 at 17:06)</a>:</h4>
<p>pretty name, unique name, binder info, type (sometimes)</p>

<a name="131243208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131243208" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131243208">Mario Carneiro (Aug 10 2018 at 17:06)</a>:</h4>
<p>binder info means explicit, implicit, typeclass implicit, etc</p>

<a name="131243243"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131243243" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131243243">Mario Carneiro (Aug 10 2018 at 17:07)</a>:</h4>
<p>you shouldn't trust the type, it is sometimes a dummy value</p>

<a name="131243254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131243254" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131243254">Mario Carneiro (Aug 10 2018 at 17:07)</a>:</h4>
<p>use <code>infer_type</code> on the variable instead</p>

<a name="131243351"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131243351" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131243351">Edward Ayers (Aug 10 2018 at 17:08)</a>:</h4>
<p><code>binder_info</code> implies something is being bound? Is it bound in the type?</p>

<a name="131243381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131243381" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131243381">Mario Carneiro (Aug 10 2018 at 17:09)</a>:</h4>
<p>every variable was bound at some point, but you have opened it to look inside the binder and now the variable is in the context</p>

<a name="131243404"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131243404" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131243404">Edward Ayers (Aug 10 2018 at 17:09)</a>:</h4>
<p>So it's the binder info for the original <code>lam</code> or <code>pi</code> that it was bound by?</p>

<a name="131243582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131243582" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131243582">Mario Carneiro (Aug 10 2018 at 17:12)</a>:</h4>
<p>yes</p>
<div class="codehilite"><pre><span></span>example {α : Type} (x : α) : α :=
by do
  expr.local_const pp_α uα bi_α t ← tactic.get_local `α,
  guard (bi_α = binder_info.implicit),
  expr.local_const pp_x ux bi_x t ← tactic.get_local `x,
  guard (bi_x = binder_info.default),
  `[exact x]
</pre></div>

<a name="131243863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131243863" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131243863">Kevin Buzzard (Aug 10 2018 at 17:16)</a>:</h4>
<p>If this conversation were going about ten times more slowly I feel like I could learn something from it. I know that <span class="user-mention" data-user-id="110044">@Chris Hughes</span> had plans to learn something about tactics this summer, but my impression was that when he realised he had 100 questions he decided that it was unreasonable to spam the chat with them all, and of course I was no help. Chris and I between us can deal with essentially all the questions the other undergrads are throwing at us because we both now have a robust understanding of how to do mathematics in Lean, but we are still lacking a tactic guru and I don't quite know what to do about it.</p>

<a name="131244150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131244150" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131244150">Edward Ayers (Aug 10 2018 at 17:21)</a>:</h4>
<p>I have no spam shame.</p>

<a name="131244386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131244386" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131244386">Kevin Buzzard (Aug 10 2018 at 17:24)</a>:</h4>
<p>I was just the same last August/Sept/Oct when I was learning dependent type theory. I don't regret it for one instant. Now when I see a newbie question that I can answer I try to answer it quickly to save Mario the bother.</p>

<a name="131244571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131244571" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131244571">Kevin Buzzard (Aug 10 2018 at 17:27)</a>:</h4>
<p>It's really important that the knowledge base expands quickly.</p>

<a name="131245099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131245099" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131245099">Edward Ayers (Aug 10 2018 at 17:34)</a>:</h4>
<p>Ok more tactics questions:<br>
This is the code for <code>abstract</code> from the core library:</p>
<div class="codehilite"><pre><span></span><span class="n">meta</span> <span class="n">def</span> <span class="n">abstract</span> <span class="o">(</span><span class="n">tac</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span><span class="o">)</span> <span class="o">(</span><span class="n">suffix</span> <span class="o">:</span> <span class="n">option</span> <span class="n">name</span> <span class="o">:=</span> <span class="n">none</span><span class="o">)</span> <span class="o">(</span><span class="n">zeta_reduce</span> <span class="o">:=</span> <span class="n">tt</span><span class="o">)</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="n">do</span> <span class="n">fail_if_no_goals</span><span class="o">,</span>
   <span class="n">gs</span> <span class="err">←</span> <span class="n">get_goals</span><span class="o">,</span>
   <span class="n">type</span> <span class="err">←</span> <span class="k">if</span> <span class="n">zeta_reduce</span> <span class="k">then</span> <span class="n">target</span> <span class="bp">&gt;&gt;=</span> <span class="n">zeta</span> <span class="k">else</span> <span class="n">target</span><span class="o">,</span>
   <span class="n">is_lemma</span> <span class="err">←</span> <span class="n">is_prop</span> <span class="n">type</span><span class="o">,</span>
   <span class="n">m</span> <span class="err">←</span> <span class="n">mk_meta_var</span> <span class="n">type</span><span class="o">,</span>
   <span class="n">set_goals</span> <span class="o">[</span><span class="n">m</span><span class="o">],</span>
   <span class="n">tac</span><span class="o">,</span>
   <span class="n">n</span> <span class="err">←</span> <span class="n">num_goals</span><span class="o">,</span>
   <span class="n">when</span> <span class="o">(</span><span class="n">n</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">fail</span> <span class="s2">&quot;abstract tactic failed, there are unsolved goals&quot;</span><span class="o">),</span>
   <span class="n">set_goals</span> <span class="n">gs</span><span class="o">,</span>
   <span class="n">val</span> <span class="err">←</span> <span class="n">instantiate_mvars</span> <span class="n">m</span><span class="o">,</span>
   <span class="n">val</span> <span class="err">←</span> <span class="k">if</span> <span class="n">zeta_reduce</span> <span class="k">then</span> <span class="n">zeta</span> <span class="n">val</span> <span class="k">else</span> <span class="n">return</span> <span class="n">val</span><span class="o">,</span>
   <span class="n">c</span>   <span class="err">←</span> <span class="n">mk_aux_decl_name</span> <span class="n">suffix</span><span class="o">,</span>
   <span class="n">e</span>   <span class="err">←</span> <span class="n">add_aux_decl</span> <span class="n">c</span> <span class="n">type</span> <span class="n">val</span> <span class="n">is_lemma</span><span class="o">,</span>
   <span class="n">exact</span> <span class="n">e</span>
</pre></div>


<ul>
<li><code>set_goals</code> seems to completely clobber the existing goals. It seems like it is just changing the field on <code>tactic_state</code> structure.  But if you can do this, what stops you from doing <code>m &lt;- mk_meta_var `(true), set_goals [m]</code> (or code to that effect) and just solving that?</li>
<li>What is keeping track of the metavariables? Are these kept in <code>tactic_state</code>? </li>
<li>Once I set a metavariable to be a goal and then solve it with a tactic, where is the proof term stored? How can I find out the status of a metavariable eg (fresh, partially instantiated etc)</li>
<li>What stops me from making infinite-descent terms using metavariables? Eg I could solve <code>?m</code> with <code>f(?n)</code> and vice versa.</li>
</ul>

<a name="131245191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131245191" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131245191">Edward Ayers (Aug 10 2018 at 17:35)</a>:</h4>
<ul>
<li>What does <code>instantiate_mvars</code> do? Is the metavariable eliminated from the state when I do this? What does it return?</li>
</ul>

<a name="131245493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131245493" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131245493">Edward Ayers (Aug 10 2018 at 17:39)</a>:</h4>
<ul>
<li>Is <code>zeta</code> the one for reducing <code>let</code> bindings? I can't find it on google. Where can I find a list of the reductions in Lean?</li>
</ul>

<a name="131245627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131245627" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131245627">Mario Carneiro (Aug 10 2018 at 17:40)</a>:</h4>
<blockquote>
<p>set_goals seems to completely clobber the existing goals. It seems like it is just changing the field on tactic_state structure. But if you can do this, what stops you from doing m &lt;- mk_meta_var `(true), set_goals [m] (or code to that effect) and just solving that?</p>
</blockquote>
<p>Nothing. If you do, you will get a strange error message saying there are no goals left but metavariables remain, and your users will be confused</p>

<a name="131245649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131245649" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131245649">Edward Ayers (Aug 10 2018 at 17:41)</a>:</h4>
<ul>
<li>If the <code>zeta_reduce</code> option isn't set, it looks like this <code>abstract</code> tactic doesn't do anything. It just sets the goal to be the same as the original goal and runs <code>tac</code>.</li>
</ul>

<a name="131245669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131245669" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131245669">Mario Carneiro (Aug 10 2018 at 17:41)</a>:</h4>
<blockquote>
<p>What is keeping track of the metavariables? Are these kept in tactic_state? </p>
</blockquote>
<p>Yes. The <code>tactic_state</code> is essentially just a list of metavariables (the goals) plus a partial proof term (the result)</p>

<a name="131245734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131245734" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131245734">Edward Ayers (Aug 10 2018 at 17:42)</a>:</h4>
<blockquote>
<p>Nothing. If you do, you will get a strange error message saying there are no goals left but metavariables remain, and your users will be confused</p>
</blockquote>
<p>Ah so the task is to get rid of the metavars. The goal state doesn't matter. nice.</p>

<a name="131245763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131245763" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131245763">Mario Carneiro (Aug 10 2018 at 17:43)</a>:</h4>
<blockquote>
<p>Once I set a metavariable to be a goal and then solve it with a tactic, where is the proof term stored? How can I find out the status of a metavariable eg (fresh, partially instantiated etc)</p>
</blockquote>
<p>The goals should be a subset of the metavariables in the result, so when they are assigned the result proof term is increased</p>

<a name="131245859"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131245859" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131245859">Mario Carneiro (Aug 10 2018 at 17:44)</a>:</h4>
<p>Metavariables that you deal with in tactics are usually uninstantiated. There is no "partially instantiated", they are just instantiated to a term that contains more metavariables</p>

<a name="131245883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131245883" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131245883">Mario Carneiro (Aug 10 2018 at 17:44)</a>:</h4>
<p><code>get_assignment</code> returns the assignment to a metavar</p>

<a name="131245949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131245949" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131245949">Mario Carneiro (Aug 10 2018 at 17:45)</a>:</h4>
<blockquote>
<p>What stops me from making infinite-descent terms using metavariables? Eg I could solve ?m with f(?n) and vice versa.</p>
</blockquote>
<p>I believe there is an occurs-check in <code>unify</code>, which is responsible for most metavariable assignment</p>

<a name="131246063"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131246063" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131246063">Mario Carneiro (Aug 10 2018 at 17:47)</a>:</h4>
<blockquote>
<p>What does instantiate_mvars do? Is the metavariable eliminated from the state when I do this? What does it return?</p>
</blockquote>
<p><code>instantiate_mvars</code> takes an expr with embedded <code>mvar</code> constructors and replaces them with their assignments</p>

<a name="131246098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131246098" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131246098">Mario Carneiro (Aug 10 2018 at 17:47)</a>:</h4>
<p>The state is manually maintained, so metavars go away when you say so. However, <code>set_goals</code> automatically prunes assigned mvars</p>

<a name="131319264"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131319264" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131319264">Edward Ayers (Aug 10 2018 at 17:48)</a>:</h4>
<ul>
<li>what happens if I try to use <code>exact e</code> where the expression depends on mvars that have already been assigned? will they be automatically assigned?</li>
</ul>

<a name="131319278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131319278" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131319278">Mario Carneiro (Aug 10 2018 at 17:49)</a>:</h4>
<blockquote>
<p>Is zeta the one for reducing let bindings? I can't find it on google. Where can I find a list of the reductions in Lean?</p>
</blockquote>
<p>Yes. The zeta rule says that if <code>x : t := e</code> is in the context, then <code>x</code> reduces to <code>e</code></p>

<a name="131392498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131392498" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131392498">Mario Carneiro (Aug 10 2018 at 17:50)</a>:</h4>
<p>The reduction rules in lean are beta, zeta, delta, and iota, with additionally alpha and eta conversions (these are not reductions, just equalities)</p>

<a name="131392549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131392549" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131392549">Mario Carneiro (Aug 10 2018 at 17:51)</a>:</h4>
<blockquote>
<p>If the zeta_reduce option isn't set, it looks like this abstract tactic doesn't do anything. It just sets the goal to be the same as the original goal and runs tac.</p>
</blockquote>
<p>The purpose of the <code>abstract</code> tactic is to take the result of the enclosed tactic script and save the result to a new auxiliary definition</p>

<a name="131465729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131465729" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131465729">Mario Carneiro (Aug 10 2018 at 17:52)</a>:</h4>
<p><code>return</code> is not an early abort in lean!</p>

<a name="131538857"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131538857" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131538857">Edward Ayers (Aug 10 2018 at 17:52)</a>:</h4>
<p>what is an auxillary definition?</p>

<a name="131538860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131538860" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131538860">Mario Carneiro (Aug 10 2018 at 17:52)</a>:</h4>
<p>It basically just means produce a value with no side effects</p>

<a name="131538882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131538882" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131538882">Mario Carneiro (Aug 10 2018 at 17:53)</a>:</h4>
<p>it's just a definition with an obscure derived name</p>

<a name="131539010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131539010" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131539010">Mario Carneiro (Aug 10 2018 at 17:55)</a>:</h4>
<p>This line</p>
<div class="codehilite"><pre><span></span>   val ← if zeta_reduce then zeta val else return val,
</pre></div>


<p>is equivalent to the following imperative code:</p>
<div class="codehilite"><pre><span></span>if (zeta_reduce) {val = zeta(val)}
</pre></div>

<a name="131539031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131539031" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131539031">Edward Ayers (Aug 10 2018 at 17:55)</a>:</h4>
<p>yeah I'm ok with <code>return</code></p>

<a name="131539087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131539087" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131539087">Edward Ayers (Aug 10 2018 at 17:56)</a>:</h4>
<p>The original question was spawned from a lack of understanding of goals vs metavars</p>

<a name="131612227"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131612227" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131612227">Mario Carneiro (Aug 10 2018 at 17:57)</a>:</h4>
<p>goals are metavariables, but there are metavars in the result that are not goals, and there are also metavars that are not in the result</p>

<a name="131612294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131612294" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131612294">Edward Ayers (Aug 10 2018 at 17:58)</a>:</h4>
<p>Right, and when you <code>set_goal m</code> and solve it. <code>m</code> is now assigned, but the actual proof term hasn't advanced</p>

<a name="131685438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131685438" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131685438">Mario Carneiro (Aug 10 2018 at 17:59)</a>:</h4>
<p>I'm not actually sure when the advancing happens. Lean is very good at making assigned metavars act as though they weren't there at all</p>

<a name="131758568"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131758568" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131758568">Mario Carneiro (Aug 10 2018 at 17:59)</a>:</h4>
<p>for most purposes you can just say that the proof term is advanced once you assign the metavar</p>

<a name="131758569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131758569" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131758569">Edward Ayers (Aug 10 2018 at 17:59)</a>:</h4>
<blockquote>
<p>I'm not actually sure when the advancing happens. Lean is very good at making assigned metavars act as though they weren't there at all</p>
</blockquote>
<p>yes this is what is throwing me</p>

<a name="131758649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131758649" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131758649">Mario Carneiro (Aug 10 2018 at 18:00)</a>:</h4>
<p>there are a few gotchas to do with "old" metavars that are assigned but not purged, but these are fairly rare</p>

<a name="131758686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131758686" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131758686">Mario Carneiro (Aug 10 2018 at 18:01)</a>:</h4>
<p>If you ask for the <code>result</code>, I'm pretty sure you will see the result of all assignments</p>

<a name="131831823"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131831823" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131831823">Mario Carneiro (Aug 10 2018 at 18:01)</a>:</h4>
<p>Note that you can't just assign a metavar - there is no direct function for this that I could see on a quick perusal</p>

<a name="131831825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131831825" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131831825">Edward Ayers (Aug 10 2018 at 18:01)</a>:</h4>
<ul>
<li>How does one purge a metavar?</li>
<li>If I make a new metavar <code>m</code> trying to prove <code>false</code>, and then assign all metavars except <code>m</code>, can I still finish the proof?</li>
</ul>

<a name="131831879"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131831879" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131831879">Mario Carneiro (Aug 10 2018 at 18:02)</a>:</h4>
<p>when you assign a metavar indirectly through <code>unify</code>, these details are taken care of for you</p>

<a name="131831937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131831937" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131831937">Mario Carneiro (Aug 10 2018 at 18:03)</a>:</h4>
<blockquote>
<p>How does one purge a metavar?</p>
</blockquote>
<p>How does one not? Once a metavar is assigned it isn't eligible to be a goal anymore, <code>set_goals</code> will remove it</p>

<a name="131831942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131831942" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131831942">Edward Ayers (Aug 10 2018 at 18:03)</a>:</h4>
<p>Would doing <code>set_goal [m]</code> and then <code>exact x</code> assign the metavar?</p>

<a name="131831985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131831985" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131831985">Mario Carneiro (Aug 10 2018 at 18:04)</a>:</h4>
<p>yes, and it would also clear the goal</p>

<a name="131832011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832011" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832011">Mario Carneiro (Aug 10 2018 at 18:04)</a>:</h4>
<p><code>exact x</code> is basically just <code>unify m x</code></p>

<a name="131832021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832021" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832021">Mario Carneiro (Aug 10 2018 at 18:04)</a>:</h4>
<p>with some goal management, I think</p>

<a name="131832083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832083" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832083">Mario Carneiro (Aug 10 2018 at 18:06)</a>:</h4>
<blockquote>
<p>If I make a new metavar m trying to prove false, and then assign all metavars except m, can I still finish the proof?</p>
</blockquote>
<p>Creating a metavar does not tie it to your proof. These "dangling" metavars are not tracked, and give that error you saw before if you try to set them as goals</p>

<a name="131832146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832146" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832146">Mario Carneiro (Aug 10 2018 at 18:06)</a>:</h4>
<p>so yes, this metavar would not affect anything</p>

<a name="131832149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832149" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832149">Edward Ayers (Aug 10 2018 at 18:06)</a>:</h4>
<p>ah ok so you can't even set a dangler as a goal</p>

<a name="131832484"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832484" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832484">Edward Ayers (Aug 10 2018 at 18:11)</a>:</h4>
<p>ah I see <code>assert T</code> is changing the target to <code>T -&gt; target</code>. But <code>setgoal</code> doesn't do that stuff.</p>

<a name="131832712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832712" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832712">Edward Ayers (Aug 10 2018 at 18:14)</a>:</h4>
<p>So just let me reask two questions that I am still unsure about;</p>

<a name="131832729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832729" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832729">Edward Ayers (Aug 10 2018 at 18:15)</a>:</h4>
<ul>
<li>How can I find the metavars that are currently in play?</li>
</ul>

<a name="131832759"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832759" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832759">Edward Ayers (Aug 10 2018 at 18:15)</a>:</h4>
<ul>
<li>what happens if I try to use <code>exact e</code> where the expression depends on mvars that have already been assigned? will they be automatically assigned?</li>
</ul>

<a name="131832765"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832765" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832765">Kevin Buzzard (Aug 10 2018 at 18:15)</a>:</h4>
<blockquote>
<p>The original question was spawned from a lack of understanding of goals vs metavars</p>
</blockquote>
<p>You've obviously not read the docs. See setion 8.5 of "Programming in Lean":</p>
<p>"8.5 Metavariables and Unification<br>
[This section is still under construction. It will discuss the notion of a metavariable and<br>
its local context, with the interesting bit of information that goals in the tactic state are<br>
nothing more than metavariables."</p>

<a name="131832818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832818" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832818">Kevin Buzzard (Aug 10 2018 at 18:16)</a>:</h4>
<p>As you can see, this is all very clearly documented :-)</p>

<a name="131832870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832870" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832870">Edward Ayers (Aug 10 2018 at 18:17)</a>:</h4>
<p>yes I found that doc earlier and thought "finally, one document that I can just read so I don't have to bother people by asking potentially silly questions"</p>

<a name="131832876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832876" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832876">Kevin Buzzard (Aug 10 2018 at 18:17)</a>:</h4>
<p>I've read it twice!</p>

<a name="131832882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832882" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832882">Kevin Buzzard (Aug 10 2018 at 18:17)</a>:</h4>
<p>What there is of it, anyway.</p>

<a name="131832928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832928" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832928">Edward Ayers (Aug 10 2018 at 18:18)</a>:</h4>
<p>The parts that are there are high-qual. I hasten to add</p>

<a name="131832940"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832940" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832940">Kevin Buzzard (Aug 10 2018 at 18:18)</a>:</h4>
<p>Yes absolutely. The docs are excellent. There's just not enough of them.</p>

<a name="131832954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832954" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832954">Kevin Buzzard (Aug 10 2018 at 18:18)</a>:</h4>
<p>Avigad writes very well.</p>

<a name="131832960"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131832960" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131832960">Kevin Buzzard (Aug 10 2018 at 18:18)</a>:</h4>
<p>And knows his stuff.</p>

<a name="131833085"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131833085" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131833085">Johan Commelin (Aug 10 2018 at 18:20)</a>:</h4>
<p>I wonder whether we could write "The Lean book" in a similar fashion as "The HoTT book" was written, somewhere in the near future.</p>

<a name="131833095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131833095" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131833095">Kevin Buzzard (Aug 10 2018 at 18:21)</a>:</h4>
<p>I learnt a lot about the basics of dependent type theory from doing all the exercises in Theorem Proving In Lean. What I need is a whole bunch of high quality basic exercises about exprs etc. Unfortunately learning meta mode is not high priority for me right now so it never happens. I feel my time is currently better spent telling other mathematicians about what I've managed to assimilate about doing mathematics in Lean. I will get to tactics in the end, but secretly hope some more docs will appear before I get there.</p>

<a name="131833119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131833119" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131833119">Mario Carneiro (Aug 10 2018 at 18:21)</a>:</h4>
<blockquote>
<p>How can I find the metavars that are currently in play?</p>
</blockquote>
<p>Lean doesn't make it particularly easy to get the full list. You are supposed to be responsible with your goal management so you don't "drop" any goals you will need later. But it is possible, while expensive, to just crawl the <code>result</code> looking for metavars. The <code>metavariables</code> tactic in mathlib does this</p>

<a name="131833167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131833167" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131833167">Johan Commelin (Aug 10 2018 at 18:22)</a>:</h4>
<p>Right, so we have to lock Mario and Simon into a room for a day, and then that chapter will be a lot better!</p>

<a name="131833194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131833194" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131833194">Mario Carneiro (Aug 10 2018 at 18:22)</a>:</h4>
<blockquote>
<p>what happens if I try to use exact e where the expression depends on mvars that have already been assigned? will they be automatically assigned?</p>
</blockquote>
<p>yes</p>

<a name="131833287"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131833287" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131833287">Kevin Buzzard (Aug 10 2018 at 18:24)</a>:</h4>
<p>As you know I am trying to write "Lean for mathematicians", but my plans have gone awry -- I had thought that my students would be completely unable to make any progress without my writing it, but they have somehow taught each other how to use Lean without my helping. Different people brought different skills to the table, and they just all talked to each other. So the book languished because I wasn't needed and I spent a lot of time getting some kind of overview of what exactly was already in mathlib.</p>

<a name="131833428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131833428" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131833428">Johan Commelin (Aug 10 2018 at 18:27)</a>:</h4>
<p>Would it make sense to start a book project in <code>leanprover-community</code>?</p>

<a name="131833481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131833481" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131833481">Mario Carneiro (Aug 10 2018 at 18:28)</a>:</h4>
<p>Maybe you should ask jeremy to go open source?</p>

<a name="131833499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131833499" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131833499">Johan Commelin (Aug 10 2018 at 18:29)</a>:</h4>
<p>I don't know Jeremy, and he doesn't know me. You know him a lot better... [hint hint]</p>

<a name="131833589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131833589" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131833589">Johan Commelin (Aug 10 2018 at 18:30)</a>:</h4>
<p>Technically, it is already open source. We could just fork the existing book. But it is nice to ask for permission. <span class="emoji emoji-263a" title="smile">:smile:</span></p>

<a name="131833625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131833625" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131833625">Johan Commelin (Aug 10 2018 at 18:31)</a>:</h4>
<p>Maybe a PR on the existing project would be ok.</p>

<a name="131834197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131834197" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131834197">Edward Ayers (Aug 10 2018 at 18:42)</a>:</h4>
<blockquote>
<p>But it is possible, while expensive, to just crawl the <code>result</code> looking for metavars. The <code>metavariables</code> tactic in mathlib does this</p>
</blockquote>
<p>How do I get <code>result</code>?</p>

<a name="131834219"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131834219" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131834219">Edward Ayers (Aug 10 2018 at 18:43)</a>:</h4>
<p>is it the same as <code>interaction_monad.result</code></p>

<a name="131834225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131834225" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131834225">Edward Ayers (Aug 10 2018 at 18:43)</a>:</h4>
<p>In which case the relevant object is <code>tactic_result</code></p>

<a name="131834298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131834298" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131834298">Edward Ayers (Aug 10 2018 at 18:44)</a>:</h4>
<p>But there don't seem to be any consts in lean lib for inspecting <code>tactic_result</code></p>

<a name="131834314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131834314" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131834314">Mario Carneiro (Aug 10 2018 at 18:45)</a>:</h4>
<p>I am talking about <code>tactic.result</code></p>

<a name="131834319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131834319" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131834319">Edward Ayers (Aug 10 2018 at 18:45)</a>:</h4>
<p>oops yes</p>

<a name="131834370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131834370" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131834370">Mario Carneiro (Aug 10 2018 at 18:46)</a>:</h4>
<p><code>interaction_monad.result</code> is a simple inductive type containing the result of a tactic execution, which you can destruct with <code>match</code></p>

<a name="131834376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131834376" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131834376">Edward Ayers (Aug 10 2018 at 18:46)</a>:</h4>
<p>I got confused between <code>tactic_result</code> and <code>tactic_state</code>. <code>tactic_result  := interaction_monad.result tactic_state</code></p>

<a name="131834539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131834539" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131834539">Edward Ayers (Aug 10 2018 at 18:50)</a>:</h4>
<p>Sorry I just completely misread the source code. <code>tactic.result</code> is totally unrelated to <code>tactic_result</code>. Sorry</p>

<a name="131834547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131834547" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131834547">Mario Carneiro (Aug 10 2018 at 18:51)</a>:</h4>
<p>when you put it that way...</p>

<a name="131834650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131834650" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131834650">Edward Ayers (Aug 10 2018 at 18:53)</a>:</h4>
<p>How would one write <code>assert</code> using only <code>mk_metavar</code> and  <code>set_goal</code> moves? is it possible?</p>

<a name="131834962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131834962" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131834962">Edward Ayers (Aug 10 2018 at 19:00)</a>:</h4>
<p>something like:</p>
<div class="codehilite"><pre><span></span><span class="n">assert</span> <span class="o">(</span><span class="n">T</span> <span class="o">:</span> <span class="n">expr</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">do</span> <span class="o">{</span>
  <span class="n">m</span> <span class="bp">&lt;-</span> <span class="n">result</span><span class="o">,</span>
  <span class="n">t</span> <span class="bp">&lt;-</span> <span class="n">target</span><span class="o">,</span>
  <span class="n">a</span> <span class="bp">&lt;-</span> <span class="n">mk_metavar</span> <span class="bp">`</span><span class="o">(</span><span class="n">T</span> <span class="bp">-&gt;</span> <span class="n">t</span><span class="o">),</span>
  <span class="n">b</span> <span class="bp">&lt;-</span> <span class="n">mk_metavar</span> <span class="n">T</span><span class="o">,</span>
  <span class="n">unify</span> <span class="n">m</span>  <span class="bp">`</span><span class="o">(</span><span class="err">%%</span><span class="n">a</span> <span class="err">$</span> <span class="err">%%</span><span class="n">b</span><span class="o">),</span>
  <span class="n">set_goals</span> <span class="o">[</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">],</span>
  <span class="n">return</span> <span class="o">()</span>
<span class="o">}</span>
</pre></div>

<a name="131834983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131834983" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131834983">Edward Ayers (Aug 10 2018 at 19:01)</a>:</h4>
<p>modulo any obvious errors</p>

<a name="131835112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131835112" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131835112">Edward Ayers (Aug 10 2018 at 19:03)</a>:</h4>
<ul>
<li>If I use <code>get_goals</code>, I get a list of expressions. Is <code>target</code> just getting the first of these?</li>
</ul>

<a name="131835195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131835195" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131835195">Mario Carneiro (Aug 10 2018 at 19:06)</a>:</h4>
<p>Here's a decent approximation:</p>
<div class="codehilite"><pre><span></span>meta def assert&#39; (h : name) (t : expr) : tactic unit := do
  g :: gs ← get_goals,
  m₂ ← mk_meta_var t,
  t&#39; ← infer_type g,
  m₁ ← mk_meta_var (expr.pi h binder_info.default t t&#39;),
  unify g (m₁ m₂),
  set_goals (m₁ :: m₂ :: gs),
  intro h &gt;&gt; skip
</pre></div>


<p>I don't know if there is a way to avoid the <code>intro</code> - you need a way to change the local context</p>

<a name="131835255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131835255" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131835255">Edward Ayers (Aug 10 2018 at 19:06)</a>:</h4>
<p>It would be interesting to find a minimal list of fundamental tactics</p>

<a name="131835276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131835276" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131835276">Mario Carneiro (Aug 10 2018 at 19:07)</a>:</h4>
<p>lean wasn't really designed for a small API</p>

<a name="131835286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131835286" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131835286">Mario Carneiro (Aug 10 2018 at 19:07)</a>:</h4>
<p>there are a lot of features which are still not quite available</p>

<a name="131835344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131835344" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131835344">Edward Ayers (Aug 10 2018 at 19:08)</a>:</h4>
<p>I know but it helps with learning, because if I find <code>meta constant ...</code> in <code>tactics.lean</code> I don't know whether I need to care about it to understand how lean works</p>

<a name="131835444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131835444" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131835444">Edward Ayers (Aug 10 2018 at 19:10)</a>:</h4>
<p>Then I could just read the wordy explanation for the minimum fundamental tactics and read the code for the derived ones. I only have to grasp the fundamental ones</p>

<a name="131835472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131835472" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131835472">Edward Ayers (Aug 10 2018 at 19:10)</a>:</h4>
<blockquote>
<p>there are a lot of features which are still not quite available</p>
</blockquote>
<p>please could you give some examples?</p>

<a name="131835503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131835503" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131835503">Mario Carneiro (Aug 10 2018 at 19:11)</a>:</h4>
<p>lean 4 is planning to roll out quite a bit more API surface area</p>

<a name="131835514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131835514" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131835514">Mario Carneiro (Aug 10 2018 at 19:12)</a>:</h4>
<p>right now you can't do much with the parser or elaborator</p>

<a name="131835567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131835567" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131835567">Mario Carneiro (Aug 10 2018 at 19:12)</a>:</h4>
<p>there is <code>lean.parser</code> but it's not nearly enough to do everything you should be able to</p>

<a name="131835580"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131835580" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131835580">Mario Carneiro (Aug 10 2018 at 19:13)</a>:</h4>
<p>you can't access the AST for the source or your place in it</p>

<a name="131835648"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131835648" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131835648">Mario Carneiro (Aug 10 2018 at 19:14)</a>:</h4>
<p>of course I have a mile long wishlist but I don't know how helpful that is</p>

<a name="131835743"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131835743" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131835743">Mario Carneiro (Aug 10 2018 at 19:16)</a>:</h4>
<p>there will also be a <code>type_context</code> monad for statefully dealing with the type context. Right now it gets reinitialized a lot which makes doing custom expr traversals really expensive in lean</p>

<a name="131843910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131843910" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131843910">Patrick Massot (Aug 10 2018 at 22:08)</a>:</h4>
<blockquote>
<p>Now when I see a newbie question that I can answer I try to answer it quickly to save Mario the bother.</p>
</blockquote>
<p>I try to do the same, I think it's important. Mario, I think you should wait at least a couple of hours before answering a question almost anyone here could answer, this would be a better resource allocation policy.</p>

<a name="131844058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131844058" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131844058">Patrick Massot (Aug 10 2018 at 22:11)</a>:</h4>
<blockquote>
<p>I spent a lot of time getting some kind of overview of what exactly was already in mathlib.</p>
</blockquote>
<p>Did you write anything about this recently? I need a break from uniform spaces so yesterday I started a new doc branch in my local fork. Maybe I should push it to the community fork immediately.</p>

<a name="131844234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60mk_app%60/near/131844234" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/84025mkapp.html#131844234">Patrick Massot (Aug 10 2018 at 22:15)</a>:</h4>
<blockquote>
<p>Maybe you should ask jeremy to go open source?</p>
</blockquote>
<p>I'm not sure this is good idea. Those books, especially TPIL, have a unity of vision and style. It makes reading them feel like reading a book and not a technical reference. You can suggest improvements and additional topics, I did that and Jeremy used some. But otherwise I think we should rather write other sources of documentation.</p>


{% endraw %}
