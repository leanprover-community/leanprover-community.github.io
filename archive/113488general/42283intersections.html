---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/42283intersections.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html">intersections</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="129031496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129031496" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129031496">Patrick Massot (Jul 03 2018 at 15:56)</a>:</h4>
<p>Do we have a better way to do</p>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="err">∩</span> <span class="n">b</span> <span class="err">∩</span> <span class="o">(</span><span class="n">a</span> <span class="err">∩</span> <span class="n">c</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span> <span class="err">∩</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">c</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">ext</span> <span class="n">x</span> <span class="bp">;</span> <span class="n">split</span> <span class="bp">;</span> <span class="n">finish</span>
</pre></div>

<a name="129031518"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129031518" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129031518">Patrick Massot (Jul 03 2018 at 15:56)</a>:</h4>
<p>Of course I'm not asking for the magic sequence of rewrite, I want Lean to figure it out.</p>

<a name="129068018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129068018" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129068018">Sean Leather (Jul 04 2018 at 06:43)</a>:</h4>
<p>It would be nice if there was. I run into something similar with conjunction  (e.g. <code>a ∧ b ∧ (a ∧ c) = a ∧ b ∧ c</code>) all the time.</p>

<a name="129068883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129068883" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129068883">Simon Hudon (Jul 04 2018 at 07:00)</a>:</h4>
<p>does <code>cc</code> help?</p>

<a name="129073167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129073167" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129073167">Patrick Massot (Jul 04 2018 at 08:50)</a>:</h4>
<p>no</p>

<a name="129083986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129083986" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129083986">Patrick Massot (Jul 04 2018 at 13:05)</a>:</h4>
<p>A related question is: can anyone bring <a href="https://leanprover.github.io/programming_in_lean/#09_Writing_Automation.html" target="_blank" title="https://leanprover.github.io/programming_in_lean/#09_Writing_Automation.html">https://leanprover.github.io/programming_in_lean/#09_Writing_Automation.html</a> up to date with current Lean?</p>

<a name="129086682"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129086682" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129086682">Reid Barton (Jul 04 2018 at 14:01)</a>:</h4>
<p><span class="user-mention" data-user-id="110045">@Sean Leather</span> for <code>a ∧ b ∧ (a ∧ c) ↔ a ∧ b ∧ c</code>, <code>tauto</code> works.</p>

<a name="129086756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129086756" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129086756">Sean Leather (Jul 04 2018 at 14:03)</a>:</h4>
<p>Yeah, that may be true for that example. But I've run into others where <code>tauto</code> didn't work.</p>

<a name="129086829"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129086829" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129086829">Reid Barton (Jul 04 2018 at 14:04)</a>:</h4>
<p>Yes, <code>tauto</code> is good at failing frustratingly close to the goal</p>

<a name="129086836"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129086836" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129086836">Sean Leather (Jul 04 2018 at 14:04)</a>:</h4>
<p><code>true</code><span class="emoji emoji-2757" title="exclamation">:exclamation:</span></p>

<a name="129090032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129090032" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129090032">Simon Hudon (Jul 04 2018 at 15:04)</a>:</h4>
<blockquote>
<p>Yes, <code>tauto</code> is good at failing frustratingly close to the goal</p>
</blockquote>
<p>Excellent, that's what I wrote it for</p>

<a name="129090080"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129090080" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129090080">Simon Hudon (Jul 04 2018 at 15:05)</a>:</h4>
<p>But seriously, any examples of what it can't handle?</p>

<a name="129090724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129090724" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129090724">Reid Barton (Jul 04 2018 at 15:17)</a>:</h4>
<p>as alluded to above, <code>example (p : Prop) : p ∧ true ↔ p := by tauto</code></p>

<a name="129090747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129090747" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129090747">Reid Barton (Jul 04 2018 at 15:17)</a>:</h4>
<p>Somewhat less trivially, I often find it gets stuck needing to prove <code>a = b</code> when <code>b = a</code> is available as a hypothesis</p>

<a name="129090994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129090994" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129090994">Simon Hudon (Jul 04 2018 at 15:23)</a>:</h4>
<p>The latter should be getting better. <span class="user-mention" data-user-id="110087">@Scott Morrison</span> recently submitted a patch to consider the symmetry of relations in <code>solve_by_elim</code> which <code>tauto</code> uses.</p>

<a name="129091055"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129091055" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129091055">Simon Hudon (Jul 04 2018 at 15:24)</a>:</h4>
<p>As for the first, <code>true</code> is probably the culprit. That's an easy fix, I can submit a PR right away</p>

<a name="129091070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129091070" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129091070">Simon Hudon (Jul 04 2018 at 15:25)</a>:</h4>
<p>While I'm at it, I'll also take care of <code>false</code> in the assumptions.</p>

<a name="129091736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129091736" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129091736">Simon Hudon (Jul 04 2018 at 15:39)</a>:</h4>
<p>Done: <a href="https://github.com/leanprover/mathlib/pull/175" target="_blank" title="https://github.com/leanprover/mathlib/pull/175">https://github.com/leanprover/mathlib/pull/175</a></p>

<a name="129091823"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129091823" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129091823">Patrick Massot (Jul 04 2018 at 15:41)</a>:</h4>
<p>Simon, what is the relation between this <code>tauto</code> and <a href="https://leanprover.github.io/programming_in_lean/#09_Writing_Automation.html" target="_blank" title="https://leanprover.github.io/programming_in_lean/#09_Writing_Automation.html">https://leanprover.github.io/programming_in_lean/#09_Writing_Automation.html</a> Would you be able to update the later?</p>

<a name="129092168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129092168" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129092168">Simon Hudon (Jul 04 2018 at 15:49)</a>:</h4>
<p>I haven't looked closely but that should be doable.</p>

<a name="129092252"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129092252" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129092252">Simon Hudon (Jul 04 2018 at 15:50)</a>:</h4>
<p>I'll take a look</p>

<a name="129092447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129092447" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129092447">Simon Hudon (Jul 04 2018 at 15:54)</a>:</h4>
<p>By the way, don't despair, I haven't forgotten your request for tutorials</p>

<a name="129092479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129092479" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129092479">Simon Hudon (Jul 04 2018 at 15:55)</a>:</h4>
<p>I'm preparing a talk about Lean tactics that I'll give at the DeepSpec summer school. That should be the seed for a useful tutorial</p>

<a name="129092537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129092537" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129092537">Patrick Massot (Jul 04 2018 at 15:56)</a>:</h4>
<p>Nice!</p>

<a name="129092543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129092543" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129092543">Simon Hudon (Jul 04 2018 at 15:56)</a>:</h4>
<p>I think I'll present the <code>transportable</code> problem that <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> brought in a few months ago</p>

<a name="129093692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129093692" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129093692">Kevin Buzzard (Jul 04 2018 at 16:22)</a>:</h4>
<p>+1 from me -- as I've probably said 100 times, this is something which mathematicians do subconsciously.</p>

<a name="129094956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129094956" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129094956">Johan Commelin (Jul 04 2018 at 16:54)</a>:</h4>
<p>(And that is <em>subconsciously</em>, with big fat capital letters <span class="emoji emoji-1f609" title="wink">:wink:</span>)</p>

<a name="129120435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129120435" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129120435">Sean Leather (Jul 05 2018 at 06:09)</a>:</h4>
<p>Reid:</p>
<blockquote>
<p>Somewhat less trivially, I often find it gets stuck needing to prove <code>a = b</code> when <code>b = a</code> is available as a hypothesis</p>
</blockquote>
<p>Same here! That's the main reason I gave up on using <code>tauto</code>.</p>
<p>Simon:</p>
<blockquote>
<p>The latter should be getting better. Scott Morrison recently submitted a patch to consider the symmetry of relations in <code>solve_by_elim</code> which <code>tauto</code> uses.</p>
</blockquote>
<p>Cool. I'll have to try it out again.</p>

<a name="129121112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129121112" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129121112">Simon Hudon (Jul 05 2018 at 06:30)</a>:</h4>
<p>Also, Mario merged my PR today. The one thing <code>tauto</code> doesn't do well still is proving disjunction. I didn't want to do back tracking out of fear that it would get slow but maybe I should do it anyway</p>

<a name="129145707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129145707" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129145707">Patrick Massot (Jul 05 2018 at 15:37)</a>:</h4>
<p>Here is what I can currently do on this topic:</p>
<div class="codehilite"><pre><span></span><span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">a</span> <span class="err">∩</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">c</span> <span class="err">∩</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">a</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">simp_inter</span>


<span class="kn">example</span> <span class="o">:</span> <span class="n">a</span> <span class="err">∩</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="err">∩</span> <span class="n">b</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">simp_inter</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">a</span> <span class="err">∩</span> <span class="n">b</span> <span class="err">∩</span> <span class="o">(</span><span class="n">a</span> <span class="err">∩</span> <span class="n">c</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span> <span class="err">∩</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">c</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">simp_inter</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">a</span> <span class="err">∩</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">b</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">simp_inter</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">a</span> <span class="err">∩</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">a</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">simp_inter</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">h&#39;</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">h&#39;&#39;</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">a</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">simp_inter</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">a</span> <span class="bp">→</span>  <span class="n">x</span> <span class="err">∈</span> <span class="n">b</span> <span class="bp">→</span>  <span class="n">x</span> <span class="err">∈</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">a</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">simp_inter</span>
</pre></div>

<a name="129145771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129145771" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129145771">Patrick Massot (Jul 05 2018 at 15:38)</a>:</h4>
<p>This is based on the <code>destruct_conjunctions</code> tactic from PIL and then poor's man tactic writing</p>

<a name="129145780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129145780" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129145780">Patrick Massot (Jul 05 2018 at 15:38)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">open</span> <span class="n">tactic</span> <span class="n">monad</span> <span class="n">expr</span>
<span class="c">/-</span><span class="cm">- Recursively destructs all hypotheses that are conjunctions. From programming in Lean. -/</span>
<span class="n">meta</span> <span class="n">def</span> <span class="n">destruct_conjunctions</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="n">repeat</span> <span class="o">(</span><span class="n">do</span>
  <span class="n">l</span> <span class="err">←</span> <span class="n">local_context</span><span class="o">,</span>
  <span class="n">first</span> <span class="err">$</span> <span class="n">l</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">do</span>
    <span class="n">ht</span> <span class="err">←</span> <span class="n">infer_type</span> <span class="n">h</span> <span class="bp">&gt;&gt;=</span> <span class="n">whnf</span><span class="o">,</span>
    <span class="k">match</span> <span class="n">ht</span> <span class="k">with</span>
    <span class="bp">|</span> <span class="bp">`</span><span class="o">(</span><span class="n">and</span> <span class="err">%%</span><span class="n">a</span> <span class="err">%%</span><span class="n">b</span><span class="o">)</span> <span class="o">:=</span> <span class="n">do</span>
      <span class="n">n</span> <span class="err">←</span> <span class="n">get_unused_name</span> <span class="bp">`</span><span class="n">h</span> <span class="n">none</span><span class="o">,</span>
      <span class="n">mk_mapp</span> <span class="bp">``</span><span class="n">and</span><span class="bp">.</span><span class="n">left</span> <span class="o">[</span><span class="n">none</span><span class="o">,</span> <span class="n">none</span><span class="o">,</span> <span class="n">some</span> <span class="n">h</span><span class="o">]</span> <span class="bp">&gt;&gt;=</span> <span class="n">assertv</span> <span class="n">n</span> <span class="n">a</span><span class="o">,</span>
      <span class="n">n</span> <span class="err">←</span> <span class="n">get_unused_name</span> <span class="bp">`</span><span class="n">h</span> <span class="n">none</span><span class="o">,</span>
      <span class="n">mk_mapp</span> <span class="bp">``</span><span class="n">and</span><span class="bp">.</span><span class="n">right</span> <span class="o">[</span><span class="n">none</span><span class="o">,</span> <span class="n">none</span><span class="o">,</span> <span class="n">some</span> <span class="n">h</span><span class="o">]</span> <span class="bp">&gt;&gt;=</span> <span class="n">assertv</span> <span class="n">n</span> <span class="n">b</span><span class="o">,</span>
      <span class="n">clear</span> <span class="n">h</span>
    <span class="bp">|</span> <span class="bp">_</span> <span class="o">:=</span> <span class="n">failed</span>
    <span class="kn">end</span><span class="o">))</span>

<span class="c">/-</span><span class="cm">- Simplify proving intersection and conjunctions goals -/</span>
<span class="n">meta</span> <span class="n">def</span> <span class="n">simp_inter</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="bp">`</span><span class="o">[</span>  <span class="n">destruct_conjunctions</span><span class="o">,</span>
    <span class="n">try</span> <span class="o">{</span> <span class="n">ext</span> <span class="o">}</span> <span class="bp">;</span> <span class="n">try</span> <span class="o">{</span> <span class="n">split</span> <span class="o">}</span> <span class="bp">;</span> <span class="n">try</span> <span class="o">{</span> <span class="n">intros</span> <span class="o">}</span><span class="bp">;</span> <span class="n">destruct_conjunctions</span><span class="o">,</span>
    <span class="n">all_goals</span> <span class="o">{</span> <span class="n">repeat</span> <span class="o">{</span> <span class="n">split</span> <span class="o">}</span> <span class="bp">;</span> <span class="n">assumption</span> <span class="o">}]</span>
</pre></div>

<a name="129145791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129145791" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129145791">Patrick Massot (Jul 05 2018 at 15:38)</a>:</h4>
<p>Any cleaner and more general way to do this is welcome <span class="emoji emoji-1f609" title="wink">:wink:</span></p>

<a name="129145823"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129145823" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129145823">Patrick Massot (Jul 05 2018 at 15:39)</a>:</h4>
<p>Note that all examples below should really be solved by the general purpose <code>come_on</code> tactic.</p>

<a name="129145893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129145893" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129145893">Simon Hudon (Jul 05 2018 at 15:40)</a>:</h4>
<p>Haha! Have you tried <code>tauto</code> since Mario merged my PR yesterday?</p>

<a name="129146378"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129146378" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129146378">Patrick Massot (Jul 05 2018 at 15:49)</a>:</h4>
<p>No. I thought you only changed stuff is <code>true</code> or <code>false</code> appears explicitly.</p>

<a name="129146385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129146385" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129146385">Patrick Massot (Jul 05 2018 at 15:49)</a>:</h4>
<p>I'm upgrading</p>

<a name="129146505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129146505" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129146505">Simon Hudon (Jul 05 2018 at 15:51)</a>:</h4>
<p>In your case, it should already work, you're right</p>

<a name="129146519"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129146519" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129146519">Simon Hudon (Jul 05 2018 at 15:51)</a>:</h4>
<p>but recently, there's been added support for symmetric relations and <code>true</code> and <code>false</code> appearing in formulas</p>

<a name="129146827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129146827" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129146827">Patrick Massot (Jul 05 2018 at 15:57)</a>:</h4>
<p><code>tauto</code> solves none of my examples</p>

<a name="129146833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129146833" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129146833">Patrick Massot (Jul 05 2018 at 15:57)</a>:</h4>
<p>even with updated mathlib</p>

<a name="129146933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129146933" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129146933">Simon Hudon (Jul 05 2018 at 15:59)</a>:</h4>
<p>and with <code>ext; tauto</code>?</p>

<a name="129147034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129147034" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129147034">Patrick Massot (Jul 05 2018 at 16:01)</a>:</h4>
<p>no luck</p>

<a name="129147044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129147044" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129147044">Patrick Massot (Jul 05 2018 at 16:01)</a>:</h4>
<p>you can try my examples, they depend on nothing else but mathlib</p>

<a name="129147374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129147374" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129147374">Simon Hudon (Jul 05 2018 at 16:06)</a>:</h4>
<p>Ok got it</p>

<a name="129147387"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129147387" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129147387">Simon Hudon (Jul 05 2018 at 16:06)</a>:</h4>
<p>first <code>import data.set.basic</code>. That's where set extensionality is declared</p>

<a name="129147402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129147402" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129147402">Simon Hudon (Jul 05 2018 at 16:07)</a>:</h4>
<p>Next:</p>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">:</span> <span class="n">a</span> <span class="err">∩</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">c</span> <span class="err">∩</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">a</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">ext</span><span class="bp">;</span> <span class="n">dsimp</span><span class="bp">;</span> <span class="n">tauto</span>


<span class="kn">example</span> <span class="o">:</span> <span class="n">a</span> <span class="err">∩</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="err">∩</span> <span class="n">b</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">ext</span><span class="bp">;</span> <span class="n">dsimp</span><span class="bp">;</span> <span class="n">tauto</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">a</span> <span class="err">∩</span> <span class="n">b</span> <span class="err">∩</span> <span class="o">(</span><span class="n">a</span> <span class="err">∩</span> <span class="n">c</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span> <span class="err">∩</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">c</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">ext</span><span class="bp">;</span> <span class="n">dsimp</span><span class="bp">;</span> <span class="n">tauto</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">a</span> <span class="err">∩</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">b</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">dsimp</span> <span class="n">at</span> <span class="bp">*;</span> <span class="n">tauto</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">a</span> <span class="err">∩</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">a</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">dsimp</span> <span class="n">at</span> <span class="bp">*;</span> <span class="n">tauto</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">h&#39;</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">h&#39;&#39;</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">a</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">dsimp</span> <span class="n">at</span> <span class="bp">*;</span> <span class="n">tauto</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">a</span> <span class="bp">→</span>  <span class="n">x</span> <span class="err">∈</span> <span class="n">b</span> <span class="bp">→</span>  <span class="n">x</span> <span class="err">∈</span> <span class="n">c</span> <span class="bp">→</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">b</span> <span class="err">∩</span> <span class="n">a</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">dsimp</span> <span class="n">at</span> <span class="bp">*;</span> <span class="n">tauto</span>
</pre></div>

<a name="129147417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129147417" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129147417">Simon Hudon (Jul 05 2018 at 16:07)</a>:</h4>
<p>Unfortunately, you need to unfold set notation for <code>tauto</code> to work</p>

<a name="129147498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129147498" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129147498">Simon Hudon (Jul 05 2018 at 16:09)</a>:</h4>
<p>And I'm not sure that adding <code>dsimp</code> to <code>tauto</code> would be a good idea.</p>

<a name="129147588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129147588" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129147588">Simon Hudon (Jul 05 2018 at 16:11)</a>:</h4>
<p>What I could do is match on hypotheses and goal using definitional equality instead of pattern matching</p>

<a name="129147667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129147667" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129147667">Simon Hudon (Jul 05 2018 at 16:12)</a>:</h4>
<p>Then the first proof would become:</p>
<div class="codehilite"><pre><span></span><span class="k">by</span> <span class="n">ext</span><span class="bp">;</span> <span class="n">tauto</span>
</pre></div>


<p>I'm wondering if that would make <code>auto</code> slower. Maybe we could enable this feature with <code>tauto!</code></p>

<a name="129147699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129147699" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129147699">Simon Hudon (Jul 05 2018 at 16:13)</a>:</h4>
<p>(In French, that would sound like you're insulting someone, with the exclamation mark)</p>

<a name="129148500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129148500" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129148500">Simon Hudon (Jul 05 2018 at 16:27)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> I managed to add support for disjunction but it requires <code>tactic.interactive</code> to import <code>logic.basic</code>. I think the creation of <code>tactic.cache</code> would fix that situation. Should I submit that change in a separate PR? (separate from the traversable PR) If you need more time to review the traversable PR, I think that would be a good way to move forward</p>

<a name="129150374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129150374" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129150374">Patrick Massot (Jul 05 2018 at 17:04)</a>:</h4>
<p>It does look like one could define </p>
<div class="codehilite"><pre><span></span><span class="n">meta</span> <span class="n">def</span> <span class="n">come_one</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span> <span class="bp">`</span><span class="o">[</span><span class="n">try</span> <span class="o">{</span> <span class="n">ext</span> <span class="bp">;</span> <span class="n">dsimp</span> <span class="n">at</span> <span class="bp">*;</span> <span class="n">tauto</span><span class="o">},</span> <span class="n">try</span> <span class="o">{</span> <span class="n">dsimp</span> <span class="n">at</span> <span class="bp">*;</span> <span class="n">tauto</span><span class="o">}]</span>
</pre></div>


<p>or something like this. It looks much better, thanks!</p>

<a name="129150498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129150498" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129150498">Simon Hudon (Jul 05 2018 at 17:07)</a>:</h4>
<p>:) At your service</p>

<a name="129150550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129150550" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129150550">Simon Hudon (Jul 05 2018 at 17:08)</a>:</h4>
<p>I would advise you to call it <code>COME_ON</code>. And you may want to add three exclamation marks, to communicate impatience ;-)</p>

<a name="129150584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129150584" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129150584">Simon Hudon (Jul 05 2018 at 17:09)</a>:</h4>
<p>Consider:</p>
<div class="codehilite"><pre><span></span><span class="n">meta</span> <span class="n">def</span> <span class="n">COME_ON</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">parse</span> <span class="o">(</span><span class="n">tk</span> <span class="s2">&quot;!&quot;</span><span class="o">))</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span> <span class="bp">...</span>
</pre></div>

<a name="129161526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129161526" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129161526">Patrick Massot (Jul 05 2018 at 20:13)</a>:</h4>
<p>The version is used currently is at <a href="https://github.com/PatrickMassot/lean-differential-topology/blob/master/src/tactic/easy.lean" target="_blank" title="https://github.com/PatrickMassot/lean-differential-topology/blob/master/src/tactic/easy.lean">https://github.com/PatrickMassot/lean-differential-topology/blob/master/src/tactic/easy.lean</a> It passes both the tests I had for <code>simp_inter</code> and the <code>tauto</code> tests from mathlib.</p>

<a name="129161810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129161810" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129161810">Patrick Massot (Jul 05 2018 at 20:18)</a>:</h4>
<p>Oh, it doesn't work in my real use case :(</p>

<a name="129161817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129161817" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129161817">Patrick Massot (Jul 05 2018 at 20:18)</a>:</h4>
<p><code>failed to prove recursive application is decreasing, well founded relation</code></p>

<a name="129162109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129162109" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129162109">Reid Barton (Jul 05 2018 at 20:23)</a>:</h4>
<p>Do you have a <code>_let_match</code> or similar in the tactic state?</p>

<a name="129162191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129162191" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129162191">Patrick Massot (Jul 05 2018 at 20:24)</a>:</h4>
<p>I don't know what is similar to <code>_let_match</code> since I have no idea what it means</p>

<a name="129162291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129162291" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129162291">Patrick Massot (Jul 05 2018 at 20:26)</a>:</h4>
<p>The full error is:</p>
<div class="codehilite"><pre><span></span><span class="n">failed</span> <span class="n">to</span> <span class="n">prove</span> <span class="n">recursive</span> <span class="n">application</span> <span class="n">is</span> <span class="n">decreasing</span><span class="o">,</span> <span class="n">well</span> <span class="n">founded</span> <span class="n">relation</span>
  <span class="bp">@</span><span class="n">has_well_founded</span><span class="bp">.</span><span class="n">r</span>
    <span class="o">(</span><span class="err">Σ&#39;</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">@</span><span class="n">smooth_compatible</span> <span class="n">X</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="n">φ</span> <span class="n">ψ</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">@</span><span class="n">smooth_compatible</span> <span class="n">X</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="n">ψ</span> <span class="n">φ</span><span class="o">),</span>
       <span class="bp">@</span><span class="n">smooth_compatible</span> <span class="n">X</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="n">ψ</span> <span class="n">χ</span><span class="o">)</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">has_well_founded_of_has_sizeof</span>
       <span class="o">(</span><span class="err">Σ&#39;</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">@</span><span class="n">smooth_compatible</span> <span class="n">X</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="n">φ</span> <span class="n">ψ</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">@</span><span class="n">smooth_compatible</span> <span class="n">X</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="n">ψ</span> <span class="n">φ</span><span class="o">),</span>
          <span class="bp">@</span><span class="n">smooth_compatible</span> <span class="n">X</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="n">ψ</span> <span class="n">χ</span><span class="o">)</span>
       <span class="o">(</span><span class="n">default_has_sizeof</span>
          <span class="o">(</span><span class="err">Σ&#39;</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">@</span><span class="n">smooth_compatible</span> <span class="n">X</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="n">φ</span> <span class="n">ψ</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">@</span><span class="n">smooth_compatible</span> <span class="n">X</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="n">ψ</span> <span class="n">φ</span><span class="o">),</span>
             <span class="bp">@</span><span class="n">smooth_compatible</span> <span class="n">X</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="n">ψ</span> <span class="n">χ</span><span class="o">)))</span>
<span class="n">Possible</span> <span class="n">solutions</span><span class="o">:</span>
  <span class="bp">-</span> <span class="n">Use</span> <span class="err">&#39;</span><span class="n">using_well_founded&#39;</span> <span class="n">keyword</span> <span class="k">in</span> <span class="n">the</span> <span class="kn">end</span> <span class="n">of</span> <span class="n">your</span> <span class="kn">definition</span> <span class="n">to</span> <span class="n">specify</span> <span class="n">tactics</span> <span class="n">for</span> <span class="n">synthesizing</span> <span class="n">well</span> <span class="n">founded</span> <span class="n">relations</span> <span class="n">and</span> <span class="n">decreasing</span> <span class="n">proofs</span><span class="bp">.</span>
  <span class="bp">-</span> <span class="n">The</span> <span class="n">default</span> <span class="n">decreasing</span> <span class="n">tactic</span> <span class="n">uses</span> <span class="n">the</span> <span class="err">&#39;</span><span class="n">assumption&#39;</span> <span class="n">tactic</span><span class="o">,</span> <span class="n">thus</span> <span class="n">hints</span> <span class="o">(</span><span class="n">aka</span> <span class="n">local</span> <span class="n">proofs</span><span class="o">)</span> <span class="n">can</span> <span class="n">be</span> <span class="n">provided</span> <span class="kn">using</span> <span class="err">&#39;</span><span class="k">have</span><span class="err">&#39;</span><span class="bp">-</span><span class="n">expressions</span><span class="bp">.</span>
<span class="n">The</span> <span class="n">nested</span> <span class="n">exception</span> <span class="n">contains</span> <span class="n">the</span> <span class="n">failure</span> <span class="n">state</span> <span class="n">for</span> <span class="n">the</span> <span class="n">decreasing</span> <span class="n">tactic</span><span class="bp">.</span>
<span class="n">nested</span> <span class="n">exception</span> <span class="n">message</span><span class="o">:</span>
<span class="n">invalid</span> <span class="n">apply</span> <span class="n">tactic</span><span class="o">,</span> <span class="n">failed</span> <span class="n">to</span> <span class="n">unify</span>
  <span class="mi">0</span> <span class="bp">&lt;</span> <span class="mi">0</span>
<span class="k">with</span>
  <span class="err">?</span><span class="n">m_1</span> <span class="bp">&lt;</span> <span class="err">?</span><span class="n">m_1</span> <span class="bp">+</span> <span class="err">?</span><span class="n">m_2</span>
<span class="n">state</span><span class="o">:</span>
<span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">,</span>
<span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">inhabited</span> <span class="n">X</span><span class="o">,</span>
<span class="n">φ</span> <span class="n">ψ</span> <span class="n">χ</span> <span class="o">:</span> <span class="n">chart</span> <span class="n">X</span><span class="o">,</span>
<span class="n">open_triple_intersection</span> <span class="o">:</span>
  <span class="o">(</span><span class="err">Σ&#39;</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">smooth_compatible</span> <span class="n">φ</span> <span class="n">ψ</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">smooth_compatible</span> <span class="n">ψ</span> <span class="n">φ</span><span class="o">),</span> <span class="n">smooth_compatible</span> <span class="n">ψ</span> <span class="n">χ</span><span class="o">)</span> <span class="bp">→</span>
  <span class="n">is_open</span> <span class="o">(</span><span class="err">⇑</span><span class="n">φ</span> <span class="err">&#39;&#39;</span> <span class="o">(</span><span class="n">φ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">ψ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">χ</span><span class="bp">.</span><span class="n">domain</span><span class="o">)),</span>
<span class="n">op_φ_ψ</span> <span class="o">:</span> <span class="n">is_open_intersection</span> <span class="n">φ</span> <span class="n">ψ</span><span class="o">,</span>
<span class="n">smooth_φ_ψ</span> <span class="o">:</span> <span class="n">is_smooth_transition</span> <span class="n">φ</span> <span class="n">ψ</span><span class="o">,</span>
<span class="n">op_ψ_φ</span> <span class="o">:</span> <span class="n">is_open_intersection</span> <span class="n">ψ</span> <span class="n">φ</span><span class="o">,</span>
<span class="n">smooth_ψ_φ</span> <span class="o">:</span> <span class="n">is_smooth_transition</span> <span class="n">ψ</span> <span class="n">φ</span><span class="o">,</span>
<span class="n">op_ψ_χ</span> <span class="o">:</span> <span class="n">is_open_intersection</span> <span class="n">ψ</span> <span class="n">χ</span><span class="o">,</span>
<span class="n">smooth_ψ_χ</span> <span class="o">:</span> <span class="n">is_smooth_transition</span> <span class="n">ψ</span> <span class="n">χ</span><span class="o">,</span>
<span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">,</span>
<span class="n">a</span> <span class="o">:</span> <span class="n">smooth_compatible</span> <span class="n">φ</span> <span class="n">ψ</span><span class="o">,</span>
<span class="n">a</span> <span class="o">:</span> <span class="n">smooth_compatible</span> <span class="n">ψ</span> <span class="n">φ</span><span class="o">,</span>
<span class="n">a</span> <span class="o">:</span> <span class="n">smooth_compatible</span> <span class="n">ψ</span> <span class="n">χ</span>
<span class="err">⊢</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="mi">0</span>
</pre></div>

<a name="129162377"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129162377" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129162377">Patrick Massot (Jul 05 2018 at 20:28)</a>:</h4>
<p>Replacing <code>meta def easy : tactic unit := `[try { ext } , try { dsimp at * }, all_goals { tauto }]</code> by <code>meta def easy : tactic unit := `[try { ext } , try { dsimp }, all_goals { tauto }]</code> make it work in this case but fail in others. Somehow the <code>try</code> is not enough to prevent the error.</p>

<a name="129162807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129162807" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129162807">Simon Hudon (Jul 05 2018 at 20:36)</a>:</h4>
<p>Well-foundedness is only checked at the end of the proof I believe which means that it won't make individual tactics fail.</p>

<a name="129162845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129162845" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129162845">Simon Hudon (Jul 05 2018 at 20:37)</a>:</h4>
<p>You may just need to add a <code>have : _ &lt; _, from _</code> expression to state and prove that some quantity decreases in your recursive function</p>

<a name="129162858"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129162858" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129162858">Patrick Massot (Jul 05 2018 at 20:37)</a>:</h4>
<p>I don't have any recursive function</p>

<a name="129162902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129162902" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129162902">Patrick Massot (Jul 05 2018 at 20:38)</a>:</h4>
<p>I have no idea what Lean is talking about</p>

<a name="129162947"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129162947" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129162947">Simon Hudon (Jul 05 2018 at 20:38)</a>:</h4>
<p>Can you show the goal prior to calling the tactic? There might be a way of saying "I'm not trying to bring in the curse of recursion"</p>

<a name="129162972"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129162972" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129162972">Patrick Massot (Jul 05 2018 at 20:39)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">,</span>
<span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">inhabited</span> <span class="n">X</span><span class="o">,</span>
<span class="n">φ</span> <span class="n">ψ</span> <span class="n">χ</span> <span class="o">:</span> <span class="n">chart</span> <span class="n">X</span><span class="o">,</span>
<span class="n">open_triple_intersection</span> <span class="o">:</span>
  <span class="n">smooth_compatible</span> <span class="n">φ</span> <span class="n">ψ</span> <span class="bp">→</span>
  <span class="n">smooth_compatible</span> <span class="n">ψ</span> <span class="n">φ</span> <span class="bp">→</span> <span class="n">smooth_compatible</span> <span class="n">ψ</span> <span class="n">χ</span> <span class="bp">→</span> <span class="n">is_open</span> <span class="o">(</span><span class="err">⇑</span><span class="n">φ</span> <span class="err">&#39;&#39;</span> <span class="o">(</span><span class="n">φ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">ψ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">χ</span><span class="bp">.</span><span class="n">domain</span><span class="o">)),</span>
<span class="n">op_φ_ψ</span> <span class="o">:</span> <span class="n">is_open_intersection</span> <span class="n">φ</span> <span class="n">ψ</span><span class="o">,</span>
<span class="n">smooth_φ_ψ</span> <span class="o">:</span> <span class="n">is_smooth_transition</span> <span class="n">φ</span> <span class="n">ψ</span><span class="o">,</span>
<span class="n">op_ψ_φ</span> <span class="o">:</span> <span class="n">is_open_intersection</span> <span class="n">ψ</span> <span class="n">φ</span><span class="o">,</span>
<span class="n">smooth_ψ_φ</span> <span class="o">:</span> <span class="n">is_smooth_transition</span> <span class="n">ψ</span> <span class="n">φ</span><span class="o">,</span>
<span class="n">op_ψ_χ</span> <span class="o">:</span> <span class="n">is_open_intersection</span> <span class="n">ψ</span> <span class="n">χ</span><span class="o">,</span>
<span class="n">smooth_ψ_χ</span> <span class="o">:</span> <span class="n">is_smooth_transition</span> <span class="n">ψ</span> <span class="n">χ</span><span class="o">,</span>
<span class="n">op</span> <span class="o">:</span> <span class="n">is_open</span> <span class="o">(</span><span class="err">⇑</span><span class="n">ψ</span> <span class="err">&#39;&#39;</span> <span class="o">(</span><span class="n">ψ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">φ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">χ</span><span class="bp">.</span><span class="n">domain</span><span class="o">)),</span>
<span class="n">this</span> <span class="o">:</span> <span class="err">⇑</span><span class="n">ψ</span> <span class="err">&#39;&#39;</span> <span class="o">(</span><span class="n">ψ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">φ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">χ</span><span class="bp">.</span><span class="n">domain</span><span class="o">)</span> <span class="err">⊆</span> <span class="err">⇑</span><span class="n">ψ</span> <span class="err">&#39;&#39;</span> <span class="o">(</span><span class="n">ψ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">φ</span><span class="bp">.</span><span class="n">domain</span><span class="o">),</span>
<span class="n">op</span> <span class="o">:</span> <span class="n">is_open</span> <span class="o">(</span><span class="n">transition</span> <span class="n">ψ</span> <span class="n">φ</span> <span class="err">&#39;&#39;</span> <span class="o">(</span><span class="err">⇑</span><span class="n">ψ</span> <span class="err">&#39;&#39;</span> <span class="o">(</span><span class="n">ψ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">φ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">χ</span><span class="bp">.</span><span class="n">domain</span><span class="o">))),</span>
<span class="n">h</span> <span class="o">:</span>
  <span class="n">transition</span> <span class="n">ψ</span> <span class="n">φ</span> <span class="err">&#39;&#39;</span> <span class="o">(</span><span class="err">⇑</span><span class="n">ψ</span> <span class="err">&#39;&#39;</span> <span class="o">(</span><span class="n">ψ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">φ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">χ</span><span class="bp">.</span><span class="n">domain</span><span class="o">))</span> <span class="bp">=</span>
    <span class="err">⇑</span><span class="n">φ</span> <span class="err">&#39;&#39;</span> <span class="o">(</span><span class="n">ψ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">φ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">χ</span><span class="bp">.</span><span class="n">domain</span><span class="o">)</span>
<span class="err">⊢</span> <span class="n">ψ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">φ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">χ</span><span class="bp">.</span><span class="n">domain</span> <span class="bp">=</span> <span class="n">φ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">ψ</span><span class="bp">.</span><span class="n">domain</span> <span class="err">∩</span> <span class="n">χ</span><span class="bp">.</span><span class="n">domain</span>
</pre></div>

<a name="129163052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129163052" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129163052">Simon Hudon (Jul 05 2018 at 20:40)</a>:</h4>
<p>Is the lemma that you're trying to prove  <code>open_triple_intersection</code>? If so, try <code>clear open_triple_intersection</code> before calling the tactic.</p>

<a name="129163058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129163058" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129163058">Patrick Massot (Jul 05 2018 at 20:40)</a>:</h4>
<p>Note that <code>ext, dsimp, tauto</code> works here, but I want a tactic which also works when you need to <code>dsimp</code> something from context</p>

<a name="129163081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129163081" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129163081">Patrick Massot (Jul 05 2018 at 20:41)</a>:</h4>
<p>Indeed, this is what I'm proving</p>

<a name="129163083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129163083" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129163083">Patrick Massot (Jul 05 2018 at 20:41)</a>:</h4>
<p>and clearing this works</p>

<a name="129163084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129163084" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129163084">Patrick Massot (Jul 05 2018 at 20:41)</a>:</h4>
<p>WTF?</p>

<a name="129163128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129163128" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129163128">Patrick Massot (Jul 05 2018 at 20:42)</a>:</h4>
<p>Is it because I have pattern matching?</p>

<a name="129163133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129163133" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129163133">Patrick Massot (Jul 05 2018 at 20:42)</a>:</h4>
<p><a href="https://github.com/PatrickMassot/lean-differential-topology/blob/master/src/manifold.lean#L185" target="_blank" title="https://github.com/PatrickMassot/lean-differential-topology/blob/master/src/manifold.lean#L185">https://github.com/PatrickMassot/lean-differential-topology/blob/master/src/manifold.lean#L185</a></p>

<a name="129163174"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129163174" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129163174">Patrick Massot (Jul 05 2018 at 20:43)</a>:</h4>
<p>Indeed</p>

<a name="129163191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129163191" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129163191">Patrick Massot (Jul 05 2018 at 20:43)</a>:</h4>
<p>If I remove the matching  and start with </p>
<div class="codehilite"><pre><span></span>  <span class="n">intros</span> <span class="n">h</span> <span class="n">h&#39;</span> <span class="n">h&#39;&#39;</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">h</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">op_φ_ψ</span><span class="o">,</span> <span class="n">smooth_φ_ψ</span><span class="bp">⟩</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">h&#39;</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">op_ψ_φ</span><span class="o">,</span> <span class="n">smooth_ψ_φ</span><span class="bp">⟩</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">h&#39;&#39;</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">op_ψ_χ</span><span class="o">,</span> <span class="n">smooth_ψ_χ</span><span class="bp">⟩</span><span class="o">,</span>
</pre></div>


<p>Then <code>easy</code> works</p>

<a name="129163245"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129163245" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129163245">Patrick Massot (Jul 05 2018 at 20:44)</a>:</h4>
<p>Do you understand what happens?</p>

<a name="129163297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129163297" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129163297">Patrick Massot (Jul 05 2018 at 20:45)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span>  We really need a hybrid of <code>intros</code> and <code>rcases</code> that would allow writing <code>intros ⟨op_φ_ψ, smooth_φ_ψ⟩ ⟨op_ψ_φ, smooth_ψ_φ⟩ ⟨op_ψ_χ, smooth_ψ_χ⟩</code></p>

<a name="129163310"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129163310" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129163310">Patrick Massot (Jul 05 2018 at 20:45)</a>:</h4>
<p>instead of the four lines of the previous code block</p>

<a name="129163364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129163364" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129163364">Simon Hudon (Jul 05 2018 at 20:46)</a>:</h4>
<p>The situation is that pattern matching and recursion are rooted in the same machinery</p>

<a name="129163423"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129163423" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129163423">Simon Hudon (Jul 05 2018 at 20:47)</a>:</h4>
<p>When you pattern match, Lean gives you the opportunity to make a recursive call. It gives you more than you need and once you're done with the proof, it checks whether you introduced recursion / induction and makes sure that it's well-founded</p>

<a name="129163442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129163442" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129163442">Simon Hudon (Jul 05 2018 at 20:47)</a>:</h4>
<p>Tactics don't see the difference between assumptions that are in fact a recursive call and the rest</p>

<a name="129163950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129163950" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129163950">Patrick Massot (Jul 05 2018 at 20:56)</a>:</h4>
<p>Thanks</p>

<a name="129163980"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129163980" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129163980">Patrick Massot (Jul 05 2018 at 20:56)</a>:</h4>
<p>I'll forget about matching and patiently wait for <code>rintros</code> to land in mathlib.</p>

<a name="129164000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129164000" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129164000">Patrick Massot (Jul 05 2018 at 20:57)</a>:</h4>
<p>And I'll go sleeping.</p>

<a name="129164449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129164449" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129164449">Simon Hudon (Jul 05 2018 at 21:06)</a>:</h4>
<p>You could do something like <code>clear_rec</code> that you call after pattern matching</p>

<a name="129183277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129183277" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129183277">Mario Carneiro (Jul 06 2018 at 05:36)</a>:</h4>
<blockquote>
<p>I managed to add support for disjunction but it requires tactic.interactive to import logic.basic. I think the creation of tactic.cache would fix that situation. Should I submit that change in a separate PR? (separate from the traversable PR) If you need more time to review the traversable PR, I think that would be a good way to move forward</p>
</blockquote>
<p><span class="user-mention" data-user-id="110026">@Simon Hudon</span> I think this is a good idea. Splitting up the different unrelated parts will make it easier to merge things</p>

<a name="129183346"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129183346" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129183346">Simon Hudon (Jul 06 2018 at 05:39)</a>:</h4>
<p>Nice, I hadn't thought of it that way but we'll kill two birds with one stone. I can pull a few more PRs from <code>traversable</code></p>

<a name="129183658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129183658" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129183658">Simon Hudon (Jul 06 2018 at 05:48)</a>:</h4>
<p>What's your opinion about using lemmas in tactics that require predicates to be decidable? Would you just let it fail if some predicate is not decidable or would you silently use <code>prop_decidable</code>?</p>

<a name="129183777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129183777" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129183777">Mario Carneiro (Jul 06 2018 at 05:52)</a>:</h4>
<p>Depends on the use case. I think <code>by_cases</code> will fail, but adding <code>prop_decidable</code> as a local instance fixes this, so this seems sufficiently flexible</p>

<a name="129183969"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129183969" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129183969">Simon Hudon (Jul 06 2018 at 05:59)</a>:</h4>
<p>That's straightforward. With <code>tauto</code>, <code>decidable</code> constraints can come from a lot of different sources and become relevant without obvious reasons</p>

<a name="129184379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129184379" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129184379">Mario Carneiro (Jul 06 2018 at 06:10)</a>:</h4>
<p>It would be nice if the tactic reports the decidability problem in the error, that way the user can decide what to do about it</p>

<a name="129184508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129184508" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129184508">Simon Hudon (Jul 06 2018 at 06:14)</a>:</h4>
<p>That's true. Unfortunately, <code>tauto</code> can keep going for a while once it has failed to find a <code>decidable</code> instance</p>

<a name="129184704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129184704" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129184704">Simon Hudon (Jul 06 2018 at 06:21)</a>:</h4>
<p>I'm thinking that <code>tauto!</code> could add <code>prop_decidable</code> as a local instance right from the start. Then when you're not sure why <code>tauto</code> failed, you can try that and move on.</p>

<a name="129187322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129187322" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129187322">Mario Carneiro (Jul 06 2018 at 07:38)</a>:</h4>
<blockquote>
<p>I'll forget about matching and patiently wait for <code>rintros</code> to land in mathlib.</p>
</blockquote>
<p>Your wish is my command...</p>

<a name="129187353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129187353" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129187353">Simon Hudon (Jul 06 2018 at 07:40)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Tag, you're it! <a href="https://github.com/leanprover/mathlib/pull/178" target="_blank" title="https://github.com/leanprover/mathlib/pull/178">https://github.com/leanprover/mathlib/pull/178</a></p>

<a name="129187470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129187470" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129187470">Patrick Massot (Jul 06 2018 at 07:42)</a>:</h4>
<p>I love that! My next wish is you answer my Wednesday email <span class="emoji emoji-1f609" title="wink">:wink:</span></p>

<a name="129187481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129187481" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129187481">Patrick Massot (Jul 06 2018 at 07:42)</a>:</h4>
<p>And I'm sure this <code>rintro</code> tactic will soon be all over the place.</p>

<a name="129187492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/intersections/near/129187492" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42283intersections.html#129187492">Simon Hudon (Jul 06 2018 at 07:43)</a>:</h4>
<p>What is this <code>rintro</code> thing?</p>


{% endraw %}

{% include archive_update.html %}