---
layout: page
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html">maximum class-instance resolution depth has been reached</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="125627176"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627176" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627176">Kevin Buzzard (Apr 24 2018 at 18:16)</a>:</h4>
<p>I was writing some random universal property code</p>

<a name="125627183"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627183" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627183">Kevin Buzzard (Apr 24 2018 at 18:16)</a>:</h4>
<p>and I got the good old "maximum class-instance resolution depth has been reached" error</p>

<a name="125627184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627184" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627184">Kevin Buzzard (Apr 24 2018 at 18:16)</a>:</h4>
<p>and we all know what that means</p>

<a name="125627185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627185" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627185">Kevin Buzzard (Apr 24 2018 at 18:16)</a>:</h4>
<p>so I restarted Lean</p>

<a name="125627186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627186" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627186">Kevin Buzzard (Apr 24 2018 at 18:16)</a>:</h4>
<p>and I got the error again.</p>

<a name="125627188"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627188" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627188">Kevin Buzzard (Apr 24 2018 at 18:16)</a>:</h4>
<p><em>sigh</em></p>

<a name="125627192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627192" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627192">Kevin Buzzard (Apr 24 2018 at 18:16)</a>:</h4>
<p>so I guess I know what that means</p>

<a name="125627194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627194" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627194">Kevin Buzzard (Apr 24 2018 at 18:17)</a>:</h4>
<p>and I decided I'd made some sort of error with my types</p>

<a name="125627201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627201" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627201">Kevin Buzzard (Apr 24 2018 at 18:17)</a>:</h4>
<p>so I carefully wrote down the types of everything in my statement</p>

<a name="125627202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627202" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627202">Kevin Buzzard (Apr 24 2018 at 18:17)</a>:</h4>
<p>and managed to make sure that everything really had the type I thought it would have</p>

<a name="125627203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627203" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627203">Kevin Buzzard (Apr 24 2018 at 18:17)</a>:</h4>
<p>and I restarted Lean</p>

<a name="125627207"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627207" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627207">Kevin Buzzard (Apr 24 2018 at 18:17)</a>:</h4>
<p>and I got the error again.</p>

<a name="125627208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627208" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627208">Kevin Buzzard (Apr 24 2018 at 18:17)</a>:</h4>
<p><em>sigh</em></p>

<a name="125627212"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627212" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627212">Kevin Buzzard (Apr 24 2018 at 18:17)</a>:</h4>
<p>The error in its Lean 3.4 form says</p>

<a name="125627217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627217" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627217">Kevin Buzzard (Apr 24 2018 at 18:17)</a>:</h4>
<div class="codehilite"><pre><span></span>maximum class-instance resolution depth has been reached (the limit can be increased by setting option &#39;class.instance_max_depth&#39;) (the class-instance resolution trace can be visualized by setting option &#39;trace.class_instances&#39;)
</pre></div>

<a name="125627263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627263" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627263">Kevin Buzzard (Apr 24 2018 at 18:18)</a>:</h4>
<p>so I figured that it was about time I read the error properly</p>

<a name="125627272"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627272" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627272">Kevin Buzzard (Apr 24 2018 at 18:18)</a>:</h4>
<p>and I realised it was hard for me to increase the max_depth</p>

<a name="125627275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627275" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627275">Kevin Buzzard (Apr 24 2018 at 18:18)</a>:</h4>
<p>because I didn't know what it currently was</p>

<a name="125627285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627285" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627285">Kevin Buzzard (Apr 24 2018 at 18:18)</a>:</h4>
<p>so I looked at the trace</p>

<a name="125627288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627288" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627288">Kevin Buzzard (Apr 24 2018 at 18:18)</a>:</h4>
<p>and it was really long</p>

<a name="125627290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627290" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627290">Kevin Buzzard (Apr 24 2018 at 18:18)</a>:</h4>
<p>and complicated</p>

<a name="125627294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627294" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627294">Kevin Buzzard (Apr 24 2018 at 18:19)</a>:</h4>
<p>and I spent some time trying to understand it</p>

<a name="125627301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627301" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627301">Kevin Buzzard (Apr 24 2018 at 18:19)</a>:</h4>
<p>and in total spent over half an hour on this issue</p>

<a name="125627302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627302" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627302">Kevin Buzzard (Apr 24 2018 at 18:19)</a>:</h4>
<p>before it occurred to me</p>

<a name="125627304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627304" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627304">Kevin Buzzard (Apr 24 2018 at 18:19)</a>:</h4>
<p>that actually</p>

<a name="125627307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627307" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627307">Kevin Buzzard (Apr 24 2018 at 18:19)</a>:</h4>
<p>maybe</p>

<a name="125627313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627313" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627313">Kevin Buzzard (Apr 24 2018 at 18:19)</a>:</h4>
<p>the maximum class-instance resolution depth <em>had</em> been reached!</p>

<a name="125627325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627325" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627325">Kevin Buzzard (Apr 24 2018 at 18:19)</a>:</h4>
<p>So I wrote <code>set_option class.instance_max_depth 100</code></p>

<a name="125627326"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627326" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627326">Kevin Buzzard (Apr 24 2018 at 18:19)</a>:</h4>
<p>and the error went away!</p>

<a name="125627387"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627387" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627387">Kenny Lau (Apr 24 2018 at 18:20)</a>:</h4>
<p>lol</p>

<a name="125627390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627390" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627390">Kevin Buzzard (Apr 24 2018 at 18:20)</a>:</h4>
<p>So I came to the conclusion</p>

<a name="125627397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627397" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627397">Kevin Buzzard (Apr 24 2018 at 18:20)</a>:</h4>
<p>that either my code is really really cool and I am using type class resolution like a pro now</p>

<a name="125627398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627398" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627398">Kevin Buzzard (Apr 24 2018 at 18:20)</a>:</h4>
<p>or</p>

<a name="125627399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627399" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627399">Kevin Buzzard (Apr 24 2018 at 18:20)</a>:</h4>
<p>maybe my code is really really bad</p>

<a name="125627428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627428" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627428">Kevin Buzzard (Apr 24 2018 at 18:21)</a>:</h4>
<p>and anyone who needs to change the default setting of the max class-instance resolution might want to take a look at what they're doing and how they're doing it.</p>

<a name="125627491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627491" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627491">Kevin Buzzard (Apr 24 2018 at 18:22)</a>:</h4>
<p>And one thing that occured to me was that I might be being sloppy with the difference between proofs and data</p>

<a name="125627503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627503" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627503">Kevin Buzzard (Apr 24 2018 at 18:23)</a>:</h4>
<p>but this might not be relevant, I'm not sure.</p>

<a name="125627506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627506" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627506">Kevin Buzzard (Apr 24 2018 at 18:23)</a>:</h4>
<p>Here's a structure:</p>

<a name="125627513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627513" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627513">Kevin Buzzard (Apr 24 2018 at 18:23)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="c1">-- Here is the way KMB wants to package all these things together.</span>
<span class="kn">structure</span> <span class="n">is_unique_R_alg_hom</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">w</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">β</span><span class="o">]</span>
<span class="o">(</span><span class="n">sα</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">sβ</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">sα</span><span class="o">]</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">sβ</span><span class="o">]</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">f</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">R_alg_hom</span> <span class="o">:</span> <span class="n">sβ</span> <span class="bp">=</span> <span class="n">f</span> <span class="err">∘</span> <span class="n">sα</span><span class="o">)</span>
<span class="o">(</span><span class="n">is_unique</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">g</span><span class="o">],</span> <span class="n">sβ</span> <span class="bp">=</span> <span class="n">g</span> <span class="err">∘</span> <span class="n">sα</span> <span class="bp">→</span> <span class="n">g</span> <span class="bp">=</span> <span class="n">f</span><span class="o">)</span>
</pre></div>

<a name="125627516"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627516" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627516">Kevin Buzzard (Apr 24 2018 at 18:23)</a>:</h4>
<p>You make an instance of that structure by giving two proofs.</p>

<a name="125627567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627567" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627567">Kevin Buzzard (Apr 24 2018 at 18:24)</a>:</h4>
<p>But the structure turns out to be a Type.</p>

<a name="125627576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627576" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627576">Kevin Buzzard (Apr 24 2018 at 18:24)</a>:</h4>
<p>I could have rewritten this as <code>is_unique_R_alg_hom blah := proof1 and proof2</code></p>

<a name="125627579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627579" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627579">Kevin Buzzard (Apr 24 2018 at 18:25)</a>:</h4>
<p>and then it would be a Prop.</p>

<a name="125627604"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627604" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627604">Kevin Buzzard (Apr 24 2018 at 18:25)</a>:</h4>
<p>Should I change this, or does it not make a difference to anything?</p>

<a name="125627619"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627619" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627619">Kevin Buzzard (Apr 24 2018 at 18:25)</a>:</h4>
<p>And is it completely unrelated to the max class-instance resolution?</p>

<a name="125627672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627672" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627672">Kevin Buzzard (Apr 24 2018 at 18:26)</a>:</h4>
<p>Oh I seem to just be able to make the structure a Prop anyway</p>

<a name="125627773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627773" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627773">Kevin Buzzard (Apr 24 2018 at 18:28)</a>:</h4>
<p>aah, and now I don't need <code>set_option class.instance_max_depth 52</code> (for 52 was the min to make it work)</p>

<a name="125627776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627776" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627776">Chris Hughes (Apr 24 2018 at 18:28)</a>:</h4>
<p>Probably best to make it a Prop, to avoid issues with not recognizing that two instances of the same thing are equal.</p>

<a name="125627779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627779" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627779">Kevin Buzzard (Apr 24 2018 at 18:28)</a>:</h4>
<p>because I seem to have forgotten things</p>

<a name="125627801"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627801" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627801">Kevin Buzzard (Apr 24 2018 at 18:29)</a>:</h4>
<p>Whyever would Lean make a structure whose constructor involved giving two proofs into a type??</p>

<a name="125627865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627865" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627865">Kevin Buzzard (Apr 24 2018 at 18:30)</a>:</h4>
<p>Probably also best to make it into a Prop, because then I don't need to change a max depth to 52</p>

<a name="125627989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627989" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627989">Kevin Buzzard (Apr 24 2018 at 18:33)</a>:</h4>
<p>no, the error is back</p>

<a name="125627992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125627992" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125627992">Kevin Buzzard (Apr 24 2018 at 18:33)</a>:</h4>
<p>I am still getting used to new lean in VS Code</p>

<a name="125628001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125628001" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125628001">Kevin Buzzard (Apr 24 2018 at 18:33)</a>:</h4>
<p>OK so my question remains</p>

<a name="125628044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125628044" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125628044">Kevin Buzzard (Apr 24 2018 at 18:34)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">set_option</span> <span class="n">class</span><span class="bp">.</span><span class="n">instance_max_depth</span> <span class="mi">52</span> <span class="c1">-- !!</span>
<span class="c">/-</span><span class="cm">- universal property of inverting one element and then another -/</span>
<span class="kn">theorem</span> <span class="n">away_away_universal_property</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span>
<span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">loc</span> <span class="n">R</span> <span class="o">(</span><span class="n">powers</span> <span class="n">f</span><span class="o">))</span> <span class="o">{</span><span class="n">γ</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">γ</span><span class="o">]</span> <span class="o">(</span><span class="n">sγ</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">γ</span><span class="o">)</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">sγ</span><span class="o">]</span> <span class="o">(</span><span class="n">Hf</span> <span class="o">:</span> <span class="n">is_unit</span> <span class="o">(</span><span class="n">sγ</span> <span class="n">f</span><span class="o">))</span>
<span class="o">(</span><span class="n">Hg</span> <span class="o">:</span> <span class="n">is_unit</span> <span class="o">(</span><span class="n">away</span><span class="bp">.</span><span class="n">extend_map_of_im_unit</span> <span class="n">sγ</span> <span class="n">Hf</span> <span class="n">g</span><span class="o">))</span> <span class="o">:</span>
<span class="n">is_unique_R_alg_hom</span>
  <span class="o">((</span><span class="n">of_comm_ring</span> <span class="o">(</span><span class="n">loc</span> <span class="n">R</span> <span class="o">(</span><span class="n">powers</span> <span class="n">f</span><span class="o">))</span> <span class="o">(</span><span class="n">powers</span> <span class="n">g</span><span class="o">))</span> <span class="err">∘</span> <span class="o">(</span><span class="n">of_comm_ring</span> <span class="n">R</span> <span class="o">(</span><span class="n">powers</span> <span class="n">f</span><span class="o">)))</span>
  <span class="n">sγ</span>
  <span class="o">(</span><span class="n">away</span><span class="bp">.</span><span class="n">extend_map_of_im_unit</span> <span class="o">(</span><span class="n">away</span><span class="bp">.</span><span class="n">extend_map_of_im_unit</span> <span class="n">sγ</span> <span class="n">Hf</span><span class="o">)</span> <span class="n">Hg</span><span class="o">)</span>
    <span class="o">:=</span> <span class="n">sorry</span>
</pre></div>

<a name="125628048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125628048" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125628048">Kevin Buzzard (Apr 24 2018 at 18:34)</a>:</h4>
<p>Is that first line evidence that I am doing something wrong?</p>

<a name="125628155"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125628155" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125628155">Kevin Buzzard (Apr 24 2018 at 18:37)</a>:</h4>
<p>If I <code>set_option trace.class_instances true</code></p>

<a name="125628159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125628159" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125628159">Kevin Buzzard (Apr 24 2018 at 18:37)</a>:</h4>
<p>then I get things like <a href="https://gist.github.com/kbuzzard/2a135ef1486fc55c3b4c70ca11cf50b4" target="_blank" title="https://gist.github.com/kbuzzard/2a135ef1486fc55c3b4c70ca11cf50b4">https://gist.github.com/kbuzzard/2a135ef1486fc55c3b4c70ca11cf50b4</a></p>

<a name="125628161"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125628161" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125628161">Chris Hughes (Apr 24 2018 at 18:37)</a>:</h4>
<p>How deep do you have to go if you try to do type class inference by hand? Maybe it's just a really hard type class inference problem, that requires that depth?</p>

<a name="125628162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125628162" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125628162">Kevin Buzzard (Apr 24 2018 at 18:37)</a>:</h4>
<p>I don't think it's hard</p>

<a name="125628205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125628205" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125628205">Kevin Buzzard (Apr 24 2018 at 18:38)</a>:</h4>
<p>I compose two ring homomorphisms</p>

<a name="125628209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125628209" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125628209">Kevin Buzzard (Apr 24 2018 at 18:38)</a>:</h4>
<p>and I want the result to be a ring homomorphism</p>

<a name="125628238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125628238" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125628238">Kevin Buzzard (Apr 24 2018 at 18:39)</a>:</h4>
<p>It's difficult to know where the exact problem is</p>

<a name="125628251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125628251" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125628251">Kevin Buzzard (Apr 24 2018 at 18:39)</a>:</h4>
<p>because when I set trace.class_instances true pretty much everything gets underlined in green</p>

<a name="125628255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125628255" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125628255">Kevin Buzzard (Apr 24 2018 at 18:39)</a>:</h4>
<p>and if I let it be 51</p>

<a name="125628305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125628305" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125628305">Kevin Buzzard (Apr 24 2018 at 18:40)</a>:</h4>
<p>then the name of the theorem gets underlined in red</p>

<a name="125628350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125628350" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125628350">Kevin Buzzard (Apr 24 2018 at 18:41)</a>:</h4>
<p>The biggest number I can find in brackets is (14)</p>

<a name="125628352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125628352" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125628352">Kevin Buzzard (Apr 24 2018 at 18:41)</a>:</h4>
<div class="codehilite"><pre><span></span>[class_instances] (14) ?x_314 : discrete_linear_ordered_field R := rat.discrete_linear_ordered_field
</pre></div>

<a name="125628356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125628356" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125628356">Kevin Buzzard (Apr 24 2018 at 18:42)</a>:</h4>
<p>the mind boggles</p>

<a name="125628401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125628401" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125628401">Kevin Buzzard (Apr 24 2018 at 18:42)</a>:</h4>
<p>why is Lean wondering if my ring is a discrete linear ordered field?</p>

<a name="125631291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125631291" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125631291">Andrew Ashworth (Apr 24 2018 at 19:45)</a>:</h4>
<p>because type class instance search is really dumb,  it's basically searching the graph of all paths that might reach your proof</p>

<a name="125631353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125631353" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125631353">Andrew Ashworth (Apr 24 2018 at 19:47)</a>:</h4>
<p>the more definitions and lemmas that you use with nested type class arguments, the bigger you'll need to set the search depth to</p>

<a name="125631548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125631548" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125631548">Kevin Buzzard (Apr 24 2018 at 19:50)</a>:</h4>
<p>So are you saying that there is a non-zero chance that I might actually have to set the search depth to 52 and this doesn't just mean that my code is crappy?</p>

<a name="125631768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125631768" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125631768">Andrew Ashworth (Apr 24 2018 at 19:54)</a>:</h4>
<p>in most cs applications the type class tree search is going to be somewhat shallow</p>

<a name="125631782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125631782" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125631782">Kevin Buzzard (Apr 24 2018 at 19:55)</a>:</h4>
<p>I am pushing it</p>

<a name="125631784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125631784" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125631784">Kevin Buzzard (Apr 24 2018 at 19:55)</a>:</h4>
<p>but I didn't realise I was pushing that hard</p>

<a name="125631789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125631789" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125631789">Andrew Ashworth (Apr 24 2018 at 19:55)</a>:</h4>
<p>if you think it's going to be super deep, i wouldn't use type class search</p>

<a name="125631794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125631794" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125631794">Kevin Buzzard (Apr 24 2018 at 19:55)</a>:</h4>
<p>I didn't think it was going to be super deep</p>

<a name="125631798"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125631798" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125631798">Kevin Buzzard (Apr 24 2018 at 19:55)</a>:</h4>
<p>I am surprised that I need 52</p>

<a name="125631847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125631847" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125631847">Kevin Buzzard (Apr 24 2018 at 19:56)</a>:</h4>
<p>in the sense that I thought that all I was doing was trying to get Lean to spot that (a) the output of some function is a ring homomorphism and (b) the composite of two ring homomorphisms is a ring homomorphism</p>

<a name="125631852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125631852" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125631852">Kevin Buzzard (Apr 24 2018 at 19:56)</a>:</h4>
<p>I don't understand how to find out where the pushing is occurring</p>

<a name="125631853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125631853" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125631853">Reid Barton (Apr 24 2018 at 19:56)</a>:</h4>
<p>I wonder whether you actually need 52, or it's going off in some other unsuccessful part of the search that needs depth 52</p>

<a name="125631856"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125631856" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125631856">Kevin Buzzard (Apr 24 2018 at 19:56)</a>:</h4>
<p>I don't know how to find out</p>

<a name="125631861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125631861" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125631861">Reid Barton (Apr 24 2018 at 19:56)</a>:</h4>
<p>Me neither</p>

<a name="125631863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125631863" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125631863">Kevin Buzzard (Apr 24 2018 at 19:56)</a>:</h4>
<p>I put the debugging on and am immediately swimming in output</p>

<a name="125632444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125632444" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125632444">Patrick Massot (Apr 24 2018 at 20:09)</a>:</h4>
<p>Maybe have a look at <a href="https://github.com/leanprover/mathlib/blob/master/data/real/basic.lean#L74" target="_blank" title="https://github.com/leanprover/mathlib/blob/master/data/real/basic.lean#L74">https://github.com/leanprover/mathlib/blob/master/data/real/basic.lean#L74</a></p>

<a name="125632453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125632453" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125632453">Patrick Massot (Apr 24 2018 at 20:09)</a>:</h4>
<p>Sometimes you can help the type class resolution algorithm</p>

<a name="125632460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125632460" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125632460">Patrick Massot (Apr 24 2018 at 20:09)</a>:</h4>
<p>By precomputing some shortcut</p>

<a name="125632465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125632465" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125632465">Patrick Massot (Apr 24 2018 at 20:09)</a>:</h4>
<p>I have no idea if this applies in your case</p>

<a name="125632645"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125632645" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125632645">Mario Carneiro (Apr 24 2018 at 20:13)</a>:</h4>
<p>Do you have something I can test here myself?</p>

<a name="125633311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125633311" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125633311">Kevin Buzzard (Apr 24 2018 at 20:27)</a>:</h4>
<p>I have a MWE but it didn't need 52</p>

<a name="125633314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125633314" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125633314">Kevin Buzzard (Apr 24 2018 at 20:27)</a>:</h4>
<p>:P</p>

<a name="125633460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125633460" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125633460">Kevin Buzzard (Apr 24 2018 at 20:30)</a>:</h4>
<p>I can point you to a theorem in lean-stacks-project if that's what you mean</p>

<a name="125633469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125633469" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125633469">Kevin Buzzard (Apr 24 2018 at 20:30)</a>:</h4>
<p>line 138 of tag01HR.lean</p>

<a name="125633498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125633498" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125633498">Kevin Buzzard (Apr 24 2018 at 20:31)</a>:</h4>
<p><a href="https://github.com/kbuzzard/lean-stacks-project" target="_blank" title="https://github.com/kbuzzard/lean-stacks-project">https://github.com/kbuzzard/lean-stacks-project</a></p>

<a name="125633510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125633510" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125633510">Kevin Buzzard (Apr 24 2018 at 20:31)</a>:</h4>
<p>wait</p>

<a name="125633511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125633511" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125633511">Kevin Buzzard (Apr 24 2018 at 20:31)</a>:</h4>
<p>I need to push</p>

<a name="125633590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125633590" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125633590">Kevin Buzzard (Apr 24 2018 at 20:33)</a>:</h4>
<p><a href="https://github.com/kbuzzard/lean-stacks-project/blob/179ff95b6bd8d4998e1a007b2e8942179d9e24a8/src/tag01HR.lean#L138" target="_blank" title="https://github.com/kbuzzard/lean-stacks-project/blob/179ff95b6bd8d4998e1a007b2e8942179d9e24a8/src/tag01HR.lean#L138">https://github.com/kbuzzard/lean-stacks-project/blob/179ff95b6bd8d4998e1a007b2e8942179d9e24a8/src/tag01HR.lean#L138</a></p>

<a name="125633753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125633753" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125633753">Kevin Buzzard (Apr 24 2018 at 20:36)</a>:</h4>
<p>Thanks for pointing that out Patrick. I don't know if this applies in my situation because I have no idea what the problem is. I didn't think I was doing anything too weird.</p>

<a name="125633780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125633780" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125633780">Kevin Buzzard (Apr 24 2018 at 20:37)</a>:</h4>
<p>PS <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> I commented everything out from line 171 onwards (I mention this because it's not so easy to spot in VS Code)</p>

<a name="125637889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125637889" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125637889">Mario Carneiro (Apr 24 2018 at 22:15)</a>:</h4>
<p>By the way another way to comment everything out after a certain point is <code>#exit</code>, which also causes a notification so it's not so hard to spot</p>

<a name="125643878"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125643878" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125643878">Kevin Buzzard (Apr 25 2018 at 00:28)</a>:</h4>
<p>woohoo</p>

<a name="125643888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125643888" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125643888">Kevin Buzzard (Apr 25 2018 at 00:28)</a>:</h4>
<p>new record</p>

<a name="125643894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125643894" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125643894">Kevin Buzzard (Apr 25 2018 at 00:28)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">noncomputable</span> <span class="kn">definition</span> <span class="n">loc_is_loc_loc</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span>
<span class="n">R_alg_equiv</span>
  <span class="o">((</span><span class="n">of_comm_ring</span> <span class="o">(</span><span class="n">loc</span> <span class="n">R</span> <span class="o">(</span><span class="n">powers</span> <span class="n">f</span><span class="o">))</span> <span class="o">(</span><span class="n">powers</span> <span class="o">(</span><span class="n">of_comm_ring</span> <span class="n">R</span> <span class="o">(</span><span class="n">powers</span> <span class="n">f</span><span class="o">)</span> <span class="n">g</span><span class="o">)))</span>
  <span class="err">∘</span> <span class="o">(</span><span class="n">of_comm_ring</span> <span class="n">R</span> <span class="o">(</span><span class="n">powers</span> <span class="n">f</span><span class="o">)))</span>
  <span class="o">(</span><span class="n">of_comm_ring</span> <span class="n">R</span> <span class="o">(</span><span class="n">powers</span> <span class="o">(</span><span class="n">f</span> <span class="bp">*</span> <span class="n">g</span><span class="o">)))</span> <span class="o">:=</span>
</pre></div>

<a name="125643897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125643897" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125643897">Kevin Buzzard (Apr 25 2018 at 00:28)</a>:</h4>
<p>proof that <code>R[1/f][1/g] = R[1/fg]</code></p>

<a name="125643904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125643904" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125643904">Kevin Buzzard (Apr 25 2018 at 00:28)</a>:</h4>
<p><code>set_option class.instance_max_depth 93</code></p>

<a name="125643905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125643905" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125643905">Kevin Buzzard (Apr 25 2018 at 00:28)</a>:</h4>
<p>:-)</p>

<a name="125643910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125643910" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125643910">Kevin Buzzard (Apr 25 2018 at 00:28)</a>:</h4>
<p>I don't like the way this is going...</p>

<a name="125644005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125644005" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125644005">Kevin Buzzard (Apr 25 2018 at 00:31)</a>:</h4>
<p>Here's the proof:</p>

<a name="125644007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125644007" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125644007">Kevin Buzzard (Apr 25 2018 at 00:31)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">R_alg_equiv_of_unique_homs</span>
  <span class="o">(</span><span class="n">away_away_universal_property&#39;</span> <span class="n">f</span> <span class="n">g</span> <span class="o">(</span><span class="n">of_comm_ring</span> <span class="n">R</span> <span class="o">(</span><span class="n">powers</span> <span class="o">(</span><span class="n">f</span> <span class="bp">*</span> <span class="n">g</span><span class="o">)))</span>
    <span class="o">(</span><span class="n">unit_of_loc_more_left</span> <span class="n">f</span> <span class="n">g</span><span class="o">)</span> <span class="c1">-- proof that f is aunit in R[1/fg]</span>
    <span class="o">(</span><span class="n">unit_of_loc_more_right</span> <span class="n">f</span> <span class="n">g</span><span class="o">)</span> <span class="c1">-- proof that g is a unit in R[1/fg]</span>
  <span class="o">)</span>
  <span class="o">(</span><span class="n">away_universal_property</span> <span class="o">(</span><span class="n">f</span><span class="bp">*</span><span class="n">g</span><span class="o">)</span>
    <span class="o">((</span><span class="n">of_comm_ring</span> <span class="o">(</span><span class="n">loc</span> <span class="n">R</span> <span class="o">(</span><span class="n">powers</span> <span class="n">f</span><span class="o">))</span> <span class="o">(</span><span class="n">powers</span> <span class="o">(</span><span class="n">of_comm_ring</span> <span class="n">R</span> <span class="o">(</span><span class="n">powers</span> <span class="n">f</span><span class="o">)</span> <span class="n">g</span><span class="o">)))</span>
      <span class="err">∘</span> <span class="o">(</span><span class="n">of_comm_ring</span> <span class="n">R</span> <span class="o">(</span><span class="n">powers</span> <span class="n">f</span><span class="o">)))</span>
    <span class="o">(</span><span class="n">tag01HR</span><span class="bp">.</span><span class="n">unitfg</span> <span class="n">f</span> <span class="n">g</span><span class="o">)</span> <span class="c1">-- proof that fg is a unit in R[1/f][1/g]</span>
  <span class="o">)</span>
  <span class="o">(</span><span class="n">away_away_universal_property&#39;</span> <span class="n">f</span> <span class="n">g</span> <span class="o">((</span><span class="n">of_comm_ring</span> <span class="o">(</span><span class="n">loc</span> <span class="n">R</span> <span class="o">(</span><span class="n">powers</span> <span class="n">f</span><span class="o">))</span> <span class="o">(</span><span class="n">powers</span> <span class="o">(</span><span class="n">of_comm_ring</span> <span class="n">R</span> <span class="o">(</span><span class="n">powers</span> <span class="n">f</span><span class="o">)</span> <span class="n">g</span><span class="o">)))</span> <span class="err">∘</span> <span class="o">(</span><span class="n">of_comm_ring</span> <span class="n">R</span> <span class="o">(</span><span class="n">powers</span> <span class="n">f</span><span class="o">)))</span>
    <span class="o">(</span><span class="n">tag01HR</span><span class="bp">.</span><span class="n">unitf</span> <span class="n">f</span> <span class="n">g</span><span class="o">)</span> <span class="c1">-- proof that f is a unit in R[1/f][1/g]</span>
    <span class="o">(</span><span class="n">tag01HR</span><span class="bp">.</span><span class="n">unitg</span> <span class="n">f</span> <span class="n">g</span><span class="o">)</span> <span class="c1">-- proof that g is a unit in R[1/f][1/g]</span>
  <span class="o">)</span>
  <span class="o">(</span><span class="n">id_unique_R_alg_from_loc</span> <span class="bp">_</span><span class="o">)</span>
</pre></div>

<a name="125644009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/maximum%20class-instance%20resolution%20depth%20has%20been%20reached/near/125644009" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/79810maximumclassinstanceresolutiondepthhasbeenreached.html#125644009">Kevin Buzzard (Apr 25 2018 at 00:31)</a>:</h4>
<p>All universal properties</p>


{% endraw %}
