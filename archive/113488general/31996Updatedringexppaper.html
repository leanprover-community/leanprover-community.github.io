---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/31996Updatedringexppaper.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/31996Updatedringexppaper.html">Updated `ring_exp` paper</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="193882047"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Updated%20%60ring_exp%60%20paper/near/193882047" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/31996Updatedringexppaper.html#193882047">Anne Baanen (Apr 14 2020 at 11:20)</a>:</h4>
<p>I've been updating the short paper on <code>ring_exp</code>, now it should be (almost) ready to submit to Springer. The latest version is available here: <a href="https://www.cs.vu.nl/~tbn305/publicaties/2020-ring_exp.pdf" title="https://www.cs.vu.nl/~tbn305/publicaties/2020-ring_exp.pdf">https://www.cs.vu.nl/~tbn305/publicaties/2020-ring_exp.pdf</a> I'm very grateful to the Lean community for the help they have already given. If you have time to read it this week, I would really appreciate any feedback.</p>

<a name="194231729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Updated%20%60ring_exp%60%20paper/near/194231729" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/31996Updatedringexppaper.html#194231729">Kevin Buzzard (Apr 15 2020 at 21:43)</a>:</h4>
<p>+1 for using 37 as an example of a nat.</p>

<a name="194232462"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Updated%20%60ring_exp%60%20paper/near/194232462" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/31996Updatedringexppaper.html#194232462">Kevin Buzzard (Apr 15 2020 at 21:51)</a>:</h4>
<p>I don't understand why you bother telling people that on random expressions ring_exp is slower; I have consistently found <code>ring_exp</code> to be faster. I'm writing a proof right now which uses <code>ring</code> and I just tried replacing it with <code>ring_exp</code> and there is a 30% speed-up. My experience with <code>ring_exp</code> on highly non-random examples is extremely positive and so you might want to mention that there is anecdotal evidence that it is performing better in practice with single-variable polynomial calculations of degree 3 or more, which is what often comes up in my work.</p>

<a name="194232686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Updated%20%60ring_exp%60%20paper/near/194232686" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/31996Updatedringexppaper.html#194232686">Kevin Buzzard (Apr 15 2020 at 21:53)</a>:</h4>
<p>Last (silly) comment -- in the last-but-one sentence of the paper it sounds like you are accusing Gabriel etc of being the anonymous reviewers :-) You could put "Gabriel Ebner, ..., and the anonymous reviewers read this paper..." to avoid this ambiguity.</p>

<a name="194232808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Updated%20%60ring_exp%60%20paper/near/194232808" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/31996Updatedringexppaper.html#194232808">Kevin Buzzard (Apr 15 2020 at 21:54)</a>:</h4>
<p>Do you have any time to do a test suite of random expressions in one variable with degrees between 3 and 10?</p>

<a name="194237663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Updated%20%60ring_exp%60%20paper/near/194237663" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/31996Updatedringexppaper.html#194237663">Bryan Gin-ge Chen (Apr 15 2020 at 22:43)</a>:</h4>
<p>Some minor typos:</p>
<p>On page 2:</p>
<blockquote>
<p>The <code>ring_exp</code> tactic does not use reflection but directly constructs proof terms <strong>to type</strong> checked by Leanâ€™s kernel,</p>
</blockquote>
<p>On page 6:</p>
<blockquote>
<p>on linear expressions such <strong>as passed</strong> by <code>linarith</code>, <code>ring_exp</code> is 1.67 times slower than <code>ring</code>.</p>
</blockquote>

<a name="194281572"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Updated%20%60ring_exp%60%20paper/near/194281572" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/31996Updatedringexppaper.html#194281572">Anne Baanen (Apr 16 2020 at 10:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113488-general/topic/Updated.20.60ring_exp.60.20paper/near/194232462" title="#narrow/stream/113488-general/topic/Updated.20.60ring_exp.60.20paper/near/194232462">said</a>:</p>
<blockquote>
<p>I don't understand why you bother telling people that on random expressions ring_exp is slower; I have consistently found <code>ring_exp</code> to be faster. I'm writing a proof right now which uses <code>ring</code> and I just tried replacing it with <code>ring_exp</code> and there is a 30% speed-up. My experience with <code>ring_exp</code> on highly non-random examples is extremely positive and so you might want to mention that there is anecdotal evidence that it is performing better in practice with single-variable polynomial calculations of degree 3 or more, which is what often comes up in my work.</p>
</blockquote>
<p>It doesn't seem as uniformly positive to me. My own anecdotal evidence is that it's easy to find worse performance for either tactic in practice. Visually looking through the benchmark output, <code>ring</code> seems to be not too much worse than <code>ring_exp</code> when it loses the race, compared to <code>ring_exp</code> losing by a lot when it does. So <code>ring_exp</code> is about 30% faster than <code>ring</code> on showing <code>(1 + x + x^2 + x^3 + x^4) * (x - 1) = x^5 - 1</code>, but 4 <em>times</em> slower than <code>ring</code> on showing <code>(x - 1)^4 = (1 - x)^4</code> (I think because <code>(a + b)^4</code> is unfolded into a bunch of multiplications, which <code>ring</code> tends to be faster at).</p>

<a name="194281748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Updated%20%60ring_exp%60%20paper/near/194281748" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/31996Updatedringexppaper.html#194281748">Kevin Buzzard (Apr 16 2020 at 10:09)</a>:</h4>
<p>OK, then maybe what you have is fine.</p>

<a name="194288557"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Updated%20%60ring_exp%60%20paper/near/194288557" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/31996Updatedringexppaper.html#194288557">Anne Baanen (Apr 16 2020 at 11:21)</a>:</h4>
<p>Thank you for the benchmark suggestion. With a fixed degree, <code>ring_exp</code> seems to catch up somewhat to <code>ring</code>. I will let it run for a couple of hours to compare the distributions.</p>

<a name="194289182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Updated%20%60ring_exp%60%20paper/near/194289182" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/31996Updatedringexppaper.html#194289182">Mario Carneiro (Apr 16 2020 at 11:28)</a>:</h4>
<p>Just an FYI, but I have some work optimizing <code>ring</code> in progress. The plan is to back port all the performance tricks used in <code>ring_exp</code> to <code>ring</code>, and if possible see what can be done to merge the two without performance regression</p>

<a name="194289295"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Updated%20%60ring_exp%60%20paper/near/194289295" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/31996Updatedringexppaper.html#194289295">Kevin Buzzard (Apr 16 2020 at 11:29)</a>:</h4>
<p>Could one mention this in the paper? The work has inspired other work etc</p>


{% endraw %}

{% include archive_update.html %}