---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/10497recursionoverlistnestedinductives.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html">recursion over list-nested inductives</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="168305372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168305372" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168305372">Sebastian Ullrich (Jun 17 2019 at 12:28)</a>:</h4>
<p>I'm surprised that the lemma <a href="https://github.com/leanprover/lean/blob/master/tests/lean/run/term_app2.lean#L27" target="_blank" title="https://github.com/leanprover/lean/blob/master/tests/lean/run/term_app2.lean#L27">https://github.com/leanprover/lean/blob/master/tests/lean/run/term_app2.lean#L27</a> has never made it into mathlib (though <code>list.attach</code> has). Do people just avoid nested inductives in general in Lean 3? Is it ultimately easier to replace a nested occurrence <code>list t -&gt;</code> with <code>(n : nat) -&gt; (fin n -&gt; t) -&gt;</code>?</p>

<a name="168307467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168307467" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168307467">Chris Hughes (Jun 17 2019 at 12:56)</a>:</h4>
<p>nested inductives don't give the best recursor right now, so I think people tend to avoid them. Also, I tend to use <code>list.length</code> instead of <code>sizeof</code> if I have to induct on a list in that way. I view <code>sizeof</code> as an internal thing. I don't actually know what the <code>sizeof</code> a list is defined to be, though I imagine it's the length.</p>

<a name="168307668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168307668" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168307668">Sebastian Ullrich (Jun 17 2019 at 12:59)</a>:</h4>
<p>No, it's the sum of element sizes. You couldn't prove such recursions terminating otherwise.</p>

<a name="168307955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168307955" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168307955">Kevin Buzzard (Jun 17 2019 at 13:02)</a>:</h4>
<p>Does everything have a size? Can we ask what the size of the real numbers are? Or a perfectoid space?</p>

<a name="168307990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168307990" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168307990">Kevin Buzzard (Jun 17 2019 at 13:03)</a>:</h4>
<p>Like Chris, I have always regarded <code>sizeof</code> as some internal thing which we mortals shouldn't be fiddling with.</p>

<a name="168308030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168308030" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168308030">Chris Hughes (Jun 17 2019 at 13:03)</a>:</h4>
<p>I think inductive types have a <code>sizeof</code></p>

<a name="168308224"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168308224" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168308224">Chris Hughes (Jun 17 2019 at 13:05)</a>:</h4>
<p>I would have used <code>list.sum</code> for that sort of induction.</p>

<a name="168308227"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168308227" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168308227">Kevin Buzzard (Jun 17 2019 at 13:05)</a>:</h4>
<p>Great, we could ask what the size of <code>[real]</code> is</p>

<a name="168308399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168308399" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168308399">Chris Hughes (Jun 17 2019 at 13:07)</a>:</h4>
<p>It's <code>2</code></p>

<a name="168308466"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168308466" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168308466">Sebastian Ullrich (Jun 17 2019 at 13:08)</a>:</h4>
<p>obviously</p>

<a name="168308554"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168308554" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168308554">Chris Hughes (Jun 17 2019 at 13:09)</a>:</h4>
<p>Turns out <code>Type</code> has sizeof as well.</p>

<a name="168308645"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168308645" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168308645">Reid Barton (Jun 17 2019 at 13:10)</a>:</h4>
<p>is it interesting?</p>

<a name="168308699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168308699" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168308699">Chris Hughes (Jun 17 2019 at 13:11)</a>:</h4>
<p>Non inductive types also have <code>sizeof</code>, but it's just always zero.</p>

<a name="168308810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168308810" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168308810">Sebastian Ullrich (Jun 17 2019 at 13:12)</a>:</h4>
<p>Every type that may be used in a mutual or nested inductive should have a <code>has_sizeof</code> instance. As Chris said, the value only really matters for actually inductive types, on which you may want to use well-founded induction.</p>

<a name="168308898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168308898" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168308898">Reid Barton (Jun 17 2019 at 13:12)</a>:</h4>
<p><code>Type</code> is not an inductive type, is it? So I would have thought it would also have <code>sizeof</code> always zero</p>

<a name="168308932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168308932" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168308932">Reid Barton (Jun 17 2019 at 13:13)</a>:</h4>
<p>Is 2 counting the two things <code>list</code> and <code>real</code> in <code>list real</code>?</p>

<a name="168309230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168309230" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168309230">Chris Hughes (Jun 17 2019 at 13:17)</a>:</h4>
<p>For some reason <code>sizeof []</code> is <code>1</code> not <code>0</code></p>

<a name="168309263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168309263" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168309263">Sebastian Ullrich (Jun 17 2019 at 13:17)</a>:</h4>
<p>I wouldn't say <code>sizeof</code> is an implementation detail. If you want to do induction over a mutual or nested inductive, you'll want to use it as the measure, and you'll need to do proofs about it. You could define your own measure, but it would not be drastically different from the synthesized one.</p>

<a name="168309275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168309275" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168309275">Sebastian Ullrich (Jun 17 2019 at 13:17)</a>:</h4>
<p>If you never do that, you don't have to care about <code>sizeof</code>, of course.</p>

<a name="168309664"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168309664" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168309664">Chris Hughes (Jun 17 2019 at 13:22)</a>:</h4>
<p>But usually I already have theorems about things like <code>list.sum</code> or <code>list.length</code>, but nothing about <code>list.sizeof</code>. These are also nicer definitions to prove things about since they're standard maths definitions, starting at <code>1</code> for <code>[]</code> is a bit odd. Also I guess the general definition of <code>sizeof</code> isn't published anywhere, so people aren't going to use it.</p>

<a name="168309833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168309833" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168309833">Reid Barton (Jun 17 2019 at 13:24)</a>:</h4>
<p>Oh I got fooled by Haskell. <code>[real]</code> is not <code>list real</code></p>

<a name="168342714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168342714" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168342714">Mario Carneiro (Jun 17 2019 at 20:02)</a>:</h4>
<p><code>sizeof</code> only works for well orders that have ordinal height &lt;= omega, so it doesn't work for things like lex order on nat x nat</p>

<a name="168342795"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168342795" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168342795">Mario Carneiro (Jun 17 2019 at 20:03)</a>:</h4>
<p>The advice I give is to avoid it in any manual proof. If lean can use it to completely automate your wf recursion then that's great, but it's basically never the best wf relation for the job</p>

<a name="168343337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168343337" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168343337">Chris Hughes (Jun 17 2019 at 20:10)</a>:</h4>
<p>I guess that's not <span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> 's advice</p>

<a name="168346572"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168346572" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168346572">Sebastian Ullrich (Jun 17 2019 at 20:54)</a>:</h4>
<p>I still don't see what other measure you would use on a rose tree-like data type, or why</p>

<a name="168347247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168347247" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168347247">Mario Carneiro (Jun 17 2019 at 21:03)</a>:</h4>
<p>you probably don't want to get the structure of the elements involved in a rose tree</p>

<a name="168347266"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168347266" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168347266">Mario Carneiro (Jun 17 2019 at 21:03)</a>:</h4>
<p>something like total size would work pretty well</p>

<a name="168347358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168347358" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168347358">Mario Carneiro (Jun 17 2019 at 21:04)</a>:</h4>
<p>I don't think I want to consider [162] bigger than [0, [1, 1], 0]</p>

<a name="168376536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168376536" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168376536">Sebastian Ullrich (Jun 18 2019 at 07:35)</a>:</h4>
<p>For the purpose of proving well-foundedness of recursions over the tree, the size of a leaf does not matter. Daniel(?) could have chosen to ignore them when synthesizing <code>sizeof</code>, but I assume it was easier to just sum up all parameters, without no apparent downside.</p>

<a name="168377421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168377421" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168377421">Mario Carneiro (Jun 18 2019 at 07:51)</a>:</h4>
<p>I think it is important to have them in the instances for sizeof so that the size passes through nested inductives (i.e. you wouldn't get the right answer with nested inductives like <code>list (list T) -&gt; T</code> unless the size of the inner list was represented in the size of the outer list), but it is otherwise undesirable to have parameters be counted in the size. I have had examples where this actually prevents some constructions; for example if you map a rose tree then the "size" should not change, but that's not true if the size of elements matter</p>

<a name="168381401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/recursion%20over%20list-nested%20inductives/near/168381401" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/10497recursionoverlistnestedinductives.html#168381401">Sebastian Ullrich (Jun 18 2019 at 08:54)</a>:</h4>
<p>Ah, you want do a structure-preserving map over the children before recursing into them... in that case <code>sizeof</code> may not work and one should define their own measure, yes. But if this is not the case, I would still default to <code>sizeof</code>, personally.</p>


{% endraw %}
