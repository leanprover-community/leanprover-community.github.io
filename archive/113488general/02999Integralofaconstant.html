---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/02999Integralofaconstant.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html">Integral of a constant</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="165921962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165921962" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165921962">Koundinya Vajjha (May 17 2019 at 17:57)</a>:</h4>
<p>I am stuck on the following goal for a test lemma:</p>
<div class="codehilite"><pre><span></span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">,</span>
<span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">measurable_space</span> <span class="n">α</span><span class="o">,</span>
<span class="n">D</span> <span class="o">:</span> <span class="n">probability_measure</span> <span class="n">bool</span><span class="o">,</span>
<span class="n">h</span> <span class="o">:</span> <span class="n">true</span>
<span class="err">⊢</span> <span class="n">measure</span><span class="bp">.</span><span class="n">integral</span> <span class="o">(</span><span class="n">D</span><span class="bp">.</span><span class="n">to_measure</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">bool</span><span class="o">),</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span>
</pre></div>


<p>Where I have extended the <code>measure</code> structure with the extra field that the measure of <code>univ</code> is 1. Is there a lemma which says I can rewrite the LHS as the measure of the whole set?</p>

<a name="165922409"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165922409" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165922409">Kevin Buzzard (May 17 2019 at 18:02)</a>:</h4>
<p>I can't help you, but it's wonderful to see that people are now trying to do differentiation and integration. Very little has happened in this area since 2017, until recently, when things seem to be slowly taking off. An attainable (in my opinion) goal is to have Lean's maths library knowing essentially all of a pure mathematics degree course within the next few years, and this stuff is absolutely essential.</p>

<a name="165923265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165923265" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165923265">Mario Carneiro (May 17 2019 at 18:13)</a>:</h4>
<p>There doesn't seem to be much about <code>measure.integral</code> yet. Also it's generally presumed that the measure of univ is infinite, so there isn't much about stuff like integrable constant functions. Presumably that's part of the focus of your <code>probability_measure</code> work. <code>measure.integral</code> is defined in terms of <code>lintegral</code>, which has the theorem <code>simple_func.lintegral_eq_integral</code>. Show that the constant function is a simple function; it follows that the integral of <code>a</code> is <code>a * measure univ = a</code> for a probability measure.</p>

<a name="165926878"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165926878" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165926878">Koundinya Vajjha (May 17 2019 at 18:55)</a>:</h4>
<p><code>apply simple_func.lintegral_eq_integral</code> is giving me a deterministic timeout. I probably shouldn't have done this, but are there any general reasons behind an <code>apply</code> giving  deterministic timeouts?</p>

<a name="165927043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165927043" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165927043">Kevin Buzzard (May 17 2019 at 18:57)</a>:</h4>
<p>Can you post a complete working example?</p>

<a name="165927196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165927196" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165927196">Kevin Buzzard (May 17 2019 at 18:59)</a>:</h4>
<p>It might be trying to prove that two types are defeq when they're not, it might be user error, it might be that two types are defeq but it's very hard to prove, it might be fixable by changing the timeout parameter (but the point of the -T50000 thread is that we'd rather be changing it the other way ;-) )</p>

<a name="165934792"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165934792" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165934792">Koundinya Vajjha (May 17 2019 at 20:40)</a>:</h4>
<p>Here a complete working example: </p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">measure_theory</span><span class="bp">.</span><span class="n">giry_monad</span>

<span class="kn">open</span> <span class="n">set</span> <span class="n">measure_theory</span> <span class="n">measurable_space</span>

<span class="kn">infixl</span> <span class="bp">`&gt;&gt;=</span><span class="err">ₐ</span><span class="bp">`</span> <span class="o">:</span><span class="mi">55</span> <span class="o">:=</span> <span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">bind</span>
<span class="n">local</span> <span class="kn">notation</span> <span class="bp">`</span><span class="n">do</span><span class="bp">`</span> <span class="n">binders</span> <span class="bp">`</span><span class="err">←ₐ</span><span class="bp">`</span> <span class="n">m</span> <span class="bp">`;`</span> <span class="n">t</span><span class="o">:(</span><span class="n">scoped</span> <span class="n">p</span><span class="o">,</span> <span class="n">m</span> <span class="bp">&gt;&gt;=</span><span class="err">ₐ</span> <span class="n">p</span><span class="o">)</span> <span class="o">:=</span> <span class="n">t</span>
<span class="n">local</span> <span class="kn">notation</span> <span class="bp">`</span><span class="n">ret</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">dirac</span>

<span class="kn">variable</span> <span class="o">[</span><span class="n">measurable_space</span> <span class="bp">ℕ</span><span class="o">]</span>

<span class="kn">structure</span> <span class="n">probability_measure</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">measurable_space</span> <span class="n">α</span><span class="o">]</span> <span class="kn">extends</span> <span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span> <span class="n">α</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">is_one</span> <span class="o">:</span> <span class="n">measure_of</span> <span class="n">univ</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span>

<span class="n">noncomputable</span> <span class="n">def</span> <span class="n">double</span><span class="o">(</span><span class="n">m</span><span class="o">:</span> <span class="n">probability_measure</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">measure</span> <span class="bp">ℕ</span> <span class="o">:=</span>
<span class="n">do</span> <span class="n">x</span> <span class="err">←ₐ</span> <span class="n">m</span><span class="bp">.</span><span class="n">to_measure</span><span class="bp">;</span>
<span class="n">ret</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span>

<span class="n">def</span> <span class="n">even</span> <span class="o">:=</span> <span class="o">{</span><span class="n">x</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">k</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">k</span><span class="o">}</span>

<span class="kn">lemma</span> <span class="n">test</span><span class="o">:</span>
<span class="bp">∀</span> <span class="n">m</span><span class="o">:</span> <span class="n">probability_measure</span> <span class="bp">ℕ</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">m&#39;</span><span class="o">:</span> <span class="n">measure</span> <span class="bp">ℕ</span><span class="o">,</span>
<span class="n">m&#39;</span> <span class="bp">=</span> <span class="n">double</span><span class="o">(</span><span class="n">m</span><span class="o">)</span> <span class="bp">→</span> <span class="n">m&#39;</span><span class="o">(</span><span class="n">even</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="n">unfold</span> <span class="n">even</span><span class="o">,</span>
  <span class="n">unfold</span> <span class="n">double</span> <span class="n">at</span> <span class="n">a</span><span class="o">,</span>
  <span class="n">rewrite</span> <span class="n">a</span><span class="o">,</span>
  <span class="n">clear</span> <span class="n">a</span><span class="o">,</span>
  <span class="n">rewrite</span> <span class="n">measure</span><span class="bp">.</span><span class="n">bind_apply</span><span class="o">,</span>

<span class="kn">end</span>
</pre></div>


<p>I'm afraid I don't know if this is even provable with the current technology...</p>

<a name="165935050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165935050" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165935050">Mario Carneiro (May 17 2019 at 20:43)</a>:</h4>
<p>This is provable, but it looks like one of those things I don't <em>want</em> to prove. As in, I challenge the premise that this theorem matters. It reminds me of Kevin's M1F problems</p>

<a name="165935174"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165935174" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165935174">Koundinya Vajjha (May 17 2019 at 20:45)</a>:</h4>
<p>Let's just say it matters very much to me.</p>

<a name="165935193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165935193" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165935193">Mario Carneiro (May 17 2019 at 20:45)</a>:</h4>
<p>Step back. What do you want to say?</p>

<a name="165935216"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165935216" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165935216">Mario Carneiro (May 17 2019 at 20:46)</a>:</h4>
<p>maybe this isn't the easiest way to formalize whatever the real goal is</p>

<a name="165935304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165935304" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165935304">Koundinya Vajjha (May 17 2019 at 20:46)</a>:</h4>
<p>Basically I want to <em>reason</em> about the measure which is returned by the <code>do x &lt;- D; return(f(x)</code> part of the Giry monad.</p>

<a name="165935339"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165935339" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165935339">Mario Carneiro (May 17 2019 at 20:47)</a>:</h4>
<p>first of all, bind return is map</p>

<a name="165935370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165935370" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165935370">Mario Carneiro (May 17 2019 at 20:47)</a>:</h4>
<p>This generalizes in a few ways. The double function doesn't matter, replace it with an arbitrary function A -&gt; B</p>

<a name="165935426"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165935426" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165935426">Mario Carneiro (May 17 2019 at 20:48)</a>:</h4>
<p>the measure takes values in the image of the function</p>

<a name="165935456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165935456" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165935456">Koundinya Vajjha (May 17 2019 at 20:48)</a>:</h4>
<p>Yes. Well maybe this particular example is too hard.</p>

<a name="165935464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165935464" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165935464">Mario Carneiro (May 17 2019 at 20:48)</a>:</h4>
<p>Examples are always harder than general theorems</p>

<a name="165935494"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165935494" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165935494">Mario Carneiro (May 17 2019 at 20:49)</a>:</h4>
<p>they add additional irrelevant stuff</p>

<a name="165935550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165935550" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165935550">Koundinya Vajjha (May 17 2019 at 20:49)</a>:</h4>
<blockquote>
<p>Basically I want to <em>reason</em> about the measure which is returned by the <code>do x &lt;- D; return(f(x)</code> part of the Giry monad.</p>
</blockquote>
<p>In particular, I want to characterize the measure zero sets of this measure.</p>

<a name="165935801"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165935801" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165935801">Mario Carneiro (May 17 2019 at 20:52)</a>:</h4>
<p>It's not hard to prove your theorem using <code>measure.map_apply</code> once you have the monad laws</p>

<a name="165935865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165935865" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165935865">Koundinya Vajjha (May 17 2019 at 20:53)</a>:</h4>
<p>Okay this is the most general I can make it</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">test</span> <span class="o">[</span><span class="n">measurable_space</span> <span class="n">α</span><span class="o">][</span><span class="n">measurable_space</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">D</span> <span class="o">:</span> <span class="n">measure</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">set</span> <span class="n">β</span><span class="o">)</span> <span class="o">[</span><span class="n">hs</span> <span class="o">:</span> <span class="n">is_measurable</span> <span class="n">A</span><span class="o">]</span> <span class="o">:</span>
<span class="o">(</span><span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">bind</span> <span class="n">D</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">measure_theory</span><span class="bp">.</span><span class="n">measure</span><span class="bp">.</span><span class="n">dirac</span> <span class="err">$</span> <span class="n">p</span> <span class="n">x</span><span class="o">))</span> <span class="n">A</span> <span class="bp">=</span> <span class="n">D</span> <span class="o">{</span><span class="n">x</span> <span class="bp">|</span> <span class="n">p</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">}</span> <span class="o">:=</span> <span class="n">sorry</span>
</pre></div>

<a name="165935939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165935939" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165935939">Mario Carneiro (May 17 2019 at 20:54)</a>:</h4>
<p>the thing on the right is <code>D.map p A</code></p>

<a name="165935946"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165935946" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165935946">Mario Carneiro (May 17 2019 at 20:54)</a>:</h4>
<p>so this is the monad law</p>

<a name="165936324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165936324" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165936324">Koundinya Vajjha (May 17 2019 at 20:59)</a>:</h4>
<p>That worked. (Btw it's failing to apply the <code>coe_fn</code> coercion. I need to explicitly say <code>(D.map p).measure_of A</code>.</p>

<a name="165936344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165936344" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165936344">Mario Carneiro (May 17 2019 at 20:59)</a>:</h4>
<p>you can use <code>(D.map p : function type) A</code></p>

<a name="165942547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165942547" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165942547">Koundinya Vajjha (May 17 2019 at 22:41)</a>:</h4>
<p>Still stuck on essentially the same goal as the first case. :(</p>
<div class="codehilite"><pre><span></span><span class="err">⊢</span><span class="n">measure</span><span class="bp">.</span><span class="n">integral</span> <span class="n">D</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="err">⨆</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">p</span> <span class="n">a</span> <span class="err">∈</span> <span class="n">A</span><span class="o">),</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="err">⇑</span><span class="n">D</span> <span class="o">(</span><span class="n">p</span> <span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">A</span><span class="o">)</span>
</pre></div>


<p>If I understand you correctly,  there surely isn't a purely abstract proof using just the monad laws, is there? You <em>have</em> to use the Giry monad bind and return somewhere to prove this right?</p>

<a name="165943387"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165943387" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165943387">Mario Carneiro (May 17 2019 at 22:57)</a>:</h4>
<p>there should be an abstract proof</p>

<a name="165943436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165943436" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165943436">Mario Carneiro (May 17 2019 at 22:58)</a>:</h4>
<p>using lemmas about Giry bind and return</p>

<a name="165943444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165943444" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165943444">Mario Carneiro (May 17 2019 at 22:58)</a>:</h4>
<p>which are the same as the usual monad laws</p>

<a name="165950357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165950357" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165950357">Koundinya Vajjha (May 18 2019 at 01:29)</a>:</h4>
<p>Sorry I just can't see how that can be..</p>

<a name="165950367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165950367" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165950367">Koundinya Vajjha (May 18 2019 at 01:29)</a>:</h4>
<p>Can you sketch a proof?</p>

<a name="165952054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165952054" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165952054">Mario Carneiro (May 18 2019 at 02:10)</a>:</h4>
<p><span class="user-mention" data-user-id="116448">@Koundinya Vajjha</span> The current <code>dirac_bind</code> is not one of the monad laws, it's too weak. The real monad law says that <code>m &gt;&gt;= pure o f = f &lt;$&gt; m</code>, and <code>dirac_bind</code> is the special case when <code>f = id</code>. So we can take inspiration from this and try to generalize the proof of <code>dirac_bind</code> with a function and deduce <code>dirac_bind</code> as a consequence:</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">dirac_bind_comp</span> <span class="o">{</span><span class="n">m</span> <span class="o">:</span> <span class="n">measure</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">measurable</span> <span class="n">f</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">bind</span> <span class="n">m</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">dirac</span> <span class="err">$</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span> <span class="n">map</span> <span class="n">f</span> <span class="n">m</span> <span class="o">:=</span>
<span class="n">measure</span><span class="bp">.</span><span class="n">ext</span> <span class="err">$</span> <span class="k">assume</span> <span class="n">s</span> <span class="n">hs</span><span class="o">,</span> <span class="k">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">bind_apply</span> <span class="n">hs</span> <span class="o">(</span><span class="n">measurable_dirac</span><span class="bp">.</span><span class="n">comp</span> <span class="n">hf</span><span class="o">),</span> <span class="n">map_apply</span> <span class="n">hf</span> <span class="n">hs</span><span class="o">],</span>
  <span class="n">conv</span> <span class="o">{</span><span class="n">to_lhs</span><span class="o">,</span> <span class="n">congr</span><span class="o">,</span> <span class="n">skip</span><span class="o">,</span> <span class="n">funext</span><span class="o">,</span> <span class="n">rw</span> <span class="n">dirac_apply</span> <span class="bp">_</span> <span class="n">hs</span><span class="o">},</span>
  <span class="n">transitivity</span><span class="o">,</span> <span class="n">apply</span> <span class="n">lintegral_supr_const</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hf</span> <span class="bp">_</span> <span class="n">hs</span><span class="o">,</span> <span class="n">rw</span> <span class="n">one_mul</span><span class="o">,</span> <span class="n">refl</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">dirac_bind</span> <span class="o">{</span><span class="n">m</span> <span class="o">:</span> <span class="n">measure</span> <span class="n">α</span><span class="o">}</span> <span class="o">:</span> <span class="n">bind</span> <span class="n">m</span> <span class="n">dirac</span> <span class="bp">=</span> <span class="n">m</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">dirac_bind_comp</span> <span class="n">measurable_id</span><span class="o">)</span><span class="bp">.</span><span class="n">trans</span> <span class="n">map_id</span>
</pre></div>

<a name="165955077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165955077" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165955077">Koundinya Vajjha (May 18 2019 at 03:20)</a>:</h4>
<p>Thanks a lot Mario!!</p>

<a name="165964352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165964352" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165964352">Kevin Buzzard (May 18 2019 at 08:03)</a>:</h4>
<p>So this is an absolutely serious statement. I went to a 24 lecture course on measure theory as an undergraduate and we learnt about sigma algebras and Borel measures and Lebesgue measure and the Borel  Cantelli lemma and all that stuff which mathematicians think of as standard, but for absolute sure there were no monads and certainly no monad law. Is this just some statement that is mathematically very straightforward but turns out to be some sort of universal statement for measures which would have been presented to us as an "obvious fact" or something?</p>

<a name="165964607"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165964607" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165964607">Kevin Buzzard (May 18 2019 at 08:09)</a>:</h4>
<p>All this measure theory chat is completely passing me by. When people start doing MSc level stuff that's fine, that's what I'd expect, but I had still expected to be following what was going on at this stage.</p>

<a name="165965791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165965791" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165965791">Andrew Ashworth (May 18 2019 at 08:47)</a>:</h4>
<p>If there's one thing type theorists love, it's categories.  The original paper by Giry is here <a href="https://www.chrisstucchio.com/blog_media/2016/probability_the_monad/categorical_probability_giry.pdf" target="_blank" title="https://www.chrisstucchio.com/blog_media/2016/probability_the_monad/categorical_probability_giry.pdf">A Categorical Approach to Probability Theory</a>.</p>

<a name="165965842"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165965842" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165965842">Andrew Ashworth (May 18 2019 at 08:49)</a>:</h4>
<p>I'm also a little confused by Giry monads, but also very interested in concrete probability theory. I suppose I'll sit down and wrestle with the terminology once the library is a little more complete...</p>

<a name="165966092"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165966092" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165966092">Kevin Buzzard (May 18 2019 at 08:57)</a>:</h4>
<p>But on the other hand we had a colloquium by <a href="https://en.wikipedia.org/wiki/Hugo_Duminil-Copin" target="_blank" title="https://en.wikipedia.org/wiki/Hugo_Duminil-Copin">Hugo Duminil-Copin</a> at Imperial last week and I went out to dinner with him afterwards and asked him if he'd heard of the Giry monad and he said no. He's a regular mathematician though, not a type theorist. There's something funny going on. Type theorists might like it but probabilists don't use it, so my guess is that it is probably a beautiful way of saying something relatively straightforward to a mathematician; I suspect it's just the observation that one can use the language of monads to precisely encapsulate some standard phenomenon in measure theory, so it doesn't buy the mathematician anything in practice, but it makes part of the theory much more pleasant to formalise. I remember when I learnt that a morphism of sheaves was a natural transformation of functors -- I just thought "cool" but it didn't mean I understood morphisms of sheaves any better, it just meant that I was suddenly better at remembering the precise list of axioms for a morphism of sheaves in some sense.</p>

<a name="165973975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165973975" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165973975">Koundinya Vajjha (May 18 2019 at 12:58)</a>:</h4>
<p>I've never come across the Giry monad myself until I got interested in it thanks to Johannes' work. The fundamental fact which everyone glosses over which makes this thing work is that the space of all measures on a set is also a measurable space. (Take the weak* topology and the borel sigma algebra wrt to that and you have a measurable space).</p>
<p>IMO, the Giry monad will pop up sooner or later when you ask a mathematician how to rigorously formalize the statement "sample a point from a distribution D". Indeed that was my motivation in discovering it as well.</p>

<a name="165974059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165974059" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165974059">Koundinya Vajjha (May 18 2019 at 13:00)</a>:</h4>
<p>We make these sort of statements all the time, but never (until now) have thought of what the best way to formalize these things would be in a proof assistant.</p>

<a name="165974130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165974130" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165974130">Koundinya Vajjha (May 18 2019 at 13:02)</a>:</h4>
<p>Part of the appeal of the Giry monad is then to "sample a point from a distribution D", you can say <code>do x &lt;- D, return (x)</code>. It's really quite beautiful.</p>

<a name="165981058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165981058" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165981058">Kevin Buzzard (May 18 2019 at 16:25)</a>:</h4>
<p>Seeing that as beautiful is something which a certain kind of person does -- and perhaps the probabilist I talked to was not that kind of person. Thanks for the explanation! I read some of the pdf link. It's a cute thing.</p>

<a name="165997121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165997121" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165997121">Mario Carneiro (May 19 2019 at 00:07)</a>:</h4>
<p>The really powerful thing about the Giry monad is it allows you to do operations on random variables without a massive amount of notation overloading to make sense of those <code>x * cos Y</code> expressions</p>

<a name="165997176"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165997176" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165997176">Mario Carneiro (May 19 2019 at 00:08)</a>:</h4>
<p>I'm sure no mathematician or statistician would even think of calling this a monad, because ad hoc notation overloading is just what they do, but they never had to prove anything formally about those expressions</p>

<a name="165997253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Integral%20of%20a%20constant/near/165997253" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/02999Integralofaconstant.html#165997253">Mario Carneiro (May 19 2019 at 00:11)</a>:</h4>
<blockquote>
<p>I suspect it's just the observation that one can use the language of monads to precisely encapsulate some standard phenomenon in measure theory, so it doesn't buy the mathematician anything in practice, but it makes part of the theory much more pleasant to formalise.</p>
</blockquote>
<p>^ this</p>


{% endraw %}

{% include archive_update.html %}