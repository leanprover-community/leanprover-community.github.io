---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/27935CNLandtheStackProject.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html">CNL and the Stack Project</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="185892636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185892636" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185892636">Johan Commelin (Jan 17 2020 at 07:01)</a>:</h4>
<p>I just watched <span class="user-mention" data-user-id="115334">@Thales</span> talk from last week, on CNL and Formal Abstracts. I was wondering about the following question: would it be interesting to attempt to pre-process the Stacks Project into something that is readable by the CNL? Is it reasonable to think that this is possible? (cc people that might know more about this: <span class="user-mention" data-user-id="221640">@Peter Koepke</span> <span class="user-mention" data-user-id="116045">@Jesse Michael Han</span>)</p>

<a name="185892943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185892943" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185892943">Johan Commelin (Jan 17 2020 at 07:08)</a>:</h4>
<p>One reason for suggesting the Stacks Project is that it is written in a very strict subset of LaTeX</p>

<a name="185893085"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185893085" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185893085">Johan Commelin (Jan 17 2020 at 07:12)</a>:</h4>
<p>See <a href="https://github.com/stacks/stacks-project/blob/master/documentation/rules" target="_blank" title="https://github.com/stacks/stacks-project/blob/master/documentation/rules">https://github.com/stacks/stacks-project/blob/master/documentation/rules</a> from which I will quote the 4th line:</p>
<blockquote>
<p>Avoid reading this document at all cost!</p>
</blockquote>

<a name="185924147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185924147" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185924147">Jesse Michael Han (Jan 17 2020 at 15:16)</a>:</h4>
<p>it would be interesting, and definitely easier than preprocessing a less uniform corpus like all math pages from e.g. Wikipedia</p>
<p>besides working in a small subset of LaTeX, the CNL parser only accepts certain canned phrases in a certain order, so some NLP will be required to align the informal text with CNL equivalents</p>

<a name="185924558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185924558" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185924558">Johan Commelin (Jan 17 2020 at 15:20)</a>:</h4>
<p>Yup, I guess it won't be trivial. But for an informal text, the Stacks Project is written rather on the formal side of the spectrum.</p>

<a name="185924572"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185924572" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185924572">Johan Commelin (Jan 17 2020 at 15:20)</a>:</h4>
<p>That's another reason why I think it might be an interesting target.</p>

<a name="185926196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185926196" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185926196">Johan Commelin (Jan 17 2020 at 15:37)</a>:</h4>
<p>A long time ago, I thought about a baby version of this problem. Together with <span class="user-mention" data-user-id="223577">@Josef Urban</span> we tried to "linkify" the Stacks Project: whenever a concept was defined in SP, link back to it when it is used later. We used some very basic NLP, but nothing fancy. As far as I remember, the results were cute, but not impressive. Also: I had to write a PhD thesis, so I stopped working on it.</p>

<a name="185926561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185926561" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185926561">Johan Commelin (Jan 17 2020 at 15:40)</a>:</h4>
<p>Unfortunately, I don't think I have any code left from that side project.</p>

<a name="185926611"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185926611" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185926611">Alex J. Best (Jan 17 2020 at 15:41)</a>:</h4>
<p>Stacks tags the term being defined in each definition too, which is helpful.</p>

<a name="185926809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185926809" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185926809">Johan Commelin (Jan 17 2020 at 15:43)</a>:</h4>
<p>You mean with the pattern <code>{\it some-word}</code>?</p>

<a name="185926946"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185926946" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185926946">Alex J. Best (Jan 17 2020 at 15:44)</a>:</h4>
<p>Right, its unfortunate they don't use a more descriptive macro, but I guess that's counter to the whole philosophy of a strict subset of latex</p>

<a name="185927052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185927052" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185927052">Johan Commelin (Jan 17 2020 at 15:46)</a>:</h4>
<p>I don't expect that you'll find many false positive <code>{\it ...}</code> patterns inside definition environments.</p>

<a name="185927113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185927113" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185927113">Johan Commelin (Jan 17 2020 at 15:46)</a>:</h4>
<p>It is true that one definition environment might contain multiple definitions.</p>

<a name="185927167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185927167" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185927167">Alex J. Best (Jan 17 2020 at 15:46)</a>:</h4>
<p>I have an even babier version of what you are talking about set up for my own notes (nothing fancy at all, just matching exact strings + pluralization) but it works passably, the main difficulties are stacked adjectives (complete separated noetherian scheme) and mathematics overloading (even stacks has normal subgroups and normal schemes) I'd imagine your NLP approach would deal with the latter quite well?</p>

<a name="185927267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185927267" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185927267">Johan Commelin (Jan 17 2020 at 15:47)</a>:</h4>
<p>No, our NLP wasn't very NLP at all. IIRC we used something that Josef called "bag-of-words" and was some sort of statistical matching algorithm.</p>

<a name="185927414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185927414" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185927414">Johan Commelin (Jan 17 2020 at 15:49)</a>:</h4>
<p>We didn't pair it with any typing information. So if you had <code>Let $X$ be a scheme. ... blabla ... Hence $X$ is normal.</code> Then it wouldn't figure out that <code>normal</code> meant <code>scheme.normal</code> (if there was no occurence of the word <code>scheme</code> within the closest 10 words).</p>

<a name="185927457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185927457" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185927457">Johan Commelin (Jan 17 2020 at 15:49)</a>:</h4>
<p>In fact, if <code>group</code> occured near by (for some reason), it would likely have a false match.</p>

<a name="185927592"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185927592" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185927592">Johan Commelin (Jan 17 2020 at 15:50)</a>:</h4>
<p>Ideally, we could get a version of the Ganesalingam–BL parser. But that seems socially impossible.</p>

<a name="185928102"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185928102" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185928102">Alex J. Best (Jan 17 2020 at 15:55)</a>:</h4>
<p>Yeah that would definitely be a boost, let me know if you ever try anything like this, this problem has been something I've wanted to try and do more on for a while.</p>

<a name="185951211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185951211" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185951211">Kevin Buzzard (Jan 17 2020 at 20:02)</a>:</h4>
<blockquote>
<p>Ideally, we could get a version of the Ganesalingam–BL parser. But that seems socially impossible.</p>
</blockquote>
<p>I don't know anything about this parser. What does your second sentence mean?</p>

<a name="185951360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185951360" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185951360">Johan Commelin (Jan 17 2020 at 20:04)</a>:</h4>
<p>Mohan Ganesalingam and TBL (yes, that TBL) have a parser that eats LaTeX and spits out some weakly typed abstract syntax tree.</p>

<a name="185951373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185951373" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185951373">Johan Commelin (Jan 17 2020 at 20:04)</a>:</h4>
<p>But Mohan doesn't want to share the code.</p>

<a name="185951388"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185951388" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185951388">Johan Commelin (Jan 17 2020 at 20:04)</a>:</h4>
<p>Ask Tim Gowers for details.</p>

<a name="185954693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185954693" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185954693">Josef Urban (Jan 17 2020 at 20:41)</a>:</h4>
<p>Hi, </p>
<p>I got an e-mail ping from Johan's post.</p>
<p>The short 2015 paper about our poor-man's Stacks hyper-linker is in<br>
<a href="https://cicm-conference.org/2015/CICM2015-wip.pdf" target="_blank" title="https://cicm-conference.org/2015/CICM2015-wip.pdf">https://cicm-conference.org/2015/CICM2015-wip.pdf</a> (p. 19 - 23).</p>
<p>As for combining statistical parsing and typing, we have so far done<br>
a couple of things in the inf2formal project :</p>
<ol>
<li>
<p>Learning probabilistic grammars from the corpora and adding native<br>
   (HOL/Mizar) typing inside the probabilistic parsers (but also using<br>
   the type checking and ATP ex post). See:<br>
<a href="https://doi.org/10.1007/978-3-319-66107-0_2" target="_blank" title="https://doi.org/10.1007/978-3-319-66107-0_2">https://doi.org/10.1007/978-3-319-66107-0_2</a><br>
<a href="https://doi.org/10.1109/SYNASC.2017.00036" target="_blank" title="https://doi.org/10.1109/SYNASC.2017.00036">https://doi.org/10.1109/SYNASC.2017.00036</a> and the Flyspeck-trained<br>
   demo at <a href="http://grid01.ciirc.cvut.cz/~mptp/demo.ogv" target="_blank" title="http://grid01.ciirc.cvut.cz/~mptp/demo.ogv">http://grid01.ciirc.cvut.cz/~mptp/demo.ogv</a> .</p>
</li>
<li>
<p>Trained supervised neural translation models on synthetic<br>
   Latex-Mizar corpus: <a href="http://arxiv.org/abs/1805.06502" target="_blank" title="http://arxiv.org/abs/1805.06502">http://arxiv.org/abs/1805.06502</a> .</p>
</li>
<li>
<p>Recently we have added unsupervised neural translation (so an aligned<br>
   corpus is not needed) - <a href="https://arxiv.org/pdf/1912.02636" target="_blank" title="https://arxiv.org/pdf/1912.02636">https://arxiv.org/pdf/1912.02636</a> and<br>
   combined the neural translation with type-checking. This is so far<br>
   done by a simple data-augmentation loop between the neural net and<br>
   the Mizar elaborator (Section 5.4 of the paper). The paper<br>
   also shows that it is so far much harder to go from ProofWiki<br>
   (informal) to Mizar. To do this for Stacks, it would be good to<br>
   have at least some parts of Stacks formalized (in Lean or<br>
   whatever). I believe this is happening (Kevin, Johan &amp; Co.), so UMT<br>
   methods might probably be directly tried right now.</p>
</li>
<li>
<p>We have also started to play with neural text summarization for<br>
   e.g. conjecturing over Mizar and Stacks -<br>
<a href="http://grid01.ciirc.cvut.cz/~mptp/AITP_2020_paper_21.pdf" target="_blank" title="http://grid01.ciirc.cvut.cz/~mptp/AITP_2020_paper_21.pdf">http://grid01.ciirc.cvut.cz/~mptp/AITP_2020_paper_21.pdf</a> . Again<br>
   (unsurprisingly), Stacks looks quite a bit harder (at least for the<br>
   task we have chosen) than the nice and declarative Mizar ND proofs for<br>
   such tasks.</p>
</li>
</ol>
<p>Obviously, these are just the beginnings - the future of<br>
autoformalization is bright and unavoidable (the naysayers can bet<br>
me - see IHP Challenge 3 at <a href="http://ai4reason.org/aichallenges.html" target="_blank" title="http://ai4reason.org/aichallenges.html">http://ai4reason.org/aichallenges.html</a> ;-).</p>
<p>Josef<br>
(I am an email-driven dinosaur, ping me again via @JosefUrban if needed) <br>
(And come to <a href="http://aitp-conference.org/2020/" target="_blank" title="http://aitp-conference.org/2020/">http://aitp-conference.org/2020/</a> if interested in the topic)</p>

<a name="185955202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/CNL%20and%20the%20Stack%20Project/near/185955202" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/27935CNLandtheStackProject.html#185955202">Johan Commelin (Jan 17 2020 at 20:47)</a>:</h4>
<p><span class="user-mention" data-user-id="223577">@Josef Urban</span> Oooh, I had completely forgotten about that wip document <span aria-label="face palm" class="emoji emoji-1f926" role="img" title="face palm">:face_palm:</span> Thanks for reminding me (-;</p>


{% endraw %}

{% include archive_update.html %}