---
layout: page
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/42501Tellleanpkgtousen1cpucores.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html">Tell leanpkg to use (n-1) cpu cores</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="131029086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131029086" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131029086">Johan Commelin (Aug 07 2018 at 18:02)</a>:</h4>
<p>Yesterday I rebuilt mathlib and it froze my desktop for &gt; 2hrs. I would like to tell leanpkg to use only 3 of my 4 cores. I'm on Linux. Should I use fancy <code>cgroups</code> for this, or is there some easy method?</p>

<a name="131029518"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131029518" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131029518">Johan Commelin (Aug 07 2018 at 18:15)</a>:</h4>
<p>Hmm, maybe <code>nice leanpkg build</code> will do the job.</p>

<a name="131029520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131029520" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131029520">Johan Commelin (Aug 07 2018 at 18:15)</a>:</h4>
<p>Let's see if I stay responsive (-;</p>

<a name="131029818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131029818" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131029818">Johan Commelin (Aug 07 2018 at 18:23)</a>:</h4>
<p>Nope... on my laptop again...</p>

<a name="131029823"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131029823" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131029823">Johan Commelin (Aug 07 2018 at 18:24)</a>:</h4>
<p>Stupid <code>nice</code></p>

<a name="131029867"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131029867" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131029867">Gabriel Ebner (Aug 07 2018 at 18:24)</a>:</h4>
<p>You can use <code>lean -j3 --make</code>.  But I don't think that using all cores is the cause for your computer freezing.  It's much more likely to be memory usage.</p>

<a name="131029873"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131029873" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131029873">Johan Commelin (Aug 07 2018 at 18:24)</a>:</h4>
<p>I've got 8 GB, shouldn't that be sufficient?</p>

<a name="131029882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131029882" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131029882">Mario Carneiro (Aug 07 2018 at 18:25)</a>:</h4>
<p>the answer is always no</p>

<a name="131029957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131029957" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131029957">Johan Commelin (Aug 07 2018 at 18:26)</a>:</h4>
<p>Whelp... it is indeed using &gt;7 GB</p>

<a name="131029977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131029977" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131029977">Johan Commelin (Aug 07 2018 at 18:27)</a>:</h4>
<p>No, something is off. The lean process with niceness 10 is using only 10% of my memory.</p>

<a name="131030025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030025" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030025">Johan Commelin (Aug 07 2018 at 18:28)</a>:</h4>
<p>I've got to kill some other memory hog.</p>

<a name="131030051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030051" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030051">Johan Commelin (Aug 07 2018 at 18:29)</a>:</h4>
<p>So, do you guys have a strategy for keeping your system responsive during rebuilds? Or you only rebuild during lunch?</p>

<a name="131030201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030201" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030201">Gabriel Ebner (Aug 07 2018 at 18:32)</a>:</h4>
<p>What are you building?  I know that Lean eats memory for breakfast, but mathlib takes only 7 minutes and 1.5G of RAM here.</p>

<a name="131030367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030367" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030367">Johan Commelin (Aug 07 2018 at 18:36)</a>:</h4>
<p>I am trying to rebuild mathlib. The 1.5GB seems to be what my system is using as well.</p>

<a name="131030370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030370" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030370">Johan Commelin (Aug 07 2018 at 18:36)</a>:</h4>
<p>The 7 minutes... not really.</p>

<a name="131030379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030379" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030379">Johan Commelin (Aug 07 2018 at 18:36)</a>:</h4>
<p>It is still frozen to the core.</p>

<a name="131030557"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030557" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030557">Johan Commelin (Aug 07 2018 at 18:40)</a>:</h4>
<p>Might it be a problem that I launched the rebuild from a feature branch?</p>

<a name="131030565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030565" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030565">Johan Commelin (Aug 07 2018 at 18:41)</a>:</h4>
<p>It only had changes in 1 file, compared to mathlib HEAD.</p>

<a name="131030633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030633" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030633">Gabriel Ebner (Aug 07 2018 at 18:42)</a>:</h4>
<p>No the small change should make it faster.  But maybe the change causes a <code>by simp</code> to time out?</p>

<a name="131030649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030649" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030649">Gabriel Ebner (Aug 07 2018 at 18:42)</a>:</h4>
<p>Wait, by frozen you just mean that lean is frozen, not your whole machine?  What is the last line that lean printed?</p>

<a name="131030659"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030659" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030659">Johan Commelin (Aug 07 2018 at 18:43)</a>:</h4>
<p>No, the machine is frozen.</p>

<a name="131030669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030669" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030669">Johan Commelin (Aug 07 2018 at 18:43)</a>:</h4>
<p>I currently have a frozen <code>top</code> in front of me. I can't even issue a kill.</p>

<a name="131030723"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030723" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030723">Mario Carneiro (Aug 07 2018 at 18:44)</a>:</h4>
<p>you are awfully chatty for someone with a bricked computer</p>

<a name="131030732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030732" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030732">Johan Commelin (Aug 07 2018 at 18:44)</a>:</h4>
<p>I'm on a laptop...</p>

<a name="131030738"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030738" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030738">Johan Commelin (Aug 07 2018 at 18:45)</a>:</h4>
<p>People have &gt;3 devices with Zulip on it nowadays, don't they?</p>

<a name="131030757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030757" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030757">Johan Commelin (Aug 07 2018 at 18:45)</a>:</h4>
<p>Ok, so the last line that lean printed says that it is making stuff on Turing machines.</p>

<a name="131030761"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030761" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030761">Johan Commelin (Aug 07 2018 at 18:45)</a>:</h4>
<p>That shouldn't get me stuck.</p>

<a name="131030813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030813" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030813">Gabriel Ebner (Aug 07 2018 at 18:46)</a>:</h4>
<p>Which branch are you on?</p>

<a name="131030832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030832" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030832">Johan Commelin (Aug 07 2018 at 18:47)</a>:</h4>
<p><code>map2</code></p>

<a name="131030875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131030875" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131030875">Johan Commelin (Aug 07 2018 at 18:48)</a>:</h4>
<p>It is a feature branch that I'm trying to PR containing about 25 lines of changes in <code>linear_algebra/multivariate_polynomial.lean</code></p>

<a name="131031229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131031229" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131031229">Gabriel Ebner (Aug 07 2018 at 18:56)</a>:</h4>
<p>Good news!  The branch builds!  (Not very helpful, I know.)<br>
Can you try <code>rm **/*.olean</code> and build again?</p>

<a name="131031311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131031311" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131031311">Johan Commelin (Aug 07 2018 at 18:58)</a>:</h4>
<p>Nope, I can't... It is still frozen...</p>

<a name="131031724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131031724" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131031724">Kevin Buzzard (Aug 07 2018 at 19:07)</a>:</h4>
<p>isn't it time to reboot?</p>

<a name="131031732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131031732" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131031732">Johan Commelin (Aug 07 2018 at 19:08)</a>:</h4>
<p>It made a bit of progress! But it is still really slow.</p>

<a name="131031778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131031778" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131031778">Johan Commelin (Aug 07 2018 at 19:08)</a>:</h4>
<p>I'm one of those guys that don't like to reboot a linux box. It feels like epic failure.</p>

<a name="131033097"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131033097" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131033097">Johan Commelin (Aug 07 2018 at 19:35)</a>:</h4>
<p>Yoochai! It survived. I managed to execute <code>killall code</code>, which closed 3 instances of VScode working on different Lean projects.</p>

<a name="131033139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131033139" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131033139">Johan Commelin (Aug 07 2018 at 19:36)</a>:</h4>
<p>Now the compile is running smoothly again!</p>

<a name="131033155"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tell%20leanpkg%20to%20use%20%28n-1%29%20cpu%20cores/near/131033155" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/42501Tellleanpkgtousen1cpucores.html#131033155">Johan Commelin (Aug 07 2018 at 19:36)</a>:</h4>
<p>I guess I need more RAM</p>


{% endraw %}
