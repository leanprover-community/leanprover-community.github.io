---
layout: page
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/74703writingunicodetofile.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html">writing unicode to file</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="156363926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156363926" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156363926">Rob Lewis (Jan 18 2019 at 23:30)</a>:</h4>
<p>Does anyone have experience using file i/o with unicode characters? Lean seems to be mangling them. But I'm pretty sure something like this has worked for me in the past.</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">system</span><span class="bp">.</span><span class="n">io</span>
<span class="kn">open</span> <span class="n">io</span> <span class="n">tactic</span>
<span class="n">run_cmd</span> <span class="n">unsafe_run_io</span> <span class="err">$</span> <span class="n">do</span> <span class="n">h</span> <span class="err">←</span> <span class="n">mk_file_handle</span> <span class="s2">&quot;oops.txt&quot;</span> <span class="n">mode</span><span class="bp">.</span><span class="n">write</span><span class="o">,</span> <span class="n">fs</span><span class="bp">.</span><span class="n">put_str</span> <span class="n">h</span> <span class="s2">&quot;α β γ&quot;</span>
</pre></div>


<p>The contents of <code>oops.txt</code> are <code>� � �</code>. This is on my desktop, so no Windows nonsense going on.</p>

<a name="156363965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156363965" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156363965">Reid Barton (Jan 18 2019 at 23:31)</a>:</h4>
<p><span class="user-mention" data-user-id="110111">@Keeley Hoek</span> ^</p>

<a name="156366966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156366966" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156366966">Patrick Massot (Jan 19 2019 at 00:24)</a>:</h4>
<p><a href="https://github.com/leanprover/lean/commit/4e16bc7192f9f32b03222142e659fa3dae4b8025" target="_blank" title="https://github.com/leanprover/lean/commit/4e16bc7192f9f32b03222142e659fa3dae4b8025">https://github.com/leanprover/lean/commit/4e16bc7192f9f32b03222142e659fa3dae4b8025</a></p>

<a name="156367421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156367421" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156367421">Rob Lewis (Jan 19 2019 at 00:31)</a>:</h4>
<p>Aha. I suppose this is related to this conversation: <a href="#narrow/stream/113488-general/topic/Character.20encoding.20of.20VM/near/132250034" title="#narrow/stream/113488-general/topic/Character.20encoding.20of.20VM/near/132250034">https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Character.20encoding.20of.20VM/near/132250034</a></p>

<a name="156367559"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156367559" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156367559">Rob Lewis (Jan 19 2019 at 00:33)</a>:</h4>
<p>And it looks like I'm using an old version of Lean that doesn't include that commit!</p>

<a name="156368083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156368083" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156368083">Sebastian Ullrich (Jan 19 2019 at 00:41)</a>:</h4>
<p><em>starts writing the 3.4.2 changelog</em></p>

<a name="156374294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156374294" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156374294">Patrick Massot (Jan 19 2019 at 02:06)</a>:</h4>
<p>I'm currently compiling mathlib from scratch using Lean 3.4.2 (building on work by Bryan). I hope to open a mathlib PR very soon</p>

<a name="156374710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156374710" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156374710">Patrick Massot (Jan 19 2019 at 02:11)</a>:</h4>
<p>I'm now merging Johannes' latest commit, but it touches <code>order/basic</code> so I guess this is most recompiling from scratch...</p>

<a name="156375416"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156375416" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156375416">Patrick Massot (Jan 19 2019 at 02:20)</a>:</h4>
<p><a href="https://github.com/leanprover/mathlib/pull/609" target="_blank" title="https://github.com/leanprover/mathlib/pull/609">https://github.com/leanprover/mathlib/pull/609</a></p>

<a name="156376140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156376140" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156376140">Kevin Buzzard (Jan 19 2019 at 02:30)</a>:</h4>
<p>Is the general idea that the moment lean 3.4.2 and mathlib are playing well together, we should all switch? ooh -- I see that <a href="https://leanprover.github.io/download/" target="_blank" title="https://leanprover.github.io/download/">https://leanprover.github.io/download/</a> now links to 3.4.2 so any new users are going to end up with 3.4.2. <span class="user-mention" data-user-id="110087">@Scott Morrison</span> do any installation procedures of yours or mine need updating I wonder?</p>

<a name="156376525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156376525" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156376525">Bryan Gin-ge Chen (Jan 19 2019 at 02:34)</a>:</h4>
<p>Not quite at the moment but as soon as this PR is merged <a href="https://github.com/leanprover/mathlib/pull/610" target="_blank" title="https://github.com/leanprover/mathlib/pull/610">https://github.com/leanprover/mathlib/pull/610</a></p>

<a name="156377384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156377384" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156377384">Patrick Massot (Jan 19 2019 at 02:45)</a>:</h4>
<p>I was faster</p>

<a name="156377551"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156377551" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156377551">Bryan Gin-ge Chen (Jan 19 2019 at 02:47)</a>:</h4>
<p>Hah, I missed that, probably because I was adding comments to mine.</p>

<a name="156377662"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156377662" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156377662">Patrick Massot (Jan 19 2019 at 02:48)</a>:</h4>
<p>My PR includes your commits (using it cherry-pick`) but also the latest upstream commits</p>

<a name="156377704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156377704" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156377704">Bryan Gin-ge Chen (Jan 19 2019 at 02:49)</a>:</h4>
<p>I rebased mine on master before I PR'd so it should be up to date as well.</p>

<a name="156377836"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156377836" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156377836">Patrick Massot (Jan 19 2019 at 02:50)</a>:</h4>
<p>Ok, they should have the same effect then. I'll close mine</p>

<a name="156412063"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156412063" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156412063">Scott Morrison (Jan 19 2019 at 11:41)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> I think my installation instructions are still correct.</p>

<a name="156412120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156412120" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156412120">Scott Morrison (Jan 19 2019 at 11:42)</a>:</h4>
<p>On &lt;<a href="https://github.com/leanprover/mathlib/blob/master/docs/elan.md" target="_blank" title="https://github.com/leanprover/mathlib/blob/master/docs/elan.md">https://github.com/leanprover/mathlib/blob/master/docs/elan.md</a>&gt;, it suggests using <code>leanpkg +nightly new my_playground</code> to create a new repository.</p>

<a name="156412132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156412132" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156412132">Scott Morrison (Jan 19 2019 at 11:43)</a>:</h4>
<p>That still seems reasonable, but it might be better to add a comment explaining what <code>+nightly</code> actually does, and explaining the alternatives.</p>

<a name="156412135"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/writing%20unicode%20to%20file/near/156412135" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74703writingunicodetofile.html#156412135">Scott Morrison (Jan 19 2019 at 11:43)</a>:</h4>
<p>If anyone has advice about what should go there, I'm happy to update that file.</p>


{% endraw %}
