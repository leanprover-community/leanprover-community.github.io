---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/96591proposalforbackwardsreasoning.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html">proposal for `backwards_reasoning`</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="135383465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135383465" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135383465">Scott Morrison (Oct 08 2018 at 06:47)</a>:</h4>
<p>I'd like to propose an interactive partner for <code>solve_by_elim</code>. The idea is that it will be a tool for applying "backwards reasoning" (i.e. applying lemmas against the goal).</p>
<p>The idea is that we'll tag certain lemmas with an attribute, perhaps <code>back</code>, that are "safe" for backwards reasoning. A good example would be <code>min_fac_dvd : ∀ (n : ℕ), min_fac n ∣ n</code>. If you can unify that conclusion with the goal, you can't possibly be unhappy --- the only parameters are determined by unification, so no new goals can appear.</p>
<p><code>backwards_reasoning [x, y, z]</code>, will apply all lemmas marked with <code>@[back]</code> against the goal, as well as applying x, y, z. It will then apply <code>solve_by_elim</code> afterwards (so also applying all hypotheses). The key difference from just using <code>solve_by_elim</code> is that <code>backwards_reasoning</code> will succeed even if it doesn't close the goal, as long as it manages to apply at least one of the specified lemmas.</p>
<p>Here's an example of it in action:</p>

<a name="135383576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135383576" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135383576">Scott Morrison (Oct 08 2018 at 06:50)</a>:</h4>
<div class="codehilite"><pre><span></span>import data.nat.prime
import tactic.backwards_reasoning

open nat

-- These are all lemmas which it is sufficiently safe to `apply`
-- that they can be automatically applied by backwards_reasoning.
attribute [back] succ_lt_succ
                 fact_pos dvd_fact
                 min_fac_prime min_fac_dvd

theorem infinitude_of_primes (N : ℕ) : ∃ p ≥ N, prime p :=
begin
  let M := fact N + 1,
  let p := min_fac M,
  have pp : prime p, sorry,
  sorry,
</pre></div>


<p>Now we replace that first <code>sorry</code> with <code>backwards_reasoning</code>, and the goal <code>prime p</code> is replaced with <code>M \neq 1</code>.<br>
(If we replace <code>backwards_reasoning</code> with <code>backwards_reasoning#</code>, it prints out what it did: <code>apply min_fac_prime</code>.)</p>
<p>We then realise that a good way to proceed is<code>apply ne_of_gt</code>, so we modify the tactic to <code>backwards_reasoning [ne_of_gt]</code>.<br>
This succeeds, discharging the goal! If we replace the tactic with <code>backwards_reasoning# [ne_of_gt]</code>, it prints what it did:<br>
<code>exact min_fac_prime (ne_of_gt (succ_lt_succ (fact_pos N)))</code>.</p>
<p>If you prefer you can then copy and paste that output, replacing entirely the call to <code>backwards_reasoning</code>.</p>

<a name="135383595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135383595" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135383595">Scott Morrison (Oct 08 2018 at 06:51)</a>:</h4>
<p>(The rest of the proof of <code>infinitude_of_primes</code> can be proved in the same style.)</p>

<a name="135383599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135383599" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135383599">Johan Commelin (Oct 08 2018 at 06:51)</a>:</h4>
<p>Looks really good <span class="user-mention" data-user-id="110087">@Scott Morrison</span></p>

<a name="135383652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135383652" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135383652">Kenny Lau (Oct 08 2018 at 06:52)</a>:</h4>
<p>looks like <code>inversion</code>™ in Coq</p>

<a name="135383661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135383661" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135383661">Scott Morrison (Oct 08 2018 at 06:53)</a>:</h4>
<p>Having this be really useful requires some judicious tagging of lemmas with <code>back</code>. My suggestion to start off just by having a smattering of attributes added in the <code>tactics/backwards_reasoning.lean</code> file itself, and to consider later moving them to the point of definition if it seems useful.</p>

<a name="135383731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135383731" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135383731">Scott Morrison (Oct 08 2018 at 06:55)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span>, can you point me to some examples? The documentation I found for <a href="https://coq.inria.fr/refman/proof-engine/tactics.html" target="_blank" title="https://coq.inria.fr/refman/proof-engine/tactics.html">inversion</a> is not super helpful. :-(</p>

<a name="135383778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135383778" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135383778">Kenny Lau (Oct 08 2018 at 06:56)</a>:</h4>
<p><a href="https://coq.inria.fr/refman/proof-engine/tactics.html#coq:tacn.inversion" target="_blank" title="https://coq.inria.fr/refman/proof-engine/tactics.html#coq:tacn.inversion">you're looking at the wrong part</a></p>

<a name="135383783"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135383783" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135383783">Kenny Lau (Oct 08 2018 at 06:56)</a>:</h4>
<blockquote>
<p><code>inversion ident</code></p>
<p>Let the type of ident in the local context be (I t), where I is a (co)inductive predicate. Then, inversion applied to ident derives for each possible constructor c i of (I t), all the necessary conditions that should hold for the instance (I t) to be proved by c i.</p>
</blockquote>

<a name="135383795"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135383795" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135383795">Scott Morrison (Oct 08 2018 at 06:57)</a>:</h4>
<p>Glad you like it, <span class="user-mention" data-user-id="112680">@Johan Commelin</span>. :-) I may wait until I hear something from <span class="user-mention" data-user-id="110026">@Simon Hudon</span> or <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> before I bother cleaning it up for a PR.</p>

<a name="135383796"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135383796" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135383796">Scott Morrison (Oct 08 2018 at 06:57)</a>:</h4>
<p>But in any case I'll need some version of it before I'm willing to PR my work on limits in category theory. :-)</p>

<a name="135383836"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135383836" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135383836">Kenny Lau (Oct 08 2018 at 06:58)</a>:</h4>
<p>and in any case one should be noted that I do not know Coq at all.</p>

<a name="135383850"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135383850" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135383850">Scott Morrison (Oct 08 2018 at 06:59)</a>:</h4>
<p>Ok. It seems in any case <code>inversion</code> in Coq is quite different; whatever exactly it's doing, it's only doing one step, it's not something that chains together a whole sequence of applications.</p>

<a name="135383862"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135383862" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135383862">Mario Carneiro (Oct 08 2018 at 06:59)</a>:</h4>
<p>I don't see what <code>inversion</code> has to do with it - <code>inversion</code> is the equivalent of lean <code>cases</code></p>

<a name="135383938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135383938" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135383938">Mario Carneiro (Oct 08 2018 at 07:01)</a>:</h4>
<p>How does <code>backwards_reasoning</code> select the lemmas to apply? Does it just go through the whole list every time?</p>

<a name="135383944"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135383944" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135383944">Mario Carneiro (Oct 08 2018 at 07:01)</a>:</h4>
<p>also <code>backwards_reasoning</code> has way too many letters in it</p>

<a name="135384240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384240" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384240">Scott Morrison (Oct 08 2018 at 07:09)</a>:</h4>
<p>Yes, it just runs through the whole list every time. I have not tested this at really big scale, but (a version of this) has been in my category theory library for a while, with maybe ~50 lemmas, and it never shows up in profiling. I think <code>apply</code> fails very fast.</p>

<a name="135384254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384254" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384254">Mario Carneiro (Oct 08 2018 at 07:09)</a>:</h4>
<p>I think that if we used it in mathlib we would want to use it large scale, and then this would become a concern</p>

<a name="135384297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384297" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384297">Scott Morrison (Oct 08 2018 at 07:10)</a>:</h4>
<blockquote>
<p>also <code>backwards_reasoning</code> has way too many letters in it</p>
</blockquote>
<p>I could rename it <code>br</code>, if you prefer. :-). How about just <code>back</code>?</p>

<a name="135384308"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384308" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384308">Mario Carneiro (Oct 08 2018 at 07:10)</a>:</h4>
<p>indeed I get the sense that it's not very useful unless it is marked everywhere</p>

<a name="135384311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384311" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384311">Sebastien Gouezel (Oct 08 2018 at 07:10)</a>:</h4>
<p>If I understand correctly, you're creating a version of <code>apply_rules</code> on steroids, with additionally a set of default rules to be applied, right?</p>

<a name="135384317"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384317" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384317">Scott Morrison (Oct 08 2018 at 07:10)</a>:</h4>
<p>That sounds about right.</p>

<a name="135384321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384321" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384321">Mario Carneiro (Oct 08 2018 at 07:10)</a>:</h4>
<p>I admit I don't understand <code>apply_rules</code> usage</p>

<a name="135384327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384327" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384327">Scott Morrison (Oct 08 2018 at 07:11)</a>:</h4>
<p>(I have not used apply_rules, but I've seen the implementation.)</p>

<a name="135384338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384338" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384338">Scott Morrison (Oct 08 2018 at 07:11)</a>:</h4>
<p>I guess we could have 'sub-attributes', to mark lemmas as relevant in certain domains.</p>

<a name="135384396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384396" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384396">Scott Morrison (Oct 08 2018 at 07:12)</a>:</h4>
<p>The other solution is just to accept that <code>backwards_reasoning</code> is a slow tactic, and you're meant to switch to <code>backwards_reasoning#</code> once you've discovered the proof, and copy-paste the trace output.</p>

<a name="135384409"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384409" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384409">Scott Morrison (Oct 08 2018 at 07:12)</a>:</h4>
<p>(And just not worry about slow tactics, because we all have 30 cores, right?)</p>

<a name="135384528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384528" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384528">Sebastien Gouezel (Oct 08 2018 at 07:15)</a>:</h4>
<p>If you want to go even further in this direction, let me mention the syntax of the Isabelle swiss army knife <code>auto</code>. Some rules in Isabelle are marked <code>[intro]</code>, or <code>[intro!]</code> (the first one would be unsafe rules to be applied in backward reasoning, the second one for safe rules). In the same way there are simp rules. And all of this can be combined with</p>
<div class="codehilite"><pre><span></span>auto (simp: foo_simp, bar_simp, intro:  foo_intro, bar_intro)
</pre></div>


<p>which will apply eagerly the rules <code>foo_intro</code> or <code>bar_intro</code> and the rules marked <code>[intro!]</code> in the library (and also the <code>[intro]</code> ones if their assumptions can be checked right away), simplify everything using the simplifier with the additional rules <code>foo_simp</code> and <code>bar_simp</code>, and go over again. All this with some amount of backtracking that can be controlled. 90% of Isabelle proofs are <code>auto</code>proofs...</p>

<a name="135384636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384636" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384636">Scott Morrison (Oct 08 2018 at 07:17)</a>:</h4>
<p>Thanks for this description, <span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span>!</p>

<a name="135384708"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384708" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384708">Scott Morrison (Oct 08 2018 at 07:18)</a>:</h4>
<p>My version of <code>tidy</code> in the category theory library has been using <code>backwards_reasoning</code> all along, and the main loop of <code>tidy</code> causes it to bounce back and forth between <code>backwards_reasoning</code> and <code>simp</code>. :-) Good to know I was re-inventing <code>auto</code>.</p>

<a name="135384713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384713" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384713">Johan Commelin (Oct 08 2018 at 07:18)</a>:</h4>
<p><span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span> And do those proofs remain <code>auto</code>, or do they get replaced by some unreadable proof that <code>auto</code> found? In other words: is this fast, and how does Isabelle solve the speed issues that we are hitting now in Lean?</p>

<a name="135384719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384719" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384719">Scott Morrison (Oct 08 2018 at 07:19)</a>:</h4>
<p>(Of course, <code>tidy</code> does many other things in the loop, for better or worse.)</p>

<a name="135384780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384780" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384780">Scott Morrison (Oct 08 2018 at 07:20)</a>:</h4>
<p>My private <code>backwards_reasoning</code> also makes the distinction analogous to <code>[intro]</code> vs <code>[intro!]</code>, but I haven't reimplemented that completely in the new backwards_reasoning I've just been describing.</p>

<a name="135384964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135384964" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135384964">Sebastien Gouezel (Oct 08 2018 at 07:25)</a>:</h4>
<blockquote>
<p><span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span> And do those proofs remain <code>auto</code>, or do they get replaced by some unreadable proof that <code>auto</code> found? In other words: is this fast, and how does Isabelle solve the speed issues that we are hitting now in Lean?</p>
</blockquote>
<p>There are no speed issues in Isabelle. <code>auto</code> is extremely fast, but this is certainly related to the lack of dependent types and unification, which makes everything much simpler.</p>

<a name="135385652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135385652" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135385652">Kevin Buzzard (Oct 08 2018 at 07:40)</a>:</h4>
<p>Anyone who watched <span class="user-mention" data-user-id="110087">@Scott Morrison</span> 's video of his Adelaide talk will have seen a pretty stunning application of <code>backwards_reasoning</code>. It was very well-delivered too. He was formalising proof of infinitely many primes and getting his hands dirty. "Oh we'll just skip this", "oh we'll come back to this later", "Oh Ok so now we've proved there are infinitely many primes modulo 5 sorries which clearly are going to be the hard work", "oh look, globally replacing <code>sorry</code> with <code>backwards_reasoning</code> closes the goal!"</p>

<a name="135385811"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135385811" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135385811">Mario Carneiro (Oct 08 2018 at 07:45)</a>:</h4>
<p>what do you mean lack of unification?</p>

<a name="135386143"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135386143" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135386143">Scott Morrison (Oct 08 2018 at 07:53)</a>:</h4>
<p>Okay, that demo in Adelaide was a bit misleading. Way too many things were marked <code>@[back]</code>, that in practice we couldn't avoid.</p>

<a name="135386148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135386148" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135386148">Scott Morrison (Oct 08 2018 at 07:53)</a>:</h4>
<p>It's going to be a little while before <code>backwards_reasoning</code> or friends really does what it appeared to do there...</p>

<a name="135386584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135386584" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135386584">Kevin Buzzard (Oct 08 2018 at 08:02)</a>:</h4>
<p>That doesn't matter. The point was made.</p>

<a name="135386607"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135386607" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135386607">Kevin Buzzard (Oct 08 2018 at 08:03)</a>:</h4>
<p>I will be doing the same thing in Sheffield; showing the audience how proving <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>x</mi><mo>+</mo><mi>y</mi><msup><mo>)</mo><mn>3</mn></msup><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mn>3</mn><msup><mi>x</mi><mn>2</mn></msup><mi>y</mi><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">(x+y)^3=x^3+3x^2y+...</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base"><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">3</span></span></span></span></span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">3</span></span></span></span></span></span></span></span><span class="mbin">+</span><span class="mord mathrm">3</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span></span></span></span></span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mbin">+</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span></span></span></span> is really hard from the axioms and then solving it using automation</p>

<a name="135386652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135386652" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135386652">Kevin Buzzard (Oct 08 2018 at 08:04)</a>:</h4>
<p>Mathematicians need to understand that doing simple maths might be simple in Lean.</p>

<a name="135386668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135386668" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135386668">Kevin Buzzard (Oct 08 2018 at 08:04)</a>:</h4>
<p>The more we say it's true and the more we work on cases where it is not true (like <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>≅</mo><mi>B</mi><mo>→</mo><mi>S</mi><mi>p</mi><mi>e</mi><mi>c</mi><mo>(</mo><mi>A</mi><mo>)</mo><mo>≅</mo><mi>S</mi><mi>p</mi><mi>e</mi><mi>c</mi><mo>(</mo><mi>B</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">A\cong B\to Spec(A)\cong Spec(B)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit">A</span><span class="mrel">≅</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mrel">→</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mord mathit">c</span><span class="mopen">(</span><span class="mord mathit">A</span><span class="mclose">)</span><span class="mrel">≅</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mord mathit">c</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span>) the more it will become true</p>

<a name="135386691"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135386691" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135386691">Kevin Buzzard (Oct 08 2018 at 08:05)</a>:</h4>
<p>If it's easy in maths, we need to try and make it easy in Lean.</p>

<a name="135388213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135388213" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135388213">Patrick Massot (Oct 08 2018 at 08:32)</a>:</h4>
<p>I also liked the backward reasoning demo in Adelaide, but I struggled with the name. Of course I'm not a native English speaker but, to me, <code>backward_reasoning</code> sounds like we are doing something wrong (like using <code>P -&gt; Q</code> to prove <code>P</code> from <code>Q</code>).</p>

<a name="135394086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135394086" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135394086">Johan Commelin (Oct 08 2018 at 10:42)</a>:</h4>
<p>How far are we from this turning into a PR?</p>

<a name="135394249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135394249" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135394249">Scott Morrison (Oct 08 2018 at 10:46)</a>:</h4>
<p>Close.</p>

<a name="135394254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135394254" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135394254">Scott Morrison (Oct 08 2018 at 10:46)</a>:</h4>
<p>But I have grumpy coauthors back in the real world. :-)</p>

<a name="135406314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135406314" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135406314">Simon Hudon (Oct 08 2018 at 14:18)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="110087">@Scott Morrison</span>! Sorry I got distracted by this sleeping thing. This looks really cool! I think we can do things much faster than going through the whole list of lemmas and we may not hit the performance wall that we did with simp. </p>
<p>A bit like <code>simp</code>, we can index <code>back</code> lemmas using the head symbol of the rhs of its pi type. Then, the number of candidate at each step should be much smaller. I'd have to think some more about further optimizations but I think Isabelle suggests it must be possible to do things really fast</p>

<a name="135436974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135436974" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135436974">Scott Morrison (Oct 09 2018 at 01:02)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="110026">@Simon Hudon</span>, indexing sounds great. How hard do you think this would be? I'm not confident I could implement it efficiently, but especially if you can give me a pointer to something similar I can give it a try. If I pushed a branch, I'd be very happy if you wanted to look at doing this.</p>

<a name="135436986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135436986" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135436986">Scott Morrison (Oct 09 2018 at 01:03)</a>:</h4>
<p>I also want to implement two attributes, analogous to [intro] and [intro!] in Isabelle, for lemmas that it's always safe to apply, vs lemmas that should only be applied if their hypotheses can immediately be solved. I already had this in my original implementation of <code>back</code>, but it's not in the current one. Perhaps I should do this first, and then we can think about indexing?</p>

<a name="135437029"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135437029" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135437029">Simon Hudon (Oct 09 2018 at 01:04)</a>:</h4>
<p>Sure, no problems. You can also have a look at the user attribute for extensionality if you want to try it before I get into it</p>

<a name="135437035"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135437035" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135437035">Simon Hudon (Oct 09 2018 at 01:04)</a>:</h4>
<p>Sure</p>

<a name="135437056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135437056" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135437056">Simon Hudon (Oct 09 2018 at 01:05)</a>:</h4>
<p>You can do one <code>intro</code> attribute and use <code>!</code> as a parameter</p>

<a name="135519236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135519236" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135519236">Scott Morrison (Oct 10 2018 at 05:06)</a>:</h4>
<p><span class="user-mention" data-user-id="110026">@Simon Hudon</span> , can you point me to examples of using a token like <code>!</code> as a parameter to an attribute?</p>

<a name="135519868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135519868" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135519868">Mario Carneiro (Oct 10 2018 at 05:24)</a>:</h4>
<p><code>intro!</code> is an attribute</p>

<a name="135519872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135519872" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135519872">Mario Carneiro (Oct 10 2018 at 05:24)</a>:</h4>
<p>but I think the parsing for that is in core</p>

<a name="135519888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135519888" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135519888">Mario Carneiro (Oct 10 2018 at 05:25)</a>:</h4>
<p>The parsing for an attribute is just a regular <code>lean.parser</code> monad thing, so you can use <code>tk "!"?</code> to get a possible <code>!</code> token</p>

<a name="135519943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135519943" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135519943">Mario Carneiro (Oct 10 2018 at 05:27)</a>:</h4>
<p>If you want an example of an attribute with arguments, look at <code>to_additive_attr</code> in <code>algebra.group</code>. You specify the type of the parsed result in one of the optional arguments to <code>user_attribute</code>, and you give the parser itself in the <code>parser := </code> field</p>

<a name="135520477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/proposal%20for%20%60backwards_reasoning%60/near/135520477" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/96591proposalforbackwardsreasoning.html#135520477">Scott Morrison (Oct 10 2018 at 05:44)</a>:</h4>
<p>Thanks. I've just made a PR at <a href="#narrow/stream/144837-PR-reviews/subject/.23410.20backwards.20reasoning" title="#narrow/stream/144837-PR-reviews/subject/.23410.20backwards.20reasoning">https://leanprover.zulipchat.com/#narrow/stream/144837-PR-reviews/subject/.23410.20backwards.20reasoning</a>, so perhaps anything further on this thread can go there.</p>


{% endraw %}

{% include archive_update.html %}