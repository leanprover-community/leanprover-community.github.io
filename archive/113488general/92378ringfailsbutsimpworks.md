---
layout: page
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/92378ringfailsbutsimpworks.html
---

## Stream: [general](index.html)
### Topic: [ring fails but simp works](92378ringfailsbutsimpworks.html)

---


{% raw %}
#### [ Chris Hughes (Apr 08 2018 at 21:50)](https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20fails%20but%20simp%20works/near/124808425):
<p>In the following context <code>simp [mul_comm, mul_left_comm, mul_assoc]</code> solved the goal, but <code>ring</code> failed. What's going on?</p>
<div class="codehilite"><pre><span></span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">,</span>
<span class="bp">_</span><span class="n">inst_2</span> <span class="o">:</span> <span class="n">comm_ring</span> <span class="n">R</span><span class="o">,</span>
<span class="n">L</span> <span class="o">:</span> <span class="n">list</span> <span class="n">R</span><span class="o">,</span>
<span class="n">H</span> <span class="o">:</span> <span class="mi">1</span> <span class="err">∈</span> <span class="n">generate</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">|</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">L</span><span class="o">},</span>
<span class="n">s</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">L</span><span class="o">)),</span> <span class="n">loc</span> <span class="n">R</span> <span class="o">(</span><span class="n">powers</span> <span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span><span class="o">)),</span>
<span class="n">h</span> <span class="o">:</span> <span class="n">β</span> <span class="n">L</span> <span class="n">s</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
<span class="n">t</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">L</span><span class="o">)),</span> <span class="n">R</span> <span class="bp">×</span> <span class="err">↥</span><span class="o">(</span><span class="n">powers</span> <span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span><span class="o">))</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">L</span><span class="o">)),</span> <span class="n">out</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">),</span>
<span class="n">r</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">L</span><span class="o">)</span> <span class="bp">→</span> <span class="bp">ℕ</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">L</span><span class="o">)),</span> <span class="n">some</span> <span class="bp">_</span><span class="o">,</span>
<span class="n">hst</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">L</span><span class="o">)),</span> <span class="n">s</span> <span class="n">i</span> <span class="bp">=</span> <span class="err">⟦</span><span class="o">((</span><span class="n">t</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">fst</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="err">^</span> <span class="n">r</span> <span class="n">i</span><span class="o">,</span> <span class="bp">_⟩</span><span class="o">)</span><span class="err">⟧</span><span class="o">,</span>
<span class="n">hi</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">L</span><span class="o">)),</span> <span class="n">s</span> <span class="n">i</span> <span class="bp">=</span> <span class="err">⟦</span><span class="o">((</span><span class="n">t</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">fst</span><span class="o">,</span> <span class="bp">⟨</span><span class="o">((</span><span class="n">t</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">snd</span><span class="o">)</span><span class="bp">.</span><span class="n">val</span><span class="o">,</span> <span class="bp">_⟩</span><span class="o">)</span><span class="err">⟧</span><span class="o">,</span>
<span class="n">hβ</span> <span class="o">:</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">L</span><span class="o">)),</span>
    <span class="err">⟦</span><span class="o">((</span><span class="n">t</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">fst</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">j</span> <span class="err">^</span> <span class="n">r</span> <span class="n">i</span><span class="o">,</span> <span class="bp">⟨</span><span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">j</span><span class="o">)</span> <span class="err">^</span> <span class="n">r</span> <span class="n">i</span><span class="o">,</span> <span class="bp">_⟩</span><span class="o">)</span><span class="err">⟧</span> <span class="bp">=</span>
      <span class="err">⟦</span><span class="o">((</span><span class="n">t</span> <span class="n">j</span><span class="o">)</span><span class="bp">.</span><span class="n">fst</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="err">^</span> <span class="n">r</span> <span class="n">j</span><span class="o">,</span> <span class="bp">⟨</span><span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">j</span><span class="o">)</span> <span class="err">^</span> <span class="n">r</span> <span class="n">j</span><span class="o">,</span> <span class="bp">_⟩</span><span class="o">)</span><span class="err">⟧</span><span class="o">,</span>
<span class="n">this</span> <span class="o">:</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">L</span><span class="o">)),</span>
    <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span>
      <span class="o">((</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">j</span><span class="o">)</span> <span class="err">^</span> <span class="n">r</span> <span class="n">i</span> <span class="bp">*</span> <span class="o">((</span><span class="n">t</span> <span class="n">j</span><span class="o">)</span><span class="bp">.</span><span class="n">fst</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="err">^</span> <span class="n">r</span> <span class="n">j</span><span class="o">)</span> <span class="bp">-</span> <span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">j</span><span class="o">)</span> <span class="err">^</span> <span class="n">r</span> <span class="n">j</span> <span class="bp">*</span> <span class="o">((</span><span class="n">t</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">fst</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">j</span> <span class="err">^</span> <span class="n">r</span> <span class="n">i</span><span class="o">))</span> <span class="bp">*</span>
          <span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">j</span><span class="o">)</span> <span class="err">^</span> <span class="n">n</span> <span class="bp">=</span>
        <span class="mi">0</span><span class="o">,</span>
<span class="n">n</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">L</span><span class="o">)</span> <span class="bp">→</span> <span class="n">fin</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">L</span><span class="o">)</span> <span class="bp">→</span> <span class="bp">ℕ</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">L</span><span class="o">)),</span> <span class="n">some</span> <span class="bp">_</span> <span class="bp">+</span> <span class="n">r</span> <span class="n">i</span> <span class="bp">+</span> <span class="n">r</span> <span class="n">j</span><span class="o">,</span>
<span class="n">hn</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">L</span><span class="o">)),</span> <span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="err">^</span> <span class="n">r</span> <span class="n">i</span> <span class="bp">*</span> <span class="o">(</span><span class="n">t</span> <span class="n">j</span><span class="o">)</span><span class="bp">.</span><span class="n">fst</span> <span class="bp">-</span> <span class="n">f</span> <span class="n">L</span> <span class="n">j</span> <span class="err">^</span> <span class="n">r</span> <span class="n">j</span> <span class="bp">*</span> <span class="o">(</span><span class="n">t</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">fst</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">j</span><span class="o">)</span> <span class="err">^</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
<span class="n">N</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="o">:=</span> <span class="n">sum</span> <span class="n">univ</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">ij</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">L</span><span class="o">)</span> <span class="bp">×</span> <span class="n">fin</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">L</span><span class="o">)),</span> <span class="n">n</span> <span class="o">(</span><span class="n">ij</span><span class="bp">.</span><span class="n">fst</span><span class="o">)</span> <span class="o">(</span><span class="n">ij</span><span class="bp">.</span><span class="n">snd</span><span class="o">)),</span>
<span class="n">Nlt</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">L</span><span class="o">)),</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span> <span class="bp">≤</span> <span class="n">N</span><span class="o">,</span>
<span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">L</span><span class="o">)</span>
<span class="err">⊢</span> <span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="err">^</span> <span class="n">r</span> <span class="n">i</span> <span class="bp">*</span> <span class="o">(</span><span class="n">t</span> <span class="n">j</span><span class="o">)</span><span class="bp">.</span><span class="n">fst</span> <span class="bp">*</span> <span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="err">^</span> <span class="o">(</span><span class="n">N</span> <span class="bp">-</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span><span class="o">)</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">j</span> <span class="err">^</span> <span class="o">(</span><span class="n">N</span> <span class="bp">-</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="err">^</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">j</span> <span class="err">^</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span><span class="o">))</span> <span class="bp">+</span>
      <span class="bp">-</span><span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">j</span> <span class="err">^</span> <span class="n">r</span> <span class="n">j</span> <span class="bp">*</span> <span class="o">(</span><span class="n">t</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">fst</span> <span class="bp">*</span> <span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="err">^</span> <span class="o">(</span><span class="n">N</span> <span class="bp">-</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span><span class="o">)</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">j</span> <span class="err">^</span> <span class="o">(</span><span class="n">N</span> <span class="bp">-</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="err">^</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">j</span> <span class="err">^</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span><span class="o">)))</span> <span class="bp">=</span>
    <span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="err">^</span> <span class="n">r</span> <span class="n">i</span> <span class="bp">*</span> <span class="o">(</span><span class="n">t</span> <span class="n">j</span><span class="o">)</span><span class="bp">.</span><span class="n">fst</span> <span class="bp">*</span> <span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="err">^</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">j</span> <span class="err">^</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="err">^</span> <span class="o">(</span><span class="n">N</span> <span class="bp">-</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span><span class="o">)</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">j</span> <span class="err">^</span> <span class="o">(</span><span class="n">N</span> <span class="bp">-</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span><span class="o">))</span> <span class="bp">+</span>
      <span class="bp">-</span><span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">j</span> <span class="err">^</span> <span class="n">r</span> <span class="n">j</span> <span class="bp">*</span> <span class="o">(</span><span class="n">t</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">fst</span> <span class="bp">*</span> <span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="err">^</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">j</span> <span class="err">^</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">f</span> <span class="n">L</span> <span class="n">i</span> <span class="err">^</span> <span class="o">(</span><span class="n">N</span> <span class="bp">-</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span><span class="o">)</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">L</span> <span class="n">j</span> <span class="err">^</span> <span class="o">(</span><span class="n">N</span> <span class="bp">-</span> <span class="n">n</span> <span class="n">i</span> <span class="n">j</span><span class="o">)))</span>
</pre></div>


{% endraw %}
