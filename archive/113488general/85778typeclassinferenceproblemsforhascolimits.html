---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/85778typeclassinferenceproblemsforhascolimits.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/85778typeclassinferenceproblemsforhascolimits.html">typeclass inference problems for `has_colimits`</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="162678972"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/typeclass%20inference%20problems%20for%20%60has_colimits%60/near/162678972" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/85778typeclassinferenceproblemsforhascolimits.html#162678972">Scott Morrison (Apr 06 2019 at 02:35)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="110032">@Reid Barton</span>, I am getting lots of strange errors that claim to be about typeclass inference for <code>has_colimits</code>. A typical example is:</p>
<div class="codehilite"><pre><span></span>failed to synthesize type class instance for
C : Type u,
ùíû : category C,
_inst_1 : has_colimits C,
F G H : PresheafedSpace C,
Œ± : F ‚ü∂ G,
Œ≤ : G ‚ü∂ H,
x : ‚Ü•(F.X)
‚ä¢ Œ† {J : Type v} {ùí• : small_category J} (F : J ‚•§ C), has_colimit F
</pre></div>

<a name="162678974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/typeclass%20inference%20problems%20for%20%60has_colimits%60/near/162678974" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/85778typeclassinferenceproblemsforhascolimits.html#162678974">Scott Morrison (Apr 06 2019 at 02:35)</a>:</h4>
<p>(The goal is just the definition of <code>has_colimits C</code>.)</p>

<a name="162678975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/typeclass%20inference%20problems%20for%20%60has_colimits%60/near/162678975" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/85778typeclassinferenceproblemsforhascolimits.html#162678975">Scott Morrison (Apr 06 2019 at 02:35)</a>:</h4>
<p>Do you have any idea what going on here?</p>

<a name="162679093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/typeclass%20inference%20problems%20for%20%60has_colimits%60/near/162679093" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/85778typeclassinferenceproblemsforhascolimits.html#162679093">Scott Morrison (Apr 06 2019 at 02:38)</a>:</h4>
<p>The current place it is cropping up, very mysteriously is <a href="https://github.com/leanprover-community/mathlib/commit/1989f232953a5e035cf7597b73dd105149f93edd#diff-974f155b519a3688df42f3dbb27a7207R72" target="_blank" title="https://github.com/leanprover-community/mathlib/commit/1989f232953a5e035cf7597b73dd105149f93edd#diff-974f155b519a3688df42f3dbb27a7207R72">here</a>, and for now blocking me working on stalks.</p>

<a name="162679099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/typeclass%20inference%20problems%20for%20%60has_colimits%60/near/162679099" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/85778typeclassinferenceproblemsforhascolimits.html#162679099">Scott Morrison (Apr 06 2019 at 02:38)</a>:</h4>
<p>Is it some strange bug in Lean dealing with <code>[class]</code> attributes on function types?</p>

<a name="162679102"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/typeclass%20inference%20problems%20for%20%60has_colimits%60/near/162679102" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/85778typeclassinferenceproblemsforhascolimits.html#162679102">Scott Morrison (Apr 06 2019 at 02:39)</a>:</h4>
<p>Or maybe I'm doing something dumb.</p>

<a name="162680400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/typeclass%20inference%20problems%20for%20%60has_colimits%60/near/162680400" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/85778typeclassinferenceproblemsforhascolimits.html#162680400">Reid Barton (Apr 06 2019 at 03:09)</a>:</h4>
<p>Yeah I've seen errors like this before. It seems that the <code>@[class] def has_colimits :=</code> a Pi-type doesn't actually totally work, even though it seems to mostly work. It takes some slightly complicated setup for it to stop working and I never got to the bottom of it.<br>
I think we just need to change each of the classes to be a structure</p>

<a name="162680479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/typeclass%20inference%20problems%20for%20%60has_colimits%60/near/162680479" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/85778typeclassinferenceproblemsforhascolimits.html#162680479">Reid Barton (Apr 06 2019 at 03:10)</a>:</h4>
<p>with instances that specialize <code>has_colimits</code> -&gt; <code>has_colimits_of_shape</code> -&gt; <code>has_colimit</code></p>

<a name="162680485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/typeclass%20inference%20problems%20for%20%60has_colimits%60/near/162680485" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/85778typeclassinferenceproblemsforhascolimits.html#162680485">Reid Barton (Apr 06 2019 at 03:10)</a>:</h4>
<p>and you won't be able to go back the other way from <code>Pi J, has_colimits_of_shape J</code> to <code>has_colimits</code> automatically, but that probably doesn't really matter in practice</p>

<a name="162683857"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/typeclass%20inference%20problems%20for%20%60has_colimits%60/near/162683857" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/85778typeclassinferenceproblemsforhascolimits.html#162683857">Scott Morrison (Apr 06 2019 at 04:34)</a>:</h4>
<p>ok. I will try this out at some point.</p>


{% endraw %}
