---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/19983weirdvscodetroubles.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html">weird vscode troubles?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="189899773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189899773" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189899773">Gabriel Ebner (Mar 06 2020 at 14:48)</a>:</h4>
<p>Sometimes the error squiggles in vscode appear at the beginning of the file instead of the correct position.  The info view is correct, though?  Does this happen to anyone else?</p>

<a name="189899828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189899828" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189899828">Bryan Gin-ge Chen (Mar 06 2020 at 14:49)</a>:</h4>
<p>Uh-oh. I wonder if I introduced a bug when I edited the diagnostics file.</p>

<a name="189899981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189899981" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189899981">Bryan Gin-ge Chen (Mar 06 2020 at 14:50)</a>:</h4>
<p>I'm not sure but my guess would be that <a href="https://github.com/leanprover/vscode-lean/blob/master/src/diagnostics.ts#L35" target="_blank" title="https://github.com/leanprover/vscode-lean/blob/master/src/diagnostics.ts#L35">these lines</a> are failing and you end up with a bad range.</p>

<a name="189900020"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189900020" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189900020">Bryan Gin-ge Chen (Mar 06 2020 at 14:51)</a>:</h4>
<p>Do you have a reliable reproduction? I can try to look into this.</p>

<a name="189900185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189900185" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189900185">Gabriel Ebner (Mar 06 2020 at 14:53)</a>:</h4>
<p>Not really.  Most of the time restarting vscode seems to fix it.  If I see it the next time, is there anything I can do to gather more information?</p>

<a name="189900192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189900192" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189900192">Sebastien Gouezel (Mar 06 2020 at 14:53)</a>:</h4>
<p>Yes, it also happens to me currently.</p>

<a name="189901142"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189901142" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189901142">Bryan Gin-ge Chen (Mar 06 2020 at 15:02)</a>:</h4>
<p>I don't know of an easy way to collect more info when it fails, unfortunately. Does it tend to happen when you're opening a file or just randomly when you're editing and errors pop up?</p>

<a name="189901225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189901225" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189901225">Gabriel Ebner (Mar 06 2020 at 15:03)</a>:</h4>
<p>It used to only happen while I was editing a file.  Now it also happens when I first open the file.  And restarting vscode does not fix it.</p>

<a name="189901420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189901420" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189901420">Bryan Gin-ge Chen (Mar 06 2020 at 15:05)</a>:</h4>
<p>OK, I can reproduce the bug after some random editing. Let me work on this for a bit.</p>

<a name="189904864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189904864" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189904864">Bryan Gin-ge Chen (Mar 06 2020 at 15:42)</a>:</h4>
<p><a href="https://github.com/leanprover/vscode-lean/pull/147" target="_blank" title="https://github.com/leanprover/vscode-lean/pull/147">https://github.com/leanprover/vscode-lean/pull/147</a></p>

<a name="189904949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189904949" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189904949">Bryan Gin-ge Chen (Mar 06 2020 at 15:42)</a>:</h4>
<p>I think this should fix it. Sorry about this!</p>

<a name="189906315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189906315" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189906315">Gabriel Ebner (Mar 06 2020 at 15:56)</a>:</h4>
<p>I've just released 0.15.8.  Let's hope that this was the issue!</p>

<a name="189909931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189909931" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189909931">Scott Morrison (Mar 06 2020 at 16:32)</a>:</h4>
<p>Yep, that fixed it.</p>

<a name="189910480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189910480" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189910480">Gabriel Ebner (Mar 06 2020 at 16:38)</a>:</h4>
<p>That's good to hear.  In the future please feel free to complain about the vscode extension, in particular if it suddenly gets worse.</p>

<a name="189910557"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189910557" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189910557">Scott Morrison (Mar 06 2020 at 16:39)</a>:</h4>
<p>I only noticed it late last night, and hadn't gotten around to complaining. :-)</p>

<a name="189913582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189913582" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189913582">Kevin Buzzard (Mar 06 2020 at 17:10)</a>:</h4>
<p>We also noticed it at Xena, I just assumed it was some student who had done a crazy thing -- and then it happened to me later :-)</p>

<a name="189926331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189926331" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189926331">Floris van Doorn (Mar 06 2020 at 19:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110043">Gabriel Ebner</span> <a href="#narrow/stream/113488-general/topic/weird.20vscode.20troubles.3F/near/189910480" title="#narrow/stream/113488-general/topic/weird.20vscode.20troubles.3F/near/189910480">said</a>:</p>
<blockquote>
<p>That's good to hear.  In the future please feel free to complain about the vscode extension, in particular if it suddenly gets worse.</p>
</blockquote>
<p>One thing I'm noticing lately (since a couple of weeks) is that it takes longer for the extension to "start up" (it sometimes takes 5+ seconds to even start showing the "busy" yellow lines). My guess is that this has to do with the different versions of Lean. I never updated my "default" Lean version, so maybe it's busy changing Lean to the version specified in <code>leanpkg.toml</code>.<br>
I just tested:  opening a file that doesn't import anything from mathlib took about 1 second before starting to show yellow lines, but opening a file that imports all of mathlib took ~20 seconds before starting to show yellow lines.</p>

<a name="189926865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189926865" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189926865">Kevin Buzzard (Mar 06 2020 at 19:39)</a>:</h4>
<p>I haven't had this problem on Ubuntu, but then again I'm not sure I know how to import all of mathlib.</p>

<a name="189926898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189926898" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189926898">Kevin Buzzard (Mar 06 2020 at 19:39)</a>:</h4>
<p>Is your lean executable path set to something funny in VS Code? Mine just says <code>lean</code></p>

<a name="189926968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189926968" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189926968">Kevin Buzzard (Mar 06 2020 at 19:40)</a>:</h4>
<p>oh wow, on my laptop this field is empty. On my desktop it says <code>lean</code>. I don't even know which one is right.</p>

<a name="189927018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189927018" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189927018">Floris van Doorn (Mar 06 2020 at 19:41)</a>:</h4>
<p>It just says <code>lean</code>.</p>

<a name="189927469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189927469" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189927469">Kevin Buzzard (Mar 06 2020 at 19:46)</a>:</h4>
<p>Try deleting it and see if it helps :-)</p>

<a name="189929179"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189929179" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189929179">Gabriel Ebner (Mar 06 2020 at 20:04)</a>:</h4>
<p>I fear that's not the fault of the vscode extension.  mathlib just keeps growing. <span aria-label="shrug" class="emoji emoji-1f937" role="img" title="shrug">:shrug:</span> </p>
<div class="codehilite"><pre><span></span>$ echo import all &gt; import_all.lean
$ time lean import_all.lean
9.80user 0.38system 0:10.13elapsed 100%CPU (0avgtext+0avgdata 978980maxresident)k
0inputs+0outputs (0major+245091minor)pagefaults 0swaps
</pre></div>


<p>(This is on my desktop with a nice SSD.) I just timed it, and it also takes 10s from typing <code>code .</code> until the yellow bar goes away.  It might be misleading that the yellow bar doesn't come on until a few seconds after the server starts up.  I believe it starts showing after we've read the oleans for all the imports.  (The server sends the lines to highlight, so this is not something we can easily fix in the vscode extension itself.)</p>

<a name="189931562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/189931562" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#189931562">Floris van Doorn (Mar 06 2020 at 20:37)</a>:</h4>
<p>Ah, ok. If it's already busy importing (or at least reading) files before the yellow lines show up, then this behavior makes sense. Thanks for checking on this <span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span></p>

<a name="190021950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/weird%20vscode%20troubles%3F/near/190021950" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/19983weirdvscodetroubles.html#190021950">Kevin Buzzard (Mar 08 2020 at 17:53)</a>:</h4>
<p>Something which has been bugging me for about a week or so with VS Code: I often want to see the definition of term. I tend to move my cursor onto the term,  and then right-click -&gt; go to definition. Recently, if the term is relatively near the top of the screen and has a large docstring, then the docstring has started appearing directly under the cursor, stopping me from being able to right-click! I think by default the hover-window or whatever it's called (the transient thing) appears safely above the term, but if the term is near the top of the VS Code window then instead of appearing below it, it appears on top of it. Did something change or are my reflexes just getting slower?</p>


{% endraw %}

{% include archive_update.html %}