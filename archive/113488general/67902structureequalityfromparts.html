---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/67902structureequalityfromparts.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html">structure equality from parts</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="124033267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124033267" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124033267">Nicholas Scheel (Mar 21 2018 at 22:12)</a>:</h4>
<p>Hi, I'm totally new here, I've spent about a day with Lean so far.</p>
<p>Currently I'm struggling to define a notion of equality for this structure (permutations aka bijective functions, which I represent with a function and its inverse, and the proof that they are inverses):</p>
<div class="codehilite"><pre><span></span>structure Perm (α : Type) :=
permute ::
  (forward : α → α) (backward : α → α)
  (are_inv : function.left_inverse forward backward ∧ function.right_inverse forward backward)
</pre></div>


<p>It appears that Lean understands <code>refl</code> enough to let me do the following:</p>
<div class="codehilite"><pre><span></span>def Perm.eq {α : Type}
  : Π (p1 p2 : Perm α),
    p1.forward = p2.forward →
    p1.backward = p2.backward →
    p1 = p1
| p1 p2 .(rfl) .(rfl) := rfl
</pre></div>


<p>but what I _really_ want is a proof that <code>p1 = p2</code> at the end, but if I give it that type it complains that <code>rfl : p1 = p1</code> not <code>p1 = p2</code> (even though it looks like the compiler has enough information to determine <code>p1 = p2</code> and has already unified them? idk)</p>
<p>I've looked in the standard library for similar examples but couldn't find any.</p>
<p>Would appreciate some pointers or help!</p>
<p>(my overall goal is to prove the group structure of permutations, which I think needs to be done through the components?)</p>

<a name="124033339"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124033339" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124033339">Simon Hudon (Mar 21 2018 at 22:14)</a>:</h4>
<p>You might want to build on top of <code>equiv</code> from <code>mathlib</code>.</p>

<a name="124033356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124033356" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124033356">Nicholas Scheel (Mar 21 2018 at 22:15)</a>:</h4>
<p>in particular, if I try</p>
<div class="codehilite"><pre><span></span>.......
    p1 = p2
| p1 p2 .(rfl) .(rfl) := _
</pre></div>


<p>I get the following message:</p>
<div class="codehilite"><pre><span></span>don&#39;t know how to synthesize placeholder
context:
α : Type,
Perm.eq : ∀ (p1 p2 : Perm α), p1.forward = p2.forward → p1.backward = p2.backward → p1 = p2,
p1 : Perm α
⊢ p1 = p1
</pre></div>


<p>Notice that only p1 is in scope and it wants a proof of <code>p1 = p1</code>, which is just <code>rfl</code>, but <code>rfl</code> won't actually unify in that environment when I try it.</p>

<a name="124033360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124033360" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124033360">Simon Hudon (Mar 21 2018 at 22:15)</a>:</h4>
<p>For your specific problem, try this instead:</p>
<div class="codehilite"><pre><span></span>| ⟨f₀,b₀,p₀⟩ ⟨f₁,b₁,p₁⟩ .(rfl) .(rfl) := rfl
</pre></div>

<a name="124033415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124033415" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124033415">Simon Hudon (Mar 21 2018 at 22:16)</a>:</h4>
<p>Sorry, I made a mistake:</p>

<a name="124033422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124033422" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124033422">Simon Hudon (Mar 21 2018 at 22:16)</a>:</h4>
<div class="codehilite"><pre><span></span>| ⟨f₀,b₀,p₀⟩ ⟨._,._,._⟩ .(rfl) .(rfl) := rfl
</pre></div>


<p>I think that should work</p>

<a name="124033496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124033496" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124033496">Simon Hudon (Mar 21 2018 at 22:18)</a>:</h4>
<p>The reason is that, to infer equality of the whole from equality of the parts, you need to pattern match on the whole. Then, the unification of the variables used for the components will translate into the patterns for the two wholes to be syntactically equal and this is where <code>rfl</code> works</p>

<a name="124033515"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124033515" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124033515">Nicholas Scheel (Mar 21 2018 at 22:19)</a>:</h4>
<p>hmm I'm still getting a cryptic error with both of those:</p>
<div class="codehilite"><pre><span></span>......
has type
∀ (forward_1 backward_1 : α → α)
(are_inv_1 : function.left_inverse forward_1 backward_1 ∧ function.right_inverse forward_1 backward_1),
{forward := forward, backward := backward, are_inv := are_inv}.forward =
{forward := forward_1, backward := backward_1, are_inv := are_inv_1}.forward →
{forward := forward, backward := backward, are_inv := are_inv}.backward =
{forward := forward_1, backward := backward_1, are_inv := are_inv_1}.backward →
{forward := forward, backward := backward, are_inv := are_inv} =
{forward := forward, backward := backward, are_inv := are_inv}
but is expected to have type
∀ (forward_1 backward_1 : α → α)
(are_inv_1 : function.left_inverse forward_1 backward_1 ∧ function.right_inverse forward_1 backward_1),
(λ (p2 : Perm α),
{forward := forward, backward := backward, are_inv := are_inv}.forward = p2.forward →
{forward := forward, backward := backward, are_inv := are_inv}.backward = p2.backward →
{forward := forward, backward := backward, are_inv := are_inv} = p2)
{forward := forward_1, backward := backward_1, are_inv := are_inv_1}
</pre></div>


<p>(I'm using <a href="https://leanprover.github.io/live/3.3.0/" target="_blank" title="https://leanprover.github.io/live/3.3.0/">https://leanprover.github.io/live/3.3.0/</a> btw)</p>

<a name="124033713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124033713" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124033713">Simon Hudon (Mar 21 2018 at 22:24)</a>:</h4>
<p>I see. The problem is the <code>.</code> before <code>rfl</code>. I think the idea is that they are not irrelevant (or inferred from the context). They actually help you establish that <code>p1</code> and <code>p2</code> are identical:</p>
<div class="codehilite"><pre><span></span>def Perm.eq {α : Type}
  : Π (p1 p2 : Perm α),
    p1.forward = p2.forward →
    p1.backward = p2.backward →
    p1 = p2
| ⟨a,b,p⟩ ⟨._,._,._⟩ (rfl) (rfl) := rfl
</pre></div>

<a name="124033784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124033784" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124033784">Nicholas Scheel (Mar 21 2018 at 22:26)</a>:</h4>
<p>aha! that seems to be working, thanks so much!</p>

<a name="124033799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124033799" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124033799">Kevin Buzzard (Mar 21 2018 at 22:27)</a>:</h4>
<p><a href="https://github.com/leanprover/mathlib/blob/master/data/equiv.lean" target="_blank" title="https://github.com/leanprover/mathlib/blob/master/data/equiv.lean">https://github.com/leanprover/mathlib/blob/master/data/equiv.lean</a></p>

<a name="124033802"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124033802" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124033802">Kevin Buzzard (Mar 21 2018 at 22:27)</a>:</h4>
<p>There are some spoilers for this sort of thing</p>

<a name="124033809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124033809" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124033809">Kevin Buzzard (Mar 21 2018 at 22:27)</a>:</h4>
<p>Your <code>Perm</code> is the <code>equiv</code> on line 54</p>

<a name="124033932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124033932" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124033932">Kevin Buzzard (Mar 21 2018 at 22:30)</a>:</h4>
<p>no, sorry, equiv can have different source and target. Your <code>Perm</code> is the <code>perm</code> on line 62</p>

<a name="124033944"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124033944" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124033944">Nicholas Scheel (Mar 21 2018 at 22:31)</a>:</h4>
<p>very cool, thanks for the link :) is that accessible in the online editor or no?</p>

<a name="124033993"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124033993" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124033993">Chris Hughes (Mar 21 2018 at 22:32)</a>:</h4>
<p>I think not</p>

<a name="124034017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034017" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034017">Simon Hudon (Mar 21 2018 at 22:33)</a>:</h4>
<p>I think it is. The online version imports <code>mathlib</code> and I don't think <code>equiv</code> is too new</p>

<a name="124034029"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034029" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034029">Kevin Buzzard (Mar 21 2018 at 22:33)</a>:</h4>
<div class="codehilite"><pre><span></span>import data.equiv

#print equiv.perm
 ```
</pre></div>

<a name="124034067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034067" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034067">Kevin Buzzard (Mar 21 2018 at 22:34)</a>:</h4>
<p>works in lean web editor</p>

<a name="124034069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034069" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034069">Simon Hudon (Mar 21 2018 at 22:34)</a>:</h4>
<p>I just checked, it's there</p>

<a name="124034099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034099" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034099">Simon Hudon (Mar 21 2018 at 22:35)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> I'm confused by your reaction to your own post. Which direction are you two pointing to?</p>

<a name="124034103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034103" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034103">Kevin Buzzard (Mar 21 2018 at 22:35)</a>:</h4>
<p>I was trying to point to your comment :-)</p>

<a name="124034151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034151" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034151">Kevin Buzzard (Mar 21 2018 at 22:36)</a>:</h4>
<p>Lean 3.4 should be with us soon, and perhaps they'll update the lean web editor so it runs 3.4. There was extensive discussion on gitter about getting everything to compile but in the end all the problems were solved IIRC.</p>

<a name="124034165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034165" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034165">Kevin Buzzard (Mar 21 2018 at 22:37)</a>:</h4>
<p><a href="https://gitter.im/leanprover_public/lean_js" target="_blank" title="https://gitter.im/leanprover_public/lean_js">https://gitter.im/leanprover_public/lean_js</a></p>

<a name="124034171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034171" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034171">Kevin Buzzard (Mar 21 2018 at 22:37)</a>:</h4>
<p>probably-hard-to-find but useful link if you want to set it up yourself.</p>

<a name="124034230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034230" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034230">Kevin Buzzard (Mar 21 2018 at 22:39)</a>:</h4>
<p>but if you're going to compile it I suppose you'd just be better off running it in an IDE :-) I think Scott compiled a more recent version of Lean and left it on an internet-facing server...</p>

<a name="124034314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034314" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034314">Simon Hudon (Mar 21 2018 at 22:41)</a>:</h4>
<p>Was it hard to compile because of the new monadic code?</p>

<a name="124034362"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034362" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034362">Mario Carneiro (Mar 21 2018 at 22:42)</a>:</h4>
<p>No, that discussion predates the monad stuff by a while. I think it was just some JS compilation arcana</p>

<a name="124034397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034397" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034397">Simon Hudon (Mar 21 2018 at 22:44)</a>:</h4>
<p>Oh fun!</p>

<a name="124034431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034431" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034431">Nicholas Scheel (Mar 21 2018 at 22:45)</a>:</h4>
<p>I have a PureScript background – JS is weird :D</p>

<a name="124034435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034435" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034435">Kevin Buzzard (Mar 21 2018 at 22:45)</a>:</h4>
<p>Yes, apparently taking a bunch of C++ code and compiling it into javascript isn't 100% straightforward</p>

<a name="124034481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034481" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034481">Nicholas Scheel (Mar 21 2018 at 22:46)</a>:</h4>
<p>I have to say, the online editor is really slick I'm impressed!</p>

<a name="124034629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034629" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034629">Simon Hudon (Mar 21 2018 at 22:50)</a>:</h4>
<p>So they actually translate the whole C++ code base to Java script and the whole thing runs in the browser? That's really cool :) I just assumed the code was sent to a server and sent back after verification.</p>

<a name="124034649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034649" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034649">Simon Hudon (Mar 21 2018 at 22:51)</a>:</h4>
<blockquote>
<p>I have to say, the online editor is really slick I'm impressed!</p>
</blockquote>
<p>Microsoft has a few like that. It's a cool idea to get you started before you decide to install it</p>

<a name="124034799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034799" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034799">Kevin Buzzard (Mar 21 2018 at 22:55)</a>:</h4>
<p>The moment you try and do something non-trivial in the lean web editor things slow to a crawl; the "recompile the entire file every time the user presses a key" gets old pretty quickly. But for small bits of experimentation I absolutely agree, it's very cute.</p>

<a name="124034866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034866" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034866">Nicholas Scheel (Mar 21 2018 at 22:57)</a>:</h4>
<p>yeah, and a little debouncing would go a long ways ... but I'm patient with it ;)</p>

<a name="124034912"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034912" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034912">Simon Hudon (Mar 21 2018 at 22:58)</a>:</h4>
<p>It might just be a tease: the real thing is actually pretty fast and getting faster.</p>

<a name="124034928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034928" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034928">Simon Hudon (Mar 21 2018 at 22:59)</a>:</h4>
<p>I think <span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> should merge an incremental caching strategy pretty soon which will make things even smoother</p>

<a name="124034932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034932" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034932">Kevin Buzzard (Mar 21 2018 at 22:59)</a>:</h4>
<p>The next step after Lean Web Editor is to try a nightly. Except that the current nightly might not work with mathlib. Is this now a problem that the community has solved?</p>

<a name="124034935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034935" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034935">Kevin Buzzard (Mar 21 2018 at 22:59)</a>:</h4>
<p>What is this #travis stream anyway?</p>

<a name="124034989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124034989" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124034989">Simon Hudon (Mar 21 2018 at 23:00)</a>:</h4>
<blockquote>
<p>What is this #travis stream anyway?</p>
</blockquote>
<p>Whenever someone commits to <code>mathlib</code>, we get the build report there.</p>

<a name="124035007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124035007" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124035007">Kevin Buzzard (Mar 21 2018 at 23:01)</a>:</h4>
<p>Oh, so we still don't have access to e.g. a nightly build before all the monad refactoring stuff went in?</p>

<a name="124035012"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124035012" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124035012">Kevin Buzzard (Mar 21 2018 at 23:01)</a>:</h4>
<p>I mean core lean</p>

<a name="124035067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124035067" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124035067">Kevin Buzzard (Mar 21 2018 at 23:03)</a>:</h4>
<p>There was an entire week from 13th to 20th March with no commits and Lean was working just fine for me. And now we have all this monad refactoring and everyone is assuming mathlib won't build any more</p>

<a name="124035134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124035134" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124035134">Simon Hudon (Mar 21 2018 at 23:05)</a>:</h4>
<p>I think older nightlies should still be available. Don't you get a long list of nightlies on the site?</p>

<a name="124035181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124035181" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124035181">Simon Hudon (Mar 21 2018 at 23:06)</a>:</h4>
<p>I think what we might need is for <code>mathlib</code> to publish Lean nightlies, a subset of all the nightlies for which <code>mathlib</code> passes.</p>

<a name="124035197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124035197" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124035197">Kevin Buzzard (Mar 21 2018 at 23:07)</a>:</h4>
<p>I can pull the repo and checkout a random commit and compile, but I don't think I've ever seen a list of nightlies. Where are they?</p>

<a name="124035342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124035342" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124035342">Simon Hudon (Mar 21 2018 at 23:10)</a>:</h4>
<p>I can't find it anymore. I wonder if they changed the way nightly works</p>

<a name="124035352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124035352" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124035352">Nicholas Scheel (Mar 21 2018 at 23:11)</a>:</h4>
<p>here's my messy code as a whole if anyone is curious <span class="emoji emoji-1f609" title="wink">:wink:</span> <a href="https://gist.github.com/MonoidMusician/b2792a2d9687dd627155996097ad97c1" target="_blank" title="https://gist.github.com/MonoidMusician/b2792a2d9687dd627155996097ad97c1">https://gist.github.com/MonoidMusician/b2792a2d9687dd627155996097ad97c1</a> (we talked about equivalence classes of functions with permutations in my combinatorics class, so I wanted to play around with the idea a little bit – in particular, equivalent surjective functions will have a unique (post-composed) permutation for the equivalence)<br>
thanks again for the help!</p>

<a name="124035501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124035501" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124035501">Sebastian Ullrich (Mar 21 2018 at 23:14)</a>:</h4>
<p>The nightly releases PR was merged today, though today's build has already failed because of broken setup... I'll test it tomorrow by having it build a custom pre-monad nightly</p>

<a name="124035521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124035521" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124035521">Simon Hudon (Mar 21 2018 at 23:15)</a>:</h4>
<p>Are more than one nightly supposed to be available at any given time?</p>

<a name="124035526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124035526" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124035526">Kevin Buzzard (Mar 21 2018 at 23:15)</a>:</h4>
<p>I've never seen more than one available</p>

<a name="124035530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124035530" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124035530">Kevin Buzzard (Mar 21 2018 at 23:15)</a>:</h4>
<p>(per OS of course)</p>

<a name="124035585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124035585" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124035585">Simon Hudon (Mar 21 2018 at 23:16)</a>:</h4>
<p>I should go offline: my dissertation doesn't write itself when I don't look at it :/  (no matter how long I look away)</p>

<a name="124035589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124035589" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124035589">Mario Carneiro (Mar 21 2018 at 23:16)</a>:</h4>
<p>I think your definition of <code>PostPermEquiv</code> should use <code>subtype</code> (notation <code>{x // p x}</code>)</p>

<a name="124036061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124036061" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124036061">Nicholas Scheel (Mar 21 2018 at 23:28)</a>:</h4>
<p>okay, looks good – what's the difference? :)</p>

<a name="124036145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124036145" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124036145">Nicholas Scheel (Mar 21 2018 at 23:31)</a>:</h4>
<p>ah, more specific to Prop?</p>

<a name="124036301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124036301" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124036301">Mario Carneiro (Mar 21 2018 at 23:36)</a>:</h4>
<p>You also shouldn't need the <code>n+2</code> case in the definition of <code>swap</code> and <code>swap_involution</code></p>

<a name="124036316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124036316" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124036316">Mario Carneiro (Mar 21 2018 at 23:37)</a>:</h4>
<p>Also, as Kevin says most of this theory is in <code>data.equiv</code> in mathlib, although we don't do anything with postperm stuff</p>

<a name="124036318"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124036318" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124036318">Nicholas Scheel (Mar 21 2018 at 23:37)</a>:</h4>
<p>hmm I get</p>
<div class="codehilite"><pre><span></span>non-exhaustive match, the following cases are missing:
swap ⟨nat.succ (nat.succ _), _⟩
</pre></div>

<a name="124036500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124036500" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124036500">Kevin Buzzard (Mar 21 2018 at 23:43)</a>:</h4>
<p><code>| ⟨n+2, prf⟩ := ⟨n+2,prf⟩</code> works :-)</p>

<a name="124036563"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124036563" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124036563">Mario Carneiro (Mar 21 2018 at 23:45)</a>:</h4>
<p>Ah, I see, it would work except that the underlying inductive type <code>nat.less_than_or_equal</code> eliminates to Prop, so it can't be used to define an element of <code>fin 2</code> (although it can be used to define an element of <code>false</code> which then defines an element of <code>fin 2</code>)</p>

<a name="124036621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124036621" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124036621">Mario Carneiro (Mar 21 2018 at 23:47)</a>:</h4>
<p>You can also use <code>absurd prf dec_trivial</code> instead of that finis stuff</p>

<a name="124036635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124036635" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124036635">Nicholas Scheel (Mar 21 2018 at 23:48)</a>:</h4>
<p>haha that's really helpful <span class="emoji emoji-1f606" title="laughing">:laughing:</span></p>

<a name="124036703"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124036703" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124036703">Nicholas Scheel (Mar 21 2018 at 23:49)</a>:</h4>
<p>I will learn these voodoo tactics one day!</p>

<a name="124036704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124036704" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124036704">Kevin Buzzard (Mar 21 2018 at 23:49)</a>:</h4>
<p>If you define <code>swap (n+2)</code> to be <code>n+2</code> then you get to write</p>
<div class="codehilite"><pre><span></span>lemma  swap_involution : ∀ n, swap (swap n) = n
| ⟨0, _⟩ := rfl
| ⟨1, _⟩ := rfl
| ⟨n+2, prf⟩ := rfl
</pre></div>

<a name="124036766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124036766" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124036766">Nicholas Scheel (Mar 21 2018 at 23:51)</a>:</h4>
<p>true, and that's essentially what the more general swapping does too</p>

<a name="124036972"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20equality%20from%20parts/near/124036972" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/67902structureequalityfromparts.html#124036972">Nicholas Scheel (Mar 21 2018 at 23:53)</a>:</h4>
<p>thanks for all the help!!</p>


{% endraw %}
