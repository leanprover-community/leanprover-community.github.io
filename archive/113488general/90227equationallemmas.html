---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/90227equationallemmas.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html">equational lemmas</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="129109127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129109127" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129109127">Simon Hudon (Jul 04 2018 at 23:18)</a>:</h4>
<p>when using <code>add_decl</code> to create a definition, is it possible to declare an accompanying equational lemma?</p>

<a name="129116213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129116213" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129116213">Mario Carneiro (Jul 05 2018 at 03:47)</a>:</h4>
<p>As far as I know, there is no way to define equational lemmas "just like" the ones generated by the equation compiler. Maybe <span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> can confirm?</p>

<a name="129116311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129116311" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129116311">Simon Hudon (Jul 05 2018 at 03:50)</a>:</h4>
<p>By "just like", I assume specifically that you're saying that <code>simp</code> and <code>unfold</code> won't pick up on them</p>

<a name="129116417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129116417" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129116417">Simon Hudon (Jul 05 2018 at 03:54)</a>:</h4>
<p>Actually, I should say that's what I'm looking for.</p>

<a name="129116428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129116428" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129116428">Mario Carneiro (Jul 05 2018 at 03:55)</a>:</h4>
<p>Yes, there is a C (and maybe lean?) function <code>get_equation_lemmas</code> which returns these things, but I don't think users have access to change it</p>

<a name="129116708"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129116708" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129116708">Simon Hudon (Jul 05 2018 at 04:04)</a>:</h4>
<p>Yeah I saw it. I was pretty disappointed that it was built in</p>

<a name="129122206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129122206" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129122206">Sebastian Ullrich (Jul 05 2018 at 07:05)</a>:</h4>
<p>Right, equation lemmas are currently stored in an environment extension, which only exposes read-only access via <a href="https://github.com/leanprover/lean/blob/a4aae537fe771ee92d746d4a2be1e73c543e48b9/library/init/meta/simp_tactic.lean#L69" target="_blank" title="https://github.com/leanprover/lean/blob/a4aae537fe771ee92d746d4a2be1e73c543e48b9/library/init/meta/simp_tactic.lean#L69">tactic.get_eqn_lemmas</a></p>

<a name="129122431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129122431" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129122431">Simon Hudon (Jul 05 2018 at 07:12)</a>:</h4>
<p>Blast! Foiled again <span class="emoji emoji-1f61d" title="stuck out tongue closed eyes">:stuck_out_tongue_closed_eyes:</span></p>

<a name="129122505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129122505" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129122505">Simon Hudon (Jul 05 2018 at 07:15)</a>:</h4>
<p>By the way, why I got you here, beside fields with underscore, is there any information about structures and substructures? I'm looking at <code>group</code> and it does not seem to have any underscore fields even though it has plenty of ancestry</p>

<a name="129122615"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129122615" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129122615">Sebastian Ullrich (Jul 05 2018 at 07:18)</a>:</h4>
<p>It should still use <code>old_structure_cmd</code></p>

<a name="129123072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129123072" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129123072">Simon Hudon (Jul 05 2018 at 07:35)</a>:</h4>
<p>I see. I'm a bit vague on how that works. Does it mean that parent structures are expanded fully and not a trace of the  fact that it's a parent is left?</p>

<a name="129123183"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129123183" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129123183">Sebastian Ullrich (Jul 05 2018 at 07:39)</a>:</h4>
<p>Right. Well, the only trace is the synthesized parent coercions.</p>

<a name="129123241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129123241" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129123241">Mario Carneiro (Jul 05 2018 at 07:40)</a>:</h4>
<p>luckily, these are completely replicable by users</p>

<a name="129123244"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129123244" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129123244">Kevin Buzzard (Jul 05 2018 at 07:40)</a>:</h4>
<p>One of my kids is doing the exercises in Software Foundations in Lean this week, that was definitely a parent coercion</p>

<a name="129123664"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129123664" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129123664">Simon Hudon (Jul 05 2018 at 07:52)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Unfortunately, this time, it's not about replicating it. I'm building proofs that structures like groups are transportable. I can unfold projections like <code>group.mul</code> but most axioms are in terms of <code>has_mul.mul</code>.</p>

<a name="129123678"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129123678" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129123678">Simon Hudon (Jul 05 2018 at 07:53)</a>:</h4>
<p>My best idea right now is hard coding references to <code>has_foo.foo</code> for multiple <code>foo</code>s.</p>

<a name="129123683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129123683" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129123683">Mario Carneiro (Jul 05 2018 at 07:53)</a>:</h4>
<p>I don't see the problem. Won't the parent instance be embedded in the <code>has_mul.mul</code> application?</p>

<a name="129123852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129123852" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129123852">Simon Hudon (Jul 05 2018 at 07:58)</a>:</h4>
<p>Let's say that from <code>equiv a b</code> and <code>group a</code>, I'm building <code>group b</code>. With a list of all the fields of <code>group</code>, I'd call <code>dsimp [...]</code>. I'm not sure what to do if I find the <code>group b</code> instance in there.</p>

<a name="129123871"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129123871" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129123871">Simon Hudon (Jul 05 2018 at 07:59)</a>:</h4>
<p>Should I look for all projections applied to that group instance?</p>

<a name="129123936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129123936" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129123936">Mario Carneiro (Jul 05 2018 at 08:00)</a>:</h4>
<p>I'm still confused. Where would there be a <code>group b</code> instance?</p>

<a name="129123947"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129123947" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129123947">Mario Carneiro (Jul 05 2018 at 08:00)</a>:</h4>
<p>In the type of a field?</p>

<a name="129123965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129123965" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129123965">Mario Carneiro (Jul 05 2018 at 08:01)</a>:</h4>
<div class="codehilite"><pre><span></span>@[to_additive name.mk_string &quot;mk&quot; (name.mk_string &quot;add_group&quot; name.anonymous)]
constructor group.mk : Π {α : Type u} (mul : α → α → α)
(mul_assoc :
  ∀ (a b c : α),
    @eq α (@has_mul.mul α (@has_mul.mk α mul) (@has_mul.mul α (@has_mul.mk α mul) a b) c)
      (@has_mul.mul α (@has_mul.mk α mul) a (@has_mul.mul α (@has_mul.mk α mul) b c))) (one : α)
(one_mul : ∀ (a : α), @eq α (@has_mul.mul α (@semigroup.to_has_mul α (@semigroup.mk α mul mul_assoc)) 1 a) a)
(mul_one : ∀ (a : α), @eq α (@has_mul.mul α (@semigroup.to_has_mul α (@semigroup.mk α mul mul_assoc)) a 1) a)
(inv : α → α),
  (∀ (a : α),
     @eq α
       (@has_mul.mul α
          (@semigroup.to_has_mul α (@monoid.to_semigroup α (@monoid.mk α mul mul_assoc one one_mul mul_one)))
          (@has_inv.inv α (@has_inv.mk α inv) a)
          a)
       1) →
  group α
</pre></div>

<a name="129124003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124003" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124003">Simon Hudon (Jul 05 2018 at 08:02)</a>:</h4>
<p>Here's part of the <code>transportable</code> class:</p>
<div class="codehilite"><pre><span></span><span class="n">class</span> <span class="n">transportable</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">on_equiv</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">equiv</span> <span class="n">α</span> <span class="n">β</span><span class="o">),</span> <span class="n">equiv</span> <span class="o">(</span><span class="n">f</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="n">β</span><span class="o">))</span>
</pre></div>

<a name="129124036"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124036" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124036">Simon Hudon (Jul 05 2018 at 08:03)</a>:</h4>
<p>To build <code>equiv (group a) (group b)</code> I first need the <code>to_fun</code> definition (which is the hairy part we're now talking about)</p>

<a name="129124085"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124085" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124085">Simon Hudon (Jul 05 2018 at 08:04)</a>:</h4>
<p>Ah! Yes, that's where the instance would be:</p>
<div class="codehilite"><pre><span></span>(@has_mul.mul α
          (@semigroup.to_has_mul α (@monoid.to_semigroup α (@monoid.mk α mul mul_assoc one one_mul mul_one)))
          (@has_inv.inv α (@has_inv.mk α inv) a)
</pre></div>

<a name="129124089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124089" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124089">Simon Hudon (Jul 05 2018 at 08:04)</a>:</h4>
<p>So it does not appear directly as an argument to a projection</p>

<a name="129124090"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124090" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124090">Mario Carneiro (Jul 05 2018 at 08:04)</a>:</h4>
<p>You can unfold all those if you want</p>

<a name="129124101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124101" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124101">Mario Carneiro (Jul 05 2018 at 08:05)</a>:</h4>
<p>it reduces to <code>mul</code> of course</p>

<a name="129124165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124165" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124165">Simon Hudon (Jul 05 2018 at 08:06)</a>:</h4>
<p>I just remembered <code>unfold_projs</code> exists. Is this what you think I should use?</p>

<a name="129124170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124170" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124170">Mario Carneiro (Jul 05 2018 at 08:07)</a>:</h4>
<p>shouldn't <code>dsimp</code> work?</p>

<a name="129124178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124178" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124178">Mario Carneiro (Jul 05 2018 at 08:07)</a>:</h4>
<p>or is the problem that you don't know what to simplify</p>

<a name="129124182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124182" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124182">Mario Carneiro (Jul 05 2018 at 08:07)</a>:</h4>
<p>You can use <code>whnf</code> to give it a good kick</p>

<a name="129124234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124234" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124234">Simon Hudon (Jul 05 2018 at 08:08)</a>:</h4>
<blockquote>
<p>Mario Carneiro: or is the problem that you don't know what to simplify</p>
</blockquote>
<p>Yes exactly. What I'm starting with is the list of all the fields of <code>group</code></p>

<a name="129124288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124288" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124288">Simon Hudon (Jul 05 2018 at 08:10)</a>:</h4>
<p><code>whnf</code> still would be pretty involved. If I just apply it to the proposition, nothing will happen because it's an equality. Then I'd need to traverse the whole expression</p>

<a name="129124357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124357" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124357">Mario Carneiro (Jul 05 2018 at 08:12)</a>:</h4>
<p>Of course you have to traverse the expression. How else would you figure out what to transport?</p>

<a name="129124417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124417" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124417">Simon Hudon (Jul 05 2018 at 08:14)</a>:</h4>
<p>cancellation rules on <code>equiv</code> are doing a lot already. I thought I could use more high level primitives. My tactic is outrageously slow already without hand crafting traversals</p>

<a name="129124426"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124426" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124426">Mario Carneiro (Jul 05 2018 at 08:15)</a>:</h4>
<p>oh, I see, you are using heuristic simplification</p>

<a name="129124497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124497" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124497">Simon Hudon (Jul 05 2018 at 08:16)</a>:</h4>
<p>Yes. Do you think it might be why it's all so slow?</p>

<a name="129124518"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124518" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124518">Mario Carneiro (Jul 05 2018 at 08:17)</a>:</h4>
<p>hard to say without knowing exactly what you are doing, but yes, I expect that a general analysis would be both more reliable and faster (and also a lot of work to write)</p>

<a name="129124589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124589" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124589">Mario Carneiro (Jul 05 2018 at 08:19)</a>:</h4>
<p>If you aren't going for the full decision procedure, then it seems okay to just have an ad hoc list and let users add to it as necessary</p>

<a name="129124708"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124708" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124708">Simon Hudon (Jul 05 2018 at 08:22)</a>:</h4>
<p>That makes sense. I'll have to do optimization at some point anyway</p>

<a name="129124725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124725" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124725">Mario Carneiro (Jul 05 2018 at 08:23)</a>:</h4>
<p>Even having an approximate transportable implementation would be very helpful, I think</p>

<a name="129124773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124773" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124773">Simon Hudon (Jul 05 2018 at 08:25)</a>:</h4>
<p>I'll try to wrap up a prototype quickly. The feedback will be useful to pick a direction. I think the performances will be very noticeable</p>

<a name="129124780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124780" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124780">Mario Carneiro (Jul 05 2018 at 08:25)</a>:</h4>
<p>Did you ever look at Johannes's <code>transport</code> tactic, with its relator based approach?</p>

<a name="129124837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124837" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124837">Simon Hudon (Jul 05 2018 at 08:26)</a>:</h4>
<p>Only a while ago and never managed to understand it. I'll have another look</p>

<a name="129124842"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129124842" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129124842">Simon Hudon (Jul 05 2018 at 08:26)</a>:</h4>
<p>Btw, here's what I have, if you want to check it out:</p>
<p><a href="https://github.com/cipher1024/transport/blob/master/src/transport.lean#L114" target="_blank" title="https://github.com/cipher1024/transport/blob/master/src/transport.lean#L114">https://github.com/cipher1024/transport/blob/master/src/transport.lean#L114</a></p>

<a name="129134127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129134127" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129134127">Johan Commelin (Jul 05 2018 at 12:11)</a>:</h4>
<p><span class="user-mention" data-user-id="110026">@Simon Hudon</span> do you have any clue how close this brings us to the parametricity results of Wadler that <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> has been talking about?</p>

<a name="129134206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129134206" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129134206">Johan Commelin (Jul 05 2018 at 12:13)</a>:</h4>
<p>It is not clear to me how our "naive transporatability" notion compares to Wadler's parametricity when it comes to ease of use. I also don't know how they compare when it comes to ease of implementation...</p>

<a name="129143345"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129143345" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129143345">Simon Hudon (Jul 05 2018 at 14:54)</a>:</h4>
<p>Actually, I haven't followed that conversation too closely. I'll have to catch up</p>

<a name="129149249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/129149249" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#129149249">Simon Hudon (Jul 05 2018 at 16:42)</a>:</h4>
<p>Can you point me to the beginning of that conversation?</p>

<a name="133328882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/133328882" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#133328882">Kenny Lau (Sep 04 2018 at 18:48)</a>:</h4>
<p>How does Lean tell the difference between an automatically generated <code>.equations._eqn_1</code> and one that I prove manually?</p>

<a name="133328929"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/133328929" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#133328929">Simon Hudon (Sep 04 2018 at 18:49)</a>:</h4>
<p>I have gone down that road before. In Lean 3, there's no way of getting Lean to use your lemmas as definitional equations</p>

<a name="133330070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/133330070" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#133330070">Kenny Lau (Sep 04 2018 at 19:06)</a>:</h4>
<p>this is so sad</p>

<a name="133330102"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/equational%20lemmas/near/133330102" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/90227equationallemmas.html#133330102">Simon Hudon (Sep 04 2018 at 19:07)</a>:</h4>
<p>I'm hopeful it'll get better in Lean 4</p>


{% endraw %}
