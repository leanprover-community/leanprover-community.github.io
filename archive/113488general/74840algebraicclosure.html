---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/74840algebraicclosure.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html">algebraic closure</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="166586393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166586393" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166586393">Kenny Lau (May 26 2019 at 18:25)</a>:</h4>
<p>I have a new idea to construct an algebraic closure of a field F: for each (monic (irreducible)) polynomial p let Fp be a splitting field of p over F, and take the tensor product of all the Fp together (there is a construction of tensor product without direct limit but the direct limit construction might grant us quicker the fact that the ring is nonzero), and then quotient by a maximal ideal</p>

<a name="166587069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166587069" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166587069">Neil Strickland (May 26 2019 at 18:43)</a>:</h4>
<p>I'd suggest something similar but a tiny bit different.  If <code>p</code> is monic of degree <code>n</code>, let <code>A_p</code> be the quotient of <code>F[a_1,..,a_n]</code> by the coefficients of <code>p - (x - a_1) * ... * (x - a_n)</code>.  The splitting field <code>L_p</code> is then the quotient of <code>A_p</code> by a maximal ideal.  Let <code>A</code> be the tensor product of all the <code>A_p</code>, and let <code>B</code> be the tensor product of all the <code>L_p</code>.  You are proposing to take the quotient of <code>B</code> by a maximal ideal, but it works just as well to take the quotient of <code>A</code> by a maximal ideal.  Moreover, you can specify a basis for <code>A_p</code> over <code>F</code> depending only on the degree of <code>p</code>, whereas the dimension of <code>L_p</code> depends in a delicate way on the Galois theoretic properties of <code>p</code>.  This makes it easier to deal with <code>A</code>.  Also, you can define <code>A</code> without explicit recourse to tensor products: you just take a polynomial ring over <code>F</code> with generators <code>a_{p,i}</code> for <code>i &lt; deg (p)</code> and take an appropriate quotient.</p>

<a name="166592739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166592739" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166592739">Kenny Lau (May 26 2019 at 21:20)</a>:</h4>
<p>but we already have splitting fields</p>

<a name="166593443"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166593443" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166593443">Neil Strickland (May 26 2019 at 21:40)</a>:</h4>
<p>I know we have splitting fields.  But if you want to use splitting fields then you need to deal with colimits and tensor products, which you can avoid by the approach that I suggested.  And you will need to work a bit harder to verify that the relevant ring is nonzero.</p>

<a name="166596633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166596633" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166596633">Kenny Lau (May 26 2019 at 23:11)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">linear_algebra</span><span class="bp">.</span><span class="n">basis</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">algebra_operations</span>

<span class="kn">universe</span> <span class="n">u</span>

<span class="kn">private</span> <span class="n">def</span> <span class="n">monic_irred</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">F</span><span class="o">]</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">p</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">F</span> <span class="bp">//</span> <span class="n">p</span><span class="bp">.</span><span class="n">monic</span> <span class="bp">∧</span> <span class="kn">irreducible</span> <span class="n">p</span> <span class="o">}</span>

<span class="bp">@</span><span class="o">[</span><span class="kn">reducible</span><span class="o">]</span> <span class="kn">private</span> <span class="n">def</span> <span class="n">big_ring</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">F</span><span class="o">]</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="o">:=</span>
<span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">monic_irred</span> <span class="n">F</span><span class="o">)</span> <span class="n">F</span>

<span class="bp">@</span><span class="o">[</span><span class="kn">reducible</span><span class="o">]</span> <span class="kn">private</span> <span class="n">def</span> <span class="n">big_ideal</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">F</span><span class="o">]</span> <span class="o">:</span> <span class="n">ideal</span> <span class="o">(</span><span class="n">big_ring</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">ideal</span><span class="bp">.</span><span class="n">span</span> <span class="o">{</span> <span class="n">q</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">p</span> <span class="o">:</span> <span class="n">monic_irred</span> <span class="n">F</span><span class="o">,</span> <span class="n">p</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="n">eval₂</span> <span class="n">mv_polynomial</span><span class="bp">.</span><span class="n">C</span> <span class="o">(</span><span class="n">mv_polynomial</span><span class="bp">.</span><span class="n">X</span> <span class="n">p</span><span class="o">)</span> <span class="bp">=</span> <span class="n">q</span> <span class="o">}</span>

<span class="kn">private</span> <span class="n">def</span> <span class="n">big_basis</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">F</span><span class="o">]</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">big_ideal</span> <span class="n">F</span><span class="o">)</span><span class="bp">.</span><span class="n">quotient</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">q</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">p</span> <span class="o">:</span> <span class="n">monic_irred</span> <span class="n">F</span><span class="o">,</span> <span class="bp">∃</span> <span class="n">n</span> <span class="bp">&lt;</span> <span class="n">p</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="n">nat_degree</span><span class="o">,</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">mk</span> <span class="bp">_</span> <span class="o">((</span><span class="n">mv_polynomial</span><span class="bp">.</span><span class="n">X</span> <span class="n">p</span><span class="o">)</span><span class="err">^</span><span class="n">n</span><span class="o">)</span> <span class="bp">=</span> <span class="n">q</span> <span class="o">}</span>

<span class="kn">instance</span> <span class="n">asdf</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">F</span><span class="o">]</span> <span class="o">:</span> <span class="n">module</span> <span class="n">F</span> <span class="o">(</span><span class="n">big_ring</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">sorry</span>

<span class="kn">instance</span> <span class="n">ghjk</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">F</span><span class="o">]</span> <span class="o">:</span> <span class="n">module</span> <span class="n">F</span> <span class="o">(</span><span class="n">big_ideal</span> <span class="n">F</span><span class="o">)</span><span class="bp">.</span><span class="n">quotient</span> <span class="o">:=</span>
<span class="n">sorry</span>

<span class="kn">private</span> <span class="kn">theorem</span> <span class="n">big_basis</span><span class="bp">.</span><span class="n">is_basis</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">F</span><span class="o">]</span> <span class="o">:</span> <span class="n">is_basis</span> <span class="n">F</span> <span class="o">(</span><span class="n">big_basis</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">sorry</span>
</pre></div>

<a name="166596676"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166596676" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166596676">Kenny Lau (May 26 2019 at 23:12)</a>:</h4>
<p>when you want to rejoin Lean but you remember the frustration of <code>maximum class-instance resolution depth has been reached</code></p>

<a name="166611003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166611003" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166611003">Kevin Buzzard (May 27 2019 at 06:06)</a>:</h4>
<p>It's usually user error :-/</p>

<a name="166611021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166611021" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166611021">Johan Commelin (May 27 2019 at 06:08)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> I suggest you talk with <span class="user-mention" data-user-id="110044">@Chris Hughes</span> about this. I was under the impression that he was almost done with algebraic closures, and that it would happen in about a week (or two) after the exams were over. He was planning to use your open PRs</p>

<a name="166611074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166611074" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166611074">Johan Commelin (May 27 2019 at 06:08)</a>:</h4>
<p>I've been working on those PRs, and at least <a href="https://github.com/leanprover-community/mathlib/issues/734" target="_blank" title="https://github.com/leanprover-community/mathlib/issues/734">#734</a> is waiting for review by others.</p>

<a name="166611100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166611100" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166611100">Kevin Buzzard (May 27 2019 at 06:09)</a>:</h4>
<p>...or can be fixed by pretending there isn't a problem and bumping up the number</p>

<a name="166611546"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166611546" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166611546">Sebastien Gouezel (May 27 2019 at 06:21)</a>:</h4>
<p>I had to bump it to 250 in <a href="https://github.com/leanprover-community/mathlib/issues/1085" target="_blank" title="https://github.com/leanprover-community/mathlib/issues/1085">#1085</a> !</p>

<a name="166611723"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166611723" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166611723">Keeley Hoek (May 27 2019 at 06:26)</a>:</h4>
<p>:O</p>

<a name="166611770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166611770" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166611770">Keeley Hoek (May 27 2019 at 06:26)</a>:</h4>
<p>Typeclass resolution is actually garbage</p>

<a name="166611885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166611885" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166611885">Keeley Hoek (May 27 2019 at 06:29)</a>:</h4>
<p>In 4 we could write our own, right?</p>

<a name="166611887"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166611887" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166611887">Johan Commelin (May 27 2019 at 06:29)</a>:</h4>
<p>We had a recent effort to make things <code>irreducible</code> after their API's had been reasonably fleshed out. Would that help in keeping this number in check?</p>

<a name="166612950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166612950" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166612950">Sebastien Gouezel (May 27 2019 at 06:53)</a>:</h4>
<p>I don't really know why it has to be that huge here. It is probably related to products and to the fact that things are rather unbundled: the definition of a topological module is</p>
<div class="codehilite"><pre><span></span><span class="n">class</span> <span class="n">topological_module</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span>
  <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">α</span><span class="o">]</span>
  <span class="o">[</span><span class="n">topological_space</span> <span class="n">β</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">β</span><span class="o">]</span>
  <span class="o">[</span><span class="n">module</span> <span class="n">α</span> <span class="n">β</span><span class="o">]</span>
  <span class="kn">extends</span> <span class="n">topological_semimodule</span> <span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Prop</span>
</pre></div>


<p>You can see how many typeclasses this depends on.</p>

<a name="166614089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166614089" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166614089">Kevin Buzzard (May 27 2019 at 07:17)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">instance</span> <span class="n">asdf</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">F</span><span class="o">]</span> <span class="o">:</span> <span class="n">module</span> <span class="n">F</span> <span class="o">(</span><span class="n">big_ring</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">sorry</span>

<span class="kn">instance</span> <span class="n">qwer</span> <span class="o">:</span> <span class="n">add_comm_group</span> <span class="o">((</span><span class="n">big_ideal</span> <span class="n">F</span><span class="o">)</span><span class="bp">.</span><span class="n">quotient</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span>
<span class="c">/-</span><span class="cm"></span>
<span class="cm">synthesized type class instance is not definitionally equal to expression inferred by typing rules, synthesized</span>
<span class="cm">  ⁇</span>
<span class="cm">inferred</span>
<span class="cm">  mv_polynomial.comm_ring</span>
<span class="cm">-/</span>
</pre></div>


<p>Could this be something to do with it?</p>

<a name="166614158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166614158" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166614158">Kevin Buzzard (May 27 2019 at 07:18)</a>:</h4>
<p>no wait, that's my user error (no F)</p>

<a name="166614705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166614705" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166614705">Kevin Buzzard (May 27 2019 at 07:29)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">set_option</span> <span class="n">class</span><span class="bp">.</span><span class="n">instance_max_depth</span> <span class="mi">36</span> <span class="c1">-- and no lower</span>
<span class="kn">instance</span> <span class="n">asdf</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">F</span><span class="o">]</span> <span class="o">:</span> <span class="n">module</span> <span class="n">F</span> <span class="o">(</span><span class="n">big_ring</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">apply_instance</span>

<span class="kn">set_option</span> <span class="n">class</span><span class="bp">.</span><span class="n">instance_max_depth</span> <span class="mi">86</span> <span class="c1">-- and no lower</span>
<span class="kn">instance</span> <span class="n">zxcv</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">F</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">big_ideal</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span>
</pre></div>


<p>Why is this nonsense happening?</p>

<a name="166615343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166615343" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166615343">Kevin Buzzard (May 27 2019 at 07:41)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">set_option</span> <span class="n">class</span><span class="bp">.</span><span class="n">instance_max_depth</span> <span class="mi">36</span> <span class="c1">-- and no lower</span>
<span class="kn">instance</span> <span class="n">asdf</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">F</span><span class="o">]</span> <span class="o">:</span> <span class="n">module</span> <span class="n">F</span> <span class="o">(</span><span class="n">big_ring</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">apply_instance</span>

<span class="kn">set_option</span> <span class="n">class</span><span class="bp">.</span><span class="n">instance_max_depth</span> <span class="mi">86</span> <span class="c1">-- and no lower</span>
<span class="kn">instance</span> <span class="n">zxcv</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">F</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">big_ideal</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span>

<span class="kn">instance</span> <span class="n">wert</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">F</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">comm_ring</span> <span class="o">(</span><span class="n">big_ideal</span> <span class="n">F</span><span class="o">)</span><span class="bp">.</span><span class="n">quotient</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span>

<span class="kn">instance</span> <span class="n">qwer</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">F</span><span class="o">]</span> <span class="o">:</span>
<span class="n">module</span> <span class="n">F</span> <span class="o">(</span><span class="n">big_ideal</span> <span class="n">F</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span> <span class="c1">-- fails</span>
</pre></div>

<a name="166615636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166615636" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166615636">Kevin Buzzard (May 27 2019 at 07:46)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> is the issue simply this:</p>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">(</span><span class="n">R</span> <span class="n">S</span> <span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">S</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">R</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">S</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">module</span> <span class="n">R</span> <span class="n">M</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span> <span class="c1">-- fails</span>
</pre></div>


<p>This should probably fail, because Lean does not know that the R-module structure on S has anything to do with the ring structure.</p>

<a name="166615662"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166615662" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166615662">Kevin Buzzard (May 27 2019 at 07:47)</a>:</h4>
<p>Aah, but this also fails:</p>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">(</span><span class="n">R</span> <span class="n">S</span> <span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">S</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">S</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">module</span> <span class="n">R</span> <span class="n">M</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span> <span class="c1">-- fails</span>
</pre></div>

<a name="166615726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166615726" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166615726">Kevin Buzzard (May 27 2019 at 07:48)</a>:</h4>
<p>We humans are too clever. We synthesize the instance automatically.</p>

<a name="166615945"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166615945" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166615945">Kevin Buzzard (May 27 2019 at 07:53)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">(</span><span class="n">R</span> <span class="n">S</span> <span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">S</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">S</span><span class="o">]</span>
  <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">S</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">has_scalar</span> <span class="n">R</span> <span class="n">M</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span> <span class="c1">-- fails</span>
</pre></div>


<p>Are there just some missing instances? Should these even be instances? There is no mention of <code>S</code> in the conclusion.</p>

<a name="166616107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166616107" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166616107">Kevin Buzzard (May 27 2019 at 07:56)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> you know the instance "map" for this stuff better than me -- is this the issue?</p>

<a name="166616145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166616145" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166616145">Kenny Lau (May 27 2019 at 07:57)</a>:</h4>
<p>oh I'm stupid</p>

<a name="166619266"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166619266" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166619266">Kenny Lau (May 27 2019 at 08:49)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span> what is your progress on algebraic closure?</p>

<a name="166621383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166621383" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166621383">Chris Hughes (May 27 2019 at 09:20)</a>:</h4>
<p>Mostly done, although I am refactoring. I proved it is algebraically closed, and am just refactoring to make it neater to show that there is a hom from any algebraic extension into the closure. This refactoring is much slower than expected however, and I'm bundling homs right now to make it easier.</p>
<p>I did sorry a couple of facts, the fact that <code>adjoin_root</code> is an algebraic extension, and the fact that an algebraic extension of an algebraic extension is algebraic over the first field. I was hoping that you were close to proving these, as some of your PRs looked like they were leading to this.</p>

<a name="166621927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166621927" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166621927">Kenny Lau (May 27 2019 at 09:28)</a>:</h4>
<p>I thought I already proved that result</p>

<a name="166622587"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166622587" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166622587">Kenny Lau (May 27 2019 at 09:38)</a>:</h4>
<p>oh it was meant to be the PR after <a href="https://github.com/leanprover-community/mathlib/issues/756" target="_blank" title="https://github.com/leanprover-community/mathlib/issues/756">#756</a></p>

<a name="166628760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/166628760" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#166628760">Kenny Lau (May 27 2019 at 11:26)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span>  <a href="https://github.com/leanprover-community/mathlib/issues/1087" target="_blank" title="https://github.com/leanprover-community/mathlib/issues/1087">#1087</a></p>

<a name="170627539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/170627539" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#170627539">Casper Putz (Jul 11 2019 at 12:26)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span>  What is the status on the algebraic closure? I am interested in working with algebraic extensions in mathlib. Are you planning on putting it into mathlib anytime in the future?</p>

<a name="171378258"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/171378258" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#171378258">Chris Hughes (Jul 21 2019 at 16:13)</a>:</h4>
<p>I pushed some stuff to the algebraic closure branch of community mathlib.<br>
The file <code>field_theory/algebraic_closure</code> is the closest thing to compiling.</p>
<p>It looks like I was half way through changing a bunch of assumptions from <code>is_algebraically_closed</code> to contains all the roots of polynomials in the base field.</p>
<p>There is another file in there <code>algebraic_closure2</code> or something, where I am halfway through a refactor, that might make some of the proofs a bit shorter, but probably isn't worth the effort.</p>
<p>I was planning a refactor to use algebra homs instead of field homs, and also a refactor to use Kenny's definition <code>is_integral</code> instead of the predicate I defined.</p>
<p>I'd be very happy to pass this on. Honestly, I won't have that much time to look at it, but I'm very happy to answer questions from anyone who wants to take it on.</p>
<p>Sorry for the delay.</p>

<a name="171406405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/171406405" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#171406405">Johan Commelin (Jul 22 2019 at 06:19)</a>:</h4>
<p><span class="user-mention" data-user-id="198529">@Casper Putz</span> <span aria-label="up" class="emoji emoji-2b06" role="img" title="up">:up:</span></p>

<a name="172217724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/172217724" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#172217724">Chris Hughes (Aug 01 2019 at 12:59)</a>:</h4>
<p>I've started playing with algebraic closure again.</p>
<p>One issue is that direct limit is not set up very well for bundled homomorphisms currently. It should probably be done using category theory. I'd like to use bundled algebra homs, but the definition <code>directed_system</code> is only defined on functions, not bundled homs. I think I'm going to have to refactor. I was taking a direct limit where the indexing type was large, which won't sit too well with the category theory library currently.</p>

<a name="172222335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/172222335" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#172222335">Casper Putz (Aug 01 2019 at 13:55)</a>:</h4>
<p>Sorry for the late response. I was on holiday.<br>
Thanks for your updates. I also don't have a lot of time to delve into.</p>

<a name="172222344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/172222344" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#172222344">Casper Putz (Aug 01 2019 at 13:55)</a>:</h4>
<p>For the things I am doing it seemed more natural to not carry around an algebraic closure when talking about algebraic field extensions. So I am now working with field homs now. But of course we still need the algebraic at some point.</p>

<a name="172266239"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/172266239" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#172266239">Scott Morrison (Aug 01 2019 at 22:14)</a>:</h4>
<p>Can you explain about the size of the indexing type? (I don't know how you're doing algebraic closure.)</p>

<a name="172268193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/172268193" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#172268193">Chris Hughes (Aug 01 2019 at 22:45)</a>:</h4>
<p>I had this type, and took the maximal element of this type using zorn. I had to use direct limit to prove the condition for Zorn's lemma. The indexing type was <code>extension K</code>. I would then prove the type was isomorphic to something in <code>Type u</code> and transfer the field structure</p>
<div class="codehilite"><pre><span></span><span class="kn">structure</span> <span class="n">extension</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">K</span><span class="o">]</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">(</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">carrier</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span>
<span class="o">[</span><span class="n">field</span> <span class="o">:</span> <span class="n">discrete_field</span> <span class="n">carrier</span><span class="o">]</span>
<span class="o">(</span><span class="n">embedding</span> <span class="o">:</span> <span class="n">carrier</span> <span class="err">↪</span> <span class="n">big_type</span> <span class="n">K</span><span class="o">)</span>
<span class="o">(</span><span class="n">lift</span> <span class="o">:</span> <span class="n">K</span> <span class="bp">→</span> <span class="n">carrier</span><span class="o">)</span>
<span class="o">[</span><span class="n">is_field_hom</span> <span class="o">:</span> <span class="n">is_field_hom</span> <span class="n">lift</span><span class="o">]</span>
<span class="o">(</span><span class="n">algebraic</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">algebraic</span> <span class="n">lift</span> <span class="n">x</span><span class="o">)</span>
</pre></div>


<p>I'm not following this approach any more, I'll just use a smaller type for extension, where the field structure has to be on a subset of <code>big_type : Type u</code>. This involves slightly more transferring field structures across isomorphisms, but shouldn't be that much more effort, if at all.</p>

<a name="172295184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/172295184" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#172295184">Chris Hughes (Aug 02 2019 at 09:26)</a>:</h4>
<p>I believe I could probably get a version of algebraic closure done this weekend with a few sorries. The structure of the proof will all be there, so anyone will be able to help fill in the sorries without having to understand the entire approach.</p>

<a name="172420999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/172420999" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#172420999">Chris Hughes (Aug 03 2019 at 20:55)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/1297" target="_blank" title="https://github.com/leanprover-community/mathlib/issues/1297">#1297</a></p>

<a name="174120328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174120328" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174120328">Johan Commelin (Aug 26 2019 at 07:22)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span> What is the status here? If we fill in all the sorries in <code>algebraic_closure.lean</code>, then we are done right?</p>

<a name="174120344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174120344" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174120344">Johan Commelin (Aug 26 2019 at 07:22)</a>:</h4>
<p>We've had some nice community efforts recently. This might be a good one for the end of this month.</p>

<a name="174120600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174120600" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174120600">Chris Hughes (Aug 26 2019 at 07:29)</a>:</h4>
<p>Yes. However, it would be nicer to do some refactoring first, and get <code>direct_limit</code> to use bundled ring homs.</p>

<a name="174120625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174120625" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174120625">Chris Hughes (Aug 26 2019 at 07:29)</a>:</h4>
<p>Because I really don't want to make the refactor that will have to be done way harder by adding a bunch of stuff with unbundled homs.</p>

<a name="174120812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174120812" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174120812">Johan Commelin (Aug 26 2019 at 07:33)</a>:</h4>
<p>Ok, I'll work on the top few sorries (min polynomials)</p>

<a name="174120819"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174120819" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174120819">Johan Commelin (Aug 26 2019 at 07:33)</a>:</h4>
<p>That should be independent, I guess.</p>

<a name="174120822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174120822" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174120822">Chris Hughes (Aug 26 2019 at 07:33)</a>:</h4>
<p>Just realised one of them is false.</p>

<a name="174120835"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174120835" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174120835">Chris Hughes (Aug 26 2019 at 07:33)</a>:</h4>
<p>That was sloppy of me.</p>

<a name="174121173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174121173" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174121173">Johan Commelin (Aug 26 2019 at 07:40)</a>:</h4>
<p>No worries</p>

<a name="174136975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174136975" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174136975">Amelia Livingston (Aug 26 2019 at 12:31)</a>:</h4>
<p>I can make a PR today changing <code>semiring_hom</code> to <code>ring_hom</code> if that'd help - I'm thinking of removing <code>semiring_hom</code> completely and just adding good docstrings to say that <code>ring_hom</code> should be used for semiring homs too, unless there's a better way.</p>

<a name="174138305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174138305" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174138305">Johan Commelin (Aug 26 2019 at 12:54)</a>:</h4>
<p>I just pushed a change</p>

<a name="174138325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174138325" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174138325">Johan Commelin (Aug 26 2019 at 12:55)</a>:</h4>
<p>I put <code>minimal_polynomial</code> in its own file. The top of the file now contains a whole bunch of stuff that should move to <code>polynomial.lean</code>.</p>

<a name="174138340"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174138340" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174138340">Johan Commelin (Aug 26 2019 at 12:55)</a>:</h4>
<p>I've filled in all the sorries about minimal polynomials.</p>

<a name="174142282"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174142282" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174142282">Johan Commelin (Aug 26 2019 at 13:44)</a>:</h4>
<p>Removed the next sorry as well.</p>

<a name="174142502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174142502" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174142502">Chris Hughes (Aug 26 2019 at 13:47)</a>:</h4>
<p>How about putting the minimal polynomial stuff in a separate PR?</p>

<a name="174142612"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174142612" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174142612">Johan Commelin (Aug 26 2019 at 13:49)</a>:</h4>
<p>I'm fine with that</p>

<a name="174142627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174142627" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174142627">Johan Commelin (Aug 26 2019 at 13:49)</a>:</h4>
<p>Anyone who wants to join in can help</p>

<a name="174142661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174142661" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174142661">Johan Commelin (Aug 26 2019 at 13:49)</a>:</h4>
<p>I was hoping that we could push this like we did with sensitivity and the IMO problems</p>

<a name="174143338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174143338" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174143338">Johan Commelin (Aug 26 2019 at 13:56)</a>:</h4>
<p>There are already a whole lot of <code>-- move this</code> comments that could also be put into a separate PR</p>

<a name="174154602"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174154602" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174154602">Johan Commelin (Aug 26 2019 at 16:03)</a>:</h4>
<p>I pushed more stuff to this branch. I moved an instance up a bit, and generalised if from discrete fields to rings. Now Lean is unhappy.</p>

<a name="174154614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174154614" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174154614">Johan Commelin (Aug 26 2019 at 16:04)</a>:</h4>
<p>Need to catch a train. Will look at this later.</p>

<a name="174175080"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174175080" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174175080">Johan Commelin (Aug 26 2019 at 20:40)</a>:</h4>
<p>Removed another <code>sorry</code>, and pushed.</p>

<a name="174214576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174214576" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174214576">Johan Commelin (Aug 27 2019 at 10:19)</a>:</h4>
<p>Merged two sorries. Pushed.</p>

<a name="174216674"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174216674" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174216674">Johan Commelin (Aug 27 2019 at 10:51)</a>:</h4>
<blockquote>
<p>I can make a PR today changing <code>semiring_hom</code> to <code>ring_hom</code> if that'd help - I'm thinking of removing <code>semiring_hom</code> completely and just adding good docstrings to say that <code>ring_hom</code> should be used for semiring homs too, unless there's a better way.</p>
</blockquote>
<p><span class="user-mention" data-user-id="118107">@Amelia Livingston</span> Thanks for all your hard work! I'm pretty sure this is going to pay off in the long run.</p>

<a name="174216758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174216758" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174216758">Amelia Livingston (Aug 27 2019 at 10:52)</a>:</h4>
<p>No problem! Thanks for reviewing it.</p>

<a name="174216760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174216760" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174216760">Johan Commelin (Aug 27 2019 at 10:52)</a>:</h4>
<p>The file on algebraic closures is quite a tangle. I'm not sure if bundled homs will be used this time. I still haven't understood which parts of the file are essential, and which ones aren't.</p>

<a name="174216797"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174216797" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174216797">Johan Commelin (Aug 27 2019 at 10:52)</a>:</h4>
<p>It would be nice if it were easier to explore such dependency graphs... for example in VScode....</p>

<a name="174218030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174218030" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174218030">Chris Hughes (Aug 27 2019 at 11:08)</a>:</h4>
<blockquote>
<p>The file on algebraic closures is quite a tangle. I'm not sure if bundled homs will be used this time. I still haven't understood which parts of the file are essential, and which ones aren't.</p>
</blockquote>
<p>I think all parts of the file on algebraic closures are essential, except perhaps one def where there is a comment saying it might be unnecessary.</p>

<a name="174218242"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174218242" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174218242">Johan Commelin (Aug 27 2019 at 11:12)</a>:</h4>
<p>I feel like you never use the direct limit stuff</p>

<a name="174218248"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174218248" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174218248">Johan Commelin (Aug 27 2019 at 11:12)</a>:</h4>
<p>In the end you just write an explicit union</p>

<a name="174218261"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174218261" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174218261">Chris Hughes (Aug 27 2019 at 11:12)</a>:</h4>
<p>But I need the direct limit to put a field structure on it.</p>

<a name="174218263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174218263" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174218263">Johan Commelin (Aug 27 2019 at 11:12)</a>:</h4>
<p>Aah, right, now I see.</p>

<a name="174218300"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174218300" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174218300">Chris Hughes (Aug 27 2019 at 11:13)</a>:</h4>
<p>I could have done that without direct limit, but the argument was actually quite hard, even thought it's "obvious".</p>

<a name="174219365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174219365" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174219365">Johan Commelin (Aug 27 2019 at 11:29)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span> I'm confused about the preorder that you put on <code>extension K</code></p>

<a name="174219380"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174219380" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174219380">Johan Commelin (Aug 27 2019 at 11:29)</a>:</h4>
<p>Don't you want the inclusions to be algebra homs, instead of merely ring homs?</p>

<a name="174219385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174219385" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174219385">Johan Commelin (Aug 27 2019 at 11:29)</a>:</h4>
<p>Or am I missing something?</p>

<a name="174220122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174220122" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174220122">Chris Hughes (Aug 27 2019 at 11:40)</a>:</h4>
<p>You'd have thought so, but the proof seems to go through without it. I was surprised as well.</p>

<a name="174220255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174220255" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174220255">Chris Hughes (Aug 27 2019 at 11:43)</a>:</h4>
<p>Can you not prove the maximal extension is algebraic without it?</p>

<a name="174220278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174220278" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174220278">Chris Hughes (Aug 27 2019 at 11:43)</a>:</h4>
<p>Makes sense that you wouldn't be able to do that.</p>

<a name="174220753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174220753" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174220753">Johan Commelin (Aug 27 2019 at 11:50)</a>:</h4>
<p>I'm currently refactoring it, to include the assumption</p>

<a name="174221447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174221447" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174221447">Chris Hughes (Aug 27 2019 at 12:00)</a>:</h4>
<p>Perhaps it's useful to make an <code>is_alg_hom</code> predicate if there isn't one already?</p>

<a name="174223235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174223235" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174223235">Johan Commelin (Aug 27 2019 at 12:26)</a>:</h4>
<p>Ok, for the existence of an algebraic closure, there is 1 sorry left.</p>

<a name="174223243"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174223243" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174223243">Johan Commelin (Aug 27 2019 at 12:26)</a>:</h4>
<p>For the ump there are still a few more.</p>

<a name="174223261"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174223261" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174223261">Johan Commelin (Aug 27 2019 at 12:27)</a>:</h4>
<p>(UMP = every algebraic extension embeds into K-bar)</p>

<a name="174223598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174223598" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174223598">Chris Hughes (Aug 27 2019 at 12:31)</a>:</h4>
<p>What is the one sorry?</p>

<a name="174229293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174229293" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174229293">Johan Commelin (Aug 27 2019 at 13:36)</a>:</h4>
<p>That being an algebraic extension is transitive.</p>

<a name="174235526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174235526" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174235526">Johan Commelin (Aug 27 2019 at 14:41)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> Do we have anything of the form <code>M/L</code> is fg and <code>L/K</code> is fg, hence <code>M/K</code> is fg?</p>

<a name="174235595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174235595" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174235595">Johan Commelin (Aug 27 2019 at 14:42)</a>:</h4>
<p>Where <code>M/L/K</code> is a tower of algebras (or subalgebras)...</p>

<a name="174235617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174235617" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174235617">Kenny Lau (Aug 27 2019 at 14:42)</a>:</h4>
<p>I think so</p>

<a name="174236562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174236562" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174236562">Patrick Massot (Aug 27 2019 at 14:52)</a>:</h4>
<p>(deleted)</p>

<a name="174236576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174236576" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174236576">Patrick Massot (Aug 27 2019 at 14:52)</a>:</h4>
<p>(deleted)</p>

<a name="174236595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174236595" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174236595">Patrick Massot (Aug 27 2019 at 14:52)</a>:</h4>
<p>(deleted)</p>

<a name="174237082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174237082" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174237082">Johan Commelin (Aug 27 2019 at 14:58)</a>:</h4>
<p>Here is what I have now:</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">adjoin_root</span><span class="bp">.</span><span class="n">algebraic</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">adjoin_root</span> <span class="n">f</span><span class="o">)</span> <span class="o">:</span> <span class="n">is_integral</span> <span class="n">K</span> <span class="n">x</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rcases</span> <span class="n">adjoin_root</span><span class="bp">.</span><span class="n">is_integral</span> <span class="n">hif</span><span class="bp">.</span><span class="n">ne_zero</span> <span class="n">x</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">p</span><span class="o">,</span> <span class="n">pmonic</span><span class="o">,</span> <span class="n">hp</span><span class="bp">⟩</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">adjoin_root</span> <span class="n">f</span><span class="o">)</span> <span class="o">:=</span>
    <span class="o">(</span><span class="err">↑</span><span class="o">((</span><span class="n">finset</span><span class="bp">.</span><span class="n">range</span> <span class="o">(</span><span class="n">f</span><span class="bp">.</span><span class="n">nat_degree</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span><span class="bp">.</span><span class="n">image</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span><span class="bp">.</span><span class="n">coeff</span> <span class="n">i</span> <span class="o">:</span> <span class="n">adjoin_root</span> <span class="n">f</span><span class="o">)))</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">adjoin_root</span> <span class="n">f</span><span class="o">)),</span>
  <span class="k">let</span> <span class="n">B</span> <span class="o">:=</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">adjoin</span> <span class="n">K</span> <span class="n">S</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">Bfg</span> <span class="o">:</span> <span class="n">submodule</span><span class="bp">.</span><span class="n">fg</span> <span class="o">(</span><span class="n">B</span> <span class="o">:</span> <span class="n">submodule</span> <span class="n">K</span> <span class="o">(</span><span class="n">adjoin_root</span> <span class="n">f</span><span class="o">)),</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">fg_adjoin_of_finite</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">apply</span> <span class="n">finset</span><span class="bp">.</span><span class="n">finite_to_set</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">finset</span><span class="bp">.</span><span class="n">mem_coe</span><span class="o">,</span> <span class="n">finset</span><span class="bp">.</span><span class="n">mem_image</span><span class="o">]</span> <span class="n">at</span> <span class="n">hx</span><span class="o">,</span>
      <span class="n">rcases</span> <span class="n">hx</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">hi</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span><span class="o">,</span>
      <span class="n">rcases</span> <span class="n">L</span><span class="bp">.</span><span class="n">algebraic</span> <span class="o">(</span><span class="n">f</span><span class="bp">.</span><span class="n">coeff</span> <span class="n">i</span><span class="o">)</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">q</span><span class="o">,</span> <span class="n">qmonic</span><span class="o">,</span> <span class="n">hq</span><span class="bp">⟩</span><span class="o">,</span>
      <span class="n">use</span> <span class="o">[</span><span class="n">q</span><span class="o">,</span> <span class="n">qmonic</span><span class="o">],</span>
      <span class="n">replace</span> <span class="n">hq</span> <span class="o">:=</span> <span class="n">congr_arg</span> <span class="o">(</span><span class="n">coe</span> <span class="o">:</span> <span class="n">L</span><span class="bp">.</span><span class="n">carrier</span> <span class="bp">→</span> <span class="n">adjoin_root</span> <span class="n">f</span><span class="o">)</span> <span class="n">hq</span><span class="o">,</span>
      <span class="n">convert</span> <span class="n">hq</span> <span class="kn">using</span> <span class="mi">1</span><span class="o">,</span>
      <span class="o">{</span> <span class="n">symmetry</span><span class="o">,</span> <span class="n">exact</span> <span class="n">polynomial</span><span class="bp">.</span><span class="n">hom_eval₂</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="o">},</span>
      <span class="o">{</span> <span class="n">symmetry</span><span class="o">,</span> <span class="n">exact</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_zero</span> <span class="bp">_</span> <span class="o">}</span> <span class="o">}</span> <span class="o">},</span>

  <span class="c1">-- (1) we know that x is integral over L, by adjoin_root.is_integral</span>
  <span class="c1">-- (2) we know that B is fg over K</span>
  <span class="c1">-- (3) we want to say that adjoin B {x} is fg over B, because (1)</span>
  <span class="c1">-- (4) hence adjoin B {x} is fg over K</span>
  <span class="c1">-- (5) and then we are done by is_integral_of_mem_of_fg</span>

  <span class="c1">-- refine is_integral_of_mem_of_fg (algebra.adjoin K S) _ x (algebra.subset_adjoin $ mem_insert _ _),</span>
  <span class="n">sorry</span>
<span class="kn">end</span>
</pre></div>

<a name="174237111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174237111" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174237111">Johan Commelin (Aug 27 2019 at 14:59)</a>:</h4>
<p>Any help with removing this sorry is very much appreciated.</p>

<a name="174237120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174237120" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174237120">Johan Commelin (Aug 27 2019 at 14:59)</a>:</h4>
<p>I need to start moving to a train now</p>

<a name="174237228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174237228" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174237228">Johan Commelin (Aug 27 2019 at 15:00)</a>:</h4>
<p>This is the final sorry in the definition of the algebraic closure...</p>

<a name="174238756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174238756" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174238756">Johan Commelin (Aug 27 2019 at 15:17)</a>:</h4>
<p>Transitivity of fg is here: <a href="https://github.com/leanprover-community/mathlib/blob/d2c5309d0bc66bdf813b4510dfe0a1d7523cad0a/src/ring_theory/adjoin.lean#L109" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/d2c5309d0bc66bdf813b4510dfe0a1d7523cad0a/src/ring_theory/adjoin.lean#L109">https://github.com/leanprover-community/mathlib/blob/d2c5309d0bc66bdf813b4510dfe0a1d7523cad0a/src/ring_theory/adjoin.lean#L109</a></p>

<a name="174268330"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174268330" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174268330">Johan Commelin (Aug 27 2019 at 20:29)</a>:</h4>
<p>All in all, this is becoming a very sad experience.</p>

<a name="174268365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174268365" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174268365">Johan Commelin (Aug 27 2019 at 20:29)</a>:</h4>
<p>I've reduced the final sorry to a content-free battle against the type-class system.</p>

<a name="174268405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174268405" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174268405">Johan Commelin (Aug 27 2019 at 20:29)</a>:</h4>
<p>There are now 4 goals left of the form <code>is_monoid_hom coe</code>.</p>

<a name="174268419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174268419" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174268419">Johan Commelin (Aug 27 2019 at 20:29)</a>:</h4>
<p>And whatever I do: deterministic timeout.</p>

<a name="174268509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174268509" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174268509">Johan Commelin (Aug 27 2019 at 20:30)</a>:</h4>
<p>If someone wants to help me out, that would be much appreciated.</p>

<a name="174268520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174268520" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174268520">Johan Commelin (Aug 27 2019 at 20:30)</a>:</h4>
<p>I need to go to bed now.</p>

<a name="174268726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174268726" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174268726">Johan Commelin (Aug 27 2019 at 20:32)</a>:</h4>
<p>I've pushed all my changes to <a href="https://github.com/leanprover-community/mathlib/blob/algebraic_closure/src/field_theory/algebraic_closure.lean" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/algebraic_closure/src/field_theory/algebraic_closure.lean">https://github.com/leanprover-community/mathlib/blob/algebraic_closure/src/field_theory/algebraic_closure.lean</a></p>

<a name="174311409"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174311409" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174311409">Patrick Massot (Aug 27 2019 at 21:12)</a>:</h4>
<p>The evil combination "coercion + hom" is the mostly effective way to bring Lean 3 to its limit.</p>

<a name="174311551"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174311551" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174311551">Chris Hughes (Aug 27 2019 at 21:15)</a>:</h4>
<p>What is the <code>coe</code> in question?</p>

<a name="174312158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174312158" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174312158">Patrick Massot (Aug 27 2019 at 21:24)</a>:</h4>
<p>Are we talking about <a href="https://github.com/leanprover-community/mathlib/blob/f3620a68e9e1913ba42fa2951c44e70c63b37785/src/field_theory/algebraic_closure.lean#L604" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/f3620a68e9e1913ba42fa2951c44e70c63b37785/src/field_theory/algebraic_closure.lean#L604">https://github.com/leanprover-community/mathlib/blob/f3620a68e9e1913ba42fa2951c44e70c63b37785/src/field_theory/algebraic_closure.lean#L604</a>? Even without reading anything or running Lean, it's clear that something is not yet setup right</p>

<a name="174312933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174312933" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174312933">Chris Hughes (Aug 27 2019 at 21:37)</a>:</h4>
<p>Bundled homs is the solution.</p>

<a name="174312954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174312954" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174312954">Chris Hughes (Aug 27 2019 at 21:37)</a>:</h4>
<p>Also I think that <code>coe</code> might be bad.</p>

<a name="174332328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174332328" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174332328">Johan Commelin (Aug 28 2019 at 04:52)</a>:</h4>
<p>Bundled homs are a major pain. For example, I've tried to use <code>subalgebra.val B</code>, which is a bundled algebra hom. But the coercion to function doesn't fire (even with 23 type ascriptions and up arrows). So I fall back to <code>algebra_map</code>.</p>

<a name="174333251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174333251" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174333251">Johan Commelin (Aug 28 2019 at 05:13)</a>:</h4>
<p>Another data point:</p>
<div class="codehilite"><pre><span></span><span class="n">function</span> <span class="n">expected</span> <span class="n">at</span>
  <span class="n">aeval</span> <span class="err">↥</span><span class="o">(</span><span class="n">L</span><span class="bp">.</span><span class="n">carrier</span><span class="o">)</span> <span class="o">(</span><span class="n">adjoin_root</span> <span class="n">f</span><span class="o">)</span> <span class="n">x</span>
<span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="n">polynomial</span> <span class="err">↥</span><span class="o">(</span><span class="n">L</span><span class="bp">.</span><span class="n">carrier</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₐ</span><span class="o">[</span><span class="err">↥</span><span class="o">(</span><span class="n">L</span><span class="bp">.</span><span class="n">carrier</span><span class="o">)]</span> <span class="n">adjoin_root</span> <span class="n">f</span>
</pre></div>


<p>Stupid Lean!!! If you expect a function, why don't you try to see if you can coerce the stupid thing??</p>

<a name="174333547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174333547" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174333547">Johan Commelin (Aug 28 2019 at 05:21)</a>:</h4>
<p>Maybe it's not actually bundled homs that we need, but bundled algebras</p>

<a name="174335297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174335297" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174335297">Johan Commelin (Aug 28 2019 at 06:02)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span> Do you remember why you need these instances for <code>adjoin_root</code>?<br>
<a href="https://github.com/leanprover-community/mathlib/blob/f3620a68e9e1913ba42fa2951c44e70c63b37785/src/field_theory/algebraic_closure.lean#L586" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/f3620a68e9e1913ba42fa2951c44e70c63b37785/src/field_theory/algebraic_closure.lean#L586">https://github.com/leanprover-community/mathlib/blob/f3620a68e9e1913ba42fa2951c44e70c63b37785/src/field_theory/algebraic_closure.lean#L586</a></p>

<a name="174335307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174335307" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174335307">Johan Commelin (Aug 28 2019 at 06:02)</a>:</h4>
<p>Is this something with putting them at the top of the stack, so that they are found faster?</p>

<a name="174335312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174335312" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174335312">Johan Commelin (Aug 28 2019 at 06:03)</a>:</h4>
<p>Because those instances already exist, right...</p>

<a name="174335394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174335394" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174335394">Chris Hughes (Aug 28 2019 at 06:06)</a>:</h4>
<p>I guess it must be just so that they are found faster, or at all. At some point I was going to go through the file and make all the instances local, since they're about private defs anyway.</p>

<a name="174335611"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174335611" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174335611">Johan Commelin (Aug 28 2019 at 06:11)</a>:</h4>
<blockquote>
<p>Another data point:</p>
<div class="codehilite"><pre><span></span><span class="n">function</span> <span class="n">expected</span> <span class="n">at</span>
  <span class="n">aeval</span> <span class="err">↥</span><span class="o">(</span><span class="n">L</span><span class="bp">.</span><span class="n">carrier</span><span class="o">)</span> <span class="o">(</span><span class="n">adjoin_root</span> <span class="n">f</span><span class="o">)</span> <span class="n">x</span>
<span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="n">polynomial</span> <span class="err">↥</span><span class="o">(</span><span class="n">L</span><span class="bp">.</span><span class="n">carrier</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₐ</span><span class="o">[</span><span class="err">↥</span><span class="o">(</span><span class="n">L</span><span class="bp">.</span><span class="n">carrier</span><span class="o">)]</span> <span class="n">adjoin_root</span> <span class="n">f</span>
</pre></div>


<p>Stupid Lean!!! If you expect a function, why don't you try to see if you can coerce the stupid thing??</p>
</blockquote>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Do you have any idea why these things happen?</p>

<a name="174345263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174345263" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174345263">Mario Carneiro (Aug 28 2019 at 09:11)</a>:</h4>
<p>The usual reason is because there are metavariables in the type that is being coerced to a function</p>

<a name="174345282"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174345282" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174345282">Mario Carneiro (Aug 28 2019 at 09:11)</a>:</h4>
<p>I don't see them in this snippet but it's possible they are hidden in an implicit</p>

<a name="174345296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174345296" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174345296">Johan Commelin (Aug 28 2019 at 09:11)</a>:</h4>
<p>I'll try some more</p>

<a name="174345299"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174345299" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174345299">Mario Carneiro (Aug 28 2019 at 09:11)</a>:</h4>
<p>It's probably the up arrow</p>

<a name="174354434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174354434" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174354434">Johan Commelin (Aug 28 2019 at 11:55)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">algebraic_trans</span> <span class="o">(</span><span class="n">B_alg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="o">:</span> <span class="n">B</span><span class="o">,</span> <span class="n">is_integral</span> <span class="n">A</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∀</span> <span class="n">x</span> <span class="o">:</span> <span class="n">comap</span> <span class="n">R</span> <span class="n">A</span> <span class="n">B</span><span class="o">,</span> <span class="n">is_integral</span> <span class="n">R</span> <span class="n">x</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">is_integral_trans</span> <span class="n">A_alg</span> <span class="n">x</span> <span class="o">(</span><span class="n">B_alg</span> <span class="n">x</span><span class="o">)</span>
</pre></div>

<a name="174354828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174354828" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174354828">Johan Commelin (Aug 28 2019 at 12:01)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">adjoin_root</span><span class="bp">.</span><span class="n">algebraic</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">adjoin_root</span> <span class="n">f</span><span class="o">)</span> <span class="o">:</span> <span class="n">is_integral</span> <span class="n">K</span> <span class="n">x</span> <span class="o">:=</span>
<span class="n">is_integral_trans</span> <span class="n">L</span><span class="bp">.</span><span class="n">algebraic</span> <span class="n">x</span> <span class="err">$</span> <span class="n">adjoin_root</span><span class="bp">.</span><span class="n">is_integral</span> <span class="n">hif</span><span class="bp">.</span><span class="n">ne_zero</span> <span class="n">x</span>
</pre></div>

<a name="174354881"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174354881" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174354881">Johan Commelin (Aug 28 2019 at 12:02)</a>:</h4>
<p>That's everything that's left of the big mess that I complained about earlier.</p>

<a name="174354904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174354904" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174354904">Johan Commelin (Aug 28 2019 at 12:02)</a>:</h4>
<p>In particular, we have a sorry-free definition of the algebraic closure!</p>

<a name="174354929"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174354929" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174354929">Patrick Massot (Aug 28 2019 at 12:03)</a>:</h4>
<p>Does it have any property, or is it only a type build out of a field?</p>

<a name="174355010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174355010" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174355010">Johan Commelin (Aug 28 2019 at 12:04)</a>:</h4>
<p>It is an algebraically closed field that is algebraic over the field you start with.</p>

<a name="174355017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174355017" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174355017">Johan Commelin (Aug 28 2019 at 12:04)</a>:</h4>
<p>What remains is to show that every algebraic extension embeds into it.</p>

<a name="174355022"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174355022" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174355022">Patrick Massot (Aug 28 2019 at 12:04)</a>:</h4>
<p>Nice!</p>

<a name="174355026"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174355026" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174355026">Johan Commelin (Aug 28 2019 at 12:04)</a>:</h4>
<p>I just pushed</p>

<a name="174355167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174355167" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174355167">Patrick Massot (Aug 28 2019 at 12:06)</a>:</h4>
<p>Did you learn any useful new trick? Or is it the old trick of being more patient than Lean?</p>

<a name="174355201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174355201" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174355201">Johan Commelin (Aug 28 2019 at 12:07)</a>:</h4>
<p>Generalising, and proving helper lemmas...</p>

<a name="174355215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174355215" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174355215">Johan Commelin (Aug 28 2019 at 12:07)</a>:</h4>
<p>extract_goal is very useful <span class="user-mention" data-user-id="110026">@Simon Hudon</span></p>

<a name="174355281"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174355281" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174355281">Johan Commelin (Aug 28 2019 at 12:08)</a>:</h4>
<p>It should just come with a bit more VScode glue, so that it write all my code for me (-;</p>

<a name="174355293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174355293" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174355293">Patrick Massot (Aug 28 2019 at 12:08)</a>:</h4>
<p>I still see lines like <code>refine @eval_map _ _ _ _ _ _ _ _ (by exact is_ring_hom.is_semiring_hom _) _ </code> that show some suffering</p>

<a name="174355317"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174355317" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174355317">Patrick Massot (Aug 28 2019 at 12:08)</a>:</h4>
<p>especially since that line is actually closing a goal</p>

<a name="174355343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174355343" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174355343">Johan Commelin (Aug 28 2019 at 12:09)</a>:</h4>
<p>(1) It should cook up a meaningul name. (2) It should paste the code above the current declaration. (3) It should take into account existing variables. (4) It should gracefully handle <code>let</code> statements. (5) It should apply the extracted lemma at the location of calling <code>extract_goal</code>, in order to close the goal in question.</p>

<a name="174355356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174355356" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174355356">Patrick Massot (Aug 28 2019 at 12:09)</a>:</h4>
<p>and make some coffee</p>

<a name="174355403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174355403" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174355403">Johan Commelin (Aug 28 2019 at 12:10)</a>:</h4>
<p>True, there was still a small amount of suffering involved. Probably because I'm cheating there.</p>

<a name="174355428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174355428" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174355428">Patrick Massot (Aug 28 2019 at 12:10)</a>:</h4>
<p>What kind of cheating?</p>

<a name="174355449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174355449" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174355449">Johan Commelin (Aug 28 2019 at 12:11)</a>:</h4>
<p>I'm identifying <code>comap R A B</code> with <code>B</code>. I should probably use the ring homs <code>to_comap</code> and <code>of_comap</code> to move between the two.</p>

<a name="174355745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174355745" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174355745">Johan Commelin (Aug 28 2019 at 12:15)</a>:</h4>
<p><span class="user-mention" data-user-id="110026">@Simon Hudon</span> I realise that those 5 feature requests have very different orders of feasability. I just posted them in a random order to stimulate your imagination (-;</p>

<a name="174355854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174355854" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174355854">Patrick Massot (Aug 28 2019 at 12:16)</a>:</h4>
<p>For instance, it could also pat the author on the back after succeeding.</p>

<a name="174356010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174356010" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174356010">Johan Commelin (Aug 28 2019 at 12:19)</a>:</h4>
<p>Wait, you mean that <code>extract_goal</code> doesn't yet buy Simon a beer each time it's called?</p>

<a name="174356031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174356031" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174356031">Patrick Massot (Aug 28 2019 at 12:19)</a>:</h4>
<p>I meant <em>your</em> back</p>

<a name="174356087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174356087" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174356087">Patrick Massot (Aug 28 2019 at 12:20)</a>:</h4>
<p>I'd love Lean to congratulate me more often when I win a big fight</p>

<a name="174356107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174356107" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174356107">Patrick Massot (Aug 28 2019 at 12:20)</a>:</h4>
<p>The "goals accomplished" congratulation is too generic</p>

<a name="174356124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174356124" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174356124">Johan Commelin (Aug 28 2019 at 12:21)</a>:</h4>
<p>But if you win the fight using Simon's tools. Doesn't he also deserve a pat on the back? Especially if he doesn't even know you're using his tools.</p>

<a name="174356125"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174356125" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174356125">Patrick Massot (Aug 28 2019 at 12:21)</a>:</h4>
<p>and using extract_goal is a clear big fight indication</p>

<a name="174356237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174356237" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174356237">Patrick Massot (Aug 28 2019 at 12:22)</a>:</h4>
<p>Sure</p>

<a name="174356275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174356275" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174356275">Simon Hudon (Aug 28 2019 at 12:23)</a>:</h4>
<p>:) I'm glad you're enjoying the tool</p>

<a name="174356383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174356383" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174356383">Simon Hudon (Aug 28 2019 at 12:24)</a>:</h4>
<p>I don't think I have an approach on any of those features (except for making coffee :P). I'm not familiar with the writing of tools in VS code so that doesn't make things easier but even in emacs, I'm not sure how I would do them</p>

<a name="174356411"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174356411" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174356411">Patrick Massot (Aug 28 2019 at 12:24)</a>:</h4>
<p>I thought you knew about hole commands</p>

<a name="174356427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174356427" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174356427">Patrick Massot (Aug 28 2019 at 12:25)</a>:</h4>
<p>I remember you writing some</p>

<a name="174356563"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174356563" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174356563">Simon Hudon (Aug 28 2019 at 12:26)</a>:</h4>
<p>Yes I know about hole commands but they don't mix well with tactic proofs and I don't think they can affect any of the text outside of the <code>{!  !}</code> brackets</p>

<a name="174356717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174356717" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174356717">Simon Hudon (Aug 28 2019 at 12:28)</a>:</h4>
<p>To write those features, we need an editor plugin with a notion of where declarations begin and end</p>

<a name="174356783"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174356783" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174356783">Patrick Massot (Aug 28 2019 at 12:29)</a>:</h4>
<p><a href="https://images-na.ssl-images-amazon.com/images/I/61JxY8tH-yL._SL1000_.jpg" target="_blank" title="https://images-na.ssl-images-amazon.com/images/I/61JxY8tH-yL._SL1000_.jpg">https://images-na.ssl-images-amazon.com/images/I/61JxY8tH-yL._SL1000_.jpg</a> looks promising</p>
<div class="message_inline_image"><a href="https://images-na.ssl-images-amazon.com/images/I/61JxY8tH-yL._SL1000_.jpg" target="_blank" title="https://images-na.ssl-images-amazon.com/images/I/61JxY8tH-yL._SL1000_.jpg"><img src="https://images-na.ssl-images-amazon.com/images/I/61JxY8tH-yL._SL1000_.jpg"></a></div>

<a name="174356789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174356789" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174356789">Simon Hudon (Aug 28 2019 at 12:29)</a>:</h4>
<p>As for treating variables better, I had a look a couple of weeks ago into adding some introspection into the variable mechanism in Lean 3.5 and it was more complicated than expected and I didn't pursue it</p>

<a name="174356797"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174356797" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174356797">Patrick Massot (Aug 28 2019 at 12:29)</a>:</h4>
<p>Oh sorry, you meant the other features</p>

<a name="174357062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174357062" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174357062">Patrick Massot (Aug 28 2019 at 12:32)</a>:</h4>
<p>I guess we would need a coffee monad in order to handle real-world side effects</p>

<a name="174359236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174359236" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174359236">Simon Hudon (Aug 28 2019 at 12:58)</a>:</h4>
<p>Easy peasy!</p>

<a name="174362535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174362535" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174362535">Wojciech Nawrocki (Aug 28 2019 at 13:35)</a>:</h4>
<p><a href="/user_uploads/3121/vdi3fqC0-AnxFCUhOCzYkuGD/coffee-maker.png" target="_blank" title="coffee-maker.png">Sorry, the (almost) anagram was too tempting</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/vdi3fqC0-AnxFCUhOCzYkuGD/coffee-maker.png" target="_blank" title="Sorry, the (almost) anagram was too tempting"><img src="/user_uploads/3121/vdi3fqC0-AnxFCUhOCzYkuGD/coffee-maker.png"></a></div>

<a name="174362627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174362627" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174362627">Johan Commelin (Aug 28 2019 at 13:36)</a>:</h4>
<p>You should sneak Erdos into that picture (-;</p>

<a name="174376480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174376480" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174376480">Johan Commelin (Aug 28 2019 at 15:56)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> How hard is it to fill in this hole?</p>
<div class="codehilite"><pre><span></span><span class="kn">namespace</span> <span class="n">subalgebra</span>
<span class="kn">open</span> <span class="n">set</span> <span class="n">lattice</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">B</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>
<span class="kn">variables</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">B</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">B</span><span class="o">]</span>

<span class="n">def</span> <span class="n">Sup</span><span class="bp">.</span><span class="n">desc</span> <span class="o">(</span><span class="n">Ss</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">subalgebra</span> <span class="n">R</span> <span class="n">A</span><span class="o">))</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">S</span> <span class="o">:</span> <span class="n">Ss</span><span class="o">,</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">subalgebra</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₐ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">B</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">S₁</span> <span class="n">S₂</span> <span class="o">:</span> <span class="n">Ss</span><span class="o">,</span> <span class="bp">∃</span> <span class="n">h</span> <span class="o">:</span> <span class="o">(</span><span class="n">S₁</span> <span class="o">:</span> <span class="n">subalgebra</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="bp">≤</span> <span class="n">S₂</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">S₂</span><span class="o">)</span> <span class="err">∘</span> <span class="n">inclusion</span> <span class="n">h</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">S₁</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">Sup</span> <span class="n">Ss</span> <span class="o">:</span> <span class="n">subalgebra</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₐ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">B</span> <span class="o">:=</span>
<span class="bp">_</span>

<span class="kn">end</span> <span class="n">subalgebra</span>
</pre></div>

<a name="174377372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174377372" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174377372">Johan Commelin (Aug 28 2019 at 16:05)</a>:</h4>
<p>Never mind, it's more painful than that.</p>

<a name="174388655"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174388655" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174388655">Johan Commelin (Aug 28 2019 at 18:24)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> How about this one?</p>
<div class="codehilite"><pre><span></span><span class="kn">namespace</span> <span class="n">algebra</span>
<span class="kn">open</span> <span class="n">set</span> <span class="n">polynomial</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">B</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>
<span class="kn">variables</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">B</span><span class="o">]</span>
<span class="kn">variables</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">B</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">B</span><span class="o">]</span>

<span class="n">def</span> <span class="n">adjoin_singleton_desc</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">is_integral</span> <span class="n">R</span> <span class="n">x</span><span class="o">)</span>
  <span class="o">(</span><span class="n">y</span> <span class="o">:</span> <span class="n">B</span><span class="o">)</span> <span class="o">(</span><span class="n">hy</span> <span class="o">:</span> <span class="n">aeval</span> <span class="n">R</span> <span class="n">B</span> <span class="n">y</span> <span class="o">(</span><span class="n">minimal_polynomial</span> <span class="n">hx</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span>
<span class="n">adjoin</span> <span class="n">R</span> <span class="o">({</span><span class="n">x</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="n">A</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₐ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">B</span> <span class="o">:=</span>
<span class="bp">_</span>

<span class="kn">end</span> <span class="n">algebra</span>
</pre></div>

<a name="174402264"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174402264" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174402264">Johan Commelin (Aug 28 2019 at 21:22)</a>:</h4>
<p>I'm going to bed now. Modulo my challenge to Kenny, the remaining sorries should be rather straightforward.</p>

<a name="174402274"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174402274" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174402274">Johan Commelin (Aug 28 2019 at 21:22)</a>:</h4>
<p>Feel free to fill them in while I'm asleep.</p>

<a name="174426729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174426729" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174426729">Chris Hughes (Aug 29 2019 at 06:08)</a>:</h4>
<p><code>polynomial.map</code> is hellish</p>

<a name="174426969"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174426969" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174426969">Johan Commelin (Aug 29 2019 at 06:14)</a>:</h4>
<p>What are you struggling with?</p>

<a name="174426987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174426987" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174426987">Johan Commelin (Aug 29 2019 at 06:15)</a>:</h4>
<p>I agree that I've often wished that <code>map</code> was defined in terms of <code>finsupp.map_codomain</code> or whatever the thing is called.</p>

<a name="174427137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174427137" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174427137">Johan Commelin (Aug 29 2019 at 06:18)</a>:</h4>
<p>Btw, in the end I didn't use your <code>subfield_and_hom</code> structure. I hope you don't mind. I think you would have to add the requirement that the field embeddings are compatible in the ordering. So you can't use <code>preorder.lift</code>, and hence you also can't apply the other <code>maximal_chain</code> thingies.</p>

<a name="174427142"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174427142" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174427142">Johan Commelin (Aug 29 2019 at 06:18)</a>:</h4>
<p>So I ended up defining <code>subfield_with_hom</code>, which I found a more intuitive approach. But that's a personal thing</p>

<a name="174427372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174427372" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174427372">Chris Hughes (Aug 29 2019 at 06:24)</a>:</h4>
<blockquote>
<p><code>polynomial.map</code> is hellish</p>
</blockquote>
<p>That's weird. I posted that comment yesterday after you were talking about <code>map</code>. It's showing as posted just now. I'm not doing anything with <code>map</code> right now.</p>

<a name="174427400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174427400" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174427400">Chris Hughes (Aug 29 2019 at 06:25)</a>:</h4>
<p>Which of the sorries did you get stuck on when you used <code>subfield_and_hom</code>? I agree that using subalgebras is more natural, but I was hoping I'd be able to reuse a bunch of stuff.</p>

<a name="174427575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174427575" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174427575">Chris Hughes (Aug 29 2019 at 06:29)</a>:</h4>
<p>I guess this one <code>-- Given K:L:M, if M is algebraic over K it is algebraic over L (names are different)</code></p>

<a name="174427878"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174427878" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174427878">Johan Commelin (Aug 29 2019 at 06:35)</a>:</h4>
<p>It's not clear how to define the embedding into the algebraically closed field  from the union of a bunch of subfields if those subfields don't have compatible embeddings into the algebraically closed field.</p>

<a name="174427924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174427924" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174427924">Chris Hughes (Aug 29 2019 at 06:36)</a>:</h4>
<p>You might still be able to do it my way. You just need to add to the order (do we know that intersection of preorders is a preorder?), and add one extra proof to <code>maximal_subfield_and_hom_chain</code> to prove some commutativity property from the direct limit.</p>

<a name="174427932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174427932" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174427932">Chris Hughes (Aug 29 2019 at 06:36)</a>:</h4>
<p>Maybe I'm trying too hard to save lines.</p>

<a name="174430701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174430701" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174430701">Johan Commelin (Aug 29 2019 at 07:36)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span> Do you have any clue why I get red squiglly lines under <code>E</code> in the type?</p>
<div class="codehilite"><pre><span></span><span class="kn">namespace</span> <span class="n">subalgebra</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">{</span><span class="n">L</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">L</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">K</span> <span class="n">L</span><span class="o">]</span>
<span class="kn">variables</span> <span class="o">(</span><span class="n">L_alg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span><span class="o">:</span><span class="n">L</span><span class="o">,</span> <span class="n">is_integral</span> <span class="n">K</span> <span class="n">x</span><span class="o">)</span>

<span class="kn">instance</span> <span class="o">(</span><span class="n">E</span> <span class="o">:</span> <span class="n">subalgebra</span> <span class="n">K</span> <span class="n">L</span><span class="o">)</span> <span class="o">:</span> <span class="n">discrete_field</span> <span class="o">(</span><span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">_</span>

<span class="kn">end</span> <span class="n">subalgebra</span>
</pre></div>

<a name="174430703"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174430703" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174430703">Johan Commelin (Aug 29 2019 at 07:36)</a>:</h4>
<p>It says max type class depth error</p>

<a name="174430710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174430710" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174430710">Johan Commelin (Aug 29 2019 at 07:36)</a>:</h4>
<p>But it should just coerce it to type... and I don't see what other type class search might be going on</p>

<a name="174430796"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174430796" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174430796">Chris Hughes (Aug 29 2019 at 07:38)</a>:</h4>
<p>There's no <code>has_coe_to_sort</code> instance for subalgbra.</p>

<a name="174430805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174430805" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174430805">Johan Commelin (Aug 29 2019 at 07:38)</a>:</h4>
<p>This line doesn't give errors:</p>
<div class="codehilite"><pre><span></span><span class="kn">instance</span> <span class="o">(</span><span class="n">E</span> <span class="o">:</span> <span class="n">subalgebra</span> <span class="n">K</span> <span class="n">L</span><span class="o">)</span> <span class="o">:</span> <span class="n">discrete_field</span> <span class="o">(</span><span class="n">subtype</span> <span class="n">E</span><span class="bp">.</span><span class="n">carrier</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">_</span>
</pre></div>

<a name="174430816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174430816" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174430816">Johan Commelin (Aug 29 2019 at 07:38)</a>:</h4>
<p>Aha... that's weird. Because I've been using it all over the place</p>

<a name="174430827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174430827" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174430827">Johan Commelin (Aug 29 2019 at 07:38)</a>:</h4>
<p>It can coerce to <code>set</code>, and then <code>subtype</code>. Both coercions exist. Why doesn't it chain them?</p>

<a name="174430844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174430844" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174430844">Chris Hughes (Aug 29 2019 at 07:39)</a>:</h4>
<p>No idea.</p>

<a name="174430851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174430851" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174430851">Johan Commelin (Aug 29 2019 at 07:39)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Any clue?</p>

<a name="174430855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174430855" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174430855">Johan Commelin (Aug 29 2019 at 07:39)</a>:</h4>
<p>I'm still mystified by things like this</p>

<a name="174432302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174432302" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174432302">Mario Carneiro (Aug 29 2019 at 08:03)</a>:</h4>
<p>If you write <code>E : Type v</code> then it will look for a coe to Type v rather than a coe_to_sort</p>

<a name="174432316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174432316" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174432316">Mario Carneiro (Aug 29 2019 at 08:03)</a>:</h4>
<p>does it work without the annotation?</p>

<a name="174432366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174432366" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174432366">Mario Carneiro (Aug 29 2019 at 08:04)</a>:</h4>
<p>The simplest mechanism is probably to write the funny up arrow (not the regular one, the one with a flat bottom)</p>

<a name="174432388"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/algebraic%20closure/near/174432388" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/74840algebraicclosure.html#174432388">Mario Carneiro (Aug 29 2019 at 08:05)</a>:</h4>
<p>I'm not even sure it has a latex shortcut, but it's short for <code>coe_sort</code></p>


{% endraw %}

{% include archive_update.html %}