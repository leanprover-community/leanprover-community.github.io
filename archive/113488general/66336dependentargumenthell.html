---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/66336dependentargumenthell.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html">dependent argument hell</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="133771753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133771753" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133771753">Scott Morrison (Sep 12 2018 at 01:19)</a>:</h4>
<p>I seem to have backed myself into a corner, and I don't understand how to escape. I would really appreciate some help, as it feels like this problem is an instance of one that will become more and more severe as we do more advanced maths.</p>

<a name="133771756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133771756" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133771756">Scott Morrison (Sep 12 2018 at 01:19)</a>:</h4>
<p>I've been working on morphisms of presheaves.</p>

<a name="133771768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133771768" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133771768">Scott Morrison (Sep 12 2018 at 01:19)</a>:</h4>
<p>These are "bundled" presheaves, so they consist of a topological space, along with a functor from the category of open sets (morphisms are subsets) to some other category.</p>

<a name="133771812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133771812" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133771812">Scott Morrison (Sep 12 2018 at 01:20)</a>:</h4>
<p>A morphism of presheaves <code>(X, O_X) \hom (Y, O_Y)</code> consists of a pair: a function <code>f : X \hom Y</code>, which is just a continuous map, and</p>

<a name="133771817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133771817" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133771817">Scott Morrison (Sep 12 2018 at 01:21)</a>:</h4>
<p>a "comorphism", which is a natural transformation from <code>O_Y \to f_* O_X</code>.</p>

<a name="133771858"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133771858" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133771858">Scott Morrison (Sep 12 2018 at 01:22)</a>:</h4>
<p>The point here is that you can push forward a presheaf on X to presheaf on Y, along a continuous map (take an open set of Y, pull it back via f, then evaluate the presheaf on it).</p>

<a name="133771924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133771924" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133771924">Scott Morrison (Sep 12 2018 at 01:26)</a>:</h4>
<p>Now, I want to define the identity presheaf morphism, and I want to define compositions of presheaf morphisms, and check they satisfy the right properties.</p>

<a name="133771965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133771965" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133771965">Scott Morrison (Sep 12 2018 at 01:26)</a>:</h4>
<p>Yesterday I managed to do this, but both the constructions and the proofs were very ugly.</p>

<a name="133771976"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133771976" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133771976">Scott Morrison (Sep 12 2018 at 01:27)</a>:</h4>
<p>Today I've made another attempt, where the constructions are quite a bit better, and the proofs look like they should be easy but get stuck at the last hurdle, when we should just be cancelling off identity morphisms and saying we're done.</p>

<a name="133772022"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772022" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772022">Scott Morrison (Sep 12 2018 at 01:28)</a>:</h4>
<p>The code is at &lt;<a href="https://github.com/semorrison/lean-category-theory/blob/master/src/category_theory/V_pre.lean" target="_blank" title="https://github.com/semorrison/lean-category-theory/blob/master/src/category_theory/V_pre.lean">https://github.com/semorrison/lean-category-theory/blob/master/src/category_theory/V_pre.lean</a>&gt;.</p>

<a name="133772037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772037" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772037">Scott Morrison (Sep 12 2018 at 01:29)</a>:</h4>
<p>The particular problem I reach is the proof of <code>comp_id'</code> in constructing <code>instance : category (Presheaf.{u v} C) := ...</code>.</p>

<a name="133772085"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772085" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772085">Scott Morrison (Sep 12 2018 at 01:30)</a>:</h4>
<p>Just before the <code>sorry</code>, the goal is</p>
<div class="codehilite"><pre><span></span>C : Type u,
𝒞 : category C,
X Y : Presheaf C,
f : Presheaf_hom X Y,
X_1 : open_set ((Y.X).α)
⊢ functor.map (Y.𝒪) (𝟙 X_1) ≫
      ⇑(f.c) (⇑(map_open_set (𝟙 (Y.X))) X_1) ≫
        functor.map (X.𝒪) (functor.map (map_open_set (f.f)) (𝟙 (⇑(map_open_set (𝟙 (Y.X))) X_1))) =
    ⇑(f.c) X_1
</pre></div>

<a name="133772095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772095" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772095">Scott Morrison (Sep 12 2018 at 01:31)</a>:</h4>
<p>And this should be perfectly manageable. The left hand side is a composition of three morphisms, and we should begin by observing the first and third are actually identity morphisms, since they are explicitly some functor applied to some identity morphism.</p>

<a name="133772100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772100" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772100">Scott Morrison (Sep 12 2018 at 01:31)</a>:</h4>
<p>In particular we should be able to rewrite <code>functor.map (Y.𝒪) (𝟙 X_1) </code> into <code>𝟙 (Y.𝒪 X_1) </code></p>

<a name="133772102"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772102" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772102">Scott Morrison (Sep 12 2018 at 01:32)</a>:</h4>
<p>However <code>simp</code> fails.</p>

<a name="133772147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772147" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772147">Reid Barton (Sep 12 2018 at 01:32)</a>:</h4>
<p>Yeah I've had this happen too. In that case the problem was some implicit argument was not <code>X_1</code> but only something defeq to it, and <code>simp</code> didn't like that.</p>

<a name="133772150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772150" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772150">Reid Barton (Sep 12 2018 at 01:32)</a>:</h4>
<p>In my case <code>dsimp, simp</code> worked, but it doesn't look like that will help you judging from the two preceding lines</p>

<a name="133772154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772154" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772154">Scott Morrison (Sep 12 2018 at 01:32)</a>:</h4>
<p>Trying the rewrite by hand, with increasing desperation:</p>
<div class="codehilite"><pre><span></span>rw [category_theory.functor.map_id]
rw [category_theory.functor.map_id Y.𝒪 X_1]
</pre></div>

<a name="133772161"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772161" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772161">Scott Morrison (Sep 12 2018 at 01:33)</a>:</h4>
<p><code>rw [category_theory.functor.map_id Y.𝒪 X_1] {md:=semireducible}</code></p>

<a name="133772164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772164" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772164">Scott Morrison (Sep 12 2018 at 01:33)</a>:</h4>
<p>all fail.</p>

<a name="133772165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772165" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772165">Reid Barton (Sep 12 2018 at 01:33)</a>:</h4>
<p><code>erw</code>?</p>

<a name="133772166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772166" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772166">Scott Morrison (Sep 12 2018 at 01:33)</a>:</h4>
<p><code>erw</code> is just the same as <code>{md:=semireducible}</code></p>

<a name="133772167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772167" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772167">Scott Morrison (Sep 12 2018 at 01:33)</a>:</h4>
<p>(I'd usually use <code>erw</code> but didn't want to scare anyone. :-)</p>

<a name="133772210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772210" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772210">Scott Morrison (Sep 12 2018 at 01:34)</a>:</h4>
<p>Reid is exactly right that the problem is an implicit argument.</p>

<a name="133772211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772211" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772211">Scott Morrison (Sep 12 2018 at 01:34)</a>:</h4>
<p>Let's look at that, turning on <code>set_option pp.implict true</code> and inspecting the goal again.</p>

<a name="133772226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772226" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772226">Scott Morrison (Sep 12 2018 at 01:35)</a>:</h4>
<p>The whole thing is a bit long, but the bit that corresponds to <code>functor.map (Y.𝒪) (𝟙 X_1)</code> is</p>
<div class="codehilite"><pre><span></span>@functor.map
        (@open_set (@bundled.α topological_space (@Presheaf.X C 𝒞 Y))
           (examples.topological_space (@Presheaf.X C 𝒞 Y)))
        (@open_set.open_sets (@bundled.α topological_space (@Presheaf.X C 𝒞 Y))
           (examples.topological_space (@Presheaf.X C 𝒞 Y)))
        C
        𝒞
        (@Presheaf.𝒪 C 𝒞 Y)
        X_1
        (⇑(@map_open_set (@Presheaf.X C 𝒞 Y) (@Presheaf.X C 𝒞 Y) (𝟙 (@Presheaf.X C 𝒞 Y))) X_1)
        (𝟙 X_1)
</pre></div>

<a name="133772266"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772266" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772266">Scott Morrison (Sep 12 2018 at 01:36)</a>:</h4>
<p>We can see the problem at the end there: the last three arguments are meant to consist of two objects, and a hom between them.</p>

<a name="133772271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772271" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772271">Scott Morrison (Sep 12 2018 at 01:36)</a>:</h4>
<p>However we've got <code>X_1</code>,  <code>(⇑(@map_open_set (@Presheaf.X C 𝒞 Y) (@Presheaf.X C 𝒞 Y) (𝟙 (@Presheaf.X C 𝒞 Y))) X_1)</code>, and <code>(𝟙 X_1)</code>.</p>

<a name="133772280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772280" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772280">Reid Barton (Sep 12 2018 at 01:37)</a>:</h4>
<p>Something like <code>id ⁻¹' X_1</code>, I guess?</p>

<a name="133772281"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772281" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772281">Scott Morrison (Sep 12 2018 at 01:37)</a>:</h4>
<p>We really want that second object to just be <code>X_1</code> again.</p>

<a name="133772283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772283" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772283">Reid Barton (Sep 12 2018 at 01:37)</a>:</h4>
<p>is what that long thing is</p>

<a name="133772285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772285" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772285">Scott Morrison (Sep 12 2018 at 01:37)</a>:</h4>
<p>If we <code>dsimp  [map_open_set]</code> we see:</p>

<a name="133772329"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772329" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772329">Scott Morrison (Sep 12 2018 at 01:39)</a>:</h4>
<p><code>(@open_set.mk (@bundled.α topological_space (@Presheaf.X C 𝒞 Y))
           (examples.topological_space (@Presheaf.X C 𝒞 Y))
           (@subtype.val
                (@bundled.α topological_space (@Presheaf.X C 𝒞 Y) →
                 @bundled.α topological_space (@Presheaf.X C 𝒞 Y))
                (@continuous (@bundled.α topological_space (@Presheaf.X C 𝒞 Y))
                   (@bundled.α topological_space (@Presheaf.X C 𝒞 Y))
                   (@bundled.str topological_space (@Presheaf.X C 𝒞 Y))
                   (@bundled.str topological_space (@Presheaf.X C 𝒞 Y)))
                (𝟙 (@Presheaf.X C 𝒞 Y)) ⁻¹'
              @open_set.s (@bundled.α topological_space (@Presheaf.X C 𝒞 Y))
                (examples.topological_space (@Presheaf.X C 𝒞 Y))
                X_1)
           _)</code></p>

<a name="133772338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772338" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772338">Scott Morrison (Sep 12 2018 at 01:40)</a>:</h4>
<p>Which sadly is not definitely equal to <code>X_1</code>, although we can prove it is equal.</p>

<a name="133772385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772385" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772385">Reid Barton (Sep 12 2018 at 01:40)</a>:</h4>
<p>oh no</p>

<a name="133772386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772386" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772386">Scott Morrison (Sep 12 2018 at 01:40)</a>:</h4>
<p>In fact, we have a lemma prepared just for this!</p>

<a name="133772390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772390" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772390">Reid Barton (Sep 12 2018 at 01:40)</a>:</h4>
<p>wait then</p>

<a name="133772394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772394" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772394">Scott Morrison (Sep 12 2018 at 01:40)</a>:</h4>
<div class="codehilite"><pre><span></span>@[simp] def map_open_set_id_obj (X : Top) (U : open_set X.α) : map_open_set (𝟙 X) U = U :=
begin dsimp [map_open_set], cases U, congr, end
</pre></div>

<a name="133772412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772412" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772412">Scott Morrison (Sep 12 2018 at 01:41)</a>:</h4>
<p>And <code>rw [map_open_set_id_obj]</code> says ...</p>

<a name="133772414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772414" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772414">Scott Morrison (Sep 12 2018 at 01:41)</a>:</h4>
<p><code>failed</code></p>

<a name="133772417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772417" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772417">Reid Barton (Sep 12 2018 at 01:41)</a>:</h4>
<p>I'm confused</p>

<a name="133772420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772420" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772420">Reid Barton (Sep 12 2018 at 01:41)</a>:</h4>
<p>Doesn't this mean your goal is ill-typed?</p>

<a name="133772421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772421" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772421">Scott Morrison (Sep 12 2018 at 01:41)</a>:</h4>
<p>(And <code>erw</code> is no better, nor does it seem that using <code>conv</code> to zoom in on it helps.)</p>

<a name="133772464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772464" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772464">Scott Morrison (Sep 12 2018 at 01:42)</a>:</h4>
<p>That's what appears to be happening, I agree.</p>

<a name="133772467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772467" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772467">Scott Morrison (Sep 12 2018 at 01:42)</a>:</h4>
<p>So how did Lean let me get this far?</p>

<a name="133772468"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772468" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772468">Reid Barton (Sep 12 2018 at 01:42)</a>:</h4>
<p>I had that happen too once, but I didn't understand how it happened, but it's almost certainly unrelated.</p>

<a name="133772479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772479" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772479">Scott Morrison (Sep 12 2018 at 01:43)</a>:</h4>
<p>I do have a note a few lines earlier in my code <code>It's hard to believe this typechecks!</code></p>

<a name="133772519"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772519" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772519">Scott Morrison (Sep 12 2018 at 01:44)</a>:</h4>
<div class="codehilite"><pre><span></span>structure Presheaf_hom (F G : Presheaf.{u v} C) :=
(f : F.X ⟶ G.X)
(c : G.𝒪 ⟹ ((map_open_set f) ⋙ F.𝒪))

namespace Presheaf_hom
def id (F : Presheaf.{u v} C) : Presheaf_hom F F :=
{ f := 𝟙 F.X,
  c := begin apply nat_trans.vcomp, swap, apply whisker_on_right (map_open_set_id _).inv, apply (functor.id_comp _ _ _).inv end
}

def comp {F G H : Presheaf.{u v} C} (α : Presheaf_hom F G) (β : Presheaf_hom G H) : Presheaf_hom F H :=
{ f := α.f ≫ β.f,
  c := β.c ⊟ (whisker_on_left (map_open_set β.f) α.c), -- It&#39;s hard to believe this typechecks!
}
end Presheaf_hom
</pre></div>

<a name="133772525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772525" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772525">Scott Morrison (Sep 12 2018 at 01:44)</a>:</h4>
<p>In particular, I have to jump through some hoops to construct the natural transformation for <code>id</code>.</p>

<a name="133772531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772531" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772531">Scott Morrison (Sep 12 2018 at 01:45)</a>:</h4>
<p>But Lean appears to be happy with me just writing the "obvious" answer for <code>comp</code>.</p>

<a name="133772542"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772542" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772542">Reid Barton (Sep 12 2018 at 01:45)</a>:</h4>
<p>I found composition/associativity things are often easier than identity/unitality things</p>

<a name="133772591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772591" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772591">Scott Morrison (Sep 12 2018 at 01:46)</a>:</h4>
<p>(... in real life as well as Lean, for me!)</p>

<a name="133772599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772599" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772599">Scott Morrison (Sep 12 2018 at 01:46)</a>:</h4>
<p>(identities are strange and confusing in higher dimensions!)</p>

<a name="133772671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772671" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772671">Reid Barton (Sep 12 2018 at 01:49)</a>:</h4>
<p>how hard would it be to find the first place the goal becomes ill-typed?<br>
Is the goal before the last <code>simp</code> comprehensible?</p>

<a name="133772673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772673" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772673">Scott Morrison (Sep 12 2018 at 01:49)</a>:</h4>
<p>The only avenues I can work out are:<br>
1) Go back and work out where this "ill-typed, or at least hard-to-see-its-well-typed" expression first appears, and then "do something different".<br>
2) Work out how to "fix" implicit arguments.</p>

<a name="133772717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772717" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772717">Scott Morrison (Sep 12 2018 at 01:50)</a>:</h4>
<p>(This is an example, by the way, of a situation it would be nice to have a good term inspector, where you can toggle on and off implicit arguments for subtrees.)</p>

<a name="133772767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772767" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772767">Reid Barton (Sep 12 2018 at 01:52)</a>:</h4>
<p>Given that the implicit argument is not even defeq to the right thing, I think 2 isn't applicable in this case.<br>
It looks to me like you hit a bug in Lean (which is probably not in the kernel, since it is only the goal which is ill-typed, but still very frustrating).</p>

<a name="133772769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772769" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772769">Scott Morrison (Sep 12 2018 at 01:53)</a>:</h4>
<p>Oooh, I maybe found a way around it.</p>

<a name="133772777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772777" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772777">Scott Morrison (Sep 12 2018 at 01:53)</a>:</h4>
<p>It's just a matter of <code>dsimp</code>ing expressions in a different order, so somehow it's not at all a principled solution.</p>

<a name="133772821"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772821" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772821">Scott Morrison (Sep 12 2018 at 01:54)</a>:</h4>
<p>Oh, no, the problem is there a step or two later. I was just doing something by hand that <code>simp</code> was doing anyway.</p>

<a name="133772822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772822" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772822">Scott Morrison (Sep 12 2018 at 01:54)</a>:</h4>
<p>:-(</p>

<a name="133772935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772935" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772935">Reid Barton (Sep 12 2018 at 01:58)</a>:</h4>
<p>I'm kind of surprised that the result of the tactic passes typechecking, even with <code>sorry</code> there</p>

<a name="133772995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133772995" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133772995">Scott Morrison (Sep 12 2018 at 02:00)</a>:</h4>
<p>Shall I try for a proof of false? :-)</p>

<a name="133773004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773004" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773004">Reid Barton (Sep 12 2018 at 02:01)</a>:</h4>
<p>Unfortunately I doubt you can prove false from a term which is ill-typed but only in that one of the type arguments is definitionally wrong (but propositionally correct)</p>

<a name="133773005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773005" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773005">Scott Morrison (Sep 12 2018 at 02:01)</a>:</h4>
<p>Okay... this is bizarre, but <code>cases X_1</code> seems to break the impasse.</p>

<a name="133773006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773006" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773006">Reid Barton (Sep 12 2018 at 02:01)</a>:</h4>
<p>that's not surprising</p>

<a name="133773008"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773008" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773008">Scott Morrison (Sep 12 2018 at 02:01)</a>:</h4>
<p>Why is that?</p>

<a name="133773051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773051" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773051">Reid Barton (Sep 12 2018 at 02:02)</a>:</h4>
<p>same reason why you used <code>cases U</code> to prove <code>map_open_set_id_obj</code></p>

<a name="133773055"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773055" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773055">Reid Barton (Sep 12 2018 at 02:02)</a>:</h4>
<p>basically you have an equality that looks like &lt;x.1, _&gt; = x</p>

<a name="133773056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773056" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773056">Scott Morrison (Sep 12 2018 at 02:02)</a>:</h4>
<p>Okay, and there's a (horrible) proof:</p>
<div class="codehilite"><pre><span></span>  comp_id&#39; := λ X Y f, --sorry,
    begin
      ext,
      -- we check the functions first
      dsimp [Presheaf_hom.id, Presheaf_hom.comp],
      simp,
      -- and now the comorphisms
      dsimp [Presheaf_hom.id, Presheaf_hom.comp],
      simp,
      ext,
      dsimp [whisker_on_right, whiskering_on_right, whisker_on_left, whiskering_on_left],
      dsimp [map_open_set],
      simp,
      erw [category_theory.functor.map_id],
      simp,
      cases X_1,
      simp,
      apply congr_fun,
      simp,
    end,
</pre></div>

<a name="133773062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773062" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773062">Reid Barton (Sep 12 2018 at 02:03)</a>:</h4>
<p>where x is a variable, and so they can never be definitionally equal. Buf after <code>cases x</code>, it's okay</p>

<a name="133773063"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773063" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773063">Scott Morrison (Sep 12 2018 at 02:03)</a>:</h4>
<p>I see.</p>

<a name="133773064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773064" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773064">Reid Barton (Sep 12 2018 at 02:03)</a>:</h4>
<p>when you do comp, both sides look like &lt;_, _&gt;</p>

<a name="133773065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773065" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773065">Reid Barton (Sep 12 2018 at 02:03)</a>:</h4>
<p>and that's why comp is easier</p>

<a name="133773107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773107" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773107">Reid Barton (Sep 12 2018 at 02:04)</a>:</h4>
<p>This still feels weird to me, but I've seen it a few times</p>

<a name="133773113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773113" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773113">Scott Morrison (Sep 12 2018 at 02:04)</a>:</h4>
<p>So maybe the summary from today is:</p>
<blockquote>
<p>avoid <code>cases</code> when constructing stuff, because then you'll have horrible <code>X.rec</code> expressions to deal with later, but<br>
remember to try <code>cases</code> when an implicit argument looks wrong!</p>
</blockquote>

<a name="133773166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773166" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773166">Reid Barton (Sep 12 2018 at 02:06)</a>:</h4>
<p>Well, in general when you need to prove <code>(blah.mk _ _) = X</code>, it will require doing cases on X</p>

<a name="133773170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773170" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773170">Reid Barton (Sep 12 2018 at 02:06)</a>:</h4>
<p>I still think something very fishy is going on with your original code</p>

<a name="133773173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773173" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773173">Scott Morrison (Sep 12 2018 at 02:07)</a>:</h4>
<p>Sure. The problem here was that it wasn't at all obvious to me that this was what was going on.</p>

<a name="133773227"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773227" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773227">Mario Carneiro (Sep 12 2018 at 02:09)</a>:</h4>
<p>The file you linked references <code>category_theory.examples.topological_spaces</code> but I can't find it in the repo</p>

<a name="133773228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773228" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773228">Scott Morrison (Sep 12 2018 at 02:09)</a>:</h4>
<p>That's in mathlib</p>

<a name="133773229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773229" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773229">Scott Morrison (Sep 12 2018 at 02:09)</a>:</h4>
<p>:-)</p>

<a name="133773271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773271" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773271">Reid Barton (Sep 12 2018 at 02:10)</a>:</h4>
<p>I just finished building your repo locally so I can take a look</p>

<a name="133773278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773278" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773278">Scott Morrison (Sep 12 2018 at 02:10)</a>:</h4>
<p>And just to confound you, Mario, lean-category-theory is currently pointing at a branch of mathlib on <code>community</code>, in which that file has been modified. :-)</p>

<a name="133773287"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773287" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773287">Reid Barton (Sep 12 2018 at 02:11)</a>:</h4>
<p>Anyways the situation you were in ought to have been impossible. If <code>x : t</code> and <code>x : t'</code> then <code>t</code> and <code>t'</code> should be definitionally equal. Not just propositionally equal.</p>

<a name="133773288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773288" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773288">Reid Barton (Sep 12 2018 at 02:11)</a>:</h4>
<p>At least, as far as I understand.</p>

<a name="133773290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773290" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773290">Scott Morrison (Sep 12 2018 at 02:11)</a>:</h4>
<p>yes.</p>

<a name="133773291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773291" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773291">Mario Carneiro (Sep 12 2018 at 02:11)</a>:</h4>
<p>oh wow, mathlib category theory has grown quite a bit since I last checked</p>

<a name="133773444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773444" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773444">Mario Carneiro (Sep 12 2018 at 02:17)</a>:</h4>
<div class="codehilite"><pre><span></span>-- Do I dare define `open_set` as a functor from Top to CAT? I don&#39;t like CAT.

def map_open_set
  {X Y : Top} (f : X ⟶ Y) : open_set Y.α ⥤ open_set X.α :=
</pre></div>


<p>Why is it a functor to CAT? It looks like <code>open_set</code> should be a (contravariant) functor from <code>Top</code> to <code>Type</code></p>

<a name="133773453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773453" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773453">Scott Morrison (Sep 12 2018 at 02:18)</a>:</h4>
<p>For each topological space X, we get the category of open sets and inclusions.</p>

<a name="133773493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773493" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773493">Reid Barton (Sep 12 2018 at 02:18)</a>:</h4>
<p>The ill-typed goal I encountered involved Lean getting confused about the difference between <code>quot</code> and <code>quotient</code>, and so I had a goal involving some types of the form <code>quot s a</code> where <code>s</code> was a setoid, which I had trouble producing</p>

<a name="133773568"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773568" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773568">Mario Carneiro (Sep 12 2018 at 02:21)</a>:</h4>
<p>Okay, I think I'm starting to piece this together. There is an unnamed function <code>comap f U</code> (where <code>f</code> is a bundled continuous function and <code>U</code> is an <code>open_set</code>) which is the object part of <code>map_open_set</code></p>

<a name="133773575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773575" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773575">Mario Carneiro (Sep 12 2018 at 02:21)</a>:</h4>
<p>And what is true is that <code>map_open_set (𝟙 X) U = comap (𝟙 X) U</code>, which is isomorphic to <code>U</code></p>

<a name="133773613"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773613" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773613">Mario Carneiro (Sep 12 2018 at 02:22)</a>:</h4>
<p>so you have a classic two-category problem</p>

<a name="133773625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773625" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773625">Scott Morrison (Sep 12 2018 at 02:23)</a>:</h4>
<p>I don't know this classic. :-)</p>

<a name="133773626"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773626" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773626">Reid Barton (Sep 12 2018 at 02:23)</a>:</h4>
<p>I think Mario means 2-category?</p>

<a name="133773628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773628" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773628">Mario Carneiro (Sep 12 2018 at 02:23)</a>:</h4>
<p>You have to worry about coherences since it's not an equality</p>

<a name="133773629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773629" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773629">Scott Morrison (Sep 12 2018 at 02:24)</a>:</h4>
<p>Oh, okay! :-)</p>

<a name="133773666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773666" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773666">Scott Morrison (Sep 12 2018 at 02:24)</a>:</h4>
<p>Yes.</p>

<a name="133773667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773667" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773667">Reid Barton (Sep 12 2018 at 02:24)</a>:</h4>
<p>Like, the Top -&gt; Cat thing could be only a pseudofunctor</p>

<a name="133773672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773672" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773672">Mario Carneiro (Sep 12 2018 at 02:24)</a>:</h4>
<p>As Kevin learned a while ago, a propositional equality should not ever be treated as equality in a category, only isomorphism</p>

<a name="133773673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773673" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773673">Mario Carneiro (Sep 12 2018 at 02:24)</a>:</h4>
<p>objects are either defeq or isomorphic</p>

<a name="133773674"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773674" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773674">Scott Morrison (Sep 12 2018 at 02:24)</a>:</h4>
<p>but where am I abusing that here?</p>

<a name="133773684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773684" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773684">Mario Carneiro (Sep 12 2018 at 02:25)</a>:</h4>
<div class="codehilite"><pre><span></span>-- These next two are desperate attempts to solve problems below.
@[simp] def map_open_set_id_obj (X : Top) (U : open_set X.α) : map_open_set (𝟙 X) U = U :=
begin dsimp [map_open_set], cases U, congr, end
@[simp] def map_open_set_id (X : Top) : map_open_set (𝟙 X) ≅ functor.id (open_set X.α) :=
</pre></div>


<p>this is bad news</p>

<a name="133773691"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773691" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773691">Mario Carneiro (Sep 12 2018 at 02:25)</a>:</h4>
<p>this equality should be turned into an iso, given a name, and explicitly reasoned with</p>

<a name="133773692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773692" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773692">Scott Morrison (Sep 12 2018 at 02:25)</a>:</h4>
<p>It's the first one that is evil</p>

<a name="133773694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773694" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773694">Scott Morrison (Sep 12 2018 at 02:25)</a>:</h4>
<p>and I don't use it</p>

<a name="133773736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773736" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773736">Scott Morrison (Sep 12 2018 at 02:26)</a>:</h4>
<p>the second one is fine, isn't it?</p>

<a name="133773743"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773743" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773743">Reid Barton (Sep 12 2018 at 02:27)</a>:</h4>
<p>the type looks fine, but now I am confused about the implementation</p>

<a name="133773744"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773744" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773744">Mario Carneiro (Sep 12 2018 at 02:27)</a>:</h4>
<p>I think? I can't parse it</p>

<a name="133773745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773745" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773745">Scott Morrison (Sep 12 2018 at 02:27)</a>:</h4>
<p>I just pushed an update</p>

<a name="133773746"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773746" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773746">Mario Carneiro (Sep 12 2018 at 02:27)</a>:</h4>
<p><code>map_open_set (𝟙 X)</code> is a functor, so what does <code>≅</code> mean here?</p>

<a name="133773748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773748" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773748">Scott Morrison (Sep 12 2018 at 02:27)</a>:</h4>
<p>that has the working proof, and doesn't have the evil <code>map_open_set_id_obj</code></p>

<a name="133773786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773786" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773786">Scott Morrison (Sep 12 2018 at 02:28)</a>:</h4>
<p>iso is automatically natural isomorphism</p>

<a name="133773791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773791" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773791">Scott Morrison (Sep 12 2018 at 02:28)</a>:</h4>
<p>sweet sweet typeclass magic finds the category of functors between two fixed categories</p>

<a name="133773792"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773792" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773792">Reid Barton (Sep 12 2018 at 02:28)</a>:</h4>
<p>isomorphism in the functor category</p>

<a name="133773793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773793" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773793">Scott Morrison (Sep 12 2018 at 02:28)</a>:</h4>
<p>and correctly interprets iso</p>

<a name="133773796"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773796" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773796">Mario Carneiro (Sep 12 2018 at 02:28)</a>:</h4>
<p>and that doesn't have any 2-category mess in it?</p>

<a name="133773799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773799" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773799">Scott Morrison (Sep 12 2018 at 02:29)</a>:</h4>
<p>no -- for a fixed pair of categories C and D</p>

<a name="133773804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773804" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773804">Scott Morrison (Sep 12 2018 at 02:29)</a>:</h4>
<p>functors and natural transformations between them are a perfectly honest 1-category</p>

<a name="133773806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773806" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773806">Scott Morrison (Sep 12 2018 at 02:29)</a>:</h4>
<p>(indeed, the prototypical example)</p>

<a name="133773899"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773899" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773899">Reid Barton (Sep 12 2018 at 02:32)</a>:</h4>
<p>Oh man this is confusing.</p>

<a name="133773901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773901" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773901">Mario Carneiro (Sep 12 2018 at 02:32)</a>:</h4>
<p>so where did you get that bad application from? <code>functor.map (Y.𝒪) (𝟙 X_1)</code></p>

<a name="133773903"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773903" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773903">Reid Barton (Sep 12 2018 at 02:32)</a>:</h4>
<p>I noticed that both of these worked, and was confused.</p>
<div class="codehilite"><pre><span></span>  <span class="o">{</span> <span class="n">app</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span><span class="o">,</span> <span class="k">show</span> <span class="n">map_open_set</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">X</span><span class="o">)</span> <span class="n">U</span> <span class="err">⟶</span> <span class="n">U</span><span class="o">,</span> <span class="k">from</span> <span class="mi">𝟙</span> <span class="n">U</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">app</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span><span class="o">,</span> <span class="k">show</span> <span class="n">U</span> <span class="err">⟶</span> <span class="n">U</span><span class="o">,</span> <span class="k">from</span> <span class="mi">𝟙</span> <span class="n">U</span> <span class="o">},</span>
</pre></div>

<a name="133773910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773910" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773910">Reid Barton (Sep 12 2018 at 02:33)</a>:</h4>
<p>Even though we know <code>map_open_set (𝟙 X) U = U</code> is not a definitional equality</p>

<a name="133773911"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773911" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773911">Mario Carneiro (Sep 12 2018 at 02:33)</a>:</h4>
<p>hah, it's because the hom destructs it</p>

<a name="133773913"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773913" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773913">Reid Barton (Sep 12 2018 at 02:33)</a>:</h4>
<p>right</p>

<a name="133773916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773916" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773916">Scott Morrison (Sep 12 2018 at 02:33)</a>:</h4>
<p>Yeah, and I think this is where the "bad" application is coming from.</p>

<a name="133773956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773956" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773956">Scott Morrison (Sep 12 2018 at 02:34)</a>:</h4>
<p>Can you explain what "the hom destructs it" means?</p>

<a name="133773962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773962" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773962">Reid Barton (Sep 12 2018 at 02:35)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">instance</span> <span class="o">:</span> <span class="n">has_subset</span> <span class="o">(</span><span class="n">open_set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">subset</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">V</span><span class="o">,</span> <span class="n">U</span><span class="bp">.</span><span class="n">s</span> <span class="err">⊆</span> <span class="n">V</span><span class="bp">.</span><span class="n">s</span> <span class="o">}</span>
</pre></div>

<a name="133773970"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773970" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773970">Reid Barton (Sep 12 2018 at 02:35)</a>:</h4>
<p>this is what defines the partial order, and therefore the hom types</p>

<a name="133773972"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133773972" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133773972">Scott Morrison (Sep 12 2018 at 02:35)</a>:</h4>
<p>oh ...</p>

<a name="133774013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774013" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774013">Reid Barton (Sep 12 2018 at 02:36)</a>:</h4>
<p>it's not true that <code>map_open_set (𝟙 X) U = U</code> definitionally, but it is true that <code>(map_open_set (𝟙 X) U).s = U.s</code> because (contrary to my initial guess) <code>preimage id</code> is definitionally the identity</p>

<a name="133774014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774014" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774014">Scott Morrison (Sep 12 2018 at 02:36)</a>:</h4>
<p>I see.</p>

<a name="133774017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774017" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774017">Reid Barton (Sep 12 2018 at 02:36)</a>:</h4>
<p>Oh, wait...</p>

<a name="133774022"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774022" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774022">Reid Barton (Sep 12 2018 at 02:37)</a>:</h4>
<p>So maybe that weird goal was correctly typed, after all</p>

<a name="133774023"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774023" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774023">Scott Morrison (Sep 12 2018 at 02:37)</a>:</h4>
<p>Yeah.</p>

<a name="133774028"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774028" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774028">Scott Morrison (Sep 12 2018 at 02:37)</a>:</h4>
<p>And I could have replaced my evil lemma with</p>

<a name="133774071"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774071" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774071">Scott Morrison (Sep 12 2018 at 02:38)</a>:</h4>
<div class="codehilite"><pre><span></span>@[simp] def map_open_set_id_obj (X : Top) (U : open_set X.α) : (map_open_set (𝟙 X) U).s = U.s := rfl
</pre></div>

<a name="133774072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774072" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774072">Scott Morrison (Sep 12 2018 at 02:38)</a>:</h4>
<p>and perhaps had it work...</p>

<a name="133774082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774082" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774082">Scott Morrison (Sep 12 2018 at 02:39)</a>:</h4>
<p>Hmm,. you can indeed prove that via <code>rfl</code>, but I can't get it to help.</p>

<a name="133774124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774124" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774124">Scott Morrison (Sep 12 2018 at 02:40)</a>:</h4>
<p>ah, I have to remove the dsimp [map_open_set], perhaps</p>

<a name="133774125"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774125" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774125">Mario Carneiro (Sep 12 2018 at 02:40)</a>:</h4>
<p>Scott, I'm trying to get your repo. How do you update everything with leanpkg?</p>

<a name="133774127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774127" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774127">Scott Morrison (Sep 12 2018 at 02:40)</a>:</h4>
<p><code>leanpkg build</code>?</p>

<a name="133774129"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774129" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774129">Scott Morrison (Sep 12 2018 at 02:40)</a>:</h4>
<p>It should notice if you don't have the right dependencies already in <code>_target</code>.</p>

<a name="133774130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774130" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774130">Mario Carneiro (Sep 12 2018 at 02:41)</a>:</h4>
<p>I get version mismatch error</p>

<a name="133774136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774136" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774136">Scott Morrison (Sep 12 2018 at 02:41)</a>:</h4>
<p>ah... Is your lean provided by elan?</p>

<a name="133774137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774137" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774137">Scott Morrison (Sep 12 2018 at 02:41)</a>:</h4>
<p>This repo is set to use nightly-2018-06-21</p>

<a name="133774139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774139" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774139">Scott Morrison (Sep 12 2018 at 02:41)</a>:</h4>
<p>but I think it should be safe to change that in leanpkg.toml file</p>

<a name="133774140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774140" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774140">Scott Morrison (Sep 12 2018 at 02:42)</a>:</h4>
<p>What is the "official recommendation" these days?</p>

<a name="133774179"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774179" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774179">Mario Carneiro (Sep 12 2018 at 02:42)</a>:</h4>
<p>I've been using 3.4.1 even though a few bugfixes have come in</p>

<a name="133774185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774185" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774185">Scott Morrison (Sep 12 2018 at 02:43)</a>:</h4>
<p>Since my student Keeley started forking Lean I've switched to using elan and don't notice these problems. :-)</p>

<a name="133774188"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774188" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774188">Mario Carneiro (Sep 12 2018 at 02:43)</a>:</h4>
<p>that's good to hear. You should write a tutorial :)</p>

<a name="133774233"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774233" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774233">Reid Barton (Sep 12 2018 at 02:44)</a>:</h4>
<p>for elan?</p>

<a name="133774234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774234" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774234">Scott Morrison (Sep 12 2018 at 02:44)</a>:</h4>
<p>I really should borrow a windows machine, and write a tutorial for running elan on windows.</p>

<a name="133774365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774365" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774365">Scott Morrison (Sep 12 2018 at 02:49)</a>:</h4>
<p>Ducking out for lunch. Thanks very much for the discussion today!</p>

<a name="133774471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774471" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774471">Mario Carneiro (Sep 12 2018 at 02:53)</a>:</h4>
<p>Aha, I found some 2-categoricity:</p>
<div class="codehilite"><pre><span></span>structure Presheaf_hom (F G : Presheaf.{u v} C) :=
(f : F.X ⟶ G.X)
(c : G.𝒪 ⟹ ((map_open_set f) ⋙ F.𝒪))
</pre></div>


<p>Since <code>Presheaf_hom</code> has a component which is a functor, proving equality of homs is going to involve equality of objects</p>

<a name="133774631"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774631" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774631">Mario Carneiro (Sep 12 2018 at 02:59)</a>:</h4>
<p>I guess that can't really be avoided, but since <code>G.𝒪</code> is a functor out of a skeletal category (a partial order category), it suffices to prove isomorphism instead of equality</p>

<a name="133774739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133774739" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133774739">Mario Carneiro (Sep 12 2018 at 03:02)</a>:</h4>
<div class="codehilite"><pre><span></span>@[extensionality] lemma ext {F G : Presheaf.{u v} C} (α β : Presheaf_hom F G)
  (w : α.f = β.f) (h : α.c == β.c)
  : α = β :=
</pre></div>


<p>the <code>heq</code> here is evil. You should state some kind of composite equality here</p>

<a name="133775001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133775001" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133775001">Scott Morrison (Sep 12 2018 at 03:11)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="110049">@Mario Carneiro</span>, actually that component <code>Preasheaf_hom.c</code> is a natural transformation, not a functor, so equality is non-evil.</p>

<a name="133775042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133775042" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133775042">Scott Morrison (Sep 12 2018 at 03:12)</a>:</h4>
<p>I agree that the <code>ext</code> lemma is evil. I will replace that.</p>

<a name="133775051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133775051" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133775051">Mario Carneiro (Sep 12 2018 at 03:12)</a>:</h4>
<p>equality of natural transformations is not evil, equality of natural transformations in different categories is</p>

<a name="133775062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133775062" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133775062">Scott Morrison (Sep 12 2018 at 03:12)</a>:</h4>
<p>Oh, so you're saying specifically the <code>heq</code> is evil.</p>

<a name="133775075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133775075" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133775075">Scott Morrison (Sep 12 2018 at 03:13)</a>:</h4>
<p>I don't think we'll ever to to say anything about equalities of objects, however.</p>

<a name="133775136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133775136" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133775136">Mario Carneiro (Sep 12 2018 at 03:15)</a>:</h4>
<p>I think I found the culprit. <code>map_open_sets</code> is a 2-categorical thing, since it takes homs to functors. This means that congruence says that equality of homs maps to natural iso of functors</p>

<a name="133775143"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133775143" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133775143">Mario Carneiro (Sep 12 2018 at 03:15)</a>:</h4>
<p>And this is the iso you should reference in the definition of <code>ext</code></p>

<a name="133775147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133775147" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133775147">Scott Morrison (Sep 12 2018 at 03:15)</a>:</h4>
<p>I'm filling in </p>
<div class="codehilite"><pre><span></span>def map_open_set_iso {X Y : Top} (f g : X ⟶ Y) (h : f = g) : map_open_set f ≅ map_open_set g := {

}
</pre></div>

<a name="133775148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133775148" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133775148">Scott Morrison (Sep 12 2018 at 03:15)</a>:</h4>
<p>right now</p>

<a name="133781152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133781152" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133781152">Kevin Buzzard (Sep 12 2018 at 06:37)</a>:</h4>
<p>This is a terrifying thread to wake up to. It reminds me of when I couldn't prove anything about real numbers because there was no norm_num. But instead of a beginner struggling to prove math-trivial things because of a lack of tools, it's experts and tool-makers having problems with something that looks math-trivial</p>

<a name="133781442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133781442" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133781442">Kevin Buzzard (Sep 12 2018 at 06:44)</a>:</h4>
<p>I actually stopped thinking about pushing the perfectoid repo forward towards the definition of an adic space because this funky category showed up, Patrick was doing completions (which were also needed) and I knew someone had to do integral closures (which were also needed) so I went back to those and thought I'd wait a bit to see what the category experts thought about this category V_pre which had shown up "in the wild". I want to argue that we don't <em>need</em> V_pre, it's just a convenient container and I thought it would be a good test case. I could instead just make a new structure modelling the objects and muddle on from there and it would no doubt be fine at least as far as the ultimate goal is concerned, which is a definition.</p>

<a name="133781575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133781575" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133781575">Mario Carneiro (Sep 12 2018 at 06:48)</a>:</h4>
<p>I think this thread is Scott having an epiphany similar to the one that prompted that blog post <a href="https://mathematicswithoutapologies.wordpress.com/2018/09/11/guest-post-by-kevin-buzzard/" target="_blank" title="https://mathematicswithoutapologies.wordpress.com/2018/09/11/guest-post-by-kevin-buzzard/">https://mathematicswithoutapologies.wordpress.com/2018/09/11/guest-post-by-kevin-buzzard/</a></p>

<a name="133781606"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133781606" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133781606">Mario Carneiro (Sep 12 2018 at 06:49)</a>:</h4>
<p>I think it boils down to "equalities of types are evil"</p>

<a name="133784114"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133784114" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133784114">Kevin Buzzard (Sep 12 2018 at 07:57)</a>:</h4>
<p>As I'm sure you realise, that comment (it was only supposed to be a comment!) was very much informed by the comments you made when I was having that big meltdown about equality a few months ago ("Kevin, stop trolling!").</p>

<a name="133784227"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133784227" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133784227">Kevin Buzzard (Sep 12 2018 at 08:01)</a>:</h4>
<p>A summer student, Ned Summers, was doing some 4th year category theory example sheet questions (using Scott's library as a dependency) and ran into these sorts of problems, and this time I was better equipped. Chris (who freely admits he knows nothing about category theory) had suggested some casts which had caused trouble for Ned, and I diagnosed the problem as exactly the same sort of thing: Ned had two objects X and Y and a proof that they were equal, and was doing exactly what a mathematican would do -- treating Hom(X,Z) as equal to Hom(Y,Z) etc etc. Equality in type theory is more delicate than that. Of course this doesn't change the fact that we are right, and your definition is rubbish -- but it's what we've got to work with ;-)</p>

<a name="133784234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133784234" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133784234">Kenny Lau (Sep 12 2018 at 08:01)</a>:</h4>
<blockquote>
<p>A summer student, Ned Summers</p>
</blockquote>

<a name="133784295"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133784295" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133784295">Kevin Buzzard (Sep 12 2018 at 08:02)</a>:</h4>
<p>They've almost all gone now. Ned stopped on Friday. Only about three left. I am going to spend all day writing documentation and basic questions. Yesterday I said "we want ten basic examples and ten basic questions about metaprogramming" -- today I'm (hopefully) going to write ten basic examples and ten basic questions about set membership.</p>

<a name="133784364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133784364" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133784364">Kevin Buzzard (Sep 12 2018 at 08:04)</a>:</h4>
<p>I asked a question on this chat probably last Wed or Thurs about how to generate "the identity morphism" between two objects which were provably equal, and Reid answered very quickly with some function called something like <code>iso_of_eq</code> which generated the data from the proof; it was because of my schemes meltdown that I had understood that this was what was missing.</p>

<a name="133786353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133786353" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133786353">Chris Hughes (Sep 12 2018 at 08:57)</a>:</h4>
<p>I didn't suggest the use of <code>eq.rec</code>. My instinct would be that <code>eq.rec</code> for data should be avoided if at all possible</p>

<a name="133788910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133788910" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133788910">Kevin Buzzard (Sep 12 2018 at 09:55)</a>:</h4>
<p>Maybe I got the wrong impression from Ned :-)</p>

<a name="133794864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133794864" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133794864">Scott Morrison (Sep 12 2018 at 12:16)</a>:</h4>
<p>Thanks to some help from Mario and Reid, it is well sorted out now!</p>

<a name="133794955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133794955" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133794955">Scott Morrison (Sep 12 2018 at 12:18)</a>:</h4>
<p>While I agree that I was making mistakes (being "evil") when I shouldn't have been, and the code is nicer as a result of today's exorcism, the fundamental cause of being stuck was something a bit different. I really need to catch up on sleep now, so I won't explain it now. :-)</p>

<a name="133794972"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133794972" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133794972">Scott Morrison (Sep 12 2018 at 12:19)</a>:</h4>
<p>The upshot is that &lt;<a href="https://github.com/semorrison/lean-category-theory/blob/master/src/category_theory/presheaves.lean" target="_blank" title="https://github.com/semorrison/lean-category-theory/blob/master/src/category_theory/presheaves.lean">https://github.com/semorrison/lean-category-theory/blob/master/src/category_theory/presheaves.lean</a>&gt; contains the definition of bundled presheaves (i.e. a topological space and a presheaf on it), and the right notion of morphisms between these, and indeed the category structure.</p>

<a name="133794979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133794979" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133794979">Scott Morrison (Sep 12 2018 at 12:19)</a>:</h4>
<p>It's certainly not all of <code>V_pre</code>, but it's the categorical theoretic core.</p>

<a name="133794986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133794986" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133794986">Patrick Massot (Sep 12 2018 at 12:19)</a>:</h4>
<p>Yeah, "Lean does no magic" ™ but sometimes a good exorcism session is needed</p>

<a name="133795036"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133795036" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133795036">Scott Morrison (Sep 12 2018 at 12:20)</a>:</h4>
<p>Hopefully from this point on it is just adding bells and whistles (that stalk needs to be local, these valuations need to be jiggered by the whatsit).</p>

<a name="133795050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133795050" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133795050">Scott Morrison (Sep 12 2018 at 12:21)</a>:</h4>
<p>Happily, the category of presheaves is actually pretty easy to PR now. I only have one dependency, about whiskering, and that looks easy to clean up. So this may be in mathlib soon.</p>

<a name="133837710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133837710" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133837710">Kenny Lau (Sep 12 2018 at 19:12)</a>:</h4>
<blockquote>
<p>to reduce an <code>eq.rec</code> you need the major premise to become <code>refl</code> somehow</p>
<p>that usually means finding the appropriate equality in the context and generalizing it until one side is a variable, and then <code>subst</code>, which is to say use <code>eq.rec</code> in the proof term</p>
</blockquote>
<p><a href="#narrow/stream/113488-general/subject/so.20what.20is.20eq.2Erec.3F/near/125134372" title="#narrow/stream/113488-general/subject/so.20what.20is.20eq.2Erec.3F/near/125134372">Mario Carneiro, 16/04/2018 04:39:04 (UTC)</a></p>

<a name="133837740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133837740" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133837740">Kenny Lau (Sep 12 2018 at 19:13)</a>:</h4>
<p>underrated comment</p>

<a name="133842645"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133842645" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133842645">Kenny Lau (Sep 12 2018 at 20:45)</a>:</h4>
<p>wow I had an <code>eq.rec</code> in my goal and it took me nearly 2 hours to destruct it</p>

<a name="133845614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133845614" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133845614">Reid Barton (Sep 12 2018 at 21:32)</a>:</h4>
<p>sounds about right</p>

<a name="133856278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133856278" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133856278">Scott Morrison (Sep 13 2018 at 01:39)</a>:</h4>
<p>I feel like <code>eq.rec</code> is such a disaster that we need special VS Code plugin support: a little zulip box that pops up, with a message: "Help me, Mario!" ready to be sent...</p>

<a name="133866974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133866974" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133866974">Kenny Lau (Sep 13 2018 at 07:16)</a>:</h4>
<p>ok so eq.rec isn't really the problem. The problem is sometimes you can't just rewrite something with an equality <code>a = b</code> because that something depends on <code>a</code> and <code>b</code> being those expressions. And the solution is to generalize <code>a</code> in all places in which that expression occurs, and then <code>subst</code> that equality</p>

<a name="133866988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133866988" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133866988">Kenny Lau (Sep 13 2018 at 07:17)</a>:</h4>
<p>sometimes you can't just generalize <code>a</code>, but you have to generalize a lot of things</p>

<a name="133866989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133866989" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133866989">Kenny Lau (Sep 13 2018 at 07:17)</a>:</h4>
<p>a strategy is to generalize all proofs first (<code>set_option pp.proofs true</code>), because that will always work because of proof irrelevance</p>

<a name="133947991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dependent%20argument%20hell/near/133947991" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/66336dependentargumenthell.html#133947991">Scott Morrison (Sep 14 2018 at 12:11)</a>:</h4>
<p>Slowly making progress here. This now compiles:</p>
<div class="codehilite"><pre><span></span>def stalks_local (F : Presheaf.{u+1 u} TopRing) : Type u :=
Π x : F, local_ring (((TopRing.forget_to_CommRing).map_presheaf F).stalk_at x)

def V_pre_pre := Σ (F : Presheaf.{u+1 u} TopRing), stalks_local F

example : category.{u+1 u} V_pre_pre := by unfold V_pre_pre; apply_instance
</pre></div>


{% endraw %}
