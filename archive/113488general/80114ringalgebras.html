---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/80114ringalgebras.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html">ring algebras</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="133299335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/133299335" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#133299335">Kenny Lau (Sep 04 2018 at 08:51)</a>:</h4>
<p>This problem has come up several times in this year, and I decided it's time to face it instead of to avoid it. This is the definition of an algebra over a commutative ring:</p>
<div class="codehilite"><pre><span></span><span class="n">class</span> <span class="n">algebra</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="n">out_param</span> <span class="err">$</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">ring</span> <span class="n">A</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">A</span><span class="o">)</span> <span class="o">[</span><span class="n">hom</span> <span class="o">:</span> <span class="n">is_ring_hom</span> <span class="n">f</span><span class="o">]</span>
<span class="o">(</span><span class="n">commutes</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">r</span> <span class="n">s</span><span class="o">,</span> <span class="n">s</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">r</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">r</span> <span class="bp">*</span> <span class="n">s</span><span class="o">)</span>
</pre></div>


<p>Mathematically there are no problems, but somehow every time I try to introduce this class, the class inferences become a mess, consistently. So, my question is: what is the best way to introduce this whole algebra thing to Lean?</p>

<a name="133299411"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/133299411" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#133299411">Johan Commelin (Sep 04 2018 at 08:53)</a>:</h4>
<p>Yeah! Go for it! I recognize the troubles, and I don't know the answer...</p>

<a name="133299424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/133299424" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#133299424">Johan Commelin (Sep 04 2018 at 08:53)</a>:</h4>
<p>Concerning terminology... I think Bourbaki has a more general notion of algebra.</p>

<a name="133299477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/133299477" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#133299477">Johan Commelin (Sep 04 2018 at 08:54)</a>:</h4>
<p>For example, a Lie algebra is an algebra.</p>

<a name="133299481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/133299481" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#133299481">Kenny Lau (Sep 04 2018 at 08:54)</a>:</h4>
<p>MWE:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">polynomial</span>

<span class="n">class</span> <span class="n">algebra</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="n">out_param</span> <span class="err">$</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">ring</span> <span class="n">A</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">A</span><span class="o">)</span> <span class="o">[</span><span class="n">hom</span> <span class="o">:</span> <span class="n">is_ring_hom</span> <span class="n">f</span><span class="o">]</span>
<span class="o">(</span><span class="n">commutes</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">r</span> <span class="n">s</span><span class="o">,</span> <span class="n">s</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">r</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">r</span> <span class="bp">*</span> <span class="n">s</span><span class="o">)</span>

<span class="kn">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">ring</span> <span class="n">R</span><span class="o">]</span>

<span class="kn">instance</span> <span class="n">ring</span><span class="bp">.</span><span class="n">to_ℤ_algebra</span> <span class="o">:</span> <span class="n">algebra</span> <span class="bp">ℤ</span> <span class="n">R</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">f</span> <span class="o">:=</span> <span class="n">coe</span><span class="o">,</span>
  <span class="n">hom</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">intros</span><span class="bp">;</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">commutes</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">n</span> <span class="n">r</span><span class="o">,</span> <span class="n">int</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">n</span> <span class="o">(</span><span class="k">by</span> <span class="n">simp</span><span class="o">)</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span> <span class="n">ih</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">mul_add</span><span class="o">,</span> <span class="n">add_mul</span><span class="o">,</span> <span class="n">ih</span><span class="o">])</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span> <span class="n">ih</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">mul_add</span><span class="o">,</span> <span class="n">add_mul</span><span class="o">,</span> <span class="n">ih</span><span class="o">]),</span> <span class="o">}</span>

<span class="kn">set_option</span> <span class="n">trace</span><span class="bp">.</span><span class="n">class_instances</span> <span class="n">true</span>
<span class="bp">#</span><span class="kn">check</span> <span class="o">(</span><span class="k">by</span> <span class="n">apply_instance</span> <span class="o">:</span> <span class="n">ring</span> <span class="o">(</span><span class="n">polynomial</span> <span class="bp">ℤ</span><span class="o">))</span>
</pre></div>

<a name="133299500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/133299500" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#133299500">Johan Commelin (Sep 04 2018 at 08:55)</a>:</h4>
<p>Don't you get diamonds this way?</p>

<a name="133299559"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/133299559" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#133299559">Kenny Lau (Sep 04 2018 at 08:56)</a>:</h4>
<p>What do you mean?</p>

<a name="133299562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/133299562" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#133299562">Johan Commelin (Sep 04 2018 at 08:56)</a>:</h4>
<p>every algebra is already a ring, and now you are turning rings into algebras, so you are getting loops, not?</p>

<a name="133299565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/133299565" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#133299565">Johan Commelin (Sep 04 2018 at 08:56)</a>:</h4>
<p>Maybe diamond is not the right word, but certainly loops.</p>

<a name="133299571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/133299571" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#133299571">Kenny Lau (Sep 04 2018 at 08:57)</a>:</h4>
<p>I see</p>

<a name="133299574"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/133299574" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#133299574">Kenny Lau (Sep 04 2018 at 08:57)</a>:</h4>
<p>but it's an important fact that every ring is a Z-algebra, no?</p>

<a name="133299633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/133299633" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#133299633">Johan Commelin (Sep 04 2018 at 08:58)</a>:</h4>
<p>Just as important as the fact that every abelian group is a Z-module.</p>

<a name="133299759"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/133299759" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#133299759">Kevin Buzzard (Sep 04 2018 at 09:01)</a>:</h4>
<p>Maybe that's the place to start this discussion. For example, my correspondence theorem is written for R-modules. How does one deduce the correspondence theorem for abelian groups? For mathematicians, the answer is easy -- "set R=Z; done". How do we do it in Lean?</p>

<a name="151194100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151194100" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151194100">Kevin Buzzard (Dec 08 2018 at 20:34)</a>:</h4>
<p>At the time, the answer to this question was "just wait until the module refactor hits and then try again". Did you try again after the module refactor? What is still problematic?</p>

<a name="151194328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151194328" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151194328">Kenny Lau (Dec 08 2018 at 20:43)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> the original MWE I posted above still works (in the sense that it still fails)</p>

<a name="151194329"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151194329" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151194329">Kenny Lau (Dec 08 2018 at 20:43)</a>:</h4>
<p>and if you define algebra differently, you run into another typeclass problem:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">polynomial</span>

<span class="n">universes</span> <span class="n">u</span> <span class="n">v</span>

<span class="n">class</span> <span class="n">algebra</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="n">out_param</span> <span class="err">$</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">[</span><span class="n">out_param</span> <span class="err">$</span> <span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">ring</span> <span class="n">A</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">A</span><span class="o">)</span> <span class="o">[</span><span class="n">hom</span> <span class="o">:</span> <span class="n">is_ring_hom</span> <span class="n">f</span><span class="o">]</span>
<span class="o">(</span><span class="n">commutes</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">r</span> <span class="n">s</span><span class="o">,</span> <span class="n">s</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">r</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">r</span> <span class="bp">*</span> <span class="n">s</span><span class="o">)</span>

<span class="n">attribute</span> <span class="o">[</span><span class="kn">instance</span><span class="o">]</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">hom</span>

<span class="kn">namespace</span> <span class="n">algebra</span>

<span class="kn">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span>
<span class="kn">variables</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">ring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">R</span> <span class="n">A</span><span class="o">]</span>

<span class="kn">instance</span> <span class="n">to_module</span> <span class="o">:</span> <span class="n">module</span> <span class="n">R</span> <span class="n">A</span> <span class="o">:=</span> <span class="n">module</span><span class="bp">.</span><span class="n">of_core</span>
<span class="o">{</span> <span class="n">smul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">r</span> <span class="n">x</span><span class="o">,</span> <span class="n">f</span> <span class="n">A</span> <span class="n">r</span> <span class="bp">*</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">smul_add</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">intros</span><span class="bp">;</span> <span class="n">simp</span> <span class="o">[</span><span class="n">mul_add</span><span class="o">],</span>
  <span class="n">add_smul</span> <span class="o">:=</span> <span class="n">sorry</span><span class="o">,</span>
  <span class="n">mul_smul</span> <span class="o">:=</span> <span class="n">sorry</span><span class="o">,</span>
  <span class="n">one_smul</span> <span class="o">:=</span> <span class="n">sorry</span> <span class="o">}</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">mul_smul</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">x</span> <span class="bp">*</span> <span class="o">(</span><span class="n">s</span> <span class="err">•</span> <span class="n">y</span><span class="o">)</span> <span class="bp">=</span> <span class="n">s</span> <span class="err">•</span> <span class="o">(</span><span class="n">x</span> <span class="bp">*</span> <span class="n">y</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">smul_def</span><span class="o">,</span> <span class="n">smul_def</span><span class="o">,</span> <span class="err">←</span> <span class="n">mul_assoc</span><span class="o">,</span> <span class="n">commutes</span><span class="o">,</span> <span class="n">mul_assoc</span><span class="o">]</span>

<span class="kn">end</span> <span class="n">algebra</span>
</pre></div>

<a name="151194330"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151194330" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151194330">Kenny Lau (Dec 08 2018 at 20:43)</a>:</h4>
<p>in any case I'm quite tired of Lean's typeclass inference</p>

<a name="151194336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151194336" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151194336">Kevin Buzzard (Dec 08 2018 at 20:44)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Help! Is this sort of thing still a problem?</p>

<a name="151194926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151194926" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151194926">Johan Commelin (Dec 08 2018 at 21:02)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> I know I'm just commenting without having tried anything out. But I have been working with over-categories a bit. And there has been some work with <code>CommRing</code>, I understand. So couldn't we define <code>algebra R</code> as <code>under R</code>?</p>

<a name="151194927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151194927" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151194927">Johan Commelin (Dec 08 2018 at 21:02)</a>:</h4>
<p>I hope that should just work.</p>

<a name="151195058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151195058" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151195058">Kenny Lau (Dec 08 2018 at 21:07)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> could you show me what the code I just posted would become?</p>

<a name="151196687"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151196687" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151196687">Johan Commelin (Dec 08 2018 at 22:01)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> Sorry, I was distracted for a while. You have worked on colimits in <code>CommRing</code> haven't you?</p>

<a name="151196688"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151196688" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151196688">Kenny Lau (Dec 08 2018 at 22:01)</a>:</h4>
<p>I haven't</p>

<a name="151196692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151196692" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151196692">Johan Commelin (Dec 08 2018 at 22:01)</a>:</h4>
<p>Aah, I thought you did, together with Ramon and Kevin.</p>

<a name="151196694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151196694" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151196694">Johan Commelin (Dec 08 2018 at 22:01)</a>:</h4>
<p>Anyway, I think <code>CommRing</code> is currently being PR'd or about to be PR'd.</p>

<a name="151196735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151196735" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151196735">Kenny Lau (Dec 08 2018 at 22:02)</a>:</h4>
<p>oh well I didn't use the category theory language</p>

<a name="151196737"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151196737" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151196737">Johan Commelin (Dec 08 2018 at 22:02)</a>:</h4>
<p><a href="https://github.com/leanprover/mathlib/blob/master/category_theory/examples/rings.lean" target="_blank" title="https://github.com/leanprover/mathlib/blob/master/category_theory/examples/rings.lean">https://github.com/leanprover/mathlib/blob/master/category_theory/examples/rings.lean</a></p>

<a name="151196739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151196739" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151196739">Johan Commelin (Dec 08 2018 at 22:02)</a>:</h4>
<p>So, there is something there.</p>

<a name="151196744"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151196744" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151196744">Johan Commelin (Dec 08 2018 at 22:03)</a>:</h4>
<p>Next, you could define under categories, as in <a href="https://github.com/leanprover-community/mathlib/blob/sheaf/category_theory/sheafy_preamble.lean#L180" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/sheaf/category_theory/sheafy_preamble.lean#L180">https://github.com/leanprover-community/mathlib/blob/sheaf/category_theory/sheafy_preamble.lean#L180</a></p>

<a name="151196745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151196745" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151196745">Johan Commelin (Dec 08 2018 at 22:03)</a>:</h4>
<p>And combining those, you would have commutative algebras over a commring.</p>

<a name="151196787"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151196787" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151196787">Kenny Lau (Dec 08 2018 at 22:04)</a>:</h4>
<p>yes, yes, yes, you could, provided that your URL doesn't contain "leanprover-community"</p>

<a name="151196790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151196790" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151196790">Johan Commelin (Dec 08 2018 at 22:04)</a>:</h4>
<p>You only need that 1 line.</p>

<a name="151196792"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151196792" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151196792">Johan Commelin (Dec 08 2018 at 22:04)</a>:</h4>
<p>Comma categories are already in mathlib.</p>

<a name="151196803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151196803" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151196803">Johan Commelin (Dec 08 2018 at 22:05)</a>:</h4>
<p>The <code>functor.of.obj</code> is currently being PR'd to replace <code>functor.of_obj</code></p>

<a name="151212724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151212724" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151212724">Johan Commelin (Dec 09 2018 at 08:02)</a>:</h4>
<p>Is there any chance that we will be able to use <code>\Z</code> notation as an object of <code>Ring</code>? Will we always have to type <code>Ring.int</code>? Somehow I wish that we can automatically coerce a type into an object of a category if the right type class instance is found... (maybe let's not worry if that is possible with modules, atm) It would be possible if that would at least be possible with the most basic examples, like nats, ints (modulo <code>n</code>), rats, reals, complexes.</p>

<a name="151213510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151213510" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151213510">Johan Commelin (Dec 09 2018 at 08:28)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> This is what I came up with, after a little bit of hacking. <a href="https://github.com/leanprover-community/mathlib/blob/jmc-leftmod/category_theory/examples/left_module.lean" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/jmc-leftmod/category_theory/examples/left_module.lean">https://github.com/leanprover-community/mathlib/blob/jmc-leftmod/category_theory/examples/left_module.lean</a><br>
Need to go now. Of course there is lots to be done.</p>

<a name="151214428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151214428" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151214428">Kenny Lau (Dec 09 2018 at 09:00)</a>:</h4>
<p>well... are you sure there will be no type-class issues?</p>

<a name="151217969"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151217969" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151217969">Johan Commelin (Dec 09 2018 at 11:01)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> Of course I can't be sure about that. But I think that the more you bundle, the less type class issues you will have. Otoh, the more you will have to be explicit about "coercions", and things like that.</p>

<a name="151217971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151217971" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151217971">Kenny Lau (Dec 09 2018 at 11:01)</a>:</h4>
<p>so are you implying that the Lean typeclass system cannot be salvaged unless we bundle everything?</p>

<a name="151218021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151218021" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151218021">Johan Commelin (Dec 09 2018 at 11:03)</a>:</h4>
<p>I don't know. The current type class system clearly isn't the most powerful thing imaginable. But for now I wouldn't mind trying more module stuff with less type class stuff.</p>

<a name="151218080"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151218080" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151218080">Johan Commelin (Dec 09 2018 at 11:05)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> Shall we try to define <code>map f</code> and <code>comap f</code> between <code>R-Mod</code> and <code>S-Mod</code> if <code>f : R \hom S</code> is a morphism of commutative rings?</p>

<a name="151218120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151218120" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151218120">Kenny Lau (Dec 09 2018 at 11:06)</a>:</h4>
<p>sure</p>

<a name="151218181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151218181" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151218181">Johan Commelin (Dec 09 2018 at 11:08)</a>:</h4>
<p>First complication: <code>CommRing</code> is not a full subcategory of <code>Ring</code> in the current setup. So we can't just speak of <code>R-Mod</code>.</p>

<a name="151220181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151220181" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151220181">Kevin Buzzard (Dec 09 2018 at 12:17)</a>:</h4>
<p>Isn't Lean's type class system the most powerful thing you can imagine subject to the requirement that you promise that if you ever define two terms of a given typeclass then they will be defeq? The problem might be that mathematicians are expecting too much from it perhaps. One way of upgrading it is to weaken the promise from "defeq" to "either defeq, or the typeclass is provably a subsingleton".</p>

<a name="151220287"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151220287" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151220287">Kevin Buzzard (Dec 09 2018 at 12:21)</a>:</h4>
<p>Maybe there is an art to using priorities somehow? You could imagine that mathematicians could try to get better at this art. I've not seen this technique used before. <span class="user-mention" data-user-id="110044">@Chris Hughes</span> you had problems with finsets or fintypes when you ended up with...something like two "different" empty lists representing the empty finset, right? Could you imagine carefully switching the priority of something to either very low or very high, to ensure that type class inference issues don't occur? Johan/Kenny, could you imagine doing the same thing here?</p>

<a name="151220971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151220971" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151220971">Chris Hughes (Dec 09 2018 at 12:47)</a>:</h4>
<p>I don't think priority switching works. In the algebra example maybe who end up with the two different instances because you used a lemma that had to use the polynomial instance, because it was proved in more generality than just the integers, and likewise for the other instance.</p>

<a name="151223377"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151223377" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151223377">Kenny Lau (Dec 09 2018 at 14:11)</a>:</h4>
<p>will auxiliary types be the solution?</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">to_module</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">algebra</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span> <span class="o">:=</span> <span class="n">A</span>

<span class="kn">instance</span> <span class="n">to_module</span><span class="bp">.</span><span class="n">comm_ring</span> <span class="o">:</span> <span class="n">comm_ring</span> <span class="o">(</span><span class="n">to_module</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">dunfold</span> <span class="n">to_module</span><span class="bp">;</span> <span class="n">apply_instance</span>

<span class="kn">instance</span> <span class="n">to_module</span><span class="bp">.</span><span class="n">module</span> <span class="o">:</span> <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">to_module</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span> <span class="n">module</span><span class="bp">.</span><span class="n">of_core</span>
<span class="o">{</span> <span class="n">smul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">r</span> <span class="n">x</span><span class="o">,</span> <span class="n">i</span> <span class="n">r</span> <span class="bp">*</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">smul_add</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">intros</span><span class="bp">;</span> <span class="n">simp</span> <span class="o">[</span><span class="n">mul_add</span><span class="o">],</span>
  <span class="n">add_smul</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">intros</span><span class="bp">;</span> <span class="n">simp</span> <span class="o">[</span><span class="n">add_mul</span><span class="o">],</span>
  <span class="n">mul_smul</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">intros</span><span class="bp">;</span> <span class="n">simp</span> <span class="o">[</span><span class="n">mul_assoc</span><span class="o">],</span>
  <span class="n">one_smul</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">intros</span><span class="bp">;</span> <span class="n">simp</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">one_mul</span> <span class="n">x</span> <span class="o">}</span>
</pre></div>

<a name="151223424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151223424" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151223424">Chris Hughes (Dec 09 2018 at 14:12)</a>:</h4>
<p>But you're still going to end up needing to prove the two instances are equal right? If you use lemmas about each of the different instances</p>

<a name="151223593"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151223593" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151223593">Kenny Lau (Dec 09 2018 at 14:18)</a>:</h4>
<p>I made it a structure</p>

<a name="151223656"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151223656" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151223656">Kevin Buzzard (Dec 09 2018 at 14:20)</a>:</h4>
<p>Maybe you can use <code>convert</code> cleverly at some point. Can you remove things from the type class inference machine? I can't help but think that it will somehow be possible to do all this, maybe we're not having the clearest ideas about how to do it</p>

<a name="151229632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151229632" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151229632">Chris Hughes (Dec 09 2018 at 17:43)</a>:</h4>
<blockquote>
<p>Maybe you can use <code>convert</code> cleverly at some point. Can you remove things from the type class inference machine? I can't help but think that it will somehow be possible to do all this, maybe we're not having the clearest ideas about how to do it</p>
</blockquote>
<p>convert and congr are handy in these situations</p>

<a name="151237409"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151237409" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151237409">Kenny Lau (Dec 09 2018 at 21:45)</a>:</h4>
<p>(non-MWE incoming)</p>

<a name="151237411"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151237411" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151237411">Kenny Lau (Dec 09 2018 at 21:45)</a>:</h4>
<p><a href="/user_uploads/3121/OP41IwlpQ8GAgQpW6UFtBNmB/2018-12-09-2.png" target="_blank" title="2018-12-09-2.png">2018-12-09-2.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/OP41IwlpQ8GAgQpW6UFtBNmB/2018-12-09-2.png" target="_blank" title="2018-12-09-2.png"><img src="/user_uploads/3121/OP41IwlpQ8GAgQpW6UFtBNmB/2018-12-09-2.png"></a></div>

<a name="151237456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151237456" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151237456">Kenny Lau (Dec 09 2018 at 21:46)</a>:</h4>
<p>"there's a type mismatch so I use <code>convert</code> which produces a proof by <code>eq.mpr (eq.refl _)</code></p>

<a name="151237458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151237458" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151237458">Kenny Lau (Dec 09 2018 at 21:46)</a>:</h4>
<p>so what is happening"</p>

<a name="151246670"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151246670" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151246670">Kenny Lau (Dec 10 2018 at 02:41)</a>:</h4>
<p>R[X] is an R-algebra so it has a module structure (where the scalar multiplication is <code>C r * p</code>). However <code>R[X]</code> is a finsupp so it also gets another module structure</p>

<a name="151246708"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151246708" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151246708">Kenny Lau (Dec 10 2018 at 02:42)</a>:</h4>
<p>The two module structures are not definitionally equal</p>

<a name="151246711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151246711" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151246711">Kenny Lau (Dec 10 2018 at 02:42)</a>:</h4>
<p>can we get rid of the latter structure?</p>

<a name="151246878"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151246878" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151246878">Reid Barton (Dec 10 2018 at 02:49)</a>:</h4>
<p>Isn't the latter instance "the direct sum of R-modules is an R-module"?</p>

<a name="151246932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151246932" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151246932">Kenny Lau (Dec 10 2018 at 02:50)</a>:</h4>
<p>right</p>

<a name="151247189"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151247189" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151247189">Reid Barton (Dec 10 2018 at 02:59)</a>:</h4>
<p>How does the second instance come up in practice? Are you manually unfolding to a finsupp?<br>
Ah, do you mean the line <code>instance : module α (polynomial α) := finsupp.to_module ℕ α</code>?</p>

<a name="151247250"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151247250" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151247250">Reid Barton (Dec 10 2018 at 03:00)</a>:</h4>
<p>(does R[X] refer to <code>data.polynomial</code>?)</p>

<a name="151247375"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151247375" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151247375">Kenny Lau (Dec 10 2018 at 03:04)</a>:</h4>
<p>yes</p>

<a name="151247440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151247440" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151247440">Reid Barton (Dec 10 2018 at 03:06)</a>:</h4>
<p>I think I mostly caught up on this thread. Deleting that instance makes sense, though I wouldn't be too surprised if you end up with new problems...</p>

<a name="151257075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151257075" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151257075">Kenny Lau (Dec 10 2018 at 08:15)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> what do you think about this?</p>

<a name="151257150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151257150" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151257150">Mario Carneiro (Dec 10 2018 at 08:17)</a>:</h4>
<div class="codehilite"><pre><span></span>class algebra (R : out_param $ Type*) [comm_ring R] (A : Type*) extends ring A :=
</pre></div>


<p>this is trouble, because this will make <code>ring A</code> typeclass problems go looking for instances of <code>algebra ? A</code></p>

<a name="151257201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151257201" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151257201">Kenny Lau (Dec 10 2018 at 08:18)</a>:</h4>
<p>right, so I am not using this now</p>

<a name="151257205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151257205" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151257205">Kenny Lau (Dec 10 2018 at 08:18)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">structure</span> <span class="n">algebra</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">A</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">to_fun</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">A</span><span class="o">)</span> <span class="o">[</span><span class="n">hom</span> <span class="o">:</span> <span class="n">is_ring_hom</span> <span class="n">to_fun</span><span class="o">]</span>
</pre></div>

<a name="151257208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151257208" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151257208">Kenny Lau (Dec 10 2018 at 08:18)</a>:</h4>
<p>I've been using this</p>

<a name="151257288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151257288" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151257288">Kenny Lau (Dec 10 2018 at 08:20)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> would there be any problem if we forgot about the module structure on R[X] induced by finsupp?</p>

<a name="151257303"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151257303" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151257303">Kenny Lau (Dec 10 2018 at 08:21)</a>:</h4>
<p>or maybe I should just prove that these two modules are isomorphic</p>

<a name="151257358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151257358" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151257358">Mario Carneiro (Dec 10 2018 at 08:22)</a>:</h4>
<p>I thought an algebra was a ring that is also a module</p>

<a name="151257370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151257370" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151257370">Mario Carneiro (Dec 10 2018 at 08:22)</a>:</h4>
<p>why not have it extend module, and assert that the function's induced smul matches the existing one</p>

<a name="151257442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151257442" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151257442">Kenny Lau (Dec 10 2018 at 08:24)</a>:</h4>
<p>I thought we like definitional equalities</p>

<a name="151257466"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151257466" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151257466">Kenny Lau (Dec 10 2018 at 08:25)</a>:</h4>
<p>hmm, I see that can be a solution</p>

<a name="151258425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151258425" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151258425">Kevin Buzzard (Dec 10 2018 at 08:49)</a>:</h4>
<blockquote>
<p>I thought an algebra was a ring that is also a module</p>
</blockquote>
<p>In CS you have to think really carefully about these sorts of things. In my mind, an <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.00773em;">R</span></span></span></span>-algebra is a ring which is also an <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.00773em;">R</span></span></span></span>-module, <em>and</em> an <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.00773em;">R</span></span></span></span>-algebra is the codomain of a ring homomorphism from <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.00773em;">R</span></span></span></span> -- the two notions are completely interchangeable. In Lean things seem to be much more delicate.</p>

<a name="151258478"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151258478" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151258478">Kevin Buzzard (Dec 10 2018 at 08:50)</a>:</h4>
<blockquote>
<div class="codehilite"><pre><span></span><span class="n">class</span> <span class="n">algebra</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="n">out_param</span> <span class="err">$</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">ring</span> <span class="n">A</span> <span class="o">:=</span>
</pre></div>


<p>this is trouble, because this will make <code>ring A</code> typeclass problems go looking for instances of <code>algebra ? A</code></p>
</blockquote>
<p>Can someone explain this to me? I don't know how the type class machine works <em>at all</em> and I would really like to know what its algorithm is.</p>

<a name="151258929"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151258929" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151258929">Kevin Buzzard (Dec 10 2018 at 09:02)</a>:</h4>
<p>Maybe what I need is some abstract examples of classes and instances and an explanation of what typeclass inference does to solve typeclass problems, and also an example of how type class inference can get into trouble and cause one of those huge log files which ends up in a max class instance resolution error.</p>

<a name="151258959"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151258959" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151258959">Kevin Buzzard (Dec 10 2018 at 09:03)</a>:</h4>
<p>If this isn't going to change in Lean 4 then perhaps it's worth documenting how all this works a bit better. Currently I just regard it as magic, but as Kenny once informed me, Lean does not do magic.</p>

<a name="151259223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151259223" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151259223">Kenny Lau (Dec 10 2018 at 09:09)</a>:</h4>
<p>well in the future a neural network will resolve typeclass issues and none of us would know the algorithm</p>

<a name="151259284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151259284" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151259284">Kevin Buzzard (Dec 10 2018 at 09:10)</a>:</h4>
<p>So Lean 7 does do magic after all.</p>

<a name="151259301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151259301" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151259301">Kevin Buzzard (Dec 10 2018 at 09:11)</a>:</h4>
<p>But how does Lean 7 resolve the problem that it can find two non-defeq instances of <code>topological_space X \times Y</code> when <code>X</code> and <code>Y</code> are both metric spaces?</p>

<a name="151259312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151259312" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151259312">Kevin Buzzard (Dec 10 2018 at 09:11)</a>:</h4>
<p>There is a fundamental issue unrelated to algorithms.</p>

<a name="151259376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151259376" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151259376">Kevin Buzzard (Dec 10 2018 at 09:13)</a>:</h4>
<p>Can we feed useful theorems into the network and tell it to try applying them whenever it can't resolve type class issues? "If you can't prove that <code>instance1 : foo A</code> and <code>instance2 : foo A</code> are defeq, take look at the useful theorems about terms of type <code>foo A</code> which I told you about".</p>

<a name="151259384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151259384" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151259384">Kevin Buzzard (Dec 10 2018 at 09:13)</a>:</h4>
<p><span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> am I living in a dream world?</p>

<a name="151259442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151259442" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151259442">Kevin Buzzard (Dec 10 2018 at 09:14)</a>:</h4>
<p>This happens to mathematicians in practice, in particular in cases where <code>foo A</code> is a subsingleton and not a prop, and the two terms are not defeq but are trivially equal.</p>

<a name="151259451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151259451" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151259451">Kevin Buzzard (Dec 10 2018 at 09:15)</a>:</h4>
<p>We want to do hard algebra in Lean but we cannot do it in a natural way and also use the typeclass system because our structures seem to be slightly too complex for it.</p>

<a name="151259503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151259503" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151259503">Kevin Buzzard (Dec 10 2018 at 09:16)</a>:</h4>
<p>Well -- maybe we can use it -- maybe we just didn't figure out how to use it yet.</p>

<a name="151259599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151259599" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151259599">Sebastian Ullrich (Dec 10 2018 at 09:19)</a>:</h4>
<p>Type classes only work well when all instances are unique. In other languages this property is enforced, but Lean's type class inference is too general to implement that in a sensible way.</p>

<a name="151259686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151259686" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151259686">Sebastian Ullrich (Dec 10 2018 at 09:20)</a>:</h4>
<p>I haven't followed these threads closely enough to say what should be done about the examples that don't satisfy this property right now</p>

<a name="151260066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151260066" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151260066">Kevin Buzzard (Dec 10 2018 at 09:29)</a>:</h4>
<p>By "unique" you mean that any two instances are defeq, I guess. Could you imagine a strengthening of the system which could handle non-defeq instances which are equal because of a theorem which the type class system "knows" ? Or is this just somehow completely computationally unfeasible? The simplest case is when the class is a subsingleton.</p>

<a name="151260884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151260884" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151260884">Sebastian Ullrich (Dec 10 2018 at 09:43)</a>:</h4>
<p>The type class system doesn't even know anything about definitional equality, it just uses the same unification as any other part of Lean. I'm not sure if it would be weird to add some sense of definitional extensionality to just this one part of the system, or what that should look like.</p>

<a name="151261422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151261422" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151261422">Patrick Massot (Dec 10 2018 at 09:52)</a>:</h4>
<p>What about the following modification: if the type class search terminally fails (not an intermediate fail during exploration), unfold the head symbol and try again? It seems to me this would make the type wrapping solution much more usable.</p>

<a name="151261745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151261745" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151261745">Sebastian Ullrich (Dec 10 2018 at 09:58)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> The failed inference can involve many other classes, should they also be unfolded if possible? No, if you want a def to be unfolded by type class inference, it should be reducible.</p>

<a name="151261760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151261760" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151261760">Kevin Buzzard (Dec 10 2018 at 09:59)</a>:</h4>
<p>Can one locally mark a def as reducible?</p>

<a name="151261761"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151261761" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151261761">Patrick Massot (Dec 10 2018 at 09:59)</a>:</h4>
<p>I don't want it to be reducible, I want is to be unfolded only in the situation I described</p>

<a name="151261816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151261816" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151261816">Patrick Massot (Dec 10 2018 at 10:00)</a>:</h4>
<p>This is strictly an extension of the current algorithm, it takes over after everything else failed, and start again on a different problem</p>

<a name="151261829"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151261829" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151261829">Kevin Buzzard (Dec 10 2018 at 10:01)</a>:</h4>
<p>By "failure" you presumably do you not include "max type class instance resolution reached", which might just mean it's not trying hard enough.</p>

<a name="151261851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151261851" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151261851">Patrick Massot (Dec 10 2018 at 10:01)</a>:</h4>
<p>Excluding maxdepth error</p>

<a name="151261904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151261904" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151261904">Patrick Massot (Dec 10 2018 at 10:02)</a>:</h4>
<p>My vague understanding is that Coq canonical structure instance resolution does what I wrote</p>

<a name="151261985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151261985" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151261985">Patrick Massot (Dec 10 2018 at 10:04)</a>:</h4>
<p>By the way, Sebastian, would it make sense to add shortcuts for the instance problems that Lean keeps solving for each proof (like <code>has_bind tactic</code> or <code>has_one ℕ</code> or <code>has_add ℕ</code>)?</p>

<a name="151266117"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151266117" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151266117">Sebastian Ullrich (Dec 10 2018 at 11:33)</a>:</h4>
<blockquote>
<p>By the way, Sebastian, would it make sense to add shortcuts for the instance problems that Lean keeps solving for each proof (like <code>has_bind tactic</code> or <code>has_one ℕ</code> or <code>has_add ℕ</code>)?</p>
</blockquote>
<p>Shortcut instances are a valid optimization, though they can also increase run time when the subproblem fails (whereas the full problem could still succeed) because there simply are more instances to check. In theory, better caching could also help there, which is the one part of the type class system that's likely to change in Lean 4.</p>

<a name="151266186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151266186" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151266186">Kenny Lau (Dec 10 2018 at 11:34)</a>:</h4>
<p>how is the Lean 4 system better?</p>

<a name="151266584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/ring%20algebras/near/151266584" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/80114ringalgebras.html#151266584">Sebastian Ullrich (Dec 10 2018 at 11:42)</a>:</h4>
<p>I don't know, it hasn't changed yet</p>


{% endraw %}

{% include archive_update.html %}