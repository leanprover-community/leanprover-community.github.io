---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/61179aboutcompilation.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html">about compilation</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="147299477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147299477" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147299477">Kenny Lau (Nov 08 2018 at 13:39)</a>:</h4>
<p>why do we need to re-compile the file as well as all the files that depend on the file even if all we did is adding a space?</p>

<a name="147299709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147299709" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147299709">Kenny Lau (Nov 08 2018 at 13:43)</a>:</h4>
<p>or if we just change proofs?</p>

<a name="147300005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147300005" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147300005">Sebastian Ullrich (Nov 08 2018 at 13:48)</a>:</h4>
<p>Because the alternative is so complex that not a single ITP I know does otherwise</p>

<a name="147300301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147300301" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147300301">Kenny Lau (Nov 08 2018 at 13:54)</a>:</h4>
<p>could you elaborate?</p>

<a name="147305164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147305164" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147305164">Sebastian Ullrich (Nov 08 2018 at 15:07)</a>:</h4>
<p>For adding a space, the short story is that we should compare the old and new AST's contents to decide if there was a semantic change. But Lean 3 does not even have ASTs for full definitions.</p>

<a name="147305250"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147305250" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147305250">Sebastian Ullrich (Nov 08 2018 at 15:08)</a>:</h4>
<p>If you change a proof, that is an actual change that results in a different .olean file. So now you need some extra logic to tell dependent files that while the .olean file has changed, they shouldn't care about that.</p>

<a name="147305300"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147305300" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147305300">Sebastian Ullrich (Nov 08 2018 at 15:09)</a>:</h4>
<p>etc. pp.. It's not impossible, and we have at least discussed whether we could do something in that direction in Lean 4, but it's not at all trivial</p>

<a name="147305319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147305319" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147305319">Kenny Lau (Nov 08 2018 at 15:09)</a>:</h4>
<p>what is AST?</p>

<a name="147305325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147305325" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147305325">Sebastian Ullrich (Nov 08 2018 at 15:09)</a>:</h4>
<p>abstract syntax tree</p>

<a name="147305521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147305521" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147305521">Kenny Lau (Nov 08 2018 at 15:12)</a>:</h4>
<p>what makes ITP different from ordinary programming languages that can do that?</p>

<a name="147305525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147305525" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147305525">Kenny Lau (Nov 08 2018 at 15:12)</a>:</h4>
<p>(that's probably a stupid question)</p>

<a name="147305750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147305750" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147305750">Johan Commelin (Nov 08 2018 at 15:16)</a>:</h4>
<p>Ordinary programming languages would recompile everything if you changed a "proof", because the don't have "proof"-irrelevance. All their function definitions are data.</p>

<a name="147306095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147306095" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147306095">Sebastian Ullrich (Nov 08 2018 at 15:21)</a>:</h4>
<p>Incremental compilation is even harder in "ordinary languages" where all definitions live in the same mutually recursive context. The Rust people have been working on it for multiple years and are still not done.</p>

<a name="147307938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147307938" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147307938">Bryan Gin-ge Chen (Nov 08 2018 at 15:46)</a>:</h4>
<p>Very na√Øve question, but why are the proofs stored in the .olean files? Since there is proof irrelevance, isn't it true that they won't be read again?</p>

<a name="147308007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147308007" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147308007">Bryan Gin-ge Chen (Nov 08 2018 at 15:48)</a>:</h4>
<p>I guess you didn't say that the proofs are stored in the .olean files and perhaps it's not true. But then my question is why should changing proofs change the .olean files?</p>

<a name="147340884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147340884" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147340884">Keeley Hoek (Nov 09 2018 at 00:27)</a>:</h4>
<p>The proofs are not needed, but they witness the fact that a proof exists. I think the idea with the olean files was something that could both have its program-parts executed, and be run through a Lean checker in order to check correctness.</p>

<a name="147357737"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147357737" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147357737">Sebastian Ullrich (Nov 09 2018 at 08:23)</a>:</h4>
<p>Yes, the proofs are consumed by external checkers. They could be move to a separate file, but it doesn't help much: Even just inserting a newline somewhere changes position information in the .olean file. So you really need a more sophisticated dependency system than on the file level.</p>

<a name="147464338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147464338" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147464338">Simon Hudon (Nov 11 2018 at 05:33)</a>:</h4>
<p>I think the easiest thing to do would be to get a build system to hash the olean files and consider a change only when the olean's hash changes</p>

<a name="147464339"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/about%20compilation/near/147464339" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/61179aboutcompilation.html#147464339">Simon Hudon (Nov 11 2018 at 05:33)</a>:</h4>
<p>Changing a proof would still trigger a rebuild but adding a space wouldn't</p>


{% endraw %}

{% include archive_update.html %}