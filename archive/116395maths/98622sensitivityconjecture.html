---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/116395maths/98622sensitivityconjecture.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/116395maths/index.html">maths</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html">sensitivity conjecture</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="172285808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172285808" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172285808">Johan Commelin (Aug 02 2019 at 05:54)</a>:</h4>
<p>The sensitivity conjecture was 30 years old, and recently resolved. Can we formalise this? <a href="https://www.scottaaronson.com/blog/?p=4229" target="_blank" title="https://www.scottaaronson.com/blog/?p=4229">https://www.scottaaronson.com/blog/?p=4229</a><br>
See also Donald Knuth's condensation of the proof: <a href="https://www.cs.stanford.edu/~knuth/papers/huang.pdf" target="_blank" title="https://www.cs.stanford.edu/~knuth/papers/huang.pdf">https://www.cs.stanford.edu/~knuth/papers/huang.pdf</a></p>

<a name="172286621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172286621" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172286621">Johan Commelin (Aug 02 2019 at 06:16)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span> You've been doing a lot with matrices lately. Did you do things like row/column rank?</p>

<a name="172286628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172286628" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172286628">Johan Commelin (Aug 02 2019 at 06:17)</a>:</h4>
<p>And how far did you get with the inverse matrix?</p>

<a name="172290859"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172290859" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172290859">Chris Hughes (Aug 02 2019 at 07:55)</a>:</h4>
<p>I used a noncomputable inverse in the end. I didn't use row and column rank either, but used the predicates <code>has_left_inverse</code> and <code>has_right_inverse</code> as well. Both of these look good enough for the sensitivity proof.</p>

<a name="172291016"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172291016" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172291016">Johan Commelin (Aug 02 2019 at 07:58)</a>:</h4>
<p>But this isn't in mathlib yet, right?</p>

<a name="172291026"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172291026" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172291026">Chris Hughes (Aug 02 2019 at 07:59)</a>:</h4>
<p>No.</p>

<a name="172292314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172292314" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172292314">Chris Hughes (Aug 02 2019 at 08:24)</a>:</h4>
<p>It's a bit unfinished, that's why. It would be nicer to have a pseudoinverse that worked on rectangular matrices.</p>

<a name="172302263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172302263" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172302263">Reid Barton (Aug 02 2019 at 11:54)</a>:</h4>
<p>I thought about this also. How easy is it to do these block matrix calculations appearing in the proof that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>n</mi></msub><mo>=</mo><mi>n</mi><mi>I</mi></mrow><annotation encoding="application/x-tex">A_n = nI</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span></span></span></span> (and in the definition of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">A_n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)?<br>
This is another example where it's natural to consider a matrix with rows and columns indexed by a general finite type (in this case, the hypercube).</p>

<a name="172302285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172302285" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172302285">Reid Barton (Aug 02 2019 at 11:55)</a>:</h4>
<p>Given what we have at the moment it might be easier to formulate the Knuth proof in terms of linear maps everywhere instead of matrices</p>

<a name="172302342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172302342" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172302342">Kevin Buzzard (Aug 02 2019 at 11:56)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span> the matrices in Knuth's proof are indexed by {0,1}^n</p>

<a name="172302847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172302847" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172302847">Chris Hughes (Aug 02 2019 at 12:06)</a>:</h4>
<p>My matrix pequiv thing might help with the block matrix computations. You can concatenate matrices algebraically using something like<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><mtable columnspacing="1em" rowspacing="0.15999999999999992em"><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mi>a</mi></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mi>b</mi></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mrow><mo fence="true">(</mo><mtable columnspacing="1em" rowspacing="0.15999999999999992em"><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mn>1</mn></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo>+</mo><mrow><mo fence="true">(</mo><mtable columnspacing="1em" rowspacing="0.15999999999999992em"><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mi>c</mi></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mi>d</mi></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mrow><mo fence="true">(</mo><mtable columnspacing="1em" rowspacing="0.15999999999999992em"><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo>=</mo><mrow><mo fence="true">(</mo><mtable columnspacing="1em" rowspacing="0.15999999999999992em"><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mi>a</mi></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mi>b</mi></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mi>c</mi></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mi>d</mi></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \begin{pmatrix} a &amp; b \end{pmatrix} \begin{pmatrix} 1 &amp; 0 \\0 &amp; 0 \end{pmatrix} +  \begin{pmatrix} c &amp; d \end{pmatrix} \begin{pmatrix} 0 &amp; 0 \\0 &amp; 1 \end{pmatrix} = \begin{pmatrix} a &amp; b \\c &amp; d \end{pmatrix} </annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">a</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">b</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></p>

<a name="172303195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172303195" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172303195">Chris Hughes (Aug 02 2019 at 12:12)</a>:</h4>
<p>In the proof you'll probably end up with some big ugly sum, but with some terms like <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><mtable columnspacing="1em" rowspacing="0.15999999999999992em"><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mn>1</mn></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mrow><mo fence="true">(</mo><mtable columnspacing="1em" rowspacing="0.15999999999999992em"><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \begin{pmatrix} 1 &amp; 0 \\0 &amp; 0 \end{pmatrix}  \begin{pmatrix} 0 &amp; 0 \\0 &amp; 1 \end{pmatrix} </annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span>, which cancel quite easily.</p>

<a name="172303474"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172303474" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172303474">Reid Barton (Aug 02 2019 at 12:18)</a>:</h4>
<p>I'm writing up a translation of Knuth's version into linear maps to compare</p>

<a name="172305884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172305884" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172305884">Reid Barton (Aug 02 2019 at 12:58)</a>:</h4>
<p><a href="https://gist.github.com/rwbarton/ed50d4340e2f654b9d778ccb3ec93442" target="_blank" title="https://gist.github.com/rwbarton/ed50d4340e2f654b9d778ccb3ec93442">https://gist.github.com/rwbarton/ed50d4340e2f654b9d778ccb3ec93442</a></p>

<a name="172306115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172306115" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172306115">Reid Barton (Aug 02 2019 at 13:00)</a>:</h4>
<p>I haven't used the relevant parts of mathlib much but as far as I could tell while writing this everything ought to be fairly straightforward</p>

<a name="172306466"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172306466" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172306466">Chris Hughes (Aug 02 2019 at 13:05)</a>:</h4>
<p>Is there an easy way to see the pdf version?</p>

<a name="172306511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172306511" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172306511">Kevin Buzzard (Aug 02 2019 at 13:05)</a>:</h4>
<p>rofl kids these days</p>

<a name="172306561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172306561" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172306561">Reid Barton (Aug 02 2019 at 13:06)</a>:</h4>
<p>One sec</p>

<a name="172306589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172306589" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172306589">Reid Barton (Aug 02 2019 at 13:06)</a>:</h4>
<p><a href="/user_uploads/3121/VNuGjVQNpDqyuE_fBRGXoVNU/sensitivity.pdf" target="_blank" title="sensitivity.pdf">sensitivity.pdf</a></p>

<a name="172307137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172307137" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172307137">Johan Commelin (Aug 02 2019 at 13:14)</a>:</h4>
<p>That looks quite formalisable, I think.</p>

<a name="172307228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172307228" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172307228">Johan Commelin (Aug 02 2019 at 13:16)</a>:</h4>
<p>After all, Kenny formalised the dimension formula, and Fabian did the dual basis.</p>

<a name="172307232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172307232" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172307232">Johan Commelin (Aug 02 2019 at 13:16)</a>:</h4>
<p>Anything else that we need?</p>

<a name="172307398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172307398" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172307398">Johan Commelin (Aug 02 2019 at 13:18)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span> How far are you with the Lean version?</p>

<a name="172307399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172307399" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172307399">Reid Barton (Aug 02 2019 at 13:18)</a>:</h4>
<p>Haven't started</p>

<a name="172307418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172307418" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172307418">Reid Barton (Aug 02 2019 at 13:18)</a>:</h4>
<p>The only other general fact which gets used is the triangle inequality for summing over a finite set, do we have that?</p>

<a name="172307483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172307483" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172307483">Johan Commelin (Aug 02 2019 at 13:19)</a>:</h4>
<p>If we do, it should be <code>finset.abs_sum</code>, right? I don't think I've seen it.</p>

<a name="172307486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172307486" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172307486">Reid Barton (Aug 02 2019 at 13:19)</a>:</h4>
<p>Then there is going to be some possibly tricky business relating the hypercube graph to the matrix entries of the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">f_n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, but that would also appear in the matrix version</p>

<a name="172307669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172307669" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172307669">Johan Commelin (Aug 02 2019 at 13:22)</a>:</h4>
<p>Right, that final <code>calc</code> block seems the most tricky part.</p>

<a name="172307680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172307680" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172307680">Johan Commelin (Aug 02 2019 at 13:22)</a>:</h4>
<p>The rest is straight-forward, I think.</p>

<a name="172307992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172307992" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172307992">Rob Lewis (Aug 02 2019 at 13:26)</a>:</h4>
<p>This looks super doable. It's obviously a different kind of proof, but somehow it reminds me of the cap set proof in spirit.</p>

<a name="172308485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172308485" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172308485">Reid Barton (Aug 02 2019 at 13:32)</a>:</h4>
<p>I guess I'll just start typing and see at what point I get stuck.</p>

<a name="172313175"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172313175" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172313175">Johan Commelin (Aug 02 2019 at 14:30)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span> How are things going so far? I finally have time to look at this</p>

<a name="172313340"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172313340" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172313340">Reid Barton (Aug 02 2019 at 14:32)</a>:</h4>
<p>So far I created a new repository and did other things while building mathlib <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>

<a name="172313359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172313359" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172313359">Reid Barton (Aug 02 2019 at 14:33)</a>:</h4>
<p>I was about to get started actually</p>

<a name="172313459"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172313459" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172313459">Johan Commelin (Aug 02 2019 at 14:34)</a>:</h4>
<p>Why do you build mathlib?</p>

<a name="172313471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172313471" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172313471">Johan Commelin (Aug 02 2019 at 14:34)</a>:</h4>
<p>I haven't built mathlib in 3 months</p>

<a name="172313488"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172313488" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172313488">Reid Barton (Aug 02 2019 at 14:34)</a>:</h4>
<p>I haven't been indoctrinated in the new ways yet and I had other things to do anyways</p>

<a name="172314588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172314588" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172314588">Reid Barton (Aug 02 2019 at 14:48)</a>:</h4>
<p>Does this look sensible so far?</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">linear_algebra</span><span class="bp">.</span><span class="n">dimension</span>

<span class="n">noncomputable</span> <span class="n">theory</span>

<span class="c">/-</span><span class="cm">- The free vector space on vertices of a hypercube, defined inductively. -/</span>
<span class="n">def</span> <span class="n">V</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">ℝ</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="n">V</span> <span class="n">n</span> <span class="bp">×</span> <span class="n">V</span> <span class="n">n</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">n</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">nat</span><span class="bp">.</span><span class="n">rec</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">dunfold</span> <span class="n">V</span><span class="o">,</span> <span class="n">apply_instance</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">introsI</span> <span class="n">n</span> <span class="n">IH</span><span class="o">,</span> <span class="n">dunfold</span> <span class="n">V</span><span class="o">,</span> <span class="n">apply_instance</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">n</span><span class="o">,</span> <span class="n">vector_space</span> <span class="n">ℝ</span> <span class="o">(</span><span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">nat</span><span class="bp">.</span><span class="n">rec</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">dunfold</span> <span class="n">V</span><span class="o">,</span> <span class="n">apply_instance</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">introsI</span> <span class="n">n</span> <span class="n">IH</span><span class="o">,</span> <span class="n">dunfold</span> <span class="n">V</span><span class="o">,</span> <span class="n">apply_instance</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">dim_V</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="n">vector_space</span><span class="bp">.</span><span class="n">dim</span> <span class="n">ℝ</span> <span class="o">(</span><span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">2</span><span class="err">^</span><span class="n">n</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">IH</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">dim_of_field</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">dunfold</span> <span class="n">V</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">dim_prod</span><span class="o">,</span> <span class="n">IH</span><span class="o">,</span> <span class="n">pow_succ</span><span class="o">,</span> <span class="n">two_mul</span><span class="o">]</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="c">/-</span><span class="cm">- The linear operator f_n corresponding to Huang&#39;s matrix A_n. -/</span>
<span class="n">def</span> <span class="n">f</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">n</span><span class="o">,</span> <span class="n">V</span> <span class="n">n</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">ℝ</span><span class="o">]</span> <span class="n">V</span> <span class="n">n</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="n">sorry</span>
</pre></div>

<a name="172314746"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172314746" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172314746">Reid Barton (Aug 02 2019 at 14:50)</a>:</h4>
<p>And is there any special support for linear maps into/out of binary direct sums?</p>

<a name="172314905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172314905" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172314905">Rob Lewis (Aug 02 2019 at 14:52)</a>:</h4>
<p>Heh, I just started playing around with this and got to exactly the same place. Not that I saw (at a quick glance).</p>

<a name="172314931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172314931" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172314931">Reid Barton (Aug 02 2019 at 14:52)</a>:</h4>
<p>Ah yes, <code>linear_map.fst/snd/prod</code></p>

<a name="172315261"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172315261" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172315261">Reid Barton (Aug 02 2019 at 14:56)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="c">/-</span><span class="cm">- The linear operator f_n corresponding to Huang&#39;s matrix A_n. -/</span>
<span class="n">noncomputable</span> <span class="n">def</span> <span class="n">f</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">n</span><span class="o">,</span> <span class="n">V</span> <span class="n">n</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">ℝ</span><span class="o">]</span> <span class="n">V</span> <span class="n">n</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span>
  <span class="n">linear_map</span><span class="bp">.</span><span class="n">pair</span>
    <span class="o">(</span><span class="n">linear_map</span><span class="bp">.</span><span class="n">copair</span> <span class="o">(</span><span class="n">f</span> <span class="n">n</span><span class="o">)</span> <span class="n">linear_map</span><span class="bp">.</span><span class="n">id</span><span class="o">)</span>
    <span class="o">(</span><span class="n">linear_map</span><span class="bp">.</span><span class="n">copair</span> <span class="n">linear_map</span><span class="bp">.</span><span class="n">id</span> <span class="o">(</span><span class="bp">-</span><span class="n">f</span> <span class="n">n</span><span class="o">))</span>
</pre></div>


<p>This definition needs an explicit <code>noncomputable</code> even though I have <code>noncomputable theory</code> at the top, is that supposed to happen?</p>

<a name="172315559"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172315559" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172315559">Chris Hughes (Aug 02 2019 at 15:00)</a>:</h4>
<p>Is noncomputable theory inside a section?</p>

<a name="172315569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172315569" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172315569">Rob Lewis (Aug 02 2019 at 15:00)</a>:</h4>
<p><code>noncomputable theory</code> doesn't always propogate to aux decls.</p>

<a name="172318371"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172318371" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172318371">Reid Barton (Aug 02 2019 at 15:32)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="c">/-</span><span class="cm">- The linear operator f_n corresponding to Huang&#39;s matrix A_n. -/</span>
<span class="n">noncomputable</span> <span class="n">def</span> <span class="n">f</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">n</span><span class="o">,</span> <span class="n">V</span> <span class="n">n</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">ℝ</span><span class="o">]</span> <span class="n">V</span> <span class="n">n</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span>
  <span class="n">linear_map</span><span class="bp">.</span><span class="n">pair</span>
    <span class="o">(</span><span class="n">linear_map</span><span class="bp">.</span><span class="n">copair</span> <span class="o">(</span><span class="n">f</span> <span class="n">n</span><span class="o">)</span> <span class="n">linear_map</span><span class="bp">.</span><span class="n">id</span><span class="o">)</span>
    <span class="o">(</span><span class="n">linear_map</span><span class="bp">.</span><span class="n">copair</span> <span class="n">linear_map</span><span class="bp">.</span><span class="n">id</span> <span class="o">(</span><span class="bp">-</span><span class="n">f</span> <span class="n">n</span><span class="o">))</span>

<span class="kn">lemma</span> <span class="n">f_squared</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">v</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="n">n</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="err">•</span> <span class="n">v</span> <span class="o">:=</span>
<span class="c1">-- The (n : ℝ) is necessary since `n • v` refers to the multiplication defined</span>
<span class="c1">-- using only the addition of V.</span>
<span class="k">begin</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">IH</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">v</span><span class="o">,</span> <span class="n">dunfold</span> <span class="n">f</span><span class="o">,</span> <span class="n">simp</span><span class="o">,</span> <span class="n">refl</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="bp">⟨</span><span class="n">v</span><span class="o">,</span> <span class="n">v&#39;</span><span class="bp">⟩</span><span class="o">,</span>
    <span class="n">ext</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">dunfold</span> <span class="n">f</span> <span class="n">V</span><span class="o">,</span>
      <span class="n">conv_rhs</span> <span class="o">{</span> <span class="n">change</span> <span class="o">((</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="err">•</span> <span class="n">v</span><span class="o">,</span> <span class="n">rw</span> <span class="n">add_smul</span> <span class="o">},</span>
      <span class="n">simp</span> <span class="o">[</span><span class="n">IH</span><span class="o">]</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">dunfold</span> <span class="n">f</span> <span class="n">V</span><span class="o">,</span>
      <span class="n">conv_rhs</span> <span class="o">{</span> <span class="n">change</span> <span class="o">((</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="err">•</span> <span class="n">v&#39;</span><span class="o">,</span> <span class="n">rw</span> <span class="n">add_smul</span> <span class="o">},</span>
      <span class="k">have</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">V</span> <span class="n">n</span><span class="o">),</span> <span class="bp">-</span><span class="n">x</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span> <span class="n">y</span> <span class="o">:=</span> <span class="k">by</span> <span class="o">{</span> <span class="n">intros</span><span class="o">,</span> <span class="n">abel</span> <span class="o">},</span> <span class="c1">-- ugh</span>
      <span class="n">simp</span> <span class="o">[</span><span class="n">IH</span><span class="o">,</span> <span class="n">this</span><span class="o">]</span> <span class="o">}</span> <span class="o">}</span>
<span class="kn">end</span>
</pre></div>

<a name="172318396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172318396" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172318396">Reid Barton (Aug 02 2019 at 15:32)</a>:</h4>
<p>Maybe I'll put up a repository under leanprover-community?</p>

<a name="172318813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172318813" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172318813">Rob Lewis (Aug 02 2019 at 15:37)</a>:</h4>
<p>This was weirdly hard to make it go through, I got caught on the <code>(n : R)</code> thing too for a bit.</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">fn2</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span> <span class="n">v</span><span class="o">,</span> <span class="n">f</span> <span class="n">n</span> <span class="o">(</span><span class="n">f</span> <span class="n">n</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="err">•</span> <span class="n">v</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="n">v</span> <span class="o">:=</span> <span class="k">by</span> <span class="o">{</span> <span class="n">rw</span> <span class="o">(</span><span class="k">show</span> <span class="n">f</span> <span class="mi">0</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span> <span class="k">from</span> <span class="n">rfl</span><span class="o">),</span> <span class="n">norm_cast</span><span class="o">,</span> <span class="n">simp</span><span class="o">,</span> <span class="n">refl</span> <span class="o">}</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">k</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="bp">⟨</span><span class="n">v1</span><span class="o">,</span> <span class="n">v2</span><span class="bp">⟩</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">f</span><span class="o">,</span> <span class="n">nat</span><span class="bp">.</span><span class="n">cast_add</span><span class="o">,</span> <span class="n">add_smul</span><span class="o">],</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">fn2</span><span class="o">],</span> <span class="n">rw</span> <span class="o">[</span><span class="n">add_comm</span><span class="o">],</span>
  <span class="n">convert</span> <span class="n">add_sub_cancel</span> <span class="bp">_</span> <span class="bp">_</span>
<span class="kn">end</span>
</pre></div>

<a name="172318902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172318902" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172318902">Reid Barton (Aug 02 2019 at 15:38)</a>:</h4>
<p>Okay, I made <a href="https://github.com/leanprover-community/lean-sensitivity" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity">https://github.com/leanprover-community/lean-sensitivity</a>. I don't know how the permissions work by default, but anyone who can add collaborators should feel free to do so.</p>

<a name="172319524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172319524" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172319524">Floris van Doorn (Aug 02 2019 at 15:46)</a>:</h4>
<p>My gut feeling says that defining <code>V n := (fin n -&gt; bool) -&gt; real</code> would be nicer to work with. Then <code>V</code> is defined directly instead of recursively. You can use the following to go between <code>fin n</code> and <code>fin (n+1)</code>:</p>
<div class="codehilite"><pre><span></span><span class="kn">universe</span> <span class="kn">variable</span> <span class="n">u</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span>
<span class="n">def</span> <span class="n">tail</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">fin</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">α</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">p</span> <span class="n">i</span><span class="bp">.</span><span class="n">succ</span>
<span class="n">def</span> <span class="n">cons</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">fin</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="n">α</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="n">fin</span><span class="bp">.</span><span class="n">cases</span> <span class="n">x</span> <span class="n">v</span> <span class="n">j</span>
</pre></div>

<a name="172319871"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172319871" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172319871">Reid Barton (Aug 02 2019 at 15:51)</a>:</h4>
<p>I thought defining <code>V</code> recursively would be more convenient for defining and proving things about <code>f</code> and <code>g</code>--and it seems pretty convenient so far. I was thinking of defining the hypercube as <code>fin n -&gt; bool</code> though (in part because it seems a bit cheating to define it recursively).</p>

<a name="172319978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172319978" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172319978">Rob Lewis (Aug 02 2019 at 15:52)</a>:</h4>
<p>I've started with the hypercube as <code>fin n -&gt; bool</code> but I'm not sure about the cleanest way to define the basis of <code>e_p</code>s.</p>

<a name="172319996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172319996" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172319996">Floris van Doorn (Aug 02 2019 at 15:53)</a>:</h4>
<p>Ok. Maybe that's right. Why do you say it feels like cheating?</p>

<a name="172320024"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320024" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320024">Johan Commelin (Aug 02 2019 at 15:53)</a>:</h4>
<blockquote>
<p>I thought defining <code>V</code> recursively would be more convenient for defining and proving things about <code>f</code> and <code>g</code>--and it seems pretty convenient so far. I was thinking of defining the hypercube as <code>fin n -&gt; bool</code> though (in part because it seems a bit cheating to define it recursively).</p>
</blockquote>
<p>Why would that be cheating?</p>

<a name="172320047"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320047" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320047">Johan Commelin (Aug 02 2019 at 15:54)</a>:</h4>
<blockquote>
<p>I've started with the hypercube as <code>fin n -&gt; bool</code> but I'm not sure about the cleanest way to define the basis of <code>e_p</code>s.</p>
</blockquote>
<p>Dual basis is in mathlib</p>

<a name="172320151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320151" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320151">Reid Barton (Aug 02 2019 at 15:55)</a>:</h4>
<p>Well just because it's part of the "interface" of the overall theorem and <code>fin n -&gt; bool</code> feels a bit more canonical. For example if the hypercube is defined recursively then it's not obvious how to construct the action of the symmetric group.</p>

<a name="172320156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320156" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320156">Floris van Doorn (Aug 02 2019 at 15:55)</a>:</h4>
<p>Isn't the basis <code>e</code> just</p>
<div class="codehilite"><pre><span></span>def V (n : ℕ) : Type := (fin n → bool) → ℝ
def e (p : fin n → bool) : V n := λ q, if q = p then 1 else 0
</pre></div>

<a name="172320160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320160" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320160">Reid Barton (Aug 02 2019 at 15:55)</a>:</h4>
<p>I agree it's not cheating by much.</p>

<a name="172320253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320253" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320253">Johan Commelin (Aug 02 2019 at 15:57)</a>:</h4>
<p><span class="user-mention" data-user-id="111080">@Floris van Doorn</span> But you changed the definition of <code>V</code></p>

<a name="172320331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320331" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320331">Reid Barton (Aug 02 2019 at 15:58)</a>:</h4>
<p>If you assume that the hypercube must be represented by <code>fin n -&gt; bool</code>, then at some point you have to make a recursive decomposition of building something for n+1 out of two somethings for n. I suggest doing that when we define the basis <code>e</code></p>

<a name="172320344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320344" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320344">Reid Barton (Aug 02 2019 at 15:58)</a>:</h4>
<p>Which is I think what Rob was going to do</p>

<a name="172320347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320347" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320347">Floris van Doorn (Aug 02 2019 at 15:58)</a>:</h4>
<p>I was responding to Rob, who said (as I understood it) that he was interested in the basis using this definition of <code>V</code></p>

<a name="172320408"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320408" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320408">Reid Barton (Aug 02 2019 at 15:59)</a>:</h4>
<p>Probably it doesn't matter very much where you do it</p>

<a name="172320501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320501" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320501">Johan Commelin (Aug 02 2019 at 16:00)</a>:</h4>
<p>Do we want to define <code>e</code> directly?</p>

<a name="172320506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320506" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320506">Johan Commelin (Aug 02 2019 at 16:00)</a>:</h4>
<p>I don't really care.</p>

<a name="172320520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320520" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320520">Johan Commelin (Aug 02 2019 at 16:00)</a>:</h4>
<p>I just thought that we would first define the basis for <code>V</code>.</p>

<a name="172320529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320529" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320529">Reid Barton (Aug 02 2019 at 16:01)</a>:</h4>
<p>So something like <code>e (n+1) p := if p 0 then prod.inr (e n p.tail) else prod.inl (e n p.tail)</code></p>

<a name="172320544"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320544" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320544">Rob Lewis (Aug 02 2019 at 16:01)</a>:</h4>
<p><span class="user-mention" data-user-id="111080">@Floris van Doorn</span> That looks way cleaner than what I was doing, I was using the other definition of <code>V</code> though.</p>

<a name="172320571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320571" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320571">Rob Lewis (Aug 02 2019 at 16:01)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">e</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">,</span> <span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">V</span> <span class="n">n</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="n">p</span> <span class="o">:=</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">k</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="n">p</span> <span class="o">:=</span>
  <span class="k">match</span> <span class="n">p</span> <span class="mi">0</span> <span class="k">with</span>
  <span class="bp">|</span> <span class="n">tt</span> <span class="o">:=</span> <span class="o">(</span><span class="n">e</span> <span class="n">k</span> <span class="o">(</span><span class="n">drop</span> <span class="n">p</span><span class="o">),</span> <span class="mi">0</span><span class="o">)</span>
  <span class="bp">|</span> <span class="n">ff</span> <span class="o">:=</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">e</span> <span class="n">k</span> <span class="o">(</span><span class="n">drop</span> <span class="n">p</span><span class="o">))</span>
  <span class="kn">end</span>
</pre></div>


<p>or something like that, I don't think it's gonna be convenient.</p>

<a name="172320585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320585" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320585">Floris van Doorn (Aug 02 2019 at 16:01)</a>:</h4>
<p>The recursive decomposition is easy:</p>
<div class="codehilite"><pre><span></span>def tail (p : fin (n+1) → α) : fin n → α := λ i, p i.succ
def tuple (x : α) (v : α → (fin n → α) → β) : (fin (n+1) → α) → β :=
λ p, v (p 0) (tail p)
</pre></div>


<p>So if you have an element of <code>bool -&gt; V n</code> you get an element of <code>V (n+1)</code></p>

<a name="172320742"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320742" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320742">Reid Barton (Aug 02 2019 at 16:04)</a>:</h4>
<p>I'm just worried that you will end up with only a linear isomorphism (not a definitional equality) between <code>V (n+1)</code> and <code>bool -&gt; V n</code> or <code>V n x V n</code> and that will make the computations involving <code>f</code> and <code>g</code> a lot more involved unless you can manage to cancel the isomorphisms automatically</p>

<a name="172320805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320805" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320805">Floris van Doorn (Aug 02 2019 at 16:05)</a>:</h4>
<p>Ok, that might be a problem if we have to translate a lot between these two representations. I think it will be doable though.</p>

<a name="172320828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320828" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320828">Floris van Doorn (Aug 02 2019 at 16:06)</a>:</h4>
<p>but maybe in that aspect the recursive definition is easier.</p>

<a name="172320877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320877" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320877">Johan Commelin (Aug 02 2019 at 16:06)</a>:</h4>
<p>How about</p>
<div class="codehilite"><pre><span></span><span class="c">/-</span><span class="cm">- The hypercube.-/</span>
<span class="n">def</span> <span class="n">Q</span> <span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">:=</span> <span class="n">fin</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">bool</span>

<span class="c">/-</span><span class="cm">- The basis of V indexed by the hypercube.-/</span>
<span class="n">def</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">n</span><span class="o">,</span> <span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">V</span> <span class="n">n</span>
<span class="bp">|</span> <span class="mi">0</span>     <span class="o">:=</span> <span class="bp">λ</span> <span class="bp">_</span><span class="o">,</span> <span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">v</span><span class="o">,</span> <span class="k">if</span> <span class="n">v</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">tt</span>
           <span class="k">then</span> <span class="o">(</span><span class="n">b</span> <span class="n">n</span> <span class="o">(</span><span class="n">v</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">),</span> <span class="mi">0</span><span class="o">)</span>
           <span class="k">else</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">b</span> <span class="n">n</span> <span class="o">(</span><span class="n">v</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">))</span>
</pre></div>

<a name="172320909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172320909" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172320909">Reid Barton (Aug 02 2019 at 16:07)</a>:</h4>
<p>The alternative is to write down the basis and probably also the dual basis separately by this kind of recursive formula and then check that the dual basis is really dual and also the formula for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ε</mi><mi>q</mi></msub><mo stretchy="false">(</mo><msub><mi>f</mi><mi>n</mi></msub><msub><mi>e</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\varepsilon_q (f_n e_p)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, by induction</p>

<a name="172321073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172321073" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172321073">Rob Lewis (Aug 02 2019 at 16:09)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> That's probably slightly more convenient than the match, yeah.</p>

<a name="172321268"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172321268" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172321268">Johan Commelin (Aug 02 2019 at 16:12)</a>:</h4>
<p>Ok, but now we need to prove that this is a basis...</p>

<a name="172321302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172321302" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172321302">Johan Commelin (Aug 02 2019 at 16:12)</a>:</h4>
<p>It should suffice to prove linear independence</p>

<a name="172321332"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172321332" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172321332">Reid Barton (Aug 02 2019 at 16:13)</a>:</h4>
<p>something like</p>
<div class="codehilite"><pre><span></span><span class="n">noncomputable</span> <span class="n">def</span> <span class="n">ε</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">fin</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">bool</span><span class="o">),</span> <span class="n">V</span> <span class="n">n</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">ℝ</span><span class="o">]</span> <span class="n">ℝ</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="bp">_</span> <span class="o">:=</span> <span class="n">linear_map</span><span class="bp">.</span><span class="n">id</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="n">p</span> <span class="o">:=</span>
  <span class="k">match</span> <span class="n">p</span> <span class="mi">0</span> <span class="k">with</span>
  <span class="bp">|</span> <span class="n">ff</span> <span class="o">:=</span> <span class="o">(</span><span class="n">ε</span> <span class="o">(</span><span class="n">p</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">))</span><span class="bp">.</span><span class="n">comp</span> <span class="o">(</span><span class="n">linear_map</span><span class="bp">.</span><span class="n">fst</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span>
  <span class="bp">|</span> <span class="n">tt</span> <span class="o">:=</span> <span class="o">(</span><span class="n">ε</span> <span class="o">(</span><span class="n">p</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">))</span><span class="bp">.</span><span class="n">comp</span> <span class="o">(</span><span class="n">linear_map</span><span class="bp">.</span><span class="n">snd</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span>
  <span class="kn">end</span>
</pre></div>

<a name="172321336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172321336" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172321336">Reid Barton (Aug 02 2019 at 16:13)</a>:</h4>
<blockquote>
<p>Ok, but now we need to prove that this is a basis...</p>
</blockquote>
<p>Yeah that's true</p>

<a name="172321407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172321407" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172321407">Johan Commelin (Aug 02 2019 at 16:14)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span> Is there a reason you don't want to use mathlibs dual basis?</p>

<a name="172321424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172321424" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172321424">Reid Barton (Aug 02 2019 at 16:14)</a>:</h4>
<p>I fear you might get stuck when you need to calculate the matrix entries but I don't really know</p>

<a name="172321464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172321464" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172321464">Reid Barton (Aug 02 2019 at 16:15)</a>:</h4>
<p>because you won't have a formula for the dual basis like the one above</p>

<a name="172321548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172321548" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172321548">Reid Barton (Aug 02 2019 at 16:16)</a>:</h4>
<p>Unless there are already theorems that say if we have bases of V and W, then we get a basis of V x W and the formula for the dual basis is the expected one</p>

<a name="172321589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172321589" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172321589">Johan Commelin (Aug 02 2019 at 16:17)</a>:</h4>
<p>Aha, but wouldn't it be better/easier to prove those formulas?</p>

<a name="172321620"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172321620" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172321620">Johan Commelin (Aug 02 2019 at 16:17)</a>:</h4>
<p>Because otherwise you have to reprove that this thing is actually a dual basis.</p>

<a name="172321690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172321690" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172321690">Reid Barton (Aug 02 2019 at 16:18)</a>:</h4>
<p>I guess we must already have a theorem about a basis of V x W so that we can compute its dimension</p>

<a name="172321725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172321725" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172321725">Reid Barton (Aug 02 2019 at 16:18)</a>:</h4>
<p>You mean we should prove a mathlib theorem about the dual basis of V x W that comes from bases of V and W?</p>

<a name="172321826"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172321826" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172321826">Reid Barton (Aug 02 2019 at 16:20)</a>:</h4>
<p>I haven't seen the dual basis stuff in mathlib at all yet, let me take a look.</p>

<a name="172321990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172321990" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172321990">Reid Barton (Aug 02 2019 at 16:23)</a>:</h4>
<p>So, there is</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">is_basis_inl_union_inr</span> <span class="o">{</span><span class="n">v</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">{</span><span class="n">v&#39;</span> <span class="o">:</span> <span class="n">ι&#39;</span> <span class="bp">→</span> <span class="n">γ</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hv</span> <span class="o">:</span> <span class="n">is_basis</span> <span class="n">α</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="n">hv&#39;</span> <span class="o">:</span> <span class="n">is_basis</span> <span class="n">α</span> <span class="n">v&#39;</span><span class="o">)</span> <span class="o">:</span> <span class="n">is_basis</span> <span class="n">α</span> <span class="o">(</span><span class="n">sum</span><span class="bp">.</span><span class="n">elim</span> <span class="o">(</span><span class="n">inl</span> <span class="n">α</span> <span class="n">β</span> <span class="n">γ</span> <span class="err">∘</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="n">inr</span> <span class="n">α</span> <span class="n">β</span> <span class="n">γ</span> <span class="err">∘</span> <span class="n">v&#39;</span><span class="o">))</span> <span class="o">:=</span>
</pre></div>

<a name="172322011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172322011" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172322011">Johan Commelin (Aug 02 2019 at 16:23)</a>:</h4>
<p>Also, more trivialities:</p>
<div class="codehilite"><pre><span></span><span class="c">/-</span><span class="cm">- The hypercube.-/</span>
<span class="n">def</span> <span class="n">Q</span> <span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">:=</span> <span class="n">fin</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">bool</span>

<span class="kn">instance</span> <span class="n">Q</span><span class="bp">.</span><span class="n">fintype</span> <span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">fintype</span> <span class="o">(</span><span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">delta</span> <span class="n">Q</span><span class="bp">;</span> <span class="n">apply_instance</span>

<span class="n">def</span> <span class="n">Q</span><span class="bp">.</span><span class="n">card</span> <span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">fintype</span><span class="bp">.</span><span class="n">card</span> <span class="o">(</span><span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">2</span><span class="err">^</span><span class="n">n</span> <span class="o">:=</span>
<span class="k">calc</span> <span class="bp">_</span> <span class="bp">=</span> <span class="bp">_</span> <span class="o">:</span> <span class="n">fintype</span><span class="bp">.</span><span class="n">card_fun</span>
   <span class="bp">...</span> <span class="bp">=</span> <span class="bp">_</span> <span class="o">:</span> <span class="k">by</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">fintype</span><span class="bp">.</span><span class="n">card_fin</span><span class="o">,</span> <span class="n">fintype</span><span class="bp">.</span><span class="n">card_bool</span><span class="o">]</span>
</pre></div>

<a name="172322081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172322081" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172322081">Johan Commelin (Aug 02 2019 at 16:24)</a>:</h4>
<p>Ooh, that def should be a simp-lemma</p>

<a name="172322172"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172322172" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172322172">Reid Barton (Aug 02 2019 at 16:25)</a>:</h4>
<p>Maybe the right way to do all this is to just define the hypercube recursively after all, and then tack a translation onto <code>fin n -&gt; bool</code> at the end if we want to.</p>

<a name="172322233"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172322233" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172322233">Reid Barton (Aug 02 2019 at 16:26)</a>:</h4>
<p>Then we can use that <code>is_basis_inl_union_inr</code> and add a formula to <code>linear_algebra.dual</code> about its dual basis</p>

<a name="172322308"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172322308" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172322308">Reid Barton (Aug 02 2019 at 16:27)</a>:</h4>
<p><code>Q (n+1) := Q n ⊕ Q n</code> and whatever definition of "adjacent" is the most convenient</p>

<a name="172322358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172322358" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172322358">Johan Commelin (Aug 02 2019 at 16:28)</a>:</h4>
<p>Or should we just prove that <code>Q n →₀ ℝ</code> is linearly equivelent to <code>V n</code>?</p>

<a name="172322400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172322400" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172322400">Johan Commelin (Aug 02 2019 at 16:28)</a>:</h4>
<p>Or maybe we should redefine <code>V n</code> to be that space?</p>

<a name="172322417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172322417" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172322417">Reid Barton (Aug 02 2019 at 16:29)</a>:</h4>
<blockquote>
<p>Or should we just prove that <code>Q n →₀ ℝ</code> is linearly equivelent to <code>V n</code>?</p>
</blockquote>
<p>This one sounds good</p>

<a name="172322688"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172322688" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172322688">Reid Barton (Aug 02 2019 at 16:32)</a>:</h4>
<p>Maybe by first providing <code>Q (n+1) ≃ Q n ⊕ Q n</code></p>

<a name="172323009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172323009" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172323009">Johan Commelin (Aug 02 2019 at 16:36)</a>:</h4>
<p>Aha, that also sounds like a good idea. And then use <code>is_basis.comp</code>?</p>

<a name="172323100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172323100" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172323100">Johan Commelin (Aug 02 2019 at 16:38)</a>:</h4>
<p>Need to feed some kids <span aria-label="children crossing" class="emoji emoji-1f6b8" role="img" title="children crossing">:children_crossing:</span> brb</p>

<a name="172324222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172324222" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172324222">Johan Commelin (Aug 02 2019 at 16:54)</a>:</h4>
<p>Huh, there is no <code>has_xor</code> typeclass??</p>

<a name="172327065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172327065" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172327065">Johan Commelin (Aug 02 2019 at 17:32)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">namespace</span> <span class="n">Q</span>
<span class="kn">variable</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">fintype</span> <span class="o">(</span><span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">delta</span> <span class="n">Q</span><span class="bp">;</span> <span class="n">apply_instance</span>

<span class="kn">variable</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span>

<span class="n">def</span> <span class="n">xor</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">bxor</span> <span class="o">(</span><span class="n">x</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">y</span> <span class="n">i</span><span class="o">)</span>

<span class="bp">@</span><span class="o">[</span><span class="n">symm</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">xor_comm</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span><span class="bp">.</span><span class="n">xor</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">y</span><span class="bp">.</span><span class="n">xor</span> <span class="n">x</span> <span class="o">:=</span>
<span class="n">funext</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">bool</span><span class="bp">.</span><span class="n">bxor_comm</span> <span class="bp">_</span> <span class="bp">_</span>

<span class="c">/-</span><span class="cm">- The distance between two vertices of the hypercube.-/</span>
<span class="n">def</span> <span class="n">dist</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">finset</span><span class="bp">.</span><span class="n">univ</span> <span class="o">:</span> <span class="n">finset</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">))</span><span class="bp">.</span><span class="n">sum</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">cond</span> <span class="o">(</span><span class="n">x</span><span class="bp">.</span><span class="n">xor</span> <span class="n">y</span> <span class="n">i</span><span class="o">)</span> <span class="mi">1</span>  <span class="mi">0</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">dist_self</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span><span class="bp">.</span><span class="n">dist</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="n">finset</span><span class="bp">.</span><span class="n">sum_eq_zero</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">i</span> <span class="n">hi</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">xor</span><span class="o">,</span> <span class="n">bxor_self</span><span class="o">,</span> <span class="n">bool</span><span class="bp">.</span><span class="n">cond_ff</span><span class="o">]</span>

<span class="bp">@</span><span class="o">[</span><span class="n">symm</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">dist_symm</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span><span class="bp">.</span><span class="n">dist</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">y</span><span class="bp">.</span><span class="n">dist</span> <span class="n">x</span> <span class="o">:=</span>
<span class="n">congr_arg</span> <span class="o">((</span><span class="n">finset</span><span class="bp">.</span><span class="n">univ</span> <span class="o">:</span> <span class="n">finset</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">))</span><span class="bp">.</span><span class="n">sum</span><span class="o">)</span> <span class="err">$</span>
<span class="k">by</span> <span class="o">{</span> <span class="n">funext</span> <span class="n">i</span><span class="o">,</span> <span class="n">simp</span> <span class="o">[</span><span class="n">xor_comm</span><span class="o">]</span> <span class="o">}</span>

<span class="c">/-</span><span class="cm">- Two vertices of the hypercube are adjacent if their distance is 1.-/</span>
<span class="n">def</span> <span class="n">adjacent</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="n">x</span><span class="bp">.</span><span class="n">dist</span> <span class="n">y</span> <span class="bp">=</span> <span class="mi">1</span>

<span class="c">/-</span><span class="cm">- The set of n-/</span>
<span class="n">def</span> <span class="n">neighbours</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="o">{</span><span class="n">y</span> <span class="bp">|</span> <span class="n">x</span><span class="bp">.</span><span class="n">adjacent</span> <span class="n">y</span><span class="o">}</span>

<span class="kn">variable</span> <span class="o">(</span><span class="n">n</span><span class="o">)</span>

<span class="c">/-</span><span class="cm">- The cardinality of the hypercube.-/</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">card</span> <span class="o">:</span> <span class="n">fintype</span><span class="bp">.</span><span class="n">card</span> <span class="o">(</span><span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">2</span><span class="err">^</span><span class="n">n</span> <span class="o">:=</span>
<span class="k">calc</span> <span class="bp">_</span> <span class="bp">=</span> <span class="bp">_</span> <span class="o">:</span> <span class="n">fintype</span><span class="bp">.</span><span class="n">card_fun</span>
   <span class="bp">...</span> <span class="bp">=</span> <span class="bp">_</span> <span class="o">:</span> <span class="k">by</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">fintype</span><span class="bp">.</span><span class="n">card_fin</span><span class="o">,</span> <span class="n">fintype</span><span class="bp">.</span><span class="n">card_bool</span><span class="o">]</span>

<span class="kn">theorem</span> <span class="n">sensitivity</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">Q</span> <span class="n">n</span><span class="o">))</span> <span class="o">(</span><span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">H</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">fintype</span><span class="bp">.</span><span class="n">card</span> <span class="o">(</span><span class="n">H</span> <span class="err">∩</span> <span class="o">(</span><span class="n">neighbours</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">Q</span> <span class="n">n</span><span class="o">))</span> <span class="o">:=</span>
<span class="n">sorry</span>

<span class="kn">end</span> <span class="n">Q</span>
</pre></div>


<p>Lean isn't yet happy with the theorem statement</p>

<a name="172328677"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172328677" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172328677">Johan Commelin (Aug 02 2019 at 17:54)</a>:</h4>
<p>Voila: that's a statement that Lean likes:</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">sensitivity</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">finset</span> <span class="o">(</span><span class="n">Q</span> <span class="n">n</span><span class="o">))</span> <span class="o">(</span><span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">H</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="n">n</span> <span class="bp">≤</span> <span class="o">(</span><span class="n">H</span><span class="bp">.</span><span class="n">filter</span> <span class="o">(</span><span class="n">neighbours</span> <span class="n">x</span><span class="o">))</span><span class="bp">.</span><span class="n">card</span> <span class="o">:=</span>
<span class="n">sorry</span>
</pre></div>

<a name="172331229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172331229" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172331229">Patrick Massot (Aug 02 2019 at 18:28)</a>:</h4>
<p>Hi everybody. I'd like to play this game too. Can we somehow distribute efforts? Where are you now?</p>

<a name="172331694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172331694" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172331694">Reid Barton (Aug 02 2019 at 18:34)</a>:</h4>
<p>Hi Patrick! I just got back to this, currently trying to add a recursive definition of the hypercube and associated basis.</p>

<a name="172331720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172331720" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172331720">Reid Barton (Aug 02 2019 at 18:35)</a>:</h4>
<p>After that, I think there are some independent pieces to do</p>

<a name="172331754"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172331754" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172331754">Patrick Massot (Aug 02 2019 at 18:35)</a>:</h4>
<p>Do you think you could push something and give me lemmas to prove?</p>

<a name="172331792"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172331792" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172331792">Johan Commelin (Aug 02 2019 at 18:36)</a>:</h4>
<p>This is what I have now:</p>
<div class="codehilite"><pre><span></span><span class="c">/-</span><span class="cm">- The cardinality of the hypercube.-/</span>
<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">card</span> <span class="o">:</span> <span class="n">fintype</span><span class="bp">.</span><span class="n">card</span> <span class="o">(</span><span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">2</span><span class="err">^</span><span class="n">n</span> <span class="o">:=</span>
<span class="k">calc</span> <span class="bp">_</span> <span class="bp">=</span> <span class="bp">_</span> <span class="o">:</span> <span class="n">fintype</span><span class="bp">.</span><span class="n">card_fun</span>
   <span class="bp">...</span> <span class="bp">=</span> <span class="bp">_</span> <span class="o">:</span> <span class="k">by</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">fintype</span><span class="bp">.</span><span class="n">card_fin</span><span class="o">,</span> <span class="n">fintype</span><span class="bp">.</span><span class="n">card_bool</span><span class="o">]</span>

<span class="n">def</span> <span class="n">equiv_sum</span> <span class="o">:</span> <span class="n">Q</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="err">≃</span> <span class="n">Q</span> <span class="n">n</span> <span class="err">⊕</span> <span class="n">Q</span> <span class="n">n</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">cond</span> <span class="o">(</span><span class="n">x</span> <span class="mi">0</span><span class="o">)</span>
                   <span class="o">(</span><span class="n">sum</span><span class="bp">.</span><span class="n">inl</span> <span class="o">(</span><span class="n">x</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">))</span>
                   <span class="o">(</span><span class="n">sum</span><span class="bp">.</span><span class="n">inr</span> <span class="o">(</span><span class="n">x</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">)),</span>
  <span class="n">inv_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">sum</span><span class="bp">.</span><span class="n">rec_on</span> <span class="n">x</span>
                   <span class="o">(</span><span class="bp">λ</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span> <span class="k">if</span> <span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">0</span> <span class="k">then</span> <span class="n">tt</span> <span class="k">else</span> <span class="n">y</span> <span class="o">(</span><span class="n">i</span><span class="bp">.</span><span class="n">pred</span> <span class="n">h</span><span class="o">))</span>
                   <span class="o">(</span><span class="bp">λ</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span> <span class="k">if</span> <span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">0</span> <span class="k">then</span> <span class="n">ff</span> <span class="k">else</span> <span class="n">y</span> <span class="o">(</span><span class="n">i</span><span class="bp">.</span><span class="n">pred</span> <span class="n">h</span><span class="o">)),</span>
  <span class="n">left_inv</span> <span class="o">:=</span>
  <span class="k">begin</span>
    <span class="n">intro</span> <span class="n">x</span><span class="o">,</span> <span class="n">dsimp</span> <span class="n">only</span><span class="o">,</span> <span class="n">cases</span> <span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="mi">0</span><span class="bp">;</span>
    <span class="o">{</span> <span class="n">funext</span> <span class="n">i</span><span class="o">,</span> <span class="n">dsimp</span> <span class="n">only</span> <span class="o">[</span><span class="n">bool</span><span class="bp">.</span><span class="n">cond_tt</span><span class="o">,</span> <span class="n">bool</span><span class="bp">.</span><span class="n">cond_ff</span><span class="o">],</span> <span class="n">split_ifs</span> <span class="k">with</span> <span class="n">H</span><span class="o">,</span>
      <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">H</span><span class="o">,</span> <span class="n">h</span><span class="o">]</span> <span class="o">},</span>
      <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">function</span><span class="bp">.</span><span class="n">comp_app</span><span class="o">,</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ_pred</span><span class="o">]</span> <span class="o">}</span> <span class="o">}</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="n">right_inv</span> <span class="o">:=</span>
  <span class="k">begin</span>

  <span class="kn">end</span> <span class="o">}</span>
</pre></div>

<a name="172331838"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172331838" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172331838">Patrick Massot (Aug 02 2019 at 18:36)</a>:</h4>
<p>Johan, which definition of Q n is this using?</p>

<a name="172331844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172331844" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172331844">Patrick Massot (Aug 02 2019 at 18:36)</a>:</h4>
<p>Did you agree on the definitions of Q n and V n?</p>

<a name="172331916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172331916" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172331916">Reid Barton (Aug 02 2019 at 18:37)</a>:</h4>
<p>Maybe I will just push something using a lot of <code>constant</code> and <code>axiom</code> as a starting point</p>

<a name="172332039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172332039" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172332039">Reid Barton (Aug 02 2019 at 18:38)</a>:</h4>
<p>then perhaps we can distribute the representation decisions</p>

<a name="172332080"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172332080" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172332080">Patrick Massot (Aug 02 2019 at 18:39)</a>:</h4>
<p>It seems hard to decide independently the representations of V n and Q n</p>

<a name="172332304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172332304" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172332304">Johan Commelin (Aug 02 2019 at 18:42)</a>:</h4>
<p>This is with <code>Q n := fin n → bool</code></p>

<a name="172332375"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172332375" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172332375">Reid Barton (Aug 02 2019 at 18:43)</a>:</h4>
<p>I think <a href="https://github.com/leanprover-community/lean-sensitivity/commit/c2d0b69cbe175f3125c2719f3b87f2f6f626f424" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/commit/c2d0b69cbe175f3125c2719f3b87f2f6f626f424">https://github.com/leanprover-community/lean-sensitivity/commit/c2d0b69cbe175f3125c2719f3b87f2f6f626f424</a> is enough to make the rest of the proof go through</p>

<a name="172332435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172332435" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172332435">Reid Barton (Aug 02 2019 at 18:44)</a>:</h4>
<p>Except with a correct statement of <code>f_matrix_nonadjacent</code></p>

<a name="172332888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172332888" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172332888">Johan Commelin (Aug 02 2019 at 18:49)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span> <span class="user-mention" data-user-id="110031">@Patrick Massot</span> Shall I fill in the <code>Q</code> and <code>adjacent</code> constants?</p>

<a name="172332947"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172332947" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172332947">Reid Barton (Aug 02 2019 at 18:50)</a>:</h4>
<p>Feel free, I'm going to try to continue to sketch out the rest of the proof</p>

<a name="172333026"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172333026" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172333026">Johan Commelin (Aug 02 2019 at 18:51)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> <span class="user-mention" data-user-id="111080">@Floris van Doorn</span> I've given you write permissions on the repo</p>

<a name="172333321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172333321" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172333321">Patrick Massot (Aug 02 2019 at 18:55)</a>:</h4>
<p>thanks!</p>

<a name="172333547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172333547" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172333547">Patrick Massot (Aug 02 2019 at 18:58)</a>:</h4>
<p>Reid I see you defined epsilon as the dual basis, but I liked the recursive definition</p>

<a name="172333590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172333590" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172333590">Patrick Massot (Aug 02 2019 at 18:59)</a>:</h4>
<p>I'd like to work on the fact about |epsilon_q f_n e_p|</p>

<a name="172333610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172333610" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172333610">Rob Lewis (Aug 02 2019 at 18:59)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> mind giving me access too? I was looking at this for a bit before dinner, might try to do a bit more.</p>

<a name="172333618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172333618" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172333618">Johan Commelin (Aug 02 2019 at 18:59)</a>:</h4>
<p>Sure!</p>

<a name="172333627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172333627" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172333627">Reid Barton (Aug 02 2019 at 19:00)</a>:</h4>
<p>I was intending that we'd add a lemma to mathlib that says that the dual basis element on <code>inl i</code> is given by projecting to the first factor, then applying the dual basis of the original basis</p>

<a name="172333699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172333699" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172333699">Johan Commelin (Aug 02 2019 at 19:00)</a>:</h4>
<p>With this definition:</p>
<div class="codehilite"><pre><span></span><span class="c">/-</span><span class="cm">- The basis of V indexed by the hypercube.-/</span>
<span class="n">def</span> <span class="n">e</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">n</span><span class="o">,</span> <span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">V</span> <span class="n">n</span>
<span class="bp">|</span> <span class="mi">0</span>     <span class="o">:=</span> <span class="bp">λ</span> <span class="bp">_</span><span class="o">,</span> <span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">v</span><span class="o">,</span> <span class="n">cond</span> <span class="o">(</span><span class="n">v</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="n">n</span> <span class="o">(</span><span class="n">v</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">),</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">e</span> <span class="n">n</span> <span class="o">(</span><span class="n">v</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">))</span>
</pre></div>


<p>I can't make <code>{n}</code> implicit...</p>

<a name="172333749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172333749" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172333749">Johan Commelin (Aug 02 2019 at 19:01)</a>:</h4>
<p><span class="user-mention" data-user-id="110596">@Rob Lewis</span> Done, although I guess you also have admin rights by default...</p>

<a name="172333760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172333760" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172333760">Johan Commelin (Aug 02 2019 at 19:01)</a>:</h4>
<p>Since you are admin of leanprover-community, right?</p>

<a name="172333846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172333846" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172333846">Reid Barton (Aug 02 2019 at 19:02)</a>:</h4>
<p>Gah, I keep running into "maximum class-instance resolution depth has been reached" issues, I think they are related to <code>decidable_eq</code> somehow...</p>

<a name="172333864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172333864" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172333864">Rob Lewis (Aug 02 2019 at 19:02)</a>:</h4>
<p>Oh, maybe. But thanks anyway!</p>

<a name="172334034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172334034" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172334034">Rob Lewis (Aug 02 2019 at 19:05)</a>:</h4>
<blockquote>
<p>I can't make <code>{n}</code> implicit...</p>
</blockquote>
<p>Why not? </p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">e</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">n</span><span class="o">},</span> <span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">V</span> <span class="n">n</span>
<span class="bp">|</span> <span class="mi">0</span>     <span class="o">:=</span> <span class="bp">λ</span> <span class="bp">_</span><span class="o">,</span> <span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">v</span><span class="o">,</span> <span class="n">cond</span> <span class="o">(</span><span class="n">v</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">(</span><span class="n">v</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">),</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">e</span> <span class="o">(</span><span class="n">v</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">))</span>
</pre></div>

<a name="172334052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172334052" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172334052">Reid Barton (Aug 02 2019 at 19:05)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> That proof will depend on the definition of <code>Q</code> and <code>e</code>, though</p>

<a name="172334182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172334182" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172334182">Reid Barton (Aug 02 2019 at 19:07)</a>:</h4>
<p>I pushed another commit about <code>g</code></p>

<a name="172334229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172334229" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172334229">Patrick Massot (Aug 02 2019 at 19:07)</a>:</h4>
<p>I'm using the definition of e that Rob just pasted</p>

<a name="172334284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172334284" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172334284">Patrick Massot (Aug 02 2019 at 19:08)</a>:</h4>
<p>(which I indeed modified from Johan's message)</p>

<a name="172334489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172334489" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172334489">Jesse Michael Han (Aug 02 2019 at 19:11)</a>:</h4>
<p>i'm also happy to contribute</p>
<p>what needs to be done besides the two <code>sorry</code>s Reid just pushed?</p>

<a name="172334511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172334511" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172334511">Reid Barton (Aug 02 2019 at 19:11)</a>:</h4>
<p>Oh dang, <code>H</code> is not a great name</p>

<a name="172334652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172334652" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172334652">Reid Barton (Aug 02 2019 at 19:13)</a>:</h4>
<p><span class="user-mention" data-user-id="116045">@Jesse Michael Han</span> I'll be pushing a couple more <code>sorry</code>s soon to complete the proof outline</p>

<a name="172334939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172334939" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172334939">Johan Commelin (Aug 02 2019 at 19:17)</a>:</h4>
<p>I'm inductively proving that <code>e</code> is a basis.</p>

<a name="172335014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172335014" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172335014">Johan Commelin (Aug 02 2019 at 19:18)</a>:</h4>
<p>See the <code>jmc</code> branch</p>

<a name="172335308"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172335308" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172335308">Patrick Massot (Aug 02 2019 at 19:22)</a>:</h4>
<p>As I wrote earlier, I'm inductively calculating epsilon q e p</p>

<a name="172335317"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172335317" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172335317">Patrick Massot (Aug 02 2019 at 19:22)</a>:</h4>
<p>I guess it should prove that e is a basis right?</p>

<a name="172335401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172335401" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172335401">Reid Barton (Aug 02 2019 at 19:24)</a>:</h4>
<blockquote>
<p>Lean isn't yet happy with the theorem statement</p>
</blockquote>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> were you having trouble with type classes?</p>

<a name="172335429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172335429" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172335429">Johan Commelin (Aug 02 2019 at 19:24)</a>:</h4>
<p>Well, sets weren't finsets and such</p>

<a name="172335434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172335434" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172335434">Johan Commelin (Aug 02 2019 at 19:25)</a>:</h4>
<p>There is a working statement on the <code>jmc</code> branch</p>

<a name="172335445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172335445" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172335445">Johan Commelin (Aug 02 2019 at 19:25)</a>:</h4>
<p>I'm almost done with the proof that <code>e</code> is a basis</p>

<a name="172335641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172335641" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172335641">Reid Barton (Aug 02 2019 at 19:28)</a>:</h4>
<p>Okay, I pushed a couple more bits (theorem statement adapted from your Johan--but it should be an exists)</p>

<a name="172335705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172335705" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172335705">Reid Barton (Aug 02 2019 at 19:29)</a>:</h4>
<p>Not sure if the next-to-last statement is phrased optimally</p>

<a name="172336115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172336115" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172336115">Patrick Massot (Aug 02 2019 at 19:34)</a>:</h4>
<p>In those terms, I'm working on <code>f_matrix_adjacent</code> and <code>f_matrix_nonadjacent</code></p>

<a name="172336158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172336158" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172336158">Jesse Michael Han (Aug 02 2019 at 19:35)</a>:</h4>
<p><code>g_injective</code> was easy:</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">g_injective</span> <span class="o">{</span><span class="n">m</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="n">function</span><span class="bp">.</span><span class="n">injective</span> <span class="o">(</span><span class="n">g</span> <span class="n">m</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rw</span><span class="o">[</span><span class="n">g</span><span class="o">],</span> <span class="n">intros</span> <span class="n">x₁</span> <span class="n">x₂</span> <span class="n">H_eq</span><span class="o">,</span> <span class="n">simp</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span> <span class="n">exact</span> <span class="n">H_eq</span><span class="bp">.</span><span class="n">right</span>
<span class="kn">end</span>
</pre></div>

<a name="172336162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172336162" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172336162">Reid Barton (Aug 02 2019 at 19:35)</a>:</h4>
<p>I'm going to tackle the inequality that's the last sentence of the PDF I posted</p>

<a name="172336204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172336204" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172336204">Reid Barton (Aug 02 2019 at 19:35)</a>:</h4>
<p>that leaves <code>f_image_g</code> and <code>exists_eigenvalue</code></p>

<a name="172336258"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172336258" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172336258">Johan Commelin (Aug 02 2019 at 19:36)</a>:</h4>
<p>I'll push what I have now.</p>

<a name="172336424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172336424" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172336424">Johan Commelin (Aug 02 2019 at 19:38)</a>:</h4>
<p>Ok, I pushed</p>

<a name="172336438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172336438" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172336438">Johan Commelin (Aug 02 2019 at 19:38)</a>:</h4>
<p>It does contain a <code>sorry</code>. Will work on that soon.</p>

<a name="172336444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172336444" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172336444">Jesse Michael Han (Aug 02 2019 at 19:38)</a>:</h4>
<p>i doubt <code>f_image_g</code> will be as easy but i can start on that. <span class="user-mention" data-user-id="112680">@Johan Commelin</span>  could i get push access as well?</p>

<a name="172336483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172336483" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172336483">Johan Commelin (Aug 02 2019 at 19:39)</a>:</h4>
<p>afk</p>

<a name="172336769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172336769" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172336769">Reid Barton (Aug 02 2019 at 19:42)</a>:</h4>
<p>What's your github username again?</p>

<a name="172336779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172336779" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172336779">Jesse Michael Han (Aug 02 2019 at 19:42)</a>:</h4>
<p><code>jesse-michael-han</code></p>

<a name="172336805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172336805" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172336805">Reid Barton (Aug 02 2019 at 19:42)</a>:</h4>
<p>Cool, added</p>

<a name="172337072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172337072" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172337072">Patrick Massot (Aug 02 2019 at 19:46)</a>:</h4>
<p>Do we have a nice way to define the two injections from <code>fin n  -&gt; bool</code> to <code>fin n+1 -&gt; bool</code>  that differ on the zeroth element of <code>fin n+1</code>?</p>

<a name="172337105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172337105" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172337105">Patrick Massot (Aug 02 2019 at 19:46)</a>:</h4>
<p>I guess I should use pattern matching</p>

<a name="172337137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172337137" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172337137">Johan Commelin (Aug 02 2019 at 19:47)</a>:</h4>
<p>Check what I did</p>

<a name="172337165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172337165" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172337165">Johan Commelin (Aug 02 2019 at 19:47)</a>:</h4>
<p>I've used <code>cond (x 0)</code> stuff</p>

<a name="172337233"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172337233" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172337233">Patrick Massot (Aug 02 2019 at 19:48)</a>:</h4>
<p>This is not quite the same question, is it?</p>

<a name="172337261"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172337261" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172337261">Johan Commelin (Aug 02 2019 at 19:48)</a>:</h4>
<p>Maybe not</p>

<a name="172337285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172337285" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172337285">Patrick Massot (Aug 02 2019 at 19:48)</a>:</h4>
<p>You're going i the easier direction (decreasing n)</p>

<a name="172337296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172337296" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172337296">Johan Commelin (Aug 02 2019 at 19:49)</a>:</h4>
<p>Right, I was too fast... sorry</p>

<a name="172337548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172337548" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172337548">Reid Barton (Aug 02 2019 at 19:52)</a>:</h4>
<p>In principle I like building the equivalence <code>Q (n+1) ≃ Q n ⊕ Q n</code> out of stuff in <code>data.equiv.basic</code>/<code>data.equiv.fin</code> though it would be kind of verbose</p>

<a name="172337577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172337577" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172337577">Patrick Massot (Aug 02 2019 at 19:53)</a>:</h4>
<p>I found the library bit I was missing</p>

<a name="172337582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172337582" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172337582">Patrick Massot (Aug 02 2019 at 19:53)</a>:</h4>
<p>I can now write <code>Q n → Q (n+1) := λ p, λ k, if h : k = 0 then tt else p (k.pred h)</code></p>

<a name="172337588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172337588" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172337588">Johan Commelin (Aug 02 2019 at 19:53)</a>:</h4>
<p>That's what I used</p>

<a name="172337590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172337590" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172337590">Patrick Massot (Aug 02 2019 at 19:53)</a>:</h4>
<p>I was missing pred</p>

<a name="172337595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172337595" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172337595">Johan Commelin (Aug 02 2019 at 19:53)</a>:</h4>
<p>I already pushed that equiv <span class="user-mention" data-user-id="110032">@Reid Barton</span></p>

<a name="172337663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172337663" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172337663">Patrick Massot (Aug 02 2019 at 19:54)</a>:</h4>
<p>Sorry Johan, I focused on your <code>cond</code> and missed <code>pred</code></p>

<a name="172337678"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172337678" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172337678">Reid Barton (Aug 02 2019 at 19:54)</a>:</h4>
<p>Oh I see, just defined manually yeah</p>

<a name="172338602"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172338602" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172338602">Reid Barton (Aug 02 2019 at 20:09)</a>:</h4>
<p>I changed <code>H</code> from a <code>finset</code> back to a <code>set</code> though I'm not yet entirely sure whether it was a good idea</p>

<a name="172339342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172339342" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172339342">Johan Commelin (Aug 02 2019 at 20:18)</a>:</h4>
<p>Ooh, you should also feel free to refactor <code>Q.equiv_sum</code></p>

<a name="172339357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172339357" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172339357">Johan Commelin (Aug 02 2019 at 20:19)</a>:</h4>
<p>If you want to use more fancy library functions (-;</p>

<a name="172339627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172339627" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172339627">Chris Hughes (Aug 02 2019 at 20:23)</a>:</h4>
<p>finsets ftw.</p>

<a name="172340338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172340338" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172340338">Floris van Doorn (Aug 02 2019 at 20:33)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span>: I would suggest</p>
<div class="codehilite"><pre><span></span>def cons (x : α) (v : fin n → α) : fin (n+1) → α :=
λ j, fin.cases x v j
</pre></div>

<a name="172340436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172340436" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172340436">Patrick Massot (Aug 02 2019 at 20:34)</a>:</h4>
<p>What is that?</p>

<a name="172340552"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172340552" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172340552">Floris van Doorn (Aug 02 2019 at 20:36)</a>:</h4>
<p>To define the maps <code>Q n → Q (n+1)</code>, <code>fin.cases</code> is there exactly for that purpose.</p>

<a name="172340604"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172340604" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172340604">Patrick Massot (Aug 02 2019 at 20:37)</a>:</h4>
<p>Oh I see</p>

<a name="172340844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172340844" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172340844">Patrick Massot (Aug 02 2019 at 20:41)</a>:</h4>
<p>It's still totally mysterious to me that your definition cannot be rewritten as <code>fin.cases x v</code></p>

<a name="172341742"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172341742" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172341742">Floris van Doorn (Aug 02 2019 at 20:56)</a>:</h4>
<p>Lean is pretty bad at these kind of unification problems, unless it uses the <code>[elab_as_eliminator]</code> attribute. With that attribute it is hardcoded to look at the third explicit argument of <code>fin.cases</code>, and then figure out what to do using the type of the third argument. If you don't give it 3 arguments, it will do the standard unification procedure, which fails.</p>

<a name="172341760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172341760" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172341760">Patrick Massot (Aug 02 2019 at 20:57)</a>:</h4>
<p>What do you get from using this definition rather than mine?</p>

<a name="172341767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172341767" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172341767">Patrick Massot (Aug 02 2019 at 20:57)</a>:</h4>
<p>It seems harder to prove lemmas about it</p>

<a name="172341771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172341771" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172341771">Patrick Massot (Aug 02 2019 at 20:57)</a>:</h4>
<p>but probably I'm missing library lemmas</p>

<a name="172342490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172342490" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172342490">Johan Commelin (Aug 02 2019 at 21:07)</a>:</h4>
<p>I'm calling it a day</p>

<a name="172342503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172342503" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172342503">Johan Commelin (Aug 02 2019 at 21:07)</a>:</h4>
<p>Unfortunately <code>e</code> is still not a basis</p>

<a name="172342567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172342567" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172342567">Johan Commelin (Aug 02 2019 at 21:08)</a>:</h4>
<p>I pushed the mess that I have so far.</p>

<a name="172342583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172342583" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172342583">Patrick Massot (Aug 02 2019 at 21:08)</a>:</h4>
<p>This is all very frustrating. I'm trying to learn how to make weird inductions in Lean</p>

<a name="172342590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172342590" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172342590">Patrick Massot (Aug 02 2019 at 21:08)</a>:</h4>
<p>And I'm very bad at it</p>

<a name="172342949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172342949" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172342949">Jesse Michael Han (Aug 02 2019 at 21:14)</a>:</h4>
<p>i'm halfway done with <code>f_image_g</code></p>

<a name="172343353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172343353" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172343353">Floris van Doorn (Aug 02 2019 at 21:20)</a>:</h4>
<p>My hope was that the lemmas you needed were already in the library. Although I don't see anything other than <code>cases_zero</code> and <code>cases_succ</code>. What else do you need?</p>

<a name="172378134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172378134" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172378134">Jesse Michael Han (Aug 02 2019 at 22:27)</a>:</h4>
<p>i'm done with <code>f_image_g</code> except for these two annoying lemmas:</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">cast_lemma_1</span> <span class="o">{</span><span class="n">m</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast</span> <span class="n">m</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span> <span class="n">sorry</span>

<span class="kn">lemma</span> <span class="n">cast_lemma_2</span> <span class="o">{</span><span class="n">m</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">succ</span> <span class="n">m</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">nat</span><span class="bp">.</span><span class="n">cast</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span> <span class="n">sorry</span>
</pre></div>

<a name="172378341"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172378341" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172378341">Jesse Michael Han (Aug 02 2019 at 22:30)</a>:</h4>
<p>oh nevermind, i just needed to make a <code>change</code>:</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">cast_lemma_1</span> <span class="o">{</span><span class="n">m</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast</span> <span class="n">m</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="o">{</span><span class="n">change</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="err">↑</span><span class="n">m</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">),</span> <span class="n">suffices</span> <span class="n">this</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="err">↑</span><span class="n">m</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">),</span> <span class="k">by</span> <span class="o">{</span><span class="n">linarith</span><span class="o">},</span> <span class="n">simp</span><span class="o">}</span>

<span class="kn">lemma</span> <span class="n">cast_lemma_2</span> <span class="o">{</span><span class="n">m</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">succ</span> <span class="n">m</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">nat</span><span class="bp">.</span><span class="n">cast</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">change</span> <span class="err">↑</span><span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">succ</span> <span class="n">m</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="err">↑</span><span class="n">m</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span><span class="bp">;</span> <span class="n">simp</span>
</pre></div>

<a name="172379531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172379531" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172379531">Jesse Michael Han (Aug 02 2019 at 22:57)</a>:</h4>
<p>trying to push my branch still results in a 403 forbidden error, could someone take a look at the permissions?</p>
<p>in the meantime i put the code for <code>f_image_g</code> on my fork <a href="https://github.com/jesse-michael-han/lean-sensitivity/blob/jmh/src/sensitivity.lean" target="_blank" title="https://github.com/jesse-michael-han/lean-sensitivity/blob/jmh/src/sensitivity.lean">here</a></p>

<a name="172382042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172382042" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172382042">Patrick Massot (Aug 02 2019 at 23:53)</a>:</h4>
<p>I'm done computing the matrix</p>

<a name="172382211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172382211" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172382211">Patrick Massot (Aug 02 2019 at 23:58)</a>:</h4>
<p>I haven't use <span class="user-mention" data-user-id="112680">@Johan Commelin</span> xor adjacency definition, see <a href="https://github.com/leanprover-community/lean-sensitivity/blob/058def458c9a4023ec95aaf211c0f7a22f77a05d/src/sensitivity.lean#L232-L235" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/blob/058def458c9a4023ec95aaf211c0f7a22f77a05d/src/sensitivity.lean#L232-L235">https://github.com/leanprover-community/lean-sensitivity/blob/058def458c9a4023ec95aaf211c0f7a22f77a05d/src/sensitivity.lean#L232-L235</a>. I hope my definition is the same as his. At least I can <a href="https://github.com/leanprover-community/lean-sensitivity/blob/058def458c9a4023ec95aaf211c0f7a22f77a05d/src/sensitivity.lean#L237" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/blob/058def458c9a4023ec95aaf211c0f7a22f77a05d/src/sensitivity.lean#L237">compute the matrix</a> using it</p>

<a name="172382252"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172382252" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172382252">Patrick Massot (Aug 02 2019 at 23:59)</a>:</h4>
<p>I also used the explicit inductive definition of the <a href="https://github.com/leanprover-community/lean-sensitivity/blob/058def458c9a4023ec95aaf211c0f7a22f77a05d/src/sensitivity.lean#L167-L170" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/blob/058def458c9a4023ec95aaf211c0f7a22f77a05d/src/sensitivity.lean#L167-L170">dual basis</a>, and proved the <a href="https://github.com/leanprover-community/lean-sensitivity/blob/058def458c9a4023ec95aaf211c0f7a22f77a05d/src/sensitivity.lean#L198" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/blob/058def458c9a4023ec95aaf211c0f7a22f77a05d/src/sensitivity.lean#L198">duality equations</a>.</p>

<a name="172382330"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172382330" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172382330">Patrick Massot (Aug 03 2019 at 00:00)</a>:</h4>
<p>Note that I spent most of my time trying to prove fancy induction principle on <code>Q n</code>, messing around with <code>elab_as_eliminator</code> and <code>induction ... using ...</code>. But nothing worked, so I reverted to good old <code>cases</code>.</p>

<a name="172382987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172382987" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172382987">Patrick Massot (Aug 03 2019 at 00:18)</a>:</h4>
<p>Is there any reason we use bool everywhere instead of Prop?</p>

<a name="172392812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172392812" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172392812">Johan Commelin (Aug 03 2019 at 05:44)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> You don't need <code>bool_cases</code>. You can just write <code>cases h : x p</code>.</p>

<a name="172400077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172400077" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172400077">Patrick Massot (Aug 03 2019 at 09:51)</a>:</h4>
<p>Nice trick! I tried <code>by_cases hp : x p = tt</code> but this gave an inconvenient second case. I'm a bit disappointed that the proof wasn't finished while I slept. I'll be again away from Lean for the next 9 hours, so maybe this will be enough. Otherwise I'll play again tonight. Have fun!</p>

<a name="172415077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172415077" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172415077">Patrick Massot (Aug 03 2019 at 17:48)</a>:</h4>
<p><span class="user-mention" data-user-id="116045">@Jesse Michael Han</span> I think you have slightly too much love for <code>tidy</code>. What about </p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">f_image_g&#39;</span> <span class="o">{</span><span class="n">m</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">w</span> <span class="o">:</span> <span class="n">V</span> <span class="o">(</span><span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span> <span class="o">(</span><span class="n">hv</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">v</span><span class="o">,</span> <span class="n">w</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">m</span> <span class="n">v</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">f</span> <span class="o">(</span><span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="n">V</span> <span class="o">(</span><span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="n">V</span> <span class="o">(</span><span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span> <span class="n">w</span> <span class="bp">=</span> <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="o">(</span><span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="err">•</span> <span class="n">w</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rcases</span> <span class="n">hv</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">v</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span><span class="o">,</span>
  <span class="n">dsimp</span> <span class="o">[</span><span class="n">g</span><span class="o">],</span>
  <span class="n">erw</span> <span class="n">f</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">f_squared</span><span class="o">],</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">smul_add</span><span class="o">,</span> <span class="n">smul_smul</span><span class="o">,</span> <span class="n">real</span><span class="bp">.</span><span class="n">mul_self_sqrt</span> <span class="o">(</span><span class="k">by</span> <span class="n">exact_mod_cast</span> <span class="n">zero_le</span> <span class="bp">_</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">+</span> <span class="n">m</span><span class="o">),</span> <span class="n">add_smul</span><span class="o">,</span> <span class="n">one_smul</span><span class="o">],</span>
  <span class="n">abel</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>

<a name="172415092"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172415092" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172415092">Patrick Massot (Aug 03 2019 at 17:49)</a>:</h4>
<p>Do you mind if I replace your proof by this one? I looks closer to the paper proof</p>

<a name="172415163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172415163" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172415163">Jesse Michael Han (Aug 03 2019 at 17:50)</a>:</h4>
<p>oh, i didn't see <code>f_squared</code></p>
<p>yeah that looks much better</p>

<a name="172415171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172415171" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172415171">Patrick Massot (Aug 03 2019 at 17:51)</a>:</h4>
<p>Did you look at the pdf proof?</p>

<a name="172415236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172415236" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172415236">Jesse Michael Han (Aug 03 2019 at 17:53)</a>:</h4>
<p>yes, but i took a longer route in proving the left-side equality (because i essentially rederived <code>f_squared</code>)</p>

<a name="172415282"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172415282" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172415282">Patrick Massot (Aug 03 2019 at 17:54)</a>:</h4>
<p>Anyway,  is anybody working on the next lemma?</p>

<a name="172415284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172415284" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172415284">Patrick Massot (Aug 03 2019 at 17:54)</a>:</h4>
<p>I mean <code>exists_eigenvalue</code></p>

<a name="172415296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172415296" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172415296">Patrick Massot (Aug 03 2019 at 17:55)</a>:</h4>
<p>I know nothing about dimension in mathlib, but it looks like a good opportunity to learn</p>

<a name="172415346"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172415346" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172415346">Jesse Michael Han (Aug 03 2019 at 17:56)</a>:</h4>
<p>i'm not working on it</p>
<p>i was going to wait to hear back from reid</p>

<a name="172415612"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172415612" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172415612">Patrick Massot (Aug 03 2019 at 18:05)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/blob/a33315d594731876aa780bb12fc79b3e67198302/src/linear_algebra/dimension.lean#L341" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/a33315d594731876aa780bb12fc79b3e67198302/src/linear_algebra/dimension.lean#L341">exists_mem_ne_zero_of_dim_pos</a> looks very promising</p>

<a name="172420878"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172420878" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172420878">Jesse Michael Han (Aug 03 2019 at 20:50)</a>:</h4>
<p>i started a bit on <code>degree_theorem</code>; feel free to overwrite or build on what's there</p>
<p>i'm not sure if <code>finsupp.mem_span_if_total</code> is the correct way to extract a linear combination from a proof of membership in a span, but it reduces to a <code>finset.sum</code> which seems to be what we want.</p>

<a name="172421000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172421000" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172421000">Patrick Massot (Aug 03 2019 at 20:55)</a>:</h4>
<p>I finished <a href="https://github.com/leanprover-community/lean-sensitivity/commit/ecd89093017668d867feaaf734b0015d29aa7598" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/commit/ecd89093017668d867feaaf734b0015d29aa7598">e_is_basis</a> that <span class="user-mention" data-user-id="112680">@Johan Commelin</span>   almost did yesterday</p>

<a name="172421054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172421054" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172421054">Patrick Massot (Aug 03 2019 at 20:56)</a>:</h4>
<p>Wait. <span class="user-mention" data-user-id="116045">@Jesse Michael Han</span>  did you proof start timeout?</p>

<a name="172421057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172421057" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172421057">Patrick Massot (Aug 03 2019 at 20:56)</a>:</h4>
<p>I tried to merge and I see it times out</p>

<a name="172421110"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172421110" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172421110">Patrick Massot (Aug 03 2019 at 20:58)</a>:</h4>
<p><a href="https://github.com/leanprover-community/lean-sensitivity/commit/0f1468180a143ba8d40276b2bf7198fc2c250093" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/commit/0f1468180a143ba8d40276b2bf7198fc2c250093">https://github.com/leanprover-community/lean-sensitivity/commit/0f1468180a143ba8d40276b2bf7198fc2c250093</a> is my attempt at the dimension argument</p>

<a name="172421112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172421112" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172421112">Patrick Massot (Aug 03 2019 at 20:58)</a>:</h4>
<p>But I don't know enough cardinal theory to do finite dimensional linear algebra <span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span></p>

<a name="172421115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172421115" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172421115">Jesse Michael Han (Aug 03 2019 at 20:58)</a>:</h4>
<p>i'll take a look</p>

<a name="172421125"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172421125" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172421125">Patrick Massot (Aug 03 2019 at 20:59)</a>:</h4>
<p>For instance I need to prove:</p>
<div class="codehilite"><pre><span></span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span>
<span class="err">⊢</span> <span class="mi">2</span> <span class="err">^</span> <span class="n">n</span> <span class="bp">&lt;</span> <span class="n">cardinal</span><span class="bp">.</span><span class="n">omega</span>
</pre></div>

<a name="172421130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172421130" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172421130">Patrick Massot (Aug 03 2019 at 20:59)</a>:</h4>
<p>and </p>
<div class="codehilite"><pre><span></span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">,</span>
<span class="err">⊢</span> <span class="mi">2</span> <span class="err">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">2</span> <span class="err">^</span> <span class="err">↑</span><span class="n">n</span>
</pre></div>


<p>Where at least some of this stuff is in cardinals</p>

<a name="172421297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172421297" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172421297">Patrick Massot (Aug 03 2019 at 21:05)</a>:</h4>
<p>I won't do more tonight.</p>

<a name="172421556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172421556" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172421556">Jesse Michael Han (Aug 03 2019 at 21:14)</a>:</h4>
<p>OK, <code>leanpkg test</code> succeeds at my commit, but indeed times out after the merge. <del>i'll fix it</del> i fixed it</p>

<a name="172421739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172421739" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172421739">Chris Hughes (Aug 03 2019 at 21:21)</a>:</h4>
<p>If you know everything is finite dimensional, you probably shouldn't be using cardinals. Everything about infinite dimension should be transferred to <code>findim</code> really, or you have to faff with coercions</p>

<a name="172422087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172422087" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172422087">Patrick Massot (Aug 03 2019 at 21:32)</a>:</h4>
<p>Chris, the problem is we seem to have a <em>lot</em> more  lemmas about <code>dim</code> than <code>findim</code></p>

<a name="172422156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172422156" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172422156">Patrick Massot (Aug 03 2019 at 21:35)</a>:</h4>
<p>For instance, do you have <a href="https://github.com/leanprover-community/mathlib/blob/a33315d594731876aa780bb12fc79b3e67198302/src/linear_algebra/dimension.lean#L275" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/a33315d594731876aa780bb12fc79b3e67198302/src/linear_algebra/dimension.lean#L275">dim_sup_add_dim_inf_eq</a> for <code>findim</code>?</p>

<a name="172422196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172422196" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172422196">Patrick Massot (Aug 03 2019 at 21:36)</a>:</h4>
<p>Or do you have a nice way to import such theorems into the finite dimensional world?</p>

<a name="172422205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172422205" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172422205">Chris Hughes (Aug 03 2019 at 21:37)</a>:</h4>
<p>I have virtually nothing. I guess when transfer comes along it will be easier. But they'll just be <code>simp [nat.cast_add]</code> or something.</p>

<a name="172422257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172422257" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172422257">Patrick Massot (Aug 03 2019 at 21:39)</a>:</h4>
<p>Was this mirroring discussed with <span class="user-mention" data-user-id="110049">@Mario Carneiro</span>? It seems a bit sad to duplicate all this, but we really want to be able to use finite dimensions as natural numbers</p>

<a name="172422308"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172422308" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172422308">Mario Carneiro (Aug 03 2019 at 21:40)</a>:</h4>
<p>most facts about numbers being equivalent to finite cardinals are proven</p>

<a name="172422316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172422316" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172422316">Patrick Massot (Aug 03 2019 at 21:41)</a>:</h4>
<p>what do you mean?</p>

<a name="172422363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172422363" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172422363">Chris Hughes (Aug 03 2019 at 21:43)</a>:</h4>
<p>Like cast is monotonic <code>etc</code>. Unfortunately, cardinals are not an ordered semiring, so the generic lemmas don't work.</p>

<a name="172422368"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172422368" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172422368">Patrick Massot (Aug 03 2019 at 21:43)</a>:</h4>
<p>Are they tagged for use by <code>norm_cast</code>?</p>

<a name="172422411"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172422411" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172422411">Patrick Massot (Aug 03 2019 at 21:44)</a>:</h4>
<p>For instance <code>attribute [elim_cast] cardinal.nat_cast_in</code> seems to be missing</p>

<a name="172423082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172423082" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172423082">Jesse Michael Han (Aug 03 2019 at 22:06)</a>:</h4>
<p>i think the version of <code>2^n &lt; omega</code> you stated is parsed by Lean as <code>monoid.pow</code>, which is more annoying to deal with</p>
<p>but if you ensure it's the cardinal pow of casted nats, it's 2 lemmas away:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">set_theory</span><span class="bp">.</span><span class="n">cardinal</span>

<span class="kn">universe</span> <span class="n">u</span>

<span class="kn">example</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="o">(</span><span class="err">↑</span><span class="mi">2</span><span class="o">)</span> <span class="err">^</span> <span class="o">(</span><span class="err">↑</span><span class="n">n</span> <span class="o">:</span> <span class="n">cardinal</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">})</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="n">cardinal</span><span class="bp">.</span><span class="n">omega</span> <span class="o">:</span> <span class="n">cardinal</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">})</span> <span class="o">:=</span>
 <span class="k">by</span> <span class="n">rw</span><span class="o">[</span><span class="bp">&lt;-</span><span class="n">cardinal</span><span class="bp">.</span><span class="n">nat_cast_pow</span><span class="o">]</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">cardinal</span><span class="bp">.</span><span class="n">nat_lt_omega</span> <span class="bp">_</span>
</pre></div>

<a name="172423357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172423357" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172423357">Patrick Massot (Aug 03 2019 at 22:15)</a>:</h4>
<p>Do we know that the restriction of linear_independent family to a subtype is linear_independent?</p>

<a name="172423644"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172423644" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172423644">Patrick Massot (Aug 03 2019 at 22:24)</a>:</h4>
<p>Anyway, I said I would stop more than one hour ago, so I should really stop now</p>

<a name="172423655"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172423655" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172423655">Patrick Massot (Aug 03 2019 at 22:25)</a>:</h4>
<p>Modulo the restriction thing, the proof of the dimension argument is reduced to these 2^n &lt; omega things</p>

<a name="172423706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172423706" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172423706">Patrick Massot (Aug 03 2019 at 22:26)</a>:</h4>
<p>see <a href="https://github.com/leanprover-community/lean-sensitivity/commit/af0e391f1d39d5448e3aff901f1dbe7eb10d3e32" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/commit/af0e391f1d39d5448e3aff901f1dbe7eb10d3e32">https://github.com/leanprover-community/lean-sensitivity/commit/af0e391f1d39d5448e3aff901f1dbe7eb10d3e32</a></p>

<a name="172423709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172423709" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172423709">Jesse Michael Han (Aug 03 2019 at 22:26)</a>:</h4>
<p>the <code>monoid.pow</code> is annoying because you have to do an induction, but it's not bad:</p>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="o">(</span><span class="mi">2</span> <span class="err">^</span> <span class="n">n</span> <span class="o">:</span> <span class="n">cardinal</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">2</span> <span class="err">^</span> <span class="o">(</span><span class="err">↑</span><span class="n">n</span> <span class="o">:</span> <span class="n">cardinal</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">})</span> <span class="o">:</span> <span class="n">cardinal</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">})</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">ih</span><span class="o">,</span>
    <span class="o">{</span><span class="n">simp</span><span class="o">},</span>
    <span class="o">{</span><span class="n">rw</span><span class="o">[</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast_succ</span><span class="o">,</span> <span class="n">cardinal</span><span class="bp">.</span><span class="n">power_add</span><span class="o">,</span> <span class="bp">&lt;-</span><span class="n">ih</span><span class="o">,</span> <span class="n">cardinal</span><span class="bp">.</span><span class="n">power_one</span><span class="o">,</span> <span class="n">mul_comm</span><span class="o">],</span> <span class="n">refl</span> <span class="o">},</span>
<span class="kn">end</span>
</pre></div>


<p>you can get the first one from this one, i believe</p>

<a name="172423716"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172423716" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172423716">Patrick Massot (Aug 03 2019 at 22:27)</a>:</h4>
<p>I followed Chris's advice to get rid of <code>dim</code> as soon as I applied the lemmas</p>

<a name="172423758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172423758" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172423758">Patrick Massot (Aug 03 2019 at 22:28)</a>:</h4>
<p>Nice, feel free to remove those sorries and push. I'll go to bed</p>

<a name="172423770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172423770" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172423770">Patrick Massot (Aug 03 2019 at 22:29)</a>:</h4>
<p>Maybe you can even finish the whole thing while I sleep</p>

<a name="172423823"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172423823" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172423823">Patrick Massot (Aug 03 2019 at 22:30)</a>:</h4>
<p>Or maybe <span class="user-mention" data-user-id="110032">@Reid Barton</span> will come back and cross the finish line for us</p>

<a name="172423834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172423834" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172423834">Patrick Massot (Aug 03 2019 at 22:31)</a>:</h4>
<p>Zulip says his local time is 6:30pm</p>

<a name="172423836"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172423836" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172423836">Patrick Massot (Aug 03 2019 at 22:31)</a>:</h4>
<p>This leaves him the whole evening and night</p>

<a name="172423839"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172423839" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172423839">Patrick Massot (Aug 03 2019 at 22:31)</a>:</h4>
<p>and same for you!</p>

<a name="172423882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172423882" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172423882">Patrick Massot (Aug 03 2019 at 22:32)</a>:</h4>
<p>Have fun!</p>

<a name="172434028"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172434028" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172434028">Yao Liu (Aug 04 2019 at 04:46)</a>:</h4>
<p>As a spectator, I was looking around and found (via Terry Tao's blog post) this interpretation <a href="https://arxiv.org/abs/1907.11175" target="_blank" title="https://arxiv.org/abs/1907.11175">https://arxiv.org/abs/1907.11175</a><br>
namely, the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>-dimensional space ought to be the exterior algebra (or Clifford algebra) of an <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>-dimensional vector space.</p>

<a name="172464141"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172464141" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172464141">Jesse Michael Han (Aug 04 2019 at 21:07)</a>:</h4>
<p>i'm trying to import <code>analysis.normed_space.basic</code> to use the triangle inequality, but this causes Lean on both my machines to start complaining about "equation compiler failed to generate bytecode for <code>e._main</code>", and something not being a <code>rfl</code> lemma, etc. the errors appear iff i have that import.</p>
<p>does anyone know why this would happen?</p>

<a name="172464303"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172464303" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172464303">Kevin Buzzard (Aug 04 2019 at 21:12)</a>:</h4>
<div class="codehilite"><pre><span></span>equation compiler failed to generate bytecode for &#39;e._main&#39;
nested exception message:
code generation failed, VM does not have code for &#39;real.normed_field&#39;
</pre></div>

<a name="172464431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172464431" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172464431">Kevin Buzzard (Aug 04 2019 at 21:16)</a>:</h4>
<p>The entire file <code>analysis.normed_space.basic</code> is marked <code>noncomputable</code> so maybe it's no surprise the VM doesn't have code for <code>real.normed_field</code></p>

<a name="172464444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172464444" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172464444">Kevin Buzzard (Aug 04 2019 at 21:17)</a>:</h4>
<p>If you mark <code>e</code> noncomputable then most of the errors go away</p>

<a name="172464492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172464492" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172464492">Jesse Michael Han (Aug 04 2019 at 21:19)</a>:</h4>
<p>indeed, but i was alarmed that previous proofs which were <code>by refl</code> were somehow no longer so after adding <code>noncomputable</code></p>

<a name="172464493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172464493" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172464493">Jesse Michael Han (Aug 04 2019 at 21:19)</a>:</h4>
<p>but that error can be fixed by changing <code>rfl</code> to <code>by rw e</code>...</p>

<a name="172464539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172464539" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172464539">Kevin Buzzard (Aug 04 2019 at 21:20)</a>:</h4>
<p>you golfed me, I just found <code>by unfold e</code> :-)</p>

<a name="172482148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172482148" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172482148">Johan Commelin (Aug 05 2019 at 06:35)</a>:</h4>
<p>Can someone give a status update? Is the only thing that needs to be done the tying together of some loose ends?</p>

<a name="172482418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172482418" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172482418">Chris Hughes (Aug 05 2019 at 06:42)</a>:</h4>
<p>Looks like two sorries right now.</p>

<a name="172482420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172482420" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172482420">Chris Hughes (Aug 05 2019 at 06:42)</a>:</h4>
<p>Neither are that hard.</p>

<a name="172482522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172482522" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172482522">Johan Commelin (Aug 05 2019 at 06:44)</a>:</h4>
<p>I'm tackling adjacent_symm</p>

<a name="172482582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172482582" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172482582">Chris Hughes (Aug 05 2019 at 06:46)</a>:</h4>
<p>I just proved that.</p>

<a name="172482592"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172482592" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172482592">Chris Hughes (Aug 05 2019 at 06:46)</a>:</h4>
<p>There are two sorries in the final theorem. I'm doing the first.</p>

<a name="172483134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172483134" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172483134">Chris Hughes (Aug 05 2019 at 06:59)</a>:</h4>
<p>One sorry left now.</p>

<a name="172486847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172486847" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172486847">Johan Commelin (Aug 05 2019 at 08:17)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span> Are you still working on this?</p>

<a name="172486855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172486855" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172486855">Johan Commelin (Aug 05 2019 at 08:17)</a>:</h4>
<p>I connected <code>adjacent</code> back to my definition that used <code>dist</code>.</p>

<a name="172489068"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172489068" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172489068">Chris Hughes (Aug 05 2019 at 08:59)</a>:</h4>
<p>I'm not. The last sorry looked like you needed to understand what was going on. Everything else I proved did not require that.</p>

<a name="172489174"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172489174" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172489174">Johan Commelin (Aug 05 2019 at 09:01)</a>:</h4>
<p>Ok, I see.</p>

<a name="172491466"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172491466" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172491466">Patrick Massot (Aug 05 2019 at 09:42)</a>:</h4>
<p>Johan, is there any use to the distance you defined, and relating it to adjacent? I'm not sure it makes <code>adjacent</code> so much more related to the usual definition. Maybe we could define a general graph class, and then adjacency in this context, and relate. But the real question is: what is the usual definition of the graph structure on Q n? Maybe the simplest answer goes through defining the (Z/2)^n action on Q n. For instance we could redefine Q n to be (Z/2)^n instead of this weird CS bool thing. Then define the canonical basis b for (Z/2)^n (it should already be in mathlib) and define <code>adjacent x y</code> by <code>exists i, b i bul x = y</code>.</p>

<a name="172491809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172491809" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172491809">Johan Commelin (Aug 05 2019 at 09:49)</a>:</h4>
<p>I'm almost done with the final sorry.</p>

<a name="172491813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172491813" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172491813">Johan Commelin (Aug 05 2019 at 09:49)</a>:</h4>
<p>I'll push what I have. Lunch time now.</p>

<a name="172491864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172491864" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172491864">Patrick Massot (Aug 05 2019 at 09:50)</a>:</h4>
<p>Oh, I was starting on this final sorry</p>

<a name="172491912"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172491912" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172491912">Patrick Massot (Aug 05 2019 at 09:51)</a>:</h4>
<p>Do you mind if I finish during your lunch?</p>

<a name="172492173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172492173" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172492173">Patrick Massot (Aug 05 2019 at 09:56)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> should I push?</p>

<a name="172492215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172492215" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172492215">Patrick Massot (Aug 05 2019 at 09:57)</a>:</h4>
<p>Ok, let's say he was really having lunch</p>

<a name="172492220"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172492220" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172492220">Patrick Massot (Aug 05 2019 at 09:57)</a>:</h4>
<p><a href="https://github.com/leanprover-community/lean-sensitivity/commit/f7be6abb34eafcd01df9417c99df34f8076362b9" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/commit/f7be6abb34eafcd01df9417c99df34f8076362b9">https://github.com/leanprover-community/lean-sensitivity/commit/f7be6abb34eafcd01df9417c99df34f8076362b9</a></p>

<a name="172492273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172492273" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172492273">Patrick Massot (Aug 05 2019 at 09:58)</a>:</h4>
<p>Now we have a lot of cleanup to do before telling people about it</p>

<a name="172493442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493442" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493442">Johan Commelin (Aug 05 2019 at 10:22)</a>:</h4>
<p>Nice, well done!</p>

<a name="172493450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493450" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493450">Johan Commelin (Aug 05 2019 at 10:22)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span> <span class="user-mention" data-user-id="110596">@Rob Lewis</span> <span class="user-mention" data-user-id="116045">@Jesse Michael Han</span> <span class="user-mention" data-user-id="110044">@Chris Hughes</span> <span class="user-mention" data-user-id="111080">@Floris van Doorn</span> We have a theorem!</p>

<a name="172493579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493579" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493579">Kevin Buzzard (Aug 05 2019 at 10:25)</a>:</h4>
<p>Well done!</p>
<p>I really like these "oh look here's some relatively simple-looking maths, how hard is it <em>actually</em> to formalise?" questions. A year or so ago my impression was "in Lean, it's probably going to be tough". Now my impression is turning to "it might be not too bad". We have cubing the cube, the IMO questions, working out pi to 7 decimal places, and now this.</p>

<a name="172493594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493594" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493594">Patrick Massot (Aug 05 2019 at 10:26)</a>:</h4>
<p>It's still a lot harder than it should be</p>

<a name="172493636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493636" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493636">Kevin Buzzard (Aug 05 2019 at 10:26)</a>:</h4>
<p>But I suspect it's a lot easier than it was.</p>

<a name="172493640"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493640" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493640">Patrick Massot (Aug 05 2019 at 10:26)</a>:</h4>
<p>Unless you already know perfectly all the relevant part of mathlib</p>

<a name="172493644"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493644" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493644">Patrick Massot (Aug 05 2019 at 10:26)</a>:</h4>
<p>Oh yes of course</p>

<a name="172493649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493649" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493649">Kevin Buzzard (Aug 05 2019 at 10:26)</a>:</h4>
<p>It's almost getting to the point where it's as easy as I thought it would be before I knew anything about how this stuff worked.</p>

<a name="172493694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493694" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493694">Johan Commelin (Aug 05 2019 at 10:27)</a>:</h4>
<p>Let's see if we can write <code>transfer</code> lemmas for this little project, to make things shorter</p>

<a name="172493703"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493703" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493703">Kevin Buzzard (Aug 05 2019 at 10:27)</a>:</h4>
<p>What does that mean?</p>

<a name="172493706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493706" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493706">Johan Commelin (Aug 05 2019 at 10:28)</a>:</h4>
<p>Because we have <code>Q n →₀ ℝ</code> and <code>V n</code>, and they are canonically isomorphic.</p>

<a name="172493752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493752" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493752">Kevin Buzzard (Aug 05 2019 at 10:28)</a>:</h4>
<p>for sure</p>

<a name="172493754"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493754" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493754">Johan Commelin (Aug 05 2019 at 10:28)</a>:</h4>
<p>Some proofs are easy on one side, others on the other.</p>

<a name="172493762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493762" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493762">Patrick Massot (Aug 05 2019 at 10:28)</a>:</h4>
<p>What do you think about starting the refactor with:</p>
<div class="codehilite"><pre><span></span><span class="kn">notation</span> <span class="bp">`</span><span class="n">Z</span><span class="bp">/</span><span class="mi">2</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">zmodp</span> <span class="mi">2</span> <span class="n">nat</span><span class="bp">.</span><span class="n">prime_two</span>

<span class="n">def</span> <span class="n">Q</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:=</span> <span class="n">fin</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">Z</span><span class="bp">/</span><span class="mi">2</span>
</pre></div>

<a name="172493770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493770" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493770">Johan Commelin (Aug 05 2019 at 10:28)</a>:</h4>
<p>This might be a good test case for the existing <code>transfer</code> api.</p>

<a name="172493776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493776" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493776">Johan Commelin (Aug 05 2019 at 10:28)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> Why would that help?</p>

<a name="172493778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493778" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493778">Kevin Buzzard (Aug 05 2019 at 10:29)</a>:</h4>
<p>I think your suggestion is a really worthwhile one Johan.</p>

<a name="172493783"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493783" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493783">Patrick Massot (Aug 05 2019 at 10:29)</a>:</h4>
<p>And then try to understand that <code>std_basis</code> thing, and define adjacency as I wrote it should be defined?</p>

<a name="172493784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493784" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493784">Johan Commelin (Aug 05 2019 at 10:29)</a>:</h4>
<p>What does <code>Z/2</code> have that <code>bool</code> doesn't have?</p>

<a name="172493786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493786" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493786">Kevin Buzzard (Aug 05 2019 at 10:29)</a>:</h4>
<p>Looks</p>

<a name="172493787"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493787" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493787">Patrick Massot (Aug 05 2019 at 10:29)</a>:</h4>
<p>A group structure</p>

<a name="172493793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493793" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493793">Patrick Massot (Aug 05 2019 at 10:29)</a>:</h4>
<blockquote>
<p>Johan, is there any use to the distance you defined, and relating it to adjacent? I'm not sure it makes <code>adjacent</code> so much more related to the usual definition. Maybe we could define a general graph class, and then adjacency in this context, and relate. But the real question is: what is the usual definition of the graph structure on Q n? Maybe the simplest answer goes through defining the (Z/2)^n action on Q n. For instance we could redefine Q n to be (Z/2)^n instead of this weird CS bool thing. Then define the canonical basis b for (Z/2)^n (it should already be in mathlib) and define <code>adjacent x y</code> by <code>exists i, b i bul x = y</code>.</p>
</blockquote>
<p>See above</p>

<a name="172493806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493806" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493806">Patrick Massot (Aug 05 2019 at 10:30)</a>:</h4>
<p>I think this would give a much more recognizable adjacency relation</p>

<a name="172493855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493855" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493855">Kevin Buzzard (Aug 05 2019 at 10:30)</a>:</h4>
<blockquote>
<p>instead of this weird CS bool thing</p>
</blockquote>
<p>Mathematicians still failing to come to terms with weird CS stuff</p>

<a name="172493887"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493887" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493887">Patrick Massot (Aug 05 2019 at 10:31)</a>:</h4>
<p>It's hard to express the fact that <code>x</code> and <code>y</code> are two different elements of a two elements sets in a nicer way than <code>x = y +1</code></p>

<a name="172493889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493889" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493889">Johan Commelin (Aug 05 2019 at 10:31)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> Ok, that seems fine.</p>

<a name="172493907"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493907" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493907">Kevin Buzzard (Aug 05 2019 at 10:31)</a>:</h4>
<p><code>x \ne y</code>?</p>

<a name="172493979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493979" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493979">Patrick Massot (Aug 05 2019 at 10:32)</a>:</h4>
<p>If I understand correctly mathlib still don't have the canonical basis of K^n (it has a more general <code>std_basis</code> for pi). It's time we fix that</p>

<a name="172493980"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493980" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493980">Johan Commelin (Aug 05 2019 at 10:32)</a>:</h4>
<p>Anyway, I have a meeting scheduled in 10 minutes... so I can't help too much with the refactor now.</p>

<a name="172493981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493981" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493981">Patrick Massot (Aug 05 2019 at 10:32)</a>:</h4>
<p>I also need to go</p>

<a name="172493997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172493997" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172493997">Patrick Massot (Aug 05 2019 at 10:32)</a>:</h4>
<p>Something easy that anyone can do is to collect all lemmas from that file that should be in mathlib and PR them</p>

<a name="172494019"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172494019" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172494019">Patrick Massot (Aug 05 2019 at 10:33)</a>:</h4>
<p>We should do that before refactoring because some of them will turn out to be unneeded for the sensitivity proof and will disappear if we don't rescue them first</p>

<a name="172497801"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172497801" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172497801">Rob Lewis (Aug 05 2019 at 11:47)</a>:</h4>
<p>I was away from Lean for the weekend and it looks like I missed all the fun. Nice job, guys!</p>

<a name="172498656"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172498656" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172498656">Reid Barton (Aug 05 2019 at 12:04)</a>:</h4>
<blockquote>
<p>We should do that before refactoring because some of them will turn out to be unneeded for the sensitivity proof and will disappear if we don't rescue them first</p>
</blockquote>
<p>I'm going to start by moving them to their own file</p>

<a name="172498672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172498672" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172498672">Reid Barton (Aug 05 2019 at 12:04)</a>:</h4>
<p>Rob I think there's still plenty of clean up that would be nice to do. You had a shorter proof of <code>f_squared</code> right?</p>

<a name="172498683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172498683" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172498683">Rob Lewis (Aug 05 2019 at 12:05)</a>:</h4>
<p>I just pushed it 20 seconds ago...</p>

<a name="172498712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172498712" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172498712">Rob Lewis (Aug 05 2019 at 12:05)</a>:</h4>
<p>Looking at a few other proofs now that should be easy to clean up.</p>

<a name="172498779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172498779" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172498779">Reid Barton (Aug 05 2019 at 12:06)</a>:</h4>
<p>Give me a couple minutes to push what I have simplified already</p>

<a name="172498867"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172498867" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172498867">Rob Lewis (Aug 05 2019 at 12:08)</a>:</h4>
<p>Sure thing.</p>

<a name="172499013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172499013" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172499013">Reid Barton (Aug 05 2019 at 12:10)</a>:</h4>
<p>OK, pushed</p>

<a name="172499038"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172499038" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172499038">Reid Barton (Aug 05 2019 at 12:11)</a>:</h4>
<p>Next I was going to try to replace the definition of <code>adjacent</code> by <code>def adjacent' {n : ℕ} (p q : Q n) : Prop := ∃! i, p i ≠ q i</code> and get rid of the <code>dist</code> stuff</p>

<a name="172499105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172499105" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172499105">Reid Barton (Aug 05 2019 at 12:12)</a>:</h4>
<p>Although I guess this means proving something similar to <code>adjacent_iff_dist</code></p>

<a name="172499146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172499146" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172499146">Reid Barton (Aug 05 2019 at 12:13)</a>:</h4>
<p>By the way, what is this <code>run_cmd tactic.skip</code> magic about?</p>

<a name="172499154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172499154" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172499154">Rob Lewis (Aug 05 2019 at 12:14)</a>:</h4>
<p>I suspect that will be nicer, but I'm not sure... I'm gonna try some more local cleanup toward the bottom.</p>

<a name="172499217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172499217" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172499217">Rob Lewis (Aug 05 2019 at 12:14)</a>:</h4>
<p>I was editing the theorem below, which was causing the one above to recompile constantly, and it was really slow. Putting no-op code in between makes it stop recompiling the one above.</p>

<a name="172499232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172499232" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172499232">Rob Lewis (Aug 05 2019 at 12:15)</a>:</h4>
<p>It wasn't meant to be pushed though, I deleted it.</p>

<a name="172499239"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172499239" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172499239">Kevin Buzzard (Aug 05 2019 at 12:15)</a>:</h4>
<p>You're giving away your secrets!</p>

<a name="172499257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172499257" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172499257">Kevin Buzzard (Aug 05 2019 at 12:15)</a>:</h4>
<p>Isn't there supposed to be some way of doing this with a <code>.</code>?</p>

<a name="172499320"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172499320" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172499320">Rob Lewis (Aug 05 2019 at 12:16)</a>:</h4>
<p><code>.</code> might have the same effect. Not sure.</p>

<a name="172499520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172499520" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172499520">Johan Commelin (Aug 05 2019 at 12:19)</a>:</h4>
<p>I always use <code>.</code></p>

<a name="172499983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172499983" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172499983">Reid Barton (Aug 05 2019 at 12:25)</a>:</h4>
<p>I'm constantly getting "excessive memory consumption" errors, is there some way to deal with these?</p>

<a name="172499993"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172499993" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172499993">Reid Barton (Aug 05 2019 at 12:25)</a>:</h4>
<p>The dependencies are definitely built</p>

<a name="172500764"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172500764" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172500764">Johan Commelin (Aug 05 2019 at 12:36)</a>:</h4>
<p>I added some <code>foo_apply</code> lemmas and golfed <code>f_image_g</code>.</p>

<a name="172501010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172501010" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172501010">Rob Lewis (Aug 05 2019 at 12:40)</a>:</h4>
<blockquote>
<p>I'm constantly getting "excessive memory consumption" errors, is there some way to deal with these?</p>
</blockquote>
<p>Hmm, something's funny with the simp set. It's spending over two seconds in the <code>simp only</code> in the 0 case of <code>f_squared</code>, that seems excessive.</p>

<a name="172501041"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172501041" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172501041">Rob Lewis (Aug 05 2019 at 12:41)</a>:</h4>
<p>Or, maybe not the simp set. Even the definition of <code>f</code> takes a while. Probably a big type class search.</p>

<a name="172501078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172501078" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172501078">Reid Barton (Aug 05 2019 at 12:41)</a>:</h4>
<p>I don't understand how anyone could have written any of this interactively. Did I break everything?</p>

<a name="172501134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172501134" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172501134">Rob Lewis (Aug 05 2019 at 12:42)</a>:</h4>
<p>It's a little slow but it works fine for me.</p>

<a name="172501152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172501152" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172501152">Kevin Buzzard (Aug 05 2019 at 12:42)</a>:</h4>
<p>restart Lean?</p>

<a name="172501367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172501367" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172501367">Rob Lewis (Aug 05 2019 at 12:46)</a>:</h4>
<p>Adding this short-circuit helps in a few places:</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">Vn_module</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="o">:</span> <span class="n">module</span> <span class="n">ℝ</span> <span class="o">(</span><span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span>
<span class="n">local</span> <span class="n">attribute</span> <span class="o">[</span><span class="kn">instance</span><span class="o">,</span> <span class="n">priority</span> <span class="mi">10000</span><span class="o">]</span> <span class="n">Vn_module</span>
</pre></div>

<a name="172501587"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172501587" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172501587">Reid Barton (Aug 05 2019 at 12:50)</a>:</h4>
<p>Now <code>leanpkg build</code> has started printing goals and failing without printing any error message</p>

<a name="172501612"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172501612" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172501612">Reid Barton (Aug 05 2019 at 12:51)</a>:</h4>
<p>(not related to that module instance)</p>

<a name="172501618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172501618" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172501618">Kevin Buzzard (Aug 05 2019 at 12:51)</a>:</h4>
<p>reboot your computer??</p>

<a name="172502073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172502073" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172502073">Patrick Massot (Aug 05 2019 at 12:59)</a>:</h4>
<blockquote>
<p>I don't understand how anyone could have written any of this interactively. Did I break everything?</p>
</blockquote>
<p>I noticed it was very slow, but wasn't sure whether it was because I'm using my laptop. Anyway, I was doing the usual sorry dance (every <code>have</code> that is proved is replaced by a commented out proof and sorry).</p>

<a name="172502139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172502139" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172502139">Patrick Massot (Aug 05 2019 at 13:00)</a>:</h4>
<p>I'd love to help refactoring but I'm on beach duty</p>

<a name="172502349"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172502349" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172502349">Reid Barton (Aug 05 2019 at 13:03)</a>:</h4>
<p>I found out how to increase the default memory limit for lean in emacs, so now I can load the whole file again</p>

<a name="172502395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172502395" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172502395">Johan Commelin (Aug 05 2019 at 13:04)</a>:</h4>
<p>Why does Lean not understand what I mean when I write</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">RQ_equiv_V</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="o">(</span><span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span><span class="err">₀</span> <span class="n">ℝ</span><span class="o">)</span> <span class="err">≃ₗ</span><span class="o">[</span><span class="n">ℝ</span><span class="o">]</span> <span class="n">V</span> <span class="n">n</span>
<span class="bp">|</span> <span class="mi">0</span>     <span class="o">:=</span> <span class="bp">_</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">_</span>
</pre></div>

<a name="172502442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172502442" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172502442">Johan Commelin (Aug 05 2019 at 13:04)</a>:</h4>
<p>It takes ages to parse/elaborate/tc this</p>

<a name="172502469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172502469" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172502469">Johan Commelin (Aug 05 2019 at 13:04)</a>:</h4>
<p>Result: 4 deterministic timeouts</p>

<a name="172502491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172502491" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172502491">Rob Lewis (Aug 05 2019 at 13:04)</a>:</h4>
<p>Does adding this before help?</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">Vn_module</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="o">:</span> <span class="n">module</span> <span class="n">ℝ</span> <span class="o">(</span><span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span>
<span class="n">def</span> <span class="n">acg</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="o">:</span> <span class="n">add_comm_semigroup</span> <span class="o">(</span><span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span>
<span class="n">def</span> <span class="n">acm</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="o">:</span> <span class="n">add_comm_monoid</span> <span class="o">(</span><span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span>
<span class="n">def</span> <span class="n">hsr</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="o">:</span> <span class="n">has_scalar</span> <span class="n">ℝ</span> <span class="o">(</span><span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span>
<span class="n">def</span> <span class="n">hav</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="o">:</span> <span class="n">has_add</span> <span class="o">(</span><span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span>

<span class="n">local</span> <span class="n">attribute</span> <span class="o">[</span><span class="kn">instance</span><span class="o">,</span> <span class="n">priority</span> <span class="mi">100000</span><span class="o">]</span> <span class="n">acg</span> <span class="n">acm</span> <span class="n">hsr</span> <span class="n">hav</span> <span class="n">Vn_module</span>
</pre></div>

<a name="172502513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172502513" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172502513">Rob Lewis (Aug 05 2019 at 13:05)</a>:</h4>
<p>I'm timing right now, but it feels like a very significant speedup on the whole file.</p>

<a name="172502538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172502538" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172502538">Rob Lewis (Aug 05 2019 at 13:05)</a>:</h4>
<p>Yeah, those short circuits reduce the compile time by more than 50%.</p>

<a name="172502547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172502547" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172502547">Johan Commelin (Aug 05 2019 at 13:05)</a>:</h4>
<p>Doesn't help for this thing <span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span></p>

<a name="172502615"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172502615" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172502615">Johan Commelin (Aug 05 2019 at 13:06)</a>:</h4>
<p>Btw, should we even use real numbers?</p>

<a name="172502635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172502635" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172502635">Johan Commelin (Aug 05 2019 at 13:06)</a>:</h4>
<p>For this problem <code>nat.sqrt</code> is just as good as <code>real.sqrt</code>, isn't it?</p>

<a name="172502671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172502671" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172502671">Johan Commelin (Aug 05 2019 at 13:07)</a>:</h4>
<p>So we could do the whole thing with <code>ℤ</code>-modules</p>

<a name="172502701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172502701" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172502701">Johan Commelin (Aug 05 2019 at 13:07)</a>:</h4>
<p>Anyway, I don't mind using <code>real</code>.</p>

<a name="172502793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172502793" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172502793">Johan Commelin (Aug 05 2019 at 13:08)</a>:</h4>
<p>Without this <code>RQ_equiv_V</code> I don't think we can get very far with "transfer"-like techniques.</p>

<a name="172503971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172503971" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172503971">Johan Commelin (Aug 05 2019 at 13:24)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span> Have your problems gone away?</p>

<a name="172503985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172503985" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172503985">Reid Barton (Aug 05 2019 at 13:25)</a>:</h4>
<p>Some of them</p>

<a name="172504136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172504136" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172504136">Rob Lewis (Aug 05 2019 at 13:27)</a>:</h4>
<p>Do you have local changes that are causing this? It compiles with <code>-T20000</code> for me, so there shouldn't be any memory issues.</p>

<a name="172504285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172504285" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172504285">Jesse Michael Han (Aug 05 2019 at 13:29)</a>:</h4>
<blockquote>
<p>I don't understand how anyone could have written any of this interactively.</p>
</blockquote>
<p>in the case of <code>degree_theorem</code>, very painfully...</p>
<p>what is this "insert no-op code" magic? do i put a <code>.</code> or <code>run_cmd tactic.skip</code> above the current declaration i'm working on to stop recompilation of previous theorems?</p>

<a name="172504317"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172504317" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172504317">Rob Lewis (Aug 05 2019 at 13:29)</a>:</h4>
<p>The only suspicious thing I see in the profiling is that <code>simp</code> is spending a long time in <code>tactic.join_user_simp_lemmas</code>.</p>

<a name="172504381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172504381" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172504381">Johan Commelin (Aug 05 2019 at 13:30)</a>:</h4>
<p><span class="user-mention" data-user-id="116045">@Jesse Michael Han</span> Yes. <code>.</code> is gold.</p>

<a name="172504848"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172504848" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172504848">Reid Barton (Aug 05 2019 at 13:37)</a>:</h4>
<p>I used to have some local changes but I still had problems when I got rid of them</p>

<a name="172504853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172504853" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172504853">Reid Barton (Aug 05 2019 at 13:37)</a>:</h4>
<p>Is the default memory limit different in VS code maybe?</p>

<a name="172504866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172504866" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172504866">Kevin Buzzard (Aug 05 2019 at 13:38)</a>:</h4>
<p>It's 100000 in VS Code I believe</p>

<a name="172504922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172504922" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172504922">Kevin Buzzard (Aug 05 2019 at 13:38)</a>:</h4>
<p>The T50000 challenge was what happened when I halved it</p>

<a name="172505257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172505257" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172505257">Reid Barton (Aug 05 2019 at 13:44)</a>:</h4>
<p>That's the "time" limit I thought</p>

<a name="172505325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172505325" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172505325">Kevin Buzzard (Aug 05 2019 at 13:44)</a>:</h4>
<p>oh apologies. Memory limit is...</p>

<a name="172505346"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172505346" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172505346">Kevin Buzzard (Aug 05 2019 at 13:45)</a>:</h4>
<p>4096 megs</p>

<a name="172505416"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172505416" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172505416">Reid Barton (Aug 05 2019 at 13:46)</a>:</h4>
<p>Ah okay, that explains some things. In emacs it's 1024 megs</p>

<a name="172505851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172505851" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172505851">Jesse Michael Han (Aug 05 2019 at 13:52)</a>:</h4>
<p>looks like something we should patch in the community version of <code>lean-mode</code></p>
<p>4096 megs and constantly swapping</p>

<a name="172508215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172508215" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172508215">Johan Commelin (Aug 05 2019 at 14:23)</a>:</h4>
<p><span class="user-mention" data-user-id="110596">@Rob Lewis</span> Did you manage to clean things up at the bottom of the file?</p>

<a name="172508269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172508269" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172508269">Johan Commelin (Aug 05 2019 at 14:24)</a>:</h4>
<p>Do we have some sort of "cleaning up" roadmap?</p>

<a name="172508449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172508449" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172508449">Johan Commelin (Aug 05 2019 at 14:26)</a>:</h4>
<p>The reason I wrote my <code>dist</code> function is that I imagined that we might rename <code>Q</code> to <code>hypercube</code> and put it in mathlib, and show that it is a (discrete) metric space, etc....</p>

<a name="172508461"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172508461" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172508461">Johan Commelin (Aug 05 2019 at 14:27)</a>:</h4>
<p>Not sure if we want to do things like that.</p>

<a name="172508517"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172508517" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172508517">Rob Lewis (Aug 05 2019 at 14:28)</a>:</h4>
<p>I got distracted by trying to speed things up. I have no major changes right now.</p>

<a name="172508693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172508693" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172508693">Rob Lewis (Aug 05 2019 at 14:29)</a>:</h4>
<p>But performance-wise, I don't see any more obvious places to optimize. It seems to behave pretty reasonably.</p>

<a name="172508784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172508784" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172508784">Johan Commelin (Aug 05 2019 at 14:30)</a>:</h4>
<p>Can you get the statement of <code>RQ_equiv_V</code> to work?</p>

<a name="172508828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172508828" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172508828">Johan Commelin (Aug 05 2019 at 14:30)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span> What do you think of <span class="user-mention" data-user-id="110031">@Patrick Massot</span>'s suggestion for adjacency?</p>

<a name="172508866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172508866" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172508866">Johan Commelin (Aug 05 2019 at 14:31)</a>:</h4>
<p>It's quite similar to your <code>∃! i, x i ≠ y i</code> suggestion, but it exploits a bit of group structure.</p>

<a name="172510675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172510675" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172510675">Rob Lewis (Aug 05 2019 at 14:56)</a>:</h4>
<p><code>local attribute [instance, priority 10000] finsupp.module classical.prop_decidable</code> makes it work. The decidable instance isn't necessary but it speeds things up a little bit.</p>

<a name="172510693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172510693" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172510693">Rob Lewis (Aug 05 2019 at 14:56)</a>:</h4>
<p>Once again, the type classes here are kind of a mess.</p>

<a name="172510863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172510863" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172510863">Johan Commelin (Aug 05 2019 at 14:58)</a>:</h4>
<p>It's really sad that this creates a mess. It doesn't feel like we are doing something horrible.</p>

<a name="172510880"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172510880" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172510880">Johan Commelin (Aug 05 2019 at 14:58)</a>:</h4>
<p>I just pushed a compression of <code>duality</code>.</p>

<a name="172513475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172513475" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172513475">Jesse Michael Han (Aug 05 2019 at 15:34)</a>:</h4>
<p>i'm working on turning <code>degree_theorem</code> into a <code>calc</code> proof after the existential instantiation of <code>q</code></p>
<p>also thank you johan for the cleanup :^)</p>

<a name="172513679"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172513679" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172513679">Reid Barton (Aug 05 2019 at 15:37)</a>:</h4>
<blockquote>
<p>i'm working on turning <code>degree_theorem</code> into a <code>calc</code> proof after the existential instantiation of <code>q</code></p>
</blockquote>
<p>Oh cool, I wanted to do this as well but currently I'm trying to simplify <code>exists_eigenvalue</code> a bit</p>

<a name="172513830"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172513830" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172513830">Rob Lewis (Aug 05 2019 at 15:40)</a>:</h4>
<p>Have you made any structural changes to <code>exists_eigenvalue</code>? I have a few cosmetic updates local, but nothing important.</p>

<a name="172513907"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172513907" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172513907">Rob Lewis (Aug 05 2019 at 15:40)</a>:</h4>
<p>I won't touch <code>degree_theorem</code> if Jesse is on it now.</p>

<a name="172514103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172514103" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172514103">Reid Barton (Aug 05 2019 at 15:43)</a>:</h4>
<p>I'm trying to do all the conversion between cardinals and naturals at once</p>

<a name="172514393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172514393" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172514393">Reid Barton (Aug 05 2019 at 15:46)</a>:</h4>
<p>Pushed, I think it is somewhat better now...</p>

<a name="172514635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172514635" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172514635">Rob Lewis (Aug 05 2019 at 15:49)</a>:</h4>
<p>Nice.</p>

<a name="172516076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172516076" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172516076">Jesse Michael Han (Aug 05 2019 at 16:07)</a>:</h4>
<p>also pushed my <code>calc</code>ification</p>
<p>not sure what the correct style is for long <code>calc</code> proofs but i tried to prettify it</p>

<a name="172518912"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172518912" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172518912">Johan Commelin (Aug 05 2019 at 16:47)</a>:</h4>
<p>Nice work <span class="user-mention" data-user-id="110032">@Reid Barton</span> and <span class="user-mention" data-user-id="116045">@Jesse Michael Han</span></p>

<a name="172518926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172518926" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172518926">Johan Commelin (Aug 05 2019 at 16:47)</a>:</h4>
<p>I think that maybe we should just use <code>begin ... end</code> instead of <code>by { .. }</code> for the longer proofs in the <code>calc</code> block</p>

<a name="172519036"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172519036" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172519036">Johan Commelin (Aug 05 2019 at 16:49)</a>:</h4>
<p>Of course that's a very minor issue</p>

<a name="172519906"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172519906" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172519906">Reid Barton (Aug 05 2019 at 17:01)</a>:</h4>
<p>Going to head out for a while, but I feel it should somehow be easier to show that <code>l q = ε q y</code></p>

<a name="172520329"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172520329" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172520329">Johan Commelin (Aug 05 2019 at 17:07)</a>:</h4>
<p>Yep... that's the kind of "transfer" thing that I wanted to do</p>

<a name="172520343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172520343" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172520343">Johan Commelin (Aug 05 2019 at 17:07)</a>:</h4>
<p>But showing <code>Q n -&gt;0 R =_l V n</code> is already non-trivial...</p>

<a name="172520395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172520395" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172520395">Johan Commelin (Aug 05 2019 at 17:08)</a>:</h4>
<p>It seems that Rob found a fix.</p>

<a name="172520414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172520414" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172520414">Johan Commelin (Aug 05 2019 at 17:08)</a>:</h4>
<p><span class="user-mention" data-user-id="116045">@Jesse Michael Han</span> what do you think of the following style?</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">degree_theorem</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">q</span><span class="o">,</span> <span class="n">q</span> <span class="err">∈</span> <span class="n">H</span> <span class="bp">∧</span> <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="o">(</span><span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">≤</span> <span class="o">(</span><span class="n">H</span> <span class="err">∩</span> <span class="n">q</span><span class="bp">.</span><span class="n">adjacent</span><span class="o">)</span><span class="bp">.</span><span class="n">to_finset</span><span class="bp">.</span><span class="n">card</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rcases</span> <span class="n">exists_eigenvalue</span> <span class="n">H</span> <span class="err">‹</span><span class="bp">_</span><span class="err">›</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">y</span><span class="o">,</span> <span class="bp">⟨⟨</span><span class="n">H_mem&#39;</span><span class="o">,</span> <span class="n">H_mem&#39;&#39;</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">H_nonzero</span><span class="bp">⟩⟩</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="o">(</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">mem_span_iff_total</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="n">H_mem&#39;</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">l</span><span class="o">,</span> <span class="n">H_l₁</span><span class="o">,</span> <span class="n">H_l₂</span><span class="bp">⟩</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">hHe</span> <span class="o">:</span> <span class="n">H</span> <span class="bp">≠</span> <span class="err">∅</span> <span class="o">,</span>
  <span class="o">{</span> <span class="n">contrapose</span><span class="bp">!</span> <span class="n">hH</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hH</span><span class="o">,</span> <span class="n">set</span><span class="bp">.</span><span class="n">empty_card&#39;</span><span class="o">],</span> <span class="n">exact</span> <span class="n">nat</span><span class="bp">.</span><span class="n">zero_lt_succ</span> <span class="bp">_</span> <span class="o">},</span>
  <span class="k">obtain</span> <span class="bp">⟨</span><span class="n">q</span><span class="o">,</span> <span class="n">H_mem_H</span><span class="o">,</span> <span class="n">H_max</span><span class="bp">⟩</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">q</span><span class="o">,</span> <span class="n">q</span> <span class="err">∈</span> <span class="n">H</span> <span class="bp">∧</span> <span class="bp">∀</span> <span class="n">q&#39;</span><span class="o">,</span> <span class="n">q&#39;</span> <span class="err">∈</span> <span class="n">H</span> <span class="bp">→</span> <span class="n">abs</span> <span class="o">(</span><span class="n">l</span> <span class="n">q&#39;</span><span class="o">)</span> <span class="bp">≤</span> <span class="n">abs</span> <span class="o">(</span><span class="n">l</span> <span class="n">q</span><span class="o">),</span>
  <span class="o">{</span> <span class="n">cases</span> <span class="n">set</span><span class="bp">.</span><span class="n">exists_mem_of_ne_empty</span> <span class="n">hHe</span> <span class="k">with</span> <span class="n">r</span> <span class="n">hr</span><span class="o">,</span>
    <span class="n">cases</span> <span class="bp">@</span><span class="n">finset</span><span class="bp">.</span><span class="n">max_of_mem</span> <span class="bp">_</span> <span class="bp">_</span> <span class="o">(</span><span class="n">H</span><span class="bp">.</span><span class="n">to_finset</span><span class="bp">.</span><span class="n">image</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">q&#39;</span><span class="o">,</span> <span class="n">abs</span> <span class="o">(</span><span class="n">l</span> <span class="n">q&#39;</span><span class="o">)))</span>
      <span class="o">(</span><span class="n">abs</span> <span class="o">(</span><span class="n">l</span> <span class="n">r</span><span class="o">))</span> <span class="o">(</span><span class="n">finset</span><span class="bp">.</span><span class="n">mem_image_of_mem</span> <span class="bp">_</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">mem_to_finset</span><span class="bp">.</span><span class="mi">2</span> <span class="n">hr</span><span class="o">))</span> <span class="k">with</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">rcases</span> <span class="n">finset</span><span class="bp">.</span><span class="n">mem_image</span><span class="bp">.</span><span class="mi">1</span> <span class="o">(</span><span class="n">finset</span><span class="bp">.</span><span class="n">mem_of_max</span> <span class="n">hx</span><span class="o">)</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">q</span><span class="o">,</span> <span class="n">hq</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span><span class="o">,</span>
    <span class="n">refine</span> <span class="bp">⟨</span><span class="n">q</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">set</span><span class="bp">.</span><span class="n">mem_to_finset</span><span class="bp">.</span><span class="mi">1</span> <span class="n">hq</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">q&#39;</span> <span class="n">hq&#39;</span><span class="o">,</span> <span class="bp">_⟩⟩</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">(</span><span class="n">finset</span><span class="bp">.</span><span class="n">le_max_of_mem</span> <span class="o">(</span><span class="n">finset</span><span class="bp">.</span><span class="n">mem_image_of_mem</span> <span class="bp">_</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">mem_to_finset</span><span class="bp">.</span><span class="mi">2</span> <span class="n">hq&#39;</span><span class="o">))</span> <span class="n">hx</span> <span class="o">:</span> <span class="bp">_</span><span class="o">)</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">H_q_pos</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">abs</span> <span class="o">(</span><span class="n">l</span> <span class="n">q</span><span class="o">),</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">abs_pos_iff</span><span class="o">],</span>
    <span class="k">assume</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">mem_supported&#39;</span><span class="o">]</span> <span class="n">at</span> <span class="n">H_l₁</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">H_max&#39;</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">q&#39;</span><span class="o">,</span> <span class="n">l</span> <span class="n">q&#39;</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">intro</span> <span class="n">q&#39;</span><span class="o">,</span>
      <span class="n">by_cases</span> <span class="n">hq&#39;</span> <span class="o">:</span> <span class="n">q&#39;</span> <span class="err">∈</span> <span class="n">H</span><span class="o">,</span>
      <span class="o">{</span> <span class="n">revert</span> <span class="n">q&#39;</span><span class="o">,</span> <span class="n">simpa</span> <span class="o">[</span><span class="n">h</span><span class="o">]</span> <span class="kn">using</span> <span class="n">H_max</span> <span class="o">},</span>
      <span class="o">{</span> <span class="n">exact</span> <span class="n">H_l₁</span> <span class="bp">_</span> <span class="n">hq&#39;</span> <span class="o">}</span> <span class="o">},</span>
    <span class="k">have</span> <span class="n">hl0</span> <span class="o">:</span> <span class="n">l</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">ext</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="n">H_max&#39;</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">zero_apply</span><span class="o">]</span> <span class="o">},</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">hl0</span><span class="o">]</span> <span class="n">at</span> <span class="n">H_l₂</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">H_nonzero</span> <span class="n">H_l₂</span><span class="bp">.</span><span class="n">symm</span> <span class="o">},</span>
  <span class="n">refine</span> <span class="bp">⟨</span><span class="n">q</span><span class="o">,</span> <span class="bp">⟨</span><span class="err">‹</span><span class="bp">_</span><span class="err">›</span><span class="o">,</span> <span class="bp">_⟩⟩</span><span class="o">,</span>
  <span class="n">suffices</span> <span class="o">:</span> <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="o">(</span><span class="err">↑</span><span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="n">abs</span> <span class="o">(</span><span class="n">l</span> <span class="n">q</span><span class="o">)</span> <span class="bp">≤</span> <span class="err">↑</span><span class="o">(</span><span class="bp">_</span><span class="o">)</span> <span class="bp">*</span> <span class="n">abs</span> <span class="o">(</span><span class="n">l</span> <span class="n">q</span><span class="o">),</span>
    <span class="k">by</span> <span class="o">{</span> <span class="n">exact</span> <span class="o">(</span><span class="n">mul_le_mul_right</span> <span class="n">H_q_pos</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="err">‹</span><span class="bp">_</span><span class="err">›</span> <span class="o">},</span>

  <span class="k">calc</span>
    <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="o">(</span><span class="err">↑</span><span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">abs</span> <span class="o">(</span><span class="n">l</span> <span class="n">q</span><span class="o">))</span>
        <span class="bp">≤</span> <span class="n">abs</span> <span class="o">(</span><span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="o">(</span><span class="err">↑</span><span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="n">l</span> <span class="n">q</span><span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">conv_lhs</span> <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">abs_sqrt_nat</span><span class="o">,</span> <span class="err">←</span> <span class="n">abs_mul</span><span class="o">]</span> <span class="o">}</span>
    <span class="bp">...</span> <span class="bp">≤</span> <span class="n">abs</span> <span class="o">(</span><span class="n">ε</span> <span class="n">q</span> <span class="o">(</span><span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="o">(</span><span class="err">↑</span><span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="err">•</span> <span class="n">y</span><span class="o">))</span> <span class="o">:</span>
        <span class="k">begin</span> <span class="n">rw</span> <span class="o">[</span><span class="n">linear_map</span><span class="bp">.</span><span class="n">map_smul</span><span class="o">,</span> <span class="n">smul_eq_mul</span><span class="o">,</span> <span class="n">abs_mul</span><span class="o">,</span> <span class="n">abs_mul</span><span class="o">],</span>
          <span class="n">apply</span> <span class="n">mul_le_mul_of_nonneg_left</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">,</span>
            <span class="o">{</span> <span class="n">apply</span> <span class="n">le_of_eq</span><span class="o">,</span> <span class="n">congr&#39;</span> <span class="mi">1</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">H_l₂</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">total_apply</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">sum</span><span class="o">,</span> <span class="n">linear_map</span><span class="bp">.</span><span class="n">map_sum</span><span class="o">],</span>
              <span class="n">rw</span> <span class="o">[</span><span class="n">finset</span><span class="bp">.</span><span class="n">sum_eq_single</span> <span class="n">q</span><span class="o">],</span>
              <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">linear_map</span><span class="bp">.</span><span class="n">map_smul</span><span class="o">,</span> <span class="n">smul_eq_mul</span><span class="o">,</span> <span class="n">duality</span><span class="o">,</span> <span class="n">if_pos</span> <span class="n">rfl</span><span class="o">,</span> <span class="n">mul_one</span><span class="o">],</span> <span class="o">},</span>
              <span class="o">{</span> <span class="n">intros</span> <span class="n">p</span> <span class="n">hp</span> <span class="n">hne</span><span class="o">,</span>
                <span class="n">simp</span> <span class="o">[</span><span class="n">linear_map</span><span class="bp">.</span><span class="n">map_smul</span><span class="o">,</span> <span class="n">duality</span><span class="o">,</span> <span class="n">hne</span><span class="bp">.</span><span class="n">symm</span><span class="o">]</span> <span class="o">},</span>
              <span class="o">{</span> <span class="n">intro</span> <span class="n">h_q_ne_supp</span><span class="o">,</span>
                <span class="n">simp</span> <span class="o">[</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">not_mem_support_iff</span><span class="bp">.</span><span class="n">mp</span> <span class="n">h_q_ne_supp</span><span class="o">]</span> <span class="o">}</span> <span class="o">},</span>
          <span class="o">{</span> <span class="n">exact</span> <span class="n">abs_nonneg</span> <span class="bp">_</span> <span class="o">}</span>
        <span class="kn">end</span>
    <span class="bp">...</span> <span class="bp">≤</span> <span class="n">l</span><span class="bp">.</span><span class="n">support</span><span class="bp">.</span><span class="n">sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="n">Q</span> <span class="o">(</span><span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">),</span> <span class="n">abs</span> <span class="o">(</span><span class="n">l</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="n">abs</span> <span class="o">((</span><span class="n">ε</span> <span class="n">q</span><span class="o">)</span> <span class="o">((</span><span class="n">f</span> <span class="o">(</span><span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="bp">_</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="n">x</span><span class="o">))))</span> <span class="o">:</span>
        <span class="k">begin</span>
          <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">f_image_g</span> <span class="n">y</span> <span class="o">(</span><span class="k">by</span> <span class="n">simpa</span> <span class="kn">using</span> <span class="n">H_mem&#39;&#39;</span><span class="o">),</span> <span class="err">←</span> <span class="n">H_l₂</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">total_apply</span><span class="o">,</span>
            <span class="n">finsupp</span><span class="bp">.</span><span class="n">sum</span><span class="o">,</span> <span class="n">linear_map</span><span class="bp">.</span><span class="n">map_sum</span><span class="o">,</span> <span class="n">linear_map</span><span class="bp">.</span><span class="n">map_sum</span><span class="o">],</span>
          <span class="n">refine</span> <span class="n">le_trans</span> <span class="n">abs_triangle_sum</span> <span class="bp">_</span><span class="o">,</span>
          <span class="n">conv_lhs</span> <span class="o">{</span> <span class="n">congr</span><span class="o">,</span> <span class="n">skip</span><span class="o">,</span> <span class="n">simp</span> <span class="o">[</span><span class="n">abs_mul</span><span class="o">]</span> <span class="o">}</span>
        <span class="kn">end</span>
    <span class="bp">...</span> <span class="bp">≤</span> <span class="n">finset</span><span class="bp">.</span><span class="n">sum</span> <span class="o">(</span><span class="n">l</span><span class="bp">.</span><span class="n">support</span> <span class="err">∩</span> <span class="n">set</span><span class="bp">.</span><span class="n">to_finset</span> <span class="n">H</span> <span class="err">∩</span> <span class="n">set</span><span class="bp">.</span><span class="n">to_finset</span> <span class="o">(</span><span class="n">Q</span><span class="bp">.</span><span class="n">adjacent</span> <span class="n">q</span><span class="o">))</span>
            <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">Q</span> <span class="o">(</span><span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)),</span> <span class="n">abs</span> <span class="o">(</span><span class="n">l</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="n">abs</span> <span class="o">((</span><span class="n">ε</span> <span class="n">q</span><span class="o">)</span> <span class="o">((</span><span class="n">f</span> <span class="o">(</span><span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="bp">_</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="n">x</span><span class="o">))))</span> <span class="o">:</span>
        <span class="k">begin</span>
          <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">finset</span><span class="bp">.</span><span class="n">sum_subset</span><span class="o">],</span>
          <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">Hx</span><span class="o">,</span> <span class="n">simp</span><span class="o">[</span><span class="bp">-</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">mem_support_iff</span><span class="o">]</span> <span class="n">at</span> <span class="n">Hx</span><span class="o">,</span> <span class="n">exact</span> <span class="n">Hx</span><span class="bp">.</span><span class="n">left</span> <span class="o">},</span>
          <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">H_mem</span> <span class="n">H_not_mem</span><span class="o">,</span>
            <span class="n">by_cases</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">H</span><span class="o">,</span>
              <span class="o">{</span> <span class="n">simp</span> <span class="n">at</span> <span class="n">H_mem</span> <span class="n">H_not_mem</span><span class="o">,</span> <span class="n">rw</span><span class="o">[</span><span class="n">f_matrix</span><span class="o">],</span> <span class="k">have</span> <span class="o">:=</span> <span class="o">(</span><span class="n">H_not_mem</span> <span class="err">‹</span><span class="bp">_</span><span class="err">›</span> <span class="err">‹</span><span class="bp">_</span><span class="err">›</span><span class="o">),</span>
                <span class="n">change</span> <span class="bp">¬</span> <span class="n">Q</span><span class="bp">.</span><span class="n">adjacent</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span> <span class="n">simp</span> <span class="o">[</span><span class="n">Q</span><span class="bp">.</span><span class="n">adjacent_comm</span><span class="o">,</span> <span class="n">this</span><span class="o">]</span> <span class="o">},</span>
              <span class="o">{</span> <span class="n">suffices</span> <span class="o">:</span> <span class="o">(</span><span class="n">l</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span> <span class="k">by</span> <span class="o">{</span><span class="n">simp</span> <span class="o">[</span><span class="n">this</span><span class="o">]},</span>
                <span class="n">rw</span> <span class="o">[</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">mem_supported&#39;</span><span class="o">]</span> <span class="n">at</span> <span class="n">H_l₁</span><span class="o">,</span> <span class="n">exact</span> <span class="n">H_l₁</span> <span class="bp">_</span> <span class="err">‹</span><span class="bp">_</span><span class="err">›</span> <span class="o">}</span> <span class="o">}</span>
        <span class="kn">end</span>
    <span class="bp">...</span> <span class="bp">≤</span> <span class="err">↑</span><span class="o">(</span><span class="n">finset</span><span class="bp">.</span><span class="n">card</span> <span class="o">(</span><span class="n">l</span><span class="bp">.</span><span class="n">support</span> <span class="err">∩</span> <span class="n">set</span><span class="bp">.</span><span class="n">to_finset</span> <span class="n">H</span> <span class="err">∩</span> <span class="n">set</span><span class="bp">.</span><span class="n">to_finset</span> <span class="o">(</span><span class="n">Q</span><span class="bp">.</span><span class="n">adjacent</span> <span class="n">q</span><span class="o">)))</span> <span class="bp">*</span> <span class="n">abs</span> <span class="o">(</span><span class="n">l</span> <span class="n">q</span><span class="o">)</span> <span class="o">:</span>
        <span class="k">begin</span>
          <span class="n">refine</span> <span class="n">le_trans</span> <span class="o">(</span><span class="n">finset</span><span class="bp">.</span><span class="n">sum_le_sum</span> <span class="bp">_</span><span class="o">)</span> <span class="bp">_</span><span class="o">,</span>
          <span class="o">{</span> <span class="n">exact</span> <span class="bp">λ</span> <span class="n">p</span><span class="o">,</span> <span class="n">abs</span> <span class="o">(</span><span class="n">l</span> <span class="n">q</span><span class="o">)</span> <span class="o">},</span>
          <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">Hx</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="n">f_matrix</span><span class="o">],</span> <span class="n">simp</span> <span class="n">at</span> <span class="n">Hx</span><span class="o">,</span>
            <span class="k">have</span> <span class="o">:=</span> <span class="n">Hx</span><span class="bp">.</span><span class="n">right</span><span class="bp">.</span><span class="n">right</span><span class="o">,</span> <span class="n">change</span> <span class="n">Q</span><span class="bp">.</span><span class="n">adjacent</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
            <span class="n">rw</span> <span class="o">[</span><span class="n">if_pos</span> <span class="n">this</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span> <span class="n">mul_one</span><span class="o">],</span> <span class="n">exact</span> <span class="n">H_max</span> <span class="n">x</span> <span class="n">Hx</span><span class="bp">.</span><span class="mi">2</span><span class="bp">.</span><span class="mi">1</span> <span class="o">},</span>
          <span class="o">{</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">mul_one</span><span class="o">,</span> <span class="n">finset</span><span class="bp">.</span><span class="n">sum_const</span><span class="o">,</span> <span class="n">add_monoid</span><span class="bp">.</span><span class="n">smul_one</span><span class="o">,</span> <span class="n">add_monoid</span><span class="bp">.</span><span class="n">smul_eq_mul</span><span class="o">]</span> <span class="o">}</span>
        <span class="kn">end</span>
    <span class="bp">...</span> <span class="bp">≤</span> <span class="err">↑</span><span class="o">(</span><span class="n">finset</span><span class="bp">.</span><span class="n">card</span> <span class="o">(</span><span class="n">set</span><span class="bp">.</span><span class="n">to_finset</span> <span class="o">(</span><span class="n">H</span> <span class="err">∩</span> <span class="n">Q</span><span class="bp">.</span><span class="n">adjacent</span> <span class="n">q</span><span class="o">)))</span> <span class="bp">*</span> <span class="n">abs</span> <span class="o">(</span><span class="n">l</span> <span class="n">q</span><span class="o">)</span> <span class="o">:</span>
        <span class="k">begin</span>
          <span class="n">refine</span> <span class="o">(</span><span class="n">mul_le_mul_right</span> <span class="err">‹</span><span class="bp">_</span><span class="err">›</span><span class="o">)</span><span class="bp">.</span><span class="n">mpr</span> <span class="bp">_</span><span class="o">,</span> <span class="n">norm_cast</span><span class="o">,</span>
          <span class="n">refine</span> <span class="n">finset</span><span class="bp">.</span><span class="n">card_le_of_subset</span> <span class="o">(</span><span class="n">finset</span><span class="bp">.</span><span class="n">coe_subset</span><span class="bp">.</span><span class="n">mp</span> <span class="bp">_</span><span class="o">),</span>
          <span class="n">simpa</span> <span class="n">only</span> <span class="o">[</span><span class="n">finset</span><span class="bp">.</span><span class="n">coe_inter</span><span class="o">,</span> <span class="n">finset</span><span class="bp">.</span><span class="n">coe_to_finset&#39;</span><span class="o">,</span> <span class="n">set</span><span class="bp">.</span><span class="n">inter_assoc</span><span class="o">]</span>
            <span class="kn">using</span> <span class="n">set</span><span class="bp">.</span><span class="n">inter_subset_right</span> <span class="bp">_</span> <span class="bp">_</span>
        <span class="kn">end</span>
<span class="kn">end</span>
</pre></div>

<a name="172520713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172520713" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172520713">Rob Lewis (Aug 05 2019 at 17:13)</a>:</h4>
<p>A fix to what? I'm playing around with changing the definition of <code>adjacent</code> right now.</p>

<a name="172521526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172521526" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172521526">Johan Commelin (Aug 05 2019 at 17:24)</a>:</h4>
<p>Oh, to Lean not parsing <code>RQ_equiv_V</code>.</p>

<a name="172521540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172521540" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172521540">Johan Commelin (Aug 05 2019 at 17:25)</a>:</h4>
<p>So I'll get back to filling in that definition now.</p>

<a name="172521550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172521550" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172521550">Johan Commelin (Aug 05 2019 at 17:25)</a>:</h4>
<p><span class="user-mention" data-user-id="110596">@Rob Lewis</span> What do you propose as new definition of <code>adjacent</code>?</p>

<a name="172521747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172521747" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172521747">Rob Lewis (Aug 05 2019 at 17:27)</a>:</h4>
<p>I was hoping <code>def adjacent {n : ℕ} (p : Q n) : set (Q n) := λ q, ∃! i, p i ≠ q i</code> would simplify things a bit. It basically exchanges the difficulty of <code>adjacent_iff_dist</code> for <code>adjacent_succ_iff</code> though.</p>

<a name="172521860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172521860" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172521860">Rob Lewis (Aug 05 2019 at 17:28)</a>:</h4>
<p>My (not quite complete) proof of <code>adjacent_succ_iff</code> is a bit longer but arguably a bit simpler, and I don't think it's optimized.</p>

<a name="172523213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172523213" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172523213">Johan Commelin (Aug 05 2019 at 17:45)</a>:</h4>
<p>For some reason</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">equiv_unique</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">unique</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">discrete_field</span> <span class="n">β</span><span class="o">]</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">α</span> <span class="bp">→</span><span class="err">₀</span> <span class="n">β</span><span class="o">)</span> <span class="err">≃ₗ</span><span class="o">[</span><span class="n">β</span><span class="o">]</span> <span class="n">β</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">f</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">default</span> <span class="n">α</span><span class="o">),</span>
  <span class="n">inv_fun</span> <span class="o">:=</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">single</span> <span class="o">(</span><span class="n">default</span> <span class="n">α</span><span class="o">),</span>
  <span class="n">add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">add_apply</span><span class="o">,</span>
  <span class="n">smul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">b</span> <span class="n">f</span><span class="o">,</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">left_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">f</span><span class="o">,</span> <span class="o">(</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">unique_single</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span>
  <span class="n">right_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">b</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">single_eq_same</span> <span class="o">}</span>
</pre></div>


<p>is also extremely slow.</p>

<a name="172523345"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172523345" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172523345">Johan Commelin (Aug 05 2019 at 17:47)</a>:</h4>
<p>And if I change <code>discrete_field</code> to <code>comm_ring</code> it doesn't find <code>add_comm_group</code> for the LHS.</p>

<a name="172523365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172523365" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172523365">Johan Commelin (Aug 05 2019 at 17:47)</a>:</h4>
<p>Even after importing <code>algebra.pi_instances</code></p>

<a name="172523454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172523454" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172523454">Jesse Michael Han (Aug 05 2019 at 17:48)</a>:</h4>
<p>yeah that looks good</p>
<p>my original version actually had <code>begin .. end</code> instead of <code>by {}</code> as well, but i thought that mathlib style forbids nested <code>begin end</code> blocks</p>

<a name="172523614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172523614" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172523614">Johan Commelin (Aug 05 2019 at 17:51)</a>:</h4>
<p>What's this??</p>
<div class="codehilite"><pre><span></span><span class="n">equation</span> <span class="n">type</span> <span class="n">mismatch</span><span class="o">,</span> <span class="n">term</span>
  <span class="n">equiv_unique</span> <span class="o">(</span><span class="n">Q</span> <span class="mi">0</span><span class="o">)</span> <span class="n">ℝ</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="o">(</span><span class="n">Q</span> <span class="mi">0</span> <span class="bp">→</span><span class="err">₀</span> <span class="n">ℝ</span><span class="o">)</span> <span class="err">≃ₗ</span><span class="o">[</span><span class="n">ℝ</span><span class="o">]</span> <span class="n">ℝ</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="o">(</span><span class="n">Q</span> <span class="mi">0</span> <span class="bp">→</span><span class="err">₀</span> <span class="n">ℝ</span><span class="o">)</span> <span class="err">≃ₗ</span><span class="o">[</span><span class="n">ℝ</span><span class="o">]</span> <span class="n">V</span> <span class="mi">0</span>
</pre></div>

<a name="172523625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172523625" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172523625">Johan Commelin (Aug 05 2019 at 17:51)</a>:</h4>
<p><code>V 0</code> is defeq to <code>real</code>.</p>

<a name="172523637"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172523637" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172523637">Johan Commelin (Aug 05 2019 at 17:51)</a>:</h4>
<p>Why doesn't it see that?</p>

<a name="172523934"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172523934" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172523934">Chris Hughes (Aug 05 2019 at 17:55)</a>:</h4>
<p>Is the module structure defeq?</p>

<a name="172524025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172524025" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172524025">Johan Commelin (Aug 05 2019 at 17:56)</a>:</h4>
<p>I think so.</p>

<a name="172524029"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172524029" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172524029">Rob Lewis (Aug 05 2019 at 17:56)</a>:</h4>
<p><a href="https://github.com/leanprover-community/lean-sensitivity/tree/new_adj" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/tree/new_adj">https://github.com/leanprover-community/lean-sensitivity/tree/new_adj</a></p>

<a name="172524053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172524053" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172524053">Johan Commelin (Aug 05 2019 at 17:57)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">noncomputable</span> <span class="kn">instance</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">n</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">nat</span><span class="bp">.</span><span class="n">rec</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">dunfold</span> <span class="n">V</span><span class="o">,</span> <span class="n">apply_instance</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">introsI</span> <span class="n">n</span> <span class="n">IH</span><span class="o">,</span> <span class="n">dunfold</span> <span class="n">V</span><span class="o">,</span> <span class="n">apply_instance</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="n">noncomputable</span> <span class="kn">instance</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">n</span><span class="o">,</span> <span class="n">vector_space</span> <span class="n">ℝ</span> <span class="o">(</span><span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">nat</span><span class="bp">.</span><span class="n">rec</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">dunfold</span> <span class="n">V</span><span class="o">,</span> <span class="n">apply_instance</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">introsI</span> <span class="n">n</span> <span class="n">IH</span><span class="o">,</span> <span class="n">dunfold</span> <span class="n">V</span><span class="o">,</span> <span class="n">apply_instance</span> <span class="o">}</span>
<span class="kn">end</span>
</pre></div>

<a name="172524059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172524059" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172524059">Rob Lewis (Aug 05 2019 at 17:57)</a>:</h4>
<p>Not thrilled with the proof of <code>adjacent_succ_iff</code>. I'm not sure this is an improvement.</p>

<a name="172524092"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172524092" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172524092">Rob Lewis (Aug 05 2019 at 17:57)</a>:</h4>
<p>But I need to head home and eat dinner now.</p>

<a name="172531037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172531037" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172531037">Johan Commelin (Aug 05 2019 at 19:31)</a>:</h4>
<p>I pushed another cleanup of degree_theorem</p>

<a name="172531092"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172531092" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172531092">Johan Commelin (Aug 05 2019 at 19:32)</a>:</h4>
<p>Maybe some parts at the top of the proof should be factored out into separate lemmas.</p>

<a name="172536361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172536361" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172536361">Floris van Doorn (Aug 05 2019 at 20:41)</a>:</h4>
<p>(deleted - wrong topic)</p>

<a name="172548535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172548535" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172548535">Patrick Massot (Aug 05 2019 at 23:53)</a>:</h4>
<p>Who could try to add the following lines after the definition of epsilon, and see if the commented lines timeout?</p>
<div class="codehilite"><pre><span></span><span class="kn">variables</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">V</span> <span class="n">n</span><span class="o">)</span>
<span class="n">local</span> <span class="kn">notation</span> <span class="bp">`</span><span class="err">Ψ</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">equiv_fun_on_fintype</span><span class="bp">.</span><span class="n">inv_fun</span>

<span class="c">/-</span><span class="cm"></span>
<span class="cm">This following fails with `by apply_instance`, but defining it doesn&#39;t seem to help.</span>
<span class="cm">instance tata : vector_space ℝ (Q n →₀ ℝ) :=</span>
<span class="cm">{..finsupp.module (Q n) ℝ, .. }</span>
<span class="cm"> -/</span>

<span class="n">def</span> <span class="n">coeffs</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span><span class="err">₀</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="err">Ψ</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">p</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span><span class="o">,</span> <span class="n">ε</span> <span class="n">p</span> <span class="n">v</span><span class="o">)</span>
<span class="n">def</span> <span class="n">somme</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:=</span> <span class="o">(</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">total</span> <span class="o">(</span><span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="n">ℝ</span> <span class="n">e</span><span class="o">)</span>

<span class="bp">#</span><span class="kn">check</span> <span class="n">coeffs</span> <span class="n">v</span> <span class="c1">-- coeffs v : Q n →₀ ℝ</span>
<span class="bp">#</span><span class="kn">check</span> <span class="bp">@</span><span class="n">somme</span> <span class="n">n</span>  <span class="c1">-- somme : (Q n →₀ ℝ) →ₗ[ℝ] V n</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">linear_map</span><span class="bp">.</span><span class="n">to_fun</span> <span class="n">somme</span>  <span class="c1">-- somme.to_fun : (Q ?M_1 →₀ ℝ) → V ?M_1</span>

<span class="c1">-- The following lines timeout</span>
<span class="c1">--#check linear_map.to_fun somme (coeffs v)</span>
<span class="c1">--#check linear_map.to_fun (@somme n)</span>
<span class="c1">--#check (Q n →₀ ℝ) →ₗ[ℝ] V n</span>
</pre></div>

<a name="172548714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172548714" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172548714">Patrick Massot (Aug 05 2019 at 23:57)</a>:</h4>
<p>Independently of this, I still think that the way we prove <code>e</code> is a basis is not optimal. What we really care about is the decomposition of vectors <code>v : V n</code> as a sum over <code>p</code> in <code>Q n</code> of <code>(ε p v) • (e p)</code> (the issues above were met while trying to write down this formula using the linear algebra library). In our current proof of the main theorem, this formula is somewhat hidden, because we use the fact <code>e</code> is  a basis to get a mysterious sequence of coefficients unrelated to <code>ε</code>. One improvement could be to prove <code>ε</code> is equal to <code>dual_basis e</code> and use stuff in <code>dual.lean</code>. But we could just as well directly prove the decomposition formula</p>

<a name="172548715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172548715" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172548715">Patrick Massot (Aug 05 2019 at 23:57)</a>:</h4>
<p>The key is:</p>

<a name="172548728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172548728" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172548728">Patrick Massot (Aug 05 2019 at 23:57)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">epsilon_total</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">{</span><span class="n">v</span> <span class="o">:</span> <span class="n">V</span> <span class="n">n</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">p</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span><span class="o">,</span> <span class="o">(</span><span class="n">ε</span> <span class="n">p</span><span class="o">)</span> <span class="n">v</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="n">v</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">ih</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">dsimp</span> <span class="o">[</span><span class="n">ε</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span> <span class="n">exact</span> <span class="n">h</span> <span class="o">(</span><span class="bp">λ</span> <span class="bp">_</span><span class="o">,</span> <span class="n">tt</span><span class="o">)</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">cases</span> <span class="n">v</span> <span class="k">with</span> <span class="n">v₁</span> <span class="n">v₂</span><span class="o">,</span>
    <span class="n">ext</span> <span class="bp">;</span> <span class="n">change</span> <span class="bp">_</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="bp">;</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[]</span> <span class="bp">;</span> <span class="n">apply</span> <span class="n">ih</span> <span class="bp">;</span> <span class="n">intro</span> <span class="n">p</span> <span class="bp">;</span>
    <span class="o">[</span> <span class="k">let</span> <span class="n">q</span> <span class="o">:</span> <span class="n">Q</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="k">if</span> <span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">0</span> <span class="k">then</span> <span class="n">tt</span> <span class="k">else</span> <span class="n">p</span> <span class="o">(</span><span class="n">i</span><span class="bp">.</span><span class="n">pred</span> <span class="n">h</span><span class="o">),</span>
      <span class="k">let</span> <span class="n">q</span> <span class="o">:</span> <span class="n">Q</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="k">if</span> <span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">0</span> <span class="k">then</span> <span class="n">ff</span> <span class="k">else</span> <span class="n">p</span> <span class="o">(</span><span class="n">i</span><span class="bp">.</span><span class="n">pred</span> <span class="n">h</span><span class="o">)],</span>
    <span class="n">all_goals</span> <span class="o">{</span>
      <span class="n">specialize</span> <span class="n">h</span> <span class="n">q</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">ε</span><span class="o">,</span> <span class="k">show</span> <span class="n">q</span> <span class="mi">0</span> <span class="bp">=</span> <span class="n">tt</span><span class="o">,</span> <span class="k">from</span> <span class="n">rfl</span><span class="o">,</span> <span class="n">cond_tt</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span> <span class="bp">&lt;|&gt;</span> <span class="n">rw</span> <span class="o">[</span><span class="n">ε</span><span class="o">,</span> <span class="k">show</span> <span class="n">q</span> <span class="mi">0</span> <span class="bp">=</span> <span class="n">ff</span><span class="o">,</span> <span class="k">from</span> <span class="n">rfl</span><span class="o">,</span> <span class="n">cond_ff</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
      <span class="n">rwa</span> <span class="k">show</span> <span class="n">p</span> <span class="bp">=</span> <span class="n">q</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">,</span> <span class="k">by</span> <span class="o">{</span> <span class="n">ext</span><span class="o">,</span> <span class="n">simp</span> <span class="o">[</span><span class="n">q</span><span class="o">,</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ_ne_zero</span><span class="o">]</span> <span class="o">}</span> <span class="o">}</span> <span class="o">}</span>
<span class="kn">end</span>
</pre></div>

<a name="172548788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172548788" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172548788">Patrick Massot (Aug 05 2019 at 23:58)</a>:</h4>
<p>Which we can apply to a vector minus its intended decomposition (using the duality lemma).</p>

<a name="172548821"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172548821" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172548821">Patrick Massot (Aug 05 2019 at 23:59)</a>:</h4>
<p>If we insist on keeping that <code>e</code> is a basis then the above lemma (together with the duality lemma) reproves it</p>

<a name="172548827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172548827" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172548827">Patrick Massot (Aug 05 2019 at 23:59)</a>:</h4>
<p>(this is all assuming we can use lemmas about sums over finsupp...)</p>

<a name="172549034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172549034" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172549034">Patrick Massot (Aug 06 2019 at 00:02)</a>:</h4>
<p>Another thing that is surprisingly painful is the proof of <code>have H_q_pos : 0 &lt; abs (l q),</code> in the main theorem. I think we should use that <code>fintype.normed_group</code> is using the supremum norm. So <code>abs (l q)</code> is actually the norm of <code>y</code>, hence positive using <code>norm_pos_iff</code></p>

<a name="172549151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172549151" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172549151">Patrick Massot (Aug 06 2019 at 00:05)</a>:</h4>
<p>And then I think the big calc at the end should have more steps and use more general lemmas about linear maps and dual bases.</p>

<a name="172585870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172585870" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172585870">Rob Lewis (Aug 06 2019 at 13:03)</a>:</h4>
<p>I didn't think of a nice way to optimize the proof of <code>adj_succ_iff</code> with the "exists unique" definition of adjacent. But I did notice that the detour through <code>dist</code> is completely unnecessary. This is all we need about <code>adjacent</code>:</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">adjacent</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">},</span> <span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span> <span class="o">(</span><span class="n">set</span> <span class="err">$</span> <span class="n">Q</span> <span class="n">n</span><span class="o">)</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="n">p</span> <span class="n">q</span> <span class="o">:=</span> <span class="n">false</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="n">p</span> <span class="n">q</span> <span class="o">:=</span> <span class="o">(</span><span class="n">p</span> <span class="mi">0</span> <span class="bp">=</span> <span class="n">q</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">adjacent</span> <span class="o">(</span><span class="n">p</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span> <span class="o">(</span><span class="n">q</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">))</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">p</span> <span class="mi">0</span> <span class="bp">≠</span> <span class="n">q</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">p</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span> <span class="bp">=</span> <span class="n">q</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span>

<span class="kn">lemma</span> <span class="n">adjacent</span><span class="bp">.</span><span class="n">symm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span><span class="o">},</span> <span class="n">p</span><span class="bp">.</span><span class="n">adjacent</span> <span class="n">q</span> <span class="bp">→</span> <span class="n">q</span><span class="bp">.</span><span class="n">adjacent</span> <span class="n">p</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="n">p</span> <span class="n">q</span> <span class="o">(</span><span class="n">or</span><span class="bp">.</span><span class="n">inl</span> <span class="bp">⟨</span><span class="n">h_eq</span><span class="o">,</span> <span class="n">h_adj</span><span class="bp">⟩</span><span class="o">)</span> <span class="o">:=</span> <span class="n">or</span><span class="bp">.</span><span class="n">inl</span> <span class="bp">⟨</span><span class="n">h_eq</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span> <span class="n">h_adj</span><span class="bp">.</span><span class="n">symm</span><span class="bp">⟩</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="n">p</span> <span class="n">q</span> <span class="o">(</span><span class="n">or</span><span class="bp">.</span><span class="n">inr</span> <span class="bp">⟨</span><span class="n">h_ne</span><span class="o">,</span> <span class="n">h_eq</span><span class="bp">⟩</span><span class="o">)</span> <span class="o">:=</span> <span class="n">or</span><span class="bp">.</span><span class="n">inr</span> <span class="bp">⟨</span><span class="n">h_ne</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span> <span class="n">h_eq</span><span class="bp">.</span><span class="n">symm</span><span class="bp">⟩</span>

<span class="kn">lemma</span> <span class="n">adjacent_comm</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span><span class="o">}</span> <span class="o">:</span> <span class="n">p</span><span class="bp">.</span><span class="n">adjacent</span> <span class="n">q</span> <span class="bp">↔</span> <span class="n">q</span><span class="bp">.</span><span class="n">adjacent</span> <span class="n">p</span> <span class="o">:=</span>
<span class="bp">⟨</span><span class="n">adjacent</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span> <span class="n">adjacent</span><span class="bp">.</span><span class="n">symm</span><span class="bp">⟩</span>

<span class="kn">lemma</span> <span class="n">adjacent_succ_iff</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">Q</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)}</span> <span class="o">:</span>
  <span class="n">p</span><span class="bp">.</span><span class="n">adjacent</span> <span class="n">q</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">p</span> <span class="mi">0</span> <span class="bp">=</span> <span class="n">q</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">adjacent</span> <span class="o">(</span><span class="n">p</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span> <span class="o">(</span><span class="n">q</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">))</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">p</span> <span class="mi">0</span> <span class="bp">≠</span> <span class="n">q</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">p</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span> <span class="bp">=</span> <span class="n">q</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">iff</span><span class="bp">.</span><span class="n">refl</span> <span class="bp">_</span>

<span class="kn">lemma</span> <span class="n">not_adjacent_zero</span> <span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">Q</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="bp">¬</span> <span class="n">p</span><span class="bp">.</span><span class="n">adjacent</span> <span class="n">q</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">rintros</span> <span class="bp">⟨</span><span class="n">v</span><span class="o">,</span> <span class="bp">_⟩;</span> <span class="n">apply</span> <span class="n">fin_zero_elim</span> <span class="n">v</span>
</pre></div>


<p>Using an inductive prop for <code>adjacent</code> looks very slightly cleaner, I think, but forces some packing and unpacking in <code>adjacent_succ_iff</code>.</p>
<div class="codehilite"><pre><span></span><span class="kn">inductive</span> <span class="n">adjacent</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">n</span><span class="o">},</span> <span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span> <span class="kt">Prop</span>
<span class="bp">|</span> <span class="n">zero</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">Q</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)}</span> <span class="o">:</span> <span class="n">p</span> <span class="mi">0</span> <span class="bp">≠</span> <span class="n">q</span> <span class="mi">0</span> <span class="bp">→</span> <span class="n">p</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span> <span class="bp">=</span> <span class="n">q</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span> <span class="bp">→</span> <span class="n">adjacent</span> <span class="n">p</span> <span class="n">q</span>
<span class="bp">|</span> <span class="n">nonzero</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">Q</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)}</span> <span class="o">:</span> <span class="n">p</span> <span class="mi">0</span> <span class="bp">=</span> <span class="n">q</span> <span class="mi">0</span> <span class="bp">→</span> <span class="n">adjacent</span> <span class="o">(</span><span class="n">p</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span> <span class="o">(</span><span class="n">q</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span> <span class="bp">→</span> <span class="n">adjacent</span> <span class="n">p</span> <span class="n">q</span>
</pre></div>

<a name="172585963"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172585963" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172585963">Patrick Massot (Aug 06 2019 at 13:04)</a>:</h4>
<p>I'm currently playing with this <code>adjacent_succ_iff</code> thing</p>

<a name="172585982"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172585982" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172585982">Patrick Massot (Aug 06 2019 at 13:04)</a>:</h4>
<p>Using my proposed definition of <code>adjacent</code></p>

<a name="172585988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172585988" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172585988">Rob Lewis (Aug 06 2019 at 13:05)</a>:</h4>
<p>Which definition is that?</p>

<a name="172586000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172586000" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172586000">Patrick Massot (Aug 06 2019 at 13:05)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="c">/-</span><span class="cm">- `flip i p` flips the i-th bit of p -/</span>
<span class="n">def</span> <span class="n">flip</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">Q</span> <span class="n">n</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">p</span> <span class="n">k</span><span class="o">,</span> <span class="k">if</span> <span class="n">i</span> <span class="bp">=</span> <span class="n">k</span> <span class="k">then</span> <span class="n">bnot</span> <span class="o">(</span><span class="n">p</span> <span class="n">k</span><span class="o">)</span> <span class="k">else</span> <span class="n">p</span> <span class="n">k</span>

<span class="n">def</span> <span class="n">adjacent</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span> <span class="o">(</span><span class="n">set</span> <span class="err">$</span> <span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">p</span><span class="o">,</span> <span class="o">{</span><span class="n">q</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="n">n</span><span class="o">,</span> <span class="n">q</span> <span class="bp">=</span> <span class="n">flip</span> <span class="n">i</span> <span class="n">p</span><span class="o">}</span>
</pre></div>

<a name="172586020"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172586020" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172586020">Patrick Massot (Aug 06 2019 at 13:05)</a>:</h4>
<p>This is my proposal but still phrased in terms of bool rather than Z/2</p>

<a name="172586089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172586089" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172586089">Patrick Massot (Aug 06 2019 at 13:06)</a>:</h4>
<p>I think this is a pretty clean definition, very close to what you would say when explaining the statement</p>

<a name="172586184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172586184" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172586184">Patrick Massot (Aug 06 2019 at 13:07)</a>:</h4>
<p>But I'm not claiming it makes the proof of <code>adjacent_succ_iff</code> as short as we'd like it to be</p>

<a name="172586273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172586273" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172586273">Patrick Massot (Aug 06 2019 at 13:08)</a>:</h4>
<p>(deleted)</p>

<a name="172591951"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172591951" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172591951">Patrick Massot (Aug 06 2019 at 14:11)</a>:</h4>
<p>I returned to this and finished this proof. I add the following trivial preliminaries:</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">ne_iff_eq_bnot</span> <span class="o">{</span><span class="n">b</span> <span class="n">b&#39;</span> <span class="o">:</span> <span class="n">bool</span><span class="o">}</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">≠</span> <span class="n">b&#39;</span> <span class="bp">↔</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">bnot</span> <span class="n">b&#39;</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">cases</span> <span class="n">b</span> <span class="bp">;</span> <span class="n">cases</span> <span class="n">b&#39;</span> <span class="bp">;</span> <span class="n">simp</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span>
<span class="kn">lemma</span> <span class="n">not_eq_bnot</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">b</span> <span class="o">:</span> <span class="n">bool</span><span class="o">,</span> <span class="bp">¬</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">bnot</span> <span class="n">b</span>
<span class="bp">|</span> <span class="n">tt</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">bool</span><span class="bp">.</span><span class="n">no_confusion</span> <span class="n">h</span>
<span class="bp">|</span> <span class="n">ff</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">bool</span><span class="bp">.</span><span class="n">no_confusion</span> <span class="n">h</span>

<span class="kn">lemma</span> <span class="n">fin</span><span class="bp">.</span><span class="n">eq_succ_iff_pred_eq</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">{</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">fin</span> <span class="n">n</span><span class="o">}</span>
<span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">=</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span> <span class="n">l</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">fin</span><span class="bp">.</span><span class="n">pred</span> <span class="n">i</span> <span class="n">h</span> <span class="bp">=</span> <span class="n">l</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">split</span> <span class="bp">;</span> <span class="n">intro</span> <span class="n">H</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">H</span><span class="o">,</span> <span class="n">h</span><span class="o">,</span> <span class="n">fin</span><span class="bp">.</span><span class="n">pred_succ</span><span class="o">]</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">H</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ_pred</span><span class="o">]</span> <span class="o">}</span>
<span class="kn">end</span>
</pre></div>

<a name="172592101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172592101" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172592101">Patrick Massot (Aug 06 2019 at 14:13)</a>:</h4>
<p>And then the adjacency stuff becomes:</p>
<div class="codehilite"><pre><span></span><span class="c">/-</span><span class="cm">- `flip i p` flips the i-th bit of p -/</span>
<span class="n">def</span> <span class="n">flip</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">Q</span> <span class="n">n</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">p</span> <span class="n">k</span><span class="o">,</span> <span class="k">if</span> <span class="n">i</span> <span class="bp">=</span> <span class="n">k</span> <span class="k">then</span> <span class="n">bnot</span> <span class="o">(</span><span class="n">p</span> <span class="n">k</span><span class="o">)</span> <span class="k">else</span> <span class="n">p</span> <span class="n">k</span>

<span class="c">/-</span><span class="cm">- The adjacency relation on Q^n: two vertices of the hypercube are adjacent if they differ at one bit. -/</span>
<span class="n">def</span> <span class="n">adjacent</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span> <span class="o">(</span><span class="n">set</span> <span class="err">$</span> <span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">p</span><span class="o">,</span> <span class="o">{</span><span class="n">q</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="n">n</span><span class="o">,</span> <span class="n">q</span> <span class="bp">=</span> <span class="n">flip</span> <span class="n">i</span> <span class="n">p</span><span class="o">}</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">not_adjacent_zero</span> <span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">Q</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="n">p</span><span class="bp">.</span><span class="n">adjacent</span> <span class="n">q</span> <span class="bp">=</span> <span class="n">false</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rw</span> <span class="n">eq_false</span><span class="o">,</span>
  <span class="n">rintro</span> <span class="bp">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">h</span><span class="bp">⟩</span><span class="o">,</span>
  <span class="n">fin_cases</span> <span class="n">i</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">adjacent_succ_iff</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">Q</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)}</span> <span class="o">:</span>
  <span class="n">p</span><span class="bp">.</span><span class="n">adjacent</span> <span class="n">q</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">p</span> <span class="mi">0</span> <span class="bp">=</span> <span class="n">q</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">adjacent</span> <span class="o">(</span><span class="n">p</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span> <span class="o">(</span><span class="n">q</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">))</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">p</span> <span class="mi">0</span> <span class="bp">≠</span> <span class="n">q</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">p</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span> <span class="bp">=</span> <span class="n">q</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rintros</span> <span class="bp">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">h</span><span class="bp">⟩</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">by_cases</span> <span class="n">hi</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">right</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">hi</span><span class="o">,</span> <span class="n">flip</span><span class="o">],</span>
      <span class="n">split</span> <span class="bp">;</span> <span class="n">simp</span><span class="o">,</span>
      <span class="n">ext</span> <span class="n">l</span><span class="o">,</span>
      <span class="n">simp</span> <span class="o">[(</span><span class="n">fin</span><span class="bp">.</span><span class="n">succ_ne_zero</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">]</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">left</span><span class="o">,</span>
      <span class="n">split</span><span class="o">,</span>
      <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">hi</span><span class="o">,</span> <span class="n">flip</span><span class="o">]</span> <span class="o">},</span>
      <span class="o">{</span> <span class="n">use</span> <span class="n">i</span><span class="bp">.</span><span class="n">pred</span> <span class="n">hi</span><span class="o">,</span>
        <span class="n">ext</span> <span class="n">l</span><span class="o">,</span>
        <span class="n">dsimp</span> <span class="o">[</span><span class="n">flip</span><span class="o">],</span>
        <span class="n">congr&#39;</span> <span class="mi">1</span><span class="o">,</span>
        <span class="n">rw</span> <span class="n">fin</span><span class="bp">.</span><span class="n">eq_succ_iff_pred_eq</span> <span class="o">}</span> <span class="o">}</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="o">(</span><span class="bp">⟨</span><span class="n">h₀</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">h</span><span class="bp">⟩⟩</span> <span class="bp">|</span> <span class="bp">⟨</span><span class="n">h₀</span><span class="o">,</span> <span class="n">h</span><span class="bp">⟩</span><span class="o">),</span>
    <span class="o">{</span> <span class="n">use</span> <span class="n">i</span><span class="bp">.</span><span class="n">succ</span><span class="o">,</span>
      <span class="n">ext</span> <span class="n">l</span><span class="o">,</span>
      <span class="n">by_cases</span> <span class="n">hl</span> <span class="o">:</span> <span class="n">l</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
      <span class="o">{</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">hl</span><span class="o">,</span> <span class="n">flip</span><span class="o">,</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ_ne_zero</span><span class="o">,</span> <span class="n">h₀</span><span class="o">,</span> <span class="n">bnot</span><span class="o">,</span> <span class="n">if_false</span><span class="o">]</span> <span class="o">},</span>
      <span class="o">{</span> <span class="k">have</span> <span class="o">:=</span> <span class="n">congr_fun</span> <span class="n">h</span> <span class="o">(</span><span class="n">l</span><span class="bp">.</span><span class="n">pred</span> <span class="n">hl</span><span class="o">),</span>
        <span class="n">simp</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
        <span class="n">rw</span> <span class="n">this</span><span class="o">,</span>
        <span class="n">dsimp</span> <span class="o">[</span><span class="n">flip</span><span class="o">],</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">fin</span><span class="bp">.</span><span class="n">succ_pred</span><span class="o">],</span>
        <span class="k">have</span> <span class="o">:=</span> <span class="n">fin</span><span class="bp">.</span><span class="n">eq_succ_iff_pred_eq</span> <span class="n">hl</span><span class="o">,</span>
        <span class="n">conv_lhs</span> <span class="n">at</span> <span class="n">this</span> <span class="o">{</span> <span class="n">rw</span> <span class="n">eq_comm</span> <span class="o">},</span>
        <span class="n">conv_rhs</span> <span class="n">at</span> <span class="n">this</span> <span class="o">{</span> <span class="n">rw</span> <span class="n">eq_comm</span> <span class="o">},</span>
        <span class="n">congr&#39;</span> <span class="mi">1</span><span class="o">,</span>
        <span class="n">rw</span> <span class="err">←</span> <span class="n">this</span> <span class="o">}</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">use</span> <span class="mi">0</span><span class="o">,</span>
      <span class="n">ext</span> <span class="n">l</span><span class="o">,</span>
      <span class="n">by_cases</span> <span class="n">hl</span> <span class="o">:</span> <span class="n">l</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
      <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">flip</span><span class="o">,</span> <span class="n">hl</span><span class="o">,</span> <span class="n">ne_iff_eq_bnot</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h₀</span><span class="o">]</span> <span class="o">},</span>
      <span class="o">{</span> <span class="n">rw</span> <span class="err">←</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ_pred</span> <span class="n">l</span> <span class="n">hl</span><span class="o">,</span>
        <span class="k">have</span> <span class="o">:=</span> <span class="n">congr_fun</span> <span class="n">h</span> <span class="o">(</span><span class="n">l</span><span class="bp">.</span><span class="n">pred</span> <span class="n">hl</span><span class="o">),</span>
        <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">function</span><span class="bp">.</span><span class="n">comp_app</span><span class="o">]</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
        <span class="n">rw</span> <span class="err">←</span> <span class="n">this</span><span class="o">,</span>
        <span class="n">simp</span> <span class="o">[</span><span class="n">flip</span><span class="o">,</span> <span class="n">ne</span><span class="bp">.</span><span class="n">symm</span> <span class="n">hl</span><span class="o">]</span> <span class="o">}</span> <span class="o">}</span> <span class="o">}</span>
<span class="kn">end</span>
</pre></div>

<a name="172592118"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172592118" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172592118">Patrick Massot (Aug 06 2019 at 14:13)</a>:</h4>
<p>It seems there is some kind of pain conservation law here</p>

<a name="172592121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172592121" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172592121">Patrick Massot (Aug 06 2019 at 14:13)</a>:</h4>
<p><span class="user-mention" data-user-id="110596">@Rob Lewis</span></p>

<a name="172592209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172592209" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172592209">Patrick Massot (Aug 06 2019 at 14:14)</a>:</h4>
<p>Maybe that solution is a bit orthogonal to the general design of our proof since it doesn't use induction on <code>n</code> at all</p>

<a name="172593902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172593902" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172593902">Patrick Massot (Aug 06 2019 at 14:32)</a>:</h4>
<p>I forget symmetry:</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">flip_flip</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">flip</span> <span class="n">i</span> <span class="o">(</span><span class="n">flip</span> <span class="n">i</span> <span class="n">p</span><span class="o">)</span> <span class="bp">=</span> <span class="n">p</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">ext</span> <span class="n">l</span><span class="o">,</span>
  <span class="n">dsimp</span> <span class="o">[</span><span class="n">flip</span><span class="o">],</span>
  <span class="n">split_ifs</span><span class="o">,</span>
  <span class="n">simp</span>
<span class="kn">end</span>

<span class="bp">@</span><span class="o">[</span><span class="n">symm</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">adjacent_comm</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span><span class="o">}</span> <span class="o">:</span> <span class="n">p</span><span class="bp">.</span><span class="n">adjacent</span> <span class="n">q</span> <span class="bp">↔</span> <span class="n">q</span><span class="bp">.</span><span class="n">adjacent</span> <span class="n">p</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">split</span> <span class="bp">;</span> <span class="n">rintro</span> <span class="bp">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">h</span><span class="bp">⟩</span> <span class="bp">;</span> <span class="n">rw</span> <span class="n">h</span> <span class="bp">;</span> <span class="n">use</span> <span class="n">i</span> <span class="bp">;</span> <span class="n">rw</span> <span class="n">flip_flip</span>
</pre></div>

<a name="172595157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172595157" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172595157">Patrick Massot (Aug 06 2019 at 14:44)</a>:</h4>
<blockquote>
<p>Who could try to add the following lines after the definition of epsilon, and see if the commented lines timeout?</p>
<div class="codehilite"><pre><span></span><span class="kn">variables</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">V</span> <span class="n">n</span><span class="o">)</span>
<span class="n">local</span> <span class="kn">notation</span> <span class="bp">`</span><span class="err">Ψ</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">equiv_fun_on_fintype</span><span class="bp">.</span><span class="n">inv_fun</span>

<span class="c">/-</span><span class="cm"></span>
<span class="cm">This following fails with `by apply_instance`, but defining it doesn&#39;t seem to help.</span>
<span class="cm">instance tata : vector_space ℝ (Q n →₀ ℝ) :=</span>
<span class="cm">{..finsupp.module (Q n) ℝ, .. }</span>
<span class="cm"> -/</span>

<span class="n">def</span> <span class="n">coeffs</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span><span class="err">₀</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="err">Ψ</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">p</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span><span class="o">,</span> <span class="n">ε</span> <span class="n">p</span> <span class="n">v</span><span class="o">)</span>
<span class="n">def</span> <span class="n">somme</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:=</span> <span class="o">(</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">total</span> <span class="o">(</span><span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="n">ℝ</span> <span class="n">e</span><span class="o">)</span>

<span class="bp">#</span><span class="kn">check</span> <span class="n">coeffs</span> <span class="n">v</span> <span class="c1">-- coeffs v : Q n →₀ ℝ</span>
<span class="bp">#</span><span class="kn">check</span> <span class="bp">@</span><span class="n">somme</span> <span class="n">n</span>  <span class="c1">-- somme : (Q n →₀ ℝ) →ₗ[ℝ] V n</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">linear_map</span><span class="bp">.</span><span class="n">to_fun</span> <span class="n">somme</span>  <span class="c1">-- somme.to_fun : (Q ?M_1 →₀ ℝ) → V ?M_1</span>

<span class="c1">-- The following lines timeout</span>
<span class="c1">--#check linear_map.to_fun somme (coeffs v)</span>
<span class="c1">--#check linear_map.to_fun (@somme n)</span>
<span class="c1">--#check (Q n →₀ ℝ) →ₗ[ℝ] V n</span>
</pre></div>


</blockquote>
<p>Does anyone has any explanation for the above mystery?</p>

<a name="172595625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172595625" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172595625">Rob Lewis (Aug 06 2019 at 14:50)</a>:</h4>
<p>You're right that the induction isn't necessary. Ultimately we need these two facts; everything below goes through fine with just these. These proofs are for the "exists unique" definition of <code>adjacent</code>.</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">adj_succ</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">Q</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)}</span> <span class="o">(</span><span class="n">h0</span> <span class="o">:</span> <span class="n">p</span> <span class="mi">0</span> <span class="bp">≠</span> <span class="n">q</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="n">p</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span> <span class="bp">=</span> <span class="n">q</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span> <span class="bp">↔</span> <span class="n">p</span><span class="bp">.</span><span class="n">adjacent</span> <span class="n">q</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">heq</span><span class="o">,</span>
    <span class="n">use</span> <span class="o">[</span><span class="mi">0</span><span class="o">,</span> <span class="n">h0</span><span class="o">],</span>
    <span class="n">intros</span> <span class="n">y</span> <span class="n">hy</span><span class="o">,</span>
    <span class="n">contrapose</span><span class="bp">!</span> <span class="n">hy</span><span class="o">,</span>
    <span class="n">rw</span> <span class="err">←</span><span class="n">fin</span><span class="bp">.</span><span class="n">succ_pred</span> <span class="bp">_</span> <span class="n">hy</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">congr_fun</span> <span class="n">heq</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rintros</span> <span class="bp">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">h_eq</span><span class="o">,</span> <span class="n">h_uni</span><span class="bp">⟩</span><span class="o">,</span>
    <span class="n">ext</span> <span class="n">x</span><span class="o">,</span> <span class="n">by_contradiction</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ_ne_zero</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">h_uni</span> <span class="bp">_</span> <span class="n">hx</span><span class="o">,</span> <span class="n">h_uni</span> <span class="bp">_</span> <span class="n">h0</span><span class="o">]</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">adj_succ_of_zeq</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">Q</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)}</span> <span class="o">(</span><span class="n">h0</span> <span class="o">:</span> <span class="n">p</span> <span class="mi">0</span> <span class="bp">=</span> <span class="n">q</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">Q</span><span class="bp">.</span><span class="n">adjacent</span> <span class="o">(</span><span class="n">p</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span> <span class="o">(</span><span class="n">q</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span> <span class="bp">↔</span> <span class="n">p</span><span class="bp">.</span><span class="n">adjacent</span> <span class="n">q</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rintros</span> <span class="bp">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">h_eq</span><span class="o">,</span> <span class="n">h_uni</span><span class="bp">⟩</span><span class="o">,</span>
    <span class="n">use</span> <span class="o">[</span><span class="n">i</span><span class="bp">.</span><span class="n">succ</span><span class="o">,</span> <span class="n">h_eq</span><span class="o">],</span>
    <span class="n">intros</span> <span class="n">y</span> <span class="n">hy</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="err">←</span><span class="n">fin</span><span class="bp">.</span><span class="n">pred_inj</span><span class="o">,</span> <span class="n">fin</span><span class="bp">.</span><span class="n">pred_succ</span><span class="o">],</span>
    <span class="o">{</span> <span class="n">apply</span> <span class="n">h_uni</span><span class="o">,</span> <span class="n">change</span> <span class="n">p</span> <span class="o">(</span><span class="n">fin</span><span class="bp">.</span><span class="n">pred</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">succ</span> <span class="bp">≠</span> <span class="n">q</span> <span class="o">(</span><span class="n">fin</span><span class="bp">.</span><span class="n">pred</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">succ</span><span class="o">,</span> <span class="n">simp</span> <span class="o">[</span><span class="n">hy</span><span class="o">]</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">contrapose</span><span class="bp">!</span> <span class="n">hy</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hy</span><span class="o">,</span> <span class="n">h0</span><span class="o">]</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">apply</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ_ne_zero</span> <span class="o">}</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rintros</span> <span class="bp">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">h_eq</span><span class="o">,</span> <span class="n">h_uni</span><span class="bp">⟩</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h_i</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span> <span class="k">from</span> <span class="bp">λ</span> <span class="n">h_i</span><span class="o">,</span> <span class="n">absurd</span> <span class="n">h0</span> <span class="o">(</span><span class="k">by</span> <span class="n">rwa</span> <span class="n">h_i</span> <span class="n">at</span> <span class="n">h_eq</span><span class="o">),</span>
    <span class="n">use</span> <span class="o">[</span><span class="n">i</span><span class="bp">.</span><span class="n">pred</span> <span class="n">h_i</span><span class="o">,</span> <span class="k">show</span> <span class="n">p</span> <span class="o">(</span><span class="n">fin</span><span class="bp">.</span><span class="n">succ</span> <span class="o">(</span><span class="n">fin</span><span class="bp">.</span><span class="n">pred</span> <span class="n">i</span> <span class="bp">_</span><span class="o">))</span> <span class="bp">≠</span> <span class="n">q</span> <span class="o">(</span><span class="n">fin</span><span class="bp">.</span><span class="n">succ</span> <span class="o">(</span><span class="n">fin</span><span class="bp">.</span><span class="n">pred</span> <span class="n">i</span> <span class="bp">_</span><span class="o">)),</span> <span class="k">by</span> <span class="n">rwa</span> <span class="o">[</span><span class="n">fin</span><span class="bp">.</span><span class="n">succ_pred</span><span class="o">]],</span>
    <span class="n">intros</span> <span class="n">y</span> <span class="n">hy</span><span class="o">,</span> <span class="n">simp</span> <span class="o">[</span><span class="n">eq</span><span class="bp">.</span><span class="n">symm</span> <span class="o">(</span><span class="n">h_uni</span> <span class="bp">_</span> <span class="n">hy</span><span class="o">)]</span> <span class="o">}</span>
<span class="kn">end</span>
</pre></div>

<a name="172595852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172595852" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172595852">Patrick Massot (Aug 06 2019 at 14:53)</a>:</h4>
<p>I don't have a strong opinion about this <code>exists_unique</code> vs <code>flip</code>. I think both definition directly relate to the intuitive definition.</p>

<a name="172595882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172595882" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172595882">Patrick Massot (Aug 06 2019 at 14:53)</a>:</h4>
<p>Why do you separate those two lemmas? Does it make later things easier?</p>

<a name="172595968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172595968" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172595968">Patrick Massot (Aug 06 2019 at 14:54)</a>:</h4>
<p>Could you try my finsupp.total mystery?</p>

<a name="172595988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172595988" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172595988">Rob Lewis (Aug 06 2019 at 14:54)</a>:</h4>
<p>I don't have time to debug the type class thing right now, but you can look at the trace here and see if you can make any sense:</p>
<div class="codehilite"><pre><span></span><span class="kn">set_option</span> <span class="n">trace</span><span class="bp">.</span><span class="n">class_instances</span> <span class="n">true</span>
<span class="n">include</span> <span class="n">v</span>
<span class="kn">example</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">try_for</span> <span class="mi">10000</span> <span class="o">{</span><span class="n">exact</span>  <span class="n">linear_map</span><span class="bp">.</span><span class="n">to_fun</span> <span class="n">somme</span> <span class="o">(</span><span class="n">coeffs</span> <span class="n">v</span><span class="o">)}</span>
</pre></div>

<a name="172596098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172596098" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172596098">Rob Lewis (Aug 06 2019 at 14:55)</a>:</h4>
<p>I think it ended up being a bit cleaner with them separate. But I generally try to avoid disjunctions, so that's why this feels cleaner to me.</p>

<a name="172597800"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172597800" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172597800">Patrick Massot (Aug 06 2019 at 15:13)</a>:</h4>
<p><code>(message too long, truncated at 262144 characters)</code></p>

<a name="172598493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172598493" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172598493">Patrick Massot (Aug 06 2019 at 15:21)</a>:</h4>
<p>It seems adding the shortcut</p>
<div class="codehilite"><pre><span></span><span class="kn">instance</span> <span class="n">toto</span> <span class="o">:</span> <span class="n">module</span> <span class="n">ℝ</span> <span class="o">(</span><span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span><span class="err">₀</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">finsupp</span><span class="bp">.</span><span class="n">module</span> <span class="o">(</span><span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="n">ℝ</span>
</pre></div>


<p>helps a lot</p>

<a name="172598539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172598539" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172598539">Patrick Massot (Aug 06 2019 at 15:21)</a>:</h4>
<p>Although the coercion from <code>linear_map</code> to function still doesn't kick in</p>

<a name="172598690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172598690" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172598690">Rob Lewis (Aug 06 2019 at 15:23)</a>:</h4>
<p>Yes, the messages get truncated, but 262144 characters is usually plenty to find the problem...</p>

<a name="172598733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172598733" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172598733">Rob Lewis (Aug 06 2019 at 15:23)</a>:</h4>
<p>Unsurprisingly there are type class issues in this whole development. You can add that to the short circuit instances for V.</p>

<a name="172598806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172598806" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172598806">Johan Commelin (Aug 06 2019 at 15:24)</a>:</h4>
<p>Why "unsurprisingly"?</p>

<a name="172598817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172598817" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172598817">Rob Lewis (Aug 06 2019 at 15:24)</a>:</h4>
<p><a href="https://github.com/leanprover-community/lean-sensitivity/tree/new_adj" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/tree/new_adj">https://github.com/leanprover-community/lean-sensitivity/tree/new_adj</a> is about as clean as I can get the <code>adjacent</code> stuff for now.</p>

<a name="172598827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172598827" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172598827">Johan Commelin (Aug 06 2019 at 15:24)</a>:</h4>
<p>To me this is quite a surprise</p>

<a name="172598955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172598955" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172598955">Rob Lewis (Aug 06 2019 at 15:26)</a>:</h4>
<p>I think it's been clear for a while that we're kind of abusing type class search. Whether it's our setup, or the inference algorithm itself, these kinds of issues are showing up a lot.</p>

<a name="172598984"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172598984" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172598984">Patrick Massot (Aug 06 2019 at 15:26)</a>:</h4>
<p>It's pretty clear that either we are doing it wrong, or Lean 3's type class is doing it wrong</p>

<a name="172598990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172598990" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172598990">Patrick Massot (Aug 06 2019 at 15:26)</a>:</h4>
<p>Rob was quicker...</p>

<a name="172599136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172599136" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172599136">Patrick Massot (Aug 06 2019 at 15:28)</a>:</h4>
<p>Rob, I think you can merge into master, I don't think anyone has a much better idea</p>

<a name="172601433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172601433" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172601433">Kevin Buzzard (Aug 06 2019 at 15:54)</a>:</h4>
<p>Can someone summarise the problems you're having?</p>

<a name="172604005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604005" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604005">Patrick Massot (Aug 06 2019 at 16:21)</a>:</h4>
<p>Kevin, there are several problems. The one I was discussing with Rob is to get a definition of the adjacency relation on the hypercube which is both easily recognizable and convenient for the proofs. I think we sort of settled that.</p>

<a name="172604110"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604110" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604110">Patrick Massot (Aug 06 2019 at 16:23)</a>:</h4>
<p>Then I went outside to help my youngest daughter training to ride a bicycle without side wheels. She's making progress but was tired. So i returned, and took up the big problem.</p>

<a name="172604131"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604131" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604131">Patrick Massot (Aug 06 2019 at 16:23)</a>:</h4>
<p>Which is the sum manipulation and basis and dual basis things.</p>

<a name="172604148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604148" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604148">Patrick Massot (Aug 06 2019 at 16:23)</a>:</h4>
<p>Now that instances work, here is my proposal:</p>

<a name="172604164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604164" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604164">Patrick Massot (Aug 06 2019 at 16:23)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">instance</span> <span class="n">coeffs_module</span> <span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">module</span> <span class="n">ℝ</span> <span class="o">(</span><span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span><span class="err">₀</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">finsupp</span><span class="bp">.</span><span class="n">module</span> <span class="o">(</span><span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="n">ℝ</span>

<span class="n">def</span> <span class="n">coeffs</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span><span class="err">₀</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">equiv_fun_on_fintype</span><span class="bp">.</span><span class="n">inv_fun</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">p</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span><span class="o">,</span> <span class="n">ε</span> <span class="n">p</span> <span class="n">v</span><span class="o">)</span>

<span class="n">def</span> <span class="n">somme</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span>  <span class="o">(</span><span class="n">Q</span> <span class="n">n</span> <span class="bp">→</span><span class="err">₀</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">→</span> <span class="n">V</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">total</span> <span class="o">(</span><span class="n">Q</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="n">ℝ</span> <span class="n">e</span>

<span class="c">/-</span><span class="cm">- For any v : V n, \sum_{p ∈ Q n} (ε p v) • e p = v -/</span>
<span class="kn">lemma</span> <span class="n">decomposition</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">somme</span> <span class="o">(</span><span class="n">coeffs</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="n">v</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">suffices</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span><span class="o">),</span> <span class="n">ε</span> <span class="n">p</span> <span class="o">(</span><span class="n">somme</span> <span class="err">$</span> <span class="n">coeffs</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="n">ε</span> <span class="n">p</span> <span class="n">v</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">refine</span> <span class="n">eq_of_sub_eq_zero</span> <span class="o">(</span><span class="n">epsilon_total</span> <span class="bp">_</span><span class="o">),</span>
    <span class="n">intros</span> <span class="n">p</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">linear_map</span><span class="bp">.</span><span class="n">map_sub</span><span class="o">,</span> <span class="n">sub_eq_zero_iff_eq</span><span class="o">,</span> <span class="n">this</span><span class="o">]</span> <span class="o">},</span>
  <span class="n">intro</span> <span class="n">p</span><span class="o">,</span>
  <span class="n">erw</span> <span class="o">[</span><span class="n">somme</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">total_apply</span><span class="o">,</span> <span class="n">linear_map</span><span class="bp">.</span><span class="n">map_sum</span><span class="o">],</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">duality</span><span class="o">,</span> <span class="n">map_smul</span><span class="o">,</span> <span class="n">smul_eq_mul</span><span class="o">],</span>
  <span class="n">rw</span> <span class="n">finset</span><span class="bp">.</span><span class="n">sum_eq_single</span> <span class="n">p</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span><span class="o">,</span> <span class="n">refl</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">q</span> <span class="n">q_in</span> <span class="n">q_ne</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">q_ne</span><span class="bp">.</span><span class="n">symm</span><span class="o">]</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">p_not_in</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">not_mem_support_iff</span><span class="bp">.</span><span class="mi">1</span> <span class="n">p_not_in</span><span class="o">]</span> <span class="o">}</span>
<span class="kn">end</span>
</pre></div>

<a name="172604284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604284" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604284">Patrick Massot (Aug 06 2019 at 16:25)</a>:</h4>
<p>Note how this doesn <em>not</em> use <a href="https://github.com/leanprover-community/lean-sensitivity/blob/1d156fb773e0729678fcd816eea20c4812d5ba0e/src/sensitivity.lean#L162" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/blob/1d156fb773e0729678fcd816eea20c4812d5ba0e/src/sensitivity.lean#L162">e.is_basis</a> or <a href="https://github.com/leanprover-community/lean-sensitivity/blob/1d156fb773e0729678fcd816eea20c4812d5ba0e/src/sensitivity.lean#L75" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/blob/1d156fb773e0729678fcd816eea20c4812d5ba0e/src/sensitivity.lean#L75">equiv_sum</a></p>

<a name="172604305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604305" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604305">Patrick Massot (Aug 06 2019 at 16:25)</a>:</h4>
<p>I think this is going more straightly to the point</p>

<a name="172604452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604452" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604452">Patrick Massot (Aug 06 2019 at 16:27)</a>:</h4>
<p>Modulo all the finsupp weirdness, it says exactly what the docstring claims</p>

<a name="172604474"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604474" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604474">Patrick Massot (Aug 06 2019 at 16:27)</a>:</h4>
<p>I think this could be the basis for a refactor of the main proof</p>

<a name="172604542"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604542" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604542">Rob Lewis (Aug 06 2019 at 16:28)</a>:</h4>
<p>What's <code>somme</code>? I keep reading that as a misspelling of <code>some</code>...</p>

<a name="172604551"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604551" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604551">Patrick Massot (Aug 06 2019 at 16:28)</a>:</h4>
<p>Oh sorry</p>

<a name="172604563"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604563" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604563">Patrick Massot (Aug 06 2019 at 16:28)</a>:</h4>
<p>It's French for sum</p>

<a name="172604573"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604573" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604573">Rob Lewis (Aug 06 2019 at 16:28)</a>:</h4>
<p>Aha.</p>

<a name="172604582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604582" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604582">Patrick Massot (Aug 06 2019 at 16:29)</a>:</h4>
<p>At some point I wanted to avoid name clash</p>

<a name="172604623"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604623" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604623">Patrick Massot (Aug 06 2019 at 16:29)</a>:</h4>
<p>Of course it uses <code>epsilon_total</code> that I posted earlier</p>

<a name="172604639"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604639" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604639">Patrick Massot (Aug 06 2019 at 16:29)</a>:</h4>
<blockquote>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">epsilon_total</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">{</span><span class="n">v</span> <span class="o">:</span> <span class="n">V</span> <span class="n">n</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">p</span> <span class="o">:</span> <span class="n">Q</span> <span class="n">n</span><span class="o">,</span> <span class="o">(</span><span class="n">ε</span> <span class="n">p</span><span class="o">)</span> <span class="n">v</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="n">v</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">ih</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">dsimp</span> <span class="o">[</span><span class="n">ε</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span> <span class="n">exact</span> <span class="n">h</span> <span class="o">(</span><span class="bp">λ</span> <span class="bp">_</span><span class="o">,</span> <span class="n">tt</span><span class="o">)</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">cases</span> <span class="n">v</span> <span class="k">with</span> <span class="n">v₁</span> <span class="n">v₂</span><span class="o">,</span>
    <span class="n">ext</span> <span class="bp">;</span> <span class="n">change</span> <span class="bp">_</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">V</span> <span class="n">n</span><span class="o">)</span> <span class="bp">;</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[]</span> <span class="bp">;</span> <span class="n">apply</span> <span class="n">ih</span> <span class="bp">;</span> <span class="n">intro</span> <span class="n">p</span> <span class="bp">;</span>
    <span class="o">[</span> <span class="k">let</span> <span class="n">q</span> <span class="o">:</span> <span class="n">Q</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="k">if</span> <span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">0</span> <span class="k">then</span> <span class="n">tt</span> <span class="k">else</span> <span class="n">p</span> <span class="o">(</span><span class="n">i</span><span class="bp">.</span><span class="n">pred</span> <span class="n">h</span><span class="o">),</span>
      <span class="k">let</span> <span class="n">q</span> <span class="o">:</span> <span class="n">Q</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="k">if</span> <span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">0</span> <span class="k">then</span> <span class="n">ff</span> <span class="k">else</span> <span class="n">p</span> <span class="o">(</span><span class="n">i</span><span class="bp">.</span><span class="n">pred</span> <span class="n">h</span><span class="o">)],</span>
    <span class="n">all_goals</span> <span class="o">{</span>
      <span class="n">specialize</span> <span class="n">h</span> <span class="n">q</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">ε</span><span class="o">,</span> <span class="k">show</span> <span class="n">q</span> <span class="mi">0</span> <span class="bp">=</span> <span class="n">tt</span><span class="o">,</span> <span class="k">from</span> <span class="n">rfl</span><span class="o">,</span> <span class="n">cond_tt</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span> <span class="bp">&lt;|&gt;</span> <span class="n">rw</span> <span class="o">[</span><span class="n">ε</span><span class="o">,</span> <span class="k">show</span> <span class="n">q</span> <span class="mi">0</span> <span class="bp">=</span> <span class="n">ff</span><span class="o">,</span> <span class="k">from</span> <span class="n">rfl</span><span class="o">,</span> <span class="n">cond_ff</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
      <span class="n">rwa</span> <span class="k">show</span> <span class="n">p</span> <span class="bp">=</span> <span class="n">q</span> <span class="err">∘</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ</span><span class="o">,</span> <span class="k">by</span> <span class="o">{</span> <span class="n">ext</span><span class="o">,</span> <span class="n">simp</span> <span class="o">[</span><span class="n">q</span><span class="o">,</span> <span class="n">fin</span><span class="bp">.</span><span class="n">succ_ne_zero</span><span class="o">]</span> <span class="o">}</span> <span class="o">}</span> <span class="o">}</span>
<span class="kn">end</span>
</pre></div>


</blockquote>

<a name="172604771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604771" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604771">Patrick Massot (Aug 06 2019 at 16:31)</a>:</h4>
<p>and <code>duality</code>. Together those lemmas are equivalent to the fact that <code>e</code> and <code>epsilon</code> are dual bases.</p>

<a name="172604807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172604807" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172604807">Patrick Massot (Aug 06 2019 at 16:31)</a>:</h4>
<p>What do you think about this?</p>

<a name="172605103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172605103" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172605103">Rob Lewis (Aug 06 2019 at 16:35)</a>:</h4>
<p>I haven't worked through your earlier posts very carefully, but if there's a chance this could clean up the bottom of the file, I'm in favor of trying...</p>

<a name="172642013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172642013" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172642013">Patrick Massot (Aug 07 2019 at 00:58)</a>:</h4>
<p>Ok, I pushed something. The main goal is to shorten the final proof, make it easier to read, and transfer as much as possible into <code>for_mathlib.lean</code>. I followed my plan of using the duality as outline in my previous messages. Maybe I went too far, and I'm actually fighting the linear algebra library. But I still like how the final proof looks like. And I guess that Lean night already lasted too long (looks like it's now almost 3am...)</p>

<a name="172663166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172663166" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172663166">Rob Lewis (Aug 07 2019 at 09:33)</a>:</h4>
<p>Nice, I think it looks great!</p>

<a name="172666446"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172666446" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172666446">Patrick Massot (Aug 07 2019 at 10:39)</a>:</h4>
<p>What I think it the final big thing is to generalize and move to mathlib <a href="https://github.com/leanprover-community/lean-sensitivity/blob/19c2800c9330ddf7130dac4ce22b7d2eb51afcfd/src/sensitivity.lean#L193-L247" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/blob/19c2800c9330ddf7130dac4ce22b7d2eb51afcfd/src/sensitivity.lean#L193-L247">https://github.com/leanprover-community/lean-sensitivity/blob/19c2800c9330ddf7130dac4ce22b7d2eb51afcfd/src/sensitivity.lean#L193-L247</a>. It should connect with <a href="https://github.com/leanprover-community/mathlib/blob/master/src/linear_algebra/dual.lean" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/master/src/linear_algebra/dual.lean">https://github.com/leanprover-community/mathlib/blob/master/src/linear_algebra/dual.lean</a>. We could have a lemma characterizing pairs of dual bases (taking as input our statements <code>duality</code> and <code>epsilon_total</code> and outputting the conjunction that <code>e</code> is a basis and <code>epsilon</code> is its dual basis). And then replace the rest of the what I outlined in the first link by general lemmas about dual bases. Or, maybe more flexibly, we could have a duality predicate about two families of vector saying they form dual bases, and then state all lemmas in <code>dual.lean</code> in term of this predicate. As usual with predicate vs construction, the gain appears in exactly the situation we are in, when we want an alternative construction for some reason.</p>

<a name="172666637"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172666637" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172666637">Patrick Massot (Aug 07 2019 at 10:42)</a>:</h4>
<p>Honestly, I spent way too much time working on this sensitivity thing. Maybe someone who understands linear algebra in mathlib (and especially <code>dual.lean</code>) should take over (<span class="user-mention" data-user-id="112680">@Johan Commelin</span>?). Today I'll bring my son to <a href="https://www.grimper.com/media/guide_falaises/sites/pen_hir_escalade%C2%A9sam_bie_3__crop_995x516.jpg" target="_blank" title="https://www.grimper.com/media/guide_falaises/sites/pen_hir_escalade%C2%A9sam_bie_3__crop_995x516.jpg">Penhir</a> for climbing.</p>
<div class="message_inline_image"><a href="https://www.grimper.com/media/guide_falaises/sites/pen_hir_escalade%C2%A9sam_bie_3__crop_995x516.jpg" target="_blank" title="Penhir"><img src="https://www.grimper.com/media/guide_falaises/sites/pen_hir_escalade%C2%A9sam_bie_3__crop_995x516.jpg"></a></div>

<a name="172890105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172890105" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172890105">Patrick Massot (Aug 09 2019 at 21:23)</a>:</h4>
<p>I'm frustrated that we can't advertise our sensitivity conjecture formalization so I tried again. I wrote <a href="https://github.com/leanprover-community/lean-sensitivity/commit/ed3d288f0fe696cc5a8049cad612f503ae2f4da3" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/commit/ed3d288f0fe696cc5a8049cad612f503ae2f4da3">https://github.com/leanprover-community/lean-sensitivity/commit/ed3d288f0fe696cc5a8049cad612f503ae2f4da3</a> about pairs of maps constituting a dual basis. It was a nightmare because elaboration was failing everywhere. And when I try to use it in the main file I get random mismatches of <code>decidable_whatever</code>. Maybe I was wrong when I wrote that function coercions were the main issue. It seems that decidability classes are there each time we really suffer in mathlib (see also polynomials). I give up.</p>

<a name="172890134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172890134" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172890134">Patrick Massot (Aug 09 2019 at 21:23)</a>:</h4>
<p>I guess Rob is our last hope.</p>

<a name="172919534"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172919534" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172919534">David Michael Roberts (Aug 10 2019 at 10:35)</a>:</h4>
<blockquote>
<p>working out pi to 7 decimal places,</p>
</blockquote>
<p>where was that done? I can't find it after a little look here in the chat.</p>

<a name="172919943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172919943" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172919943">Mario Carneiro (Aug 10 2019 at 10:46)</a>:</h4>
<p>see <a href="https://github.com/leanprover-community/mathlib/blob/master/src/data/real/pi.lean#L193-L229" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/master/src/data/real/pi.lean#L193-L229">https://github.com/leanprover-community/mathlib/blob/master/src/data/real/pi.lean#L193-L229</a> and the linked gist at <a href="https://gist.github.com/fpvandoorn/5b405988bc2e61953d56e3597db16ecf" target="_blank" title="https://gist.github.com/fpvandoorn/5b405988bc2e61953d56e3597db16ecf">https://gist.github.com/fpvandoorn/5b405988bc2e61953d56e3597db16ecf</a></p>

<a name="172919955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172919955" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172919955">Mario Carneiro (Aug 10 2019 at 10:46)</a>:</h4>
<p>I think it was our pi day activity</p>

<a name="172921002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172921002" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172921002">Kevin Buzzard (Aug 10 2019 at 11:18)</a>:</h4>
<p>They worked it out to a million decimal places in Coq once, but I would imagine the process took more than 24 hours in total. What has been interesting recently is that questions have come up and then a group of people have worked on them and within a day or two the code is up and running.</p>

<a name="172924890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172924890" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172924890">David Michael Roberts (Aug 10 2019 at 13:27)</a>:</h4>
<p>Though the seven decimal places include the 3., that's still pretty nice.</p>

<a name="172926333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/172926333" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#172926333">Reid Barton (Aug 10 2019 at 14:13)</a>:</h4>
<p>I also have the impression that <code>decidable_eq</code> requirements are somehow responsible for a lot of pain, though I have no data or understanding of why that would be.</p>

<a name="173779470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173779470" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173779470">Rob Lewis (Aug 21 2019 at 09:54)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> What were the issues you were having here? It seems like things compile, and I don't see any nightmares in the file right now.</p>

<a name="173779502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173779502" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173779502">Rob Lewis (Aug 21 2019 at 09:54)</a>:</h4>
<p>I was planning to try to move some of the lemmas to mathlib and put this in the archive. Are there still major changes you want to make?</p>

<a name="173782998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173782998" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173782998">Patrick Massot (Aug 21 2019 at 10:59)</a>:</h4>
<p>I think I've explained it in previous messages. This minor nightmare is <a href="https://github.com/leanprover-community/lean-sensitivity/blob/lean-3.4.2/src/sensitivity.lean#L154-L247" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/blob/lean-3.4.2/src/sensitivity.lean#L154-L247">https://github.com/leanprover-community/lean-sensitivity/blob/lean-3.4.2/src/sensitivity.lean#L154-L247</a> which was meant to be replaced by calling <a href="https://github.com/leanprover-community/lean-sensitivity/blob/lean-3.4.2/src/for_mathlib.lean#L25-L103" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/blob/lean-3.4.2/src/for_mathlib.lean#L25-L103">https://github.com/leanprover-community/lean-sensitivity/blob/lean-3.4.2/src/for_mathlib.lean#L25-L103</a> but I couldn't make it work because of conflicting decidable instances (mixing actual instances and <code>classical.prop_decidable</code> I guess). Also <a href="https://github.com/leanprover-community/lean-sensitivity/blob/lean-3.4.2/src/sensitivity.lean#L117-L140" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/blob/lean-3.4.2/src/sensitivity.lean#L117-L140">https://github.com/leanprover-community/lean-sensitivity/blob/lean-3.4.2/src/sensitivity.lean#L117-L140</a> looks stupid since we then explicitly describe a basis.</p>

<a name="173783054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173783054" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173783054">Patrick Massot (Aug 21 2019 at 11:00)</a>:</h4>
<p>I would really love it if you could have a look at this decidability nightmare</p>

<a name="173783100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173783100" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173783100">Patrick Massot (Aug 21 2019 at 11:01)</a>:</h4>
<p>When we rushed to prove this theorem I thought that within one week we would be able to post comments to all blogs discussing this theorem to point out it was very quickly formalized. Instead we have one more proof that formalization is not practicable for stupid reasons.</p>

<a name="173783757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173783757" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173783757">Rob Lewis (Aug 21 2019 at 11:13)</a>:</h4>
<p>I'll see what I can do.</p>

<a name="173784660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173784660" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173784660">Kevin Buzzard (Aug 21 2019 at 11:28)</a>:</h4>
<p>I wasn't involved but I thought that it was indeed quickly formalised</p>

<a name="173784884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173784884" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173784884">Rob Lewis (Aug 21 2019 at 11:32)</a>:</h4>
<p>It was quickly formalized but it's not a perfect formalization. To brag about something this short, it kind of has to be done canonically, and the problem (I think) is that Patrick struggled to get the canonical proof to work.</p>

<a name="173784923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173784923" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173784923">Patrick Massot (Aug 21 2019 at 11:33)</a>:</h4>
<p>We don't need it to be perfect, but I'd like it to be recognizable maths</p>

<a name="173795003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173795003" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173795003">Rob Lewis (Aug 21 2019 at 13:44)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> I just pushed an update. Is this what you had in mind? The decidability issues were nothing major. We were missing a decidable_eq instance for <code>V n</code>, which was confusing things in a few places.</p>

<a name="173795690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173795690" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173795690">Rob Lewis (Aug 21 2019 at 13:52)</a>:</h4>
<p>In fact, the specific dec_eq instance I gave it isn't necessary. Defining it using <code>classical.dec_eq</code> is fine too. But without the explicit instance, it seems to be inferring different dec_eqs in different places.</p>

<a name="173795751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173795751" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173795751">Rob Lewis (Aug 21 2019 at 13:52)</a>:</h4>
<p>It's all kind of ironic since <code>V</code> definitely isn't decidable. There are non-defeq ways to pretend that it is.</p>

<a name="173801473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173801473" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173801473">Patrick Massot (Aug 21 2019 at 14:54)</a>:</h4>
<p>Yes, it looks good. I'm happy you found it easy. I'm so upset by those kinds of problems that my mind refuse to work on them.</p>

<a name="173801521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173801521" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173801521">Patrick Massot (Aug 21 2019 at 14:54)</a>:</h4>
<p>What is the point of getting <code>calc_lemma</code> out of the theorem proof?</p>

<a name="173801531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173801531" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173801531">Kevin Buzzard (Aug 21 2019 at 14:54)</a>:</h4>
<p>We mathematicians just instinctively deny that such (decidability) issues can exist, because we've been ignoring them for centuries.</p>

<a name="173801593"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173801593" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173801593">Patrick Massot (Aug 21 2019 at 14:55)</a>:</h4>
<p>I think <a href="https://github.com/leanprover-community/lean-sensitivity/blob/a4b69d68217b7b8319a03f3406f4fba6147b2f91/src/sensitivity.lean#L194-L202" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/blob/a4b69d68217b7b8319a03f3406f4fba6147b2f91/src/sensitivity.lean#L194-L202">https://github.com/leanprover-community/lean-sensitivity/blob/a4b69d68217b7b8319a03f3406f4fba6147b2f91/src/sensitivity.lean#L194-L202</a> are not needed, we can use their proofs where we need them</p>

<a name="173801811"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173801811" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173801811">Patrick Massot (Aug 21 2019 at 14:57)</a>:</h4>
<p>And we still have that silly dimension computation. We should have a mathlib lemma stating that if <code>V</code> has a basis index by a finite type then its <code>findim</code> is the cardinal of this finite type, and of course a lemma computing the cardinal of <code>fin n to bool</code></p>

<a name="173801971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173801971" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173801971">Rob Lewis (Aug 21 2019 at 14:59)</a>:</h4>
<blockquote>
<p>What is the point of getting <code>calc_lemma</code> out of the theorem proof?</p>
</blockquote>
<p>That calc block is a memory hog. I moved it out to make it easier to fix, it doesn't have to stay out. Also gave me a chance to try <code>extract_goal</code>, which stumbles a bit with <code>let</code> statements.</p>

<a name="173802076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173802076" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173802076">Rob Lewis (Aug 21 2019 at 15:00)</a>:</h4>
<blockquote>
<p>I think <a href="https://github.com/leanprover-community/lean-sensitivity/blob/a4b69d68217b7b8319a03f3406f4fba6147b2f91/src/sensitivity.lean#L194-L202" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/blob/a4b69d68217b7b8319a03f3406f4fba6147b2f91/src/sensitivity.lean#L194-L202">https://github.com/leanprover-community/lean-sensitivity/blob/a4b69d68217b7b8319a03f3406f4fba6147b2f91/src/sensitivity.lean#L194-L202</a> are not needed, we can use their proofs where we need them</p>
</blockquote>
<p>Yeah. Again, just slightly easier to put them there while making the updates.</p>

<a name="173807927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173807927" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173807927">Rob Lewis (Aug 21 2019 at 16:02)</a>:</h4>
<blockquote>
<p>And we still have that silly dimension computation. We should have a mathlib lemma stating that if <code>V</code> has a basis index by a finite type then its <code>findim</code> is the cardinal of this finite type, and of course a lemma computing the cardinal of <code>fin n to bool</code></p>
</blockquote>
<p>This is more annoying than it should be because of cardinal universes.</p>

<a name="173808017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173808017" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173808017">Patrick Massot (Aug 21 2019 at 16:03)</a>:</h4>
<p>I really think mathlib should hide this to users who manipulate only finite-dimensional vector spaces (as we do in this proof)</p>

<a name="173808050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173808050" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173808050">Patrick Massot (Aug 21 2019 at 16:03)</a>:</h4>
<p>If we can't do that then the linear algebra library has a serious issue</p>

<a name="173808648"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173808648" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173808648">Rob Lewis (Aug 21 2019 at 16:09)</a>:</h4>
<p>I think this is what <code>linear_algebra/finite_dimensional.lean</code> is trying to do, but there's still some glue missing.</p>

<a name="173808881"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173808881" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173808881">Rob Lewis (Aug 21 2019 at 16:12)</a>:</h4>
<p><code>fg</code> doesn't seem to be linked up with the existence of a finite basis, as far as I can tell.</p>

<a name="173840611"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173840611" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173840611">Rob Lewis (Aug 21 2019 at 23:26)</a>:</h4>
<p>Turns out I work better late at night and this was much easier than I thought. <a href="https://github.com/leanprover-community/lean-sensitivity/commit/af28ecfab7f412f7d451a4ff4cf328aad322eae3" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/commit/af28ecfab7f412f7d451a4ff4cf328aad322eae3">https://github.com/leanprover-community/lean-sensitivity/commit/af28ecfab7f412f7d451a4ff4cf328aad322eae3</a></p>

<a name="173891541"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173891541" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173891541">Patrick Massot (Aug 22 2019 at 15:16)</a>:</h4>
<p>Thanks Rob! I finally had some time to look at it. I would still prefer to hide cardinal even more (or at least have only one of <code>dim_V</code> or <code>dim_V'</code>) but it's already much better. I feel sufficiently confident that we are close to something we could share (and I feel sufficiently confident I don't want to write that referee report I should be writing) that I made a cosmetic pass on the whole file: <a href="https://github.com/leanprover-community/lean-sensitivity/commit/4feaed5a407676a45327854595bd3e4b319c4f7e" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/commit/4feaed5a407676a45327854595bd3e4b319c4f7e">https://github.com/leanprover-community/lean-sensitivity/commit/4feaed5a407676a45327854595bd3e4b319c4f7e</a> I hope there aren't too many controversial changes (especially for equation compiler addicts). Everyone is free to tweak it.</p>

<a name="173891734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173891734" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173891734">Patrick Massot (Aug 22 2019 at 15:18)</a>:</h4>
<p>I also reintegrated the calc block in the main proof.</p>

<a name="173892876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173892876" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173892876">Patrick Massot (Aug 22 2019 at 15:32)</a>:</h4>
<p>And now we can go on removing stuff that just got merged in mathlib, and continue emptying <code>for_mathlib.lean</code></p>

<a name="173895389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173895389" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173895389">Rob Lewis (Aug 22 2019 at 16:00)</a>:</h4>
<p>It looks good! I just pushed an update that gets rid of <code>dim_V'</code>. But updating mathlib breaks the <code>assumption_mod_cast</code>in <code>findim_V</code>, I'm not sure why.</p>

<a name="173896379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173896379" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173896379">Rob Lewis (Aug 22 2019 at 16:12)</a>:</h4>
<p>Fixed. <a href="https://github.com/leanprover-community/lean-sensitivity/tree/upgraded_mathlib" target="_blank" title="https://github.com/leanprover-community/lean-sensitivity/tree/upgraded_mathlib">https://github.com/leanprover-community/lean-sensitivity/tree/upgraded_mathlib</a> on a branch for now so it doesn't interfere with update-mathlib. After the next nightly comes out, we can upgrade to that and merge to master.</p>

<a name="173896604"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/sensitivity%20conjecture/near/173896604" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/98622sensitivityconjecture.html#173896604">Rob Lewis (Aug 22 2019 at 16:15)</a>:</h4>
<p><span class="user-mention" data-user-id="213273">@Paul-Nicolas Madelaine</span> At <a href="https://github.com/leanprover-community/mathlib/blob/master/src/set_theory/cardinal.lean#L589" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/master/src/set_theory/cardinal.lean#L589">https://github.com/leanprover-community/mathlib/blob/master/src/set_theory/cardinal.lean#L589</a>, is <code>nat_cast_pow</code> (and <code>nat_cast_le</code>) a good <code>elim_cast</code> lemma? Maybe I was wrong to add that.</p>


{% endraw %}

{% include archive_update.html %}