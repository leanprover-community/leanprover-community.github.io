---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/116395maths/89037TakingtheStacksProjectformalisationforward.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/116395maths/index.html">maths</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html">Taking the Stacks Project formalisation forward</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="135477612"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135477612" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135477612">Kevin Buzzard (Oct 09 2018 at 15:25)</a>:</h4>
<p>I formalised the definition of a scheme -- in theory at least. I proved that an affine scheme was a scheme which gave me some sort of hope that I'd formalised the definition correctly. The files are a mess, some people were never happy with the names of the theorems or the names of the lean files, the whole thing needs a tidy. I have a Masters student who <em>might</em> be interested. What are the priorities here? He'd like to prove some more lemmas about schemes (and indeed we as a department would like to see some original material). But maybe I could use this as impetus to tidy the whole thing up. Does anyone have any ideas about what could be priorities here? <span class="user-mention" data-user-id="110031">@Patrick Massot</span> and <span class="user-mention" data-user-id="112680">@Johan Commelin</span> you probably both have clearer ideas than me about where this project should be going.</p>

<a name="135477722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135477722" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135477722">Patrick Massot (Oct 09 2018 at 15:27)</a>:</h4>
<p>It should be going into mathlib</p>

<a name="135477729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135477729" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135477729">Patrick Massot (Oct 09 2018 at 15:27)</a>:</h4>
<p>with mathlib quality</p>

<a name="135478190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135478190" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135478190">Kevin Buzzard (Oct 09 2018 at 15:34)</a>:</h4>
<p>I thought you'd say that.</p>

<a name="135478389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135478389" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135478389">Patrick Massot (Oct 09 2018 at 15:37)</a>:</h4>
<p>And we also need progress by <span class="user-mention" data-user-id="110087">@Scott Morrison</span> on sheaves</p>

<a name="135478391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135478391" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135478391">Kevin Buzzard (Oct 09 2018 at 15:37)</a>:</h4>
<p>A big question here is what to do with the sheaf theory. I defined a sheaf of rings and a presheaf of sets and a sheaf of sets on a basis of a topological space and blah blah blah; do we just sit and wait for more category theory stuff or use the fact that everything is a typeclass so the low-level approach is fine? How long will it be before mathlib contains all the machinery necessary to write "let F be a presheaf of rings on the topological space X" in a category-theory-like manner, so I don't have to also define morphisms of presheaves?</p>

<a name="135478435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135478435" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135478435">Kevin Buzzard (Oct 09 2018 at 15:38)</a>:</h4>
<p>two minds with a single thought :-)</p>

<a name="135478531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135478531" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135478531">Patrick Massot (Oct 09 2018 at 15:39)</a>:</h4>
<p>This is blocking for the perfectoid project as well (also blocked by ring completions, subring issue, etc...)</p>

<a name="135481011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481011" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481011">Johan Commelin (Oct 09 2018 at 16:18)</a>:</h4>
<p>Right. I think those presheaves are pretty close. As soon as <span class="user-mention" data-user-id="110087">@Scott Morrison</span>'s coauthors stop being grumpy, we will get <code>backwards_reasoning</code> and then all sorts of limits. After that a bunch of stuff about sheaves will be within reach.</p>

<a name="135481109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481109" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481109">Kevin Buzzard (Oct 09 2018 at 16:20)</a>:</h4>
<p>I managed just fine in the schemes project with no category theory. Part of me is scared that using the category theory stuff will actually make things more complicated! And unfortunately I must be completely honest and say that I have not been paying careful attention to exactly what is there and what is not there. I know that Scott's work seems to rely on a bunch of automation and I know that these things are very complicated to get right and that I know essentially nothing which would help. I would like to contribute to Scott's work by actually trying it out in some basic cases and then asking for advice when I can't get it to work.</p>
<p>Perhaps going back to the stacks project and doing it all again using the category-theoretic tools that we either have already or will have soon would be a good test case for this category theory stuff. I think that in particular getting the parts of category theory working which are used widely outside of pure category theory would be an important project.</p>

<a name="135481135"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481135" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481135">Kevin Buzzard (Oct 09 2018 at 16:20)</a>:</h4>
<p>Golly so we need backwards reasoning and then limits and _then_ sheaves? Because the sheaf axiom says that some map to a limit is an isomorphism?</p>

<a name="135481163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481163" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481163">Patrick Massot (Oct 09 2018 at 16:21)</a>:</h4>
<p>Right, we need someone totally unrelated to GRU to visit Scott's collaborators towns for tourism</p>

<a name="135481415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481415" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481415">Johan Commelin (Oct 09 2018 at 16:26)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> I think we should certainly try to take advantage of category theory. After all, we want étale cohomology next, and then you don't want to have live in a parallel universe where you have no category theory available...</p>

<a name="135481438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481438" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481438">Patrick Massot (Oct 09 2018 at 16:27)</a>:</h4>
<p>Johan, I cannot allow you to bad mouth Bourbaki</p>

<a name="135481489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481489" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481489">Johan Commelin (Oct 09 2018 at 16:28)</a>:</h4>
<p>What did I say wrong? <span class="emoji emoji-1f630" title="cold sweat">:cold_sweat:</span></p>

<a name="135481497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481497" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481497">Patrick Massot (Oct 09 2018 at 16:28)</a>:</h4>
<p>You don't like living in a parallel universe without category theory</p>

<a name="135481512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481512" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481512">Johan Commelin (Oct 09 2018 at 16:29)</a>:</h4>
<p>Bourbaki never wrote a volume on étale cohomology.</p>

<a name="135481575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481575" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481575">Patrick Massot (Oct 09 2018 at 16:30)</a>:</h4>
<p>Oh, I just received an email from Bourbaki</p>

<a name="135481614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481614" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481614">Patrick Massot (Oct 09 2018 at 16:30)</a>:</h4>
<p>But it's not about category theory</p>

<a name="135481632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481632" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481632">Johan Commelin (Oct 09 2018 at 16:31)</a>:</h4>
<blockquote>
<p>Oh, I just received an email from Bourbaki</p>
</blockquote>
<p>He invites you to give a seminar talk about interactive theorem proving?</p>

<a name="135481634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481634" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481634">Patrick Massot (Oct 09 2018 at 16:31)</a>:</h4>
<p>He wants another seminar talk</p>

<a name="135481640"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481640" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481640">Johan Commelin (Oct 09 2018 at 16:31)</a>:</h4>
<blockquote>
<p>He wants another seminar talk</p>
</blockquote>
<p>Congratulations!</p>

<a name="135481645"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481645" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481645">Patrick Massot (Oct 09 2018 at 16:31)</a>:</h4>
<p>No, unfortunately it's another topic</p>

<a name="135481714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481714" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481714">Patrick Massot (Oct 09 2018 at 16:32)</a>:</h4>
<p>Hales gave a Bourbaki seminar on proof assistants not so long ago</p>

<a name="135481720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481720" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481720">Patrick Massot (Oct 09 2018 at 16:32)</a>:</h4>
<p>so I don't think they'll want another one before seeing real progress here</p>

<a name="135481745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481745" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481745">Patrick Massot (Oct 09 2018 at 16:33)</a>:</h4>
<p><a href="http://www.bourbaki.ens.fr/seminaires/2014/Prog_juin14.html" target="_blank" title="http://www.bourbaki.ens.fr/seminaires/2014/Prog_juin14.html">http://www.bourbaki.ens.fr/seminaires/2014/Prog_juin14.html</a></p>

<a name="135481892"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481892" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481892">Patrick Massot (Oct 09 2018 at 16:36)</a>:</h4>
<p>What's funny is I wanted to write Bourbaki an email asking whether he currently think he left a gap about that completion map thing or whether he claims this is only an ellipsis</p>

<a name="135481916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481916" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481916">Patrick Massot (Oct 09 2018 at 16:36)</a>:</h4>
<p>Of course there is a risk he doesn't remember</p>

<a name="135481945"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135481945" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135481945">Patrick Massot (Oct 09 2018 at 16:37)</a>:</h4>
<p>he wrote that GT book in 1971</p>

<a name="135482138"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135482138" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135482138">Johan Commelin (Oct 09 2018 at 16:40)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> What does "original" mean for a masters project? Is computing an example enough? Or do we need a new lemma? Because that will be extremely hard to do in Lean.</p>

<a name="135482981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135482981" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135482981">Kevin Buzzard (Oct 09 2018 at 16:55)</a>:</h4>
<p>Proving some basic lemmas about schemes and completely fixing up the schemes code is definitely enough.</p>

<a name="135482985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135482985" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135482985">Kevin Buzzard (Oct 09 2018 at 16:55)</a>:</h4>
<p>Oh talking of schemes, you're not going to believe this: I've been asked to give a talk on them!</p>

<a name="135483047"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135483047" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135483047">Kevin Buzzard (Oct 09 2018 at 16:56)</a>:</h4>
<p><a href="http://aitp-conference.org/2019/" target="_blank" title="http://aitp-conference.org/2019/">http://aitp-conference.org/2019/</a> :D</p>

<a name="135483058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135483058" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135483058">Kevin Buzzard (Oct 09 2018 at 16:57)</a>:</h4>
<p>So it needs to be fixed up by then!</p>

<a name="135483616"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135483616" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135483616">Johan Commelin (Oct 09 2018 at 17:06)</a>:</h4>
<p>That's nice!</p>

<a name="135483634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135483634" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135483634">Johan Commelin (Oct 09 2018 at 17:06)</a>:</h4>
<p>So I suggest that this master student turns it into a project to get schemes into mathlib. And then prove the Gamma_Spec adjunction.</p>

<a name="135483666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135483666" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135483666">Johan Commelin (Oct 09 2018 at 17:07)</a>:</h4>
<p>Alternatively, define smooth morphisms. Or something like that.</p>

<a name="135484086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135484086" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135484086">Kevin Buzzard (Oct 09 2018 at 17:15)</a>:</h4>
<p>I'd forgotten about gamma spec adjunction! That's an excellent project</p>

<a name="135484098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135484098" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135484098">Kevin Buzzard (Oct 09 2018 at 17:15)</a>:</h4>
<p>I never even did locally ringed spaces</p>

<a name="135484202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135484202" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135484202">Kevin Buzzard (Oct 09 2018 at 17:16)</a>:</h4>
<p>Because spec of a ring is automatically locally ringed and I never defined a morphism of schemes :-)</p>

<a name="135484402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135484402" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135484402">Johan Commelin (Oct 09 2018 at 17:20)</a>:</h4>
<p>Right, so we need some category theory (-;</p>

<a name="135484434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135484434" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135484434">Johan Commelin (Oct 09 2018 at 17:20)</a>:</h4>
<p>Another non-trivial but fundamental thing: fibre products of schemes.</p>

<a name="135488955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135488955" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135488955">Reid Barton (Oct 09 2018 at 18:33)</a>:</h4>
<blockquote>
<p>"let F be a presheaf of rings on the topological space X"</p>
</blockquote>
<p>As it happens, we have this specific thing already. Not sure how far that will actually get you though.</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">category_theory</span><span class="bp">.</span><span class="n">opposites</span>
<span class="kn">import</span> <span class="n">category_theory</span><span class="bp">.</span><span class="n">examples</span><span class="bp">.</span><span class="n">topological_spaces</span>
<span class="kn">import</span> <span class="n">category_theory</span><span class="bp">.</span><span class="n">examples</span><span class="bp">.</span><span class="n">rings</span>

<span class="kn">open</span> <span class="n">category_theory</span> <span class="n">category_theory</span><span class="bp">.</span><span class="n">examples</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="n">Top</span><span class="o">}</span> <span class="o">{</span><span class="n">F</span> <span class="o">:</span> <span class="o">(</span><span class="n">open_set</span> <span class="n">X</span><span class="o">)</span><span class="err">ᵒᵖ</span> <span class="err">⥤</span> <span class="n">Ring</span><span class="o">}</span>
</pre></div>

<a name="135489039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135489039" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135489039">Patrick Massot (Oct 09 2018 at 18:34)</a>:</h4>
<p>But we can't look at its stalks, right?</p>

<a name="135489043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135489043" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135489043">Reid Barton (Oct 09 2018 at 18:34)</a>:</h4>
<p>except it looks like <code>open_set</code> already has the order reversed for some reason</p>

<a name="135489065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135489065" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135489065">Reid Barton (Oct 09 2018 at 18:35)</a>:</h4>
<p>Right, basically anything past this involves either limits or colimits of some kind.</p>

<a name="135500370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135500370" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135500370">Scott Morrison (Oct 09 2018 at 21:27)</a>:</h4>
<p>I'm listening. :-) I've tried once or twice to just make my code on limits not need backwards_reasoning, but it felt pretty painful to me. <code>backwards_reasoning</code> \ <code>back</code> is actually quite close. Simon has ideas to make it efficient, but hopefully an inefficient PR can make it into mathlib if there's a promise we know how to make it fast, later.</p>

<a name="135500456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135500456" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135500456">Scott Morrison (Oct 09 2018 at 21:28)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span>, Should I revert <code>open_set</code> to the usual definition? I guess I was just thinking "no one ever uses the forward direction, just the opposite category, lets just cut out the middleman".</p>

<a name="135500470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135500470" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135500470">Scott Morrison (Oct 09 2018 at 21:29)</a>:</h4>
<p>(Perhaps the explicit opposites were causing some pain, but I don't think so.)</p>

<a name="135501687"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135501687" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135501687">Reid Barton (Oct 09 2018 at 21:53)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span>, if the many different shapes of limit are causing some difficulty, I know that I would find it already very helpful to have just general (co)limits. Perhaps it would even be possible to do a version of these before <code>back</code> is merged (I might take another shot at this in a couple of days--I tried to set up a branch with all the limit types but it turned into too much work).</p>

<a name="135501770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135501770" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135501770">Reid Barton (Oct 09 2018 at 21:54)</a>:</h4>
<p>Basically everything I want to formalize for locally presentable categories and model categories involves some kind of limits or colimits but a large fraction of it only needs general (co)limits (some other parts do need specific shapes like pushouts).</p>

<a name="135501785"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135501785" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135501785">Reid Barton (Oct 09 2018 at 21:54)</a>:</h4>
<p>I guess the situation for perfectoid spaces may be similar</p>

<a name="135502648"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135502648" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135502648">Scott Morrison (Oct 09 2018 at 22:10)</a>:</h4>
<p>Ok, I'll keep that in mind. There are a few missing sections on equalizers and pullbacks, but I was intending to leave those out at first anyway. Really the only thing to do for the PR is deal with the dependency on <code>back</code>.</p>

<a name="135534437"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135534437" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135534437">Scott Morrison (Oct 10 2018 at 11:21)</a>:</h4>
<p>getting closer. The new <code>back</code> works fine in my limits code, now it's just a matter of copying and pasting all the sequences of rewrites <code>rewrite_search</code> finds into the source code... :-(</p>

<a name="135534445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135534445" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135534445">Scott Morrison (Oct 10 2018 at 11:21)</a>:</h4>
<p>It's not like <code>rewrite_search</code> is going to be merged anytime soon. :-)</p>

<a name="135534730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135534730" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135534730">Johan Commelin (Oct 10 2018 at 11:28)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> This copy-pasting should/can be automated.</p>

<a name="135534746"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135534746" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135534746">Scott Morrison (Oct 10 2018 at 11:28)</a>:</h4>
<p>Meh... it should be made unnecessary. :-)</p>

<a name="135534748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135534748" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135534748">Johan Commelin (Oct 10 2018 at 11:28)</a>:</h4>
<p>Anyway, I'm really glad to hear that <code>back</code> is converging to mathlib.</p>

<a name="135534750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135534750" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135534750">Scott Morrison (Oct 10 2018 at 11:28)</a>:</h4>
<p>But okay, I agree.</p>

<a name="135534765"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135534765" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135534765">Johan Commelin (Oct 10 2018 at 11:29)</a>:</h4>
<p>I wrote a substitution script that takes coordinates and replacement text and patches up your file.</p>

<a name="135534766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135534766" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135534766">Scott Morrison (Oct 10 2018 at 11:29)</a>:</h4>
<p>We need to learn how to have tactics talk directly to VS Code.</p>

<a name="135534770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135534770" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135534770">Johan Commelin (Oct 10 2018 at 11:29)</a>:</h4>
<p>It is a sort of poor man's diff-patch.</p>

<a name="135534771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135534771" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135534771">Scott Morrison (Oct 10 2018 at 11:29)</a>:</h4>
<p>command line scripts are too messy</p>

<a name="135534779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135534779" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135534779">Scott Morrison (Oct 10 2018 at 11:29)</a>:</h4>
<p>I think Gabriel and Mario were talking about exactly this</p>

<a name="135560201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135560201" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135560201">Mario Carneiro (Oct 10 2018 at 18:43)</a>:</h4>
<p>Could <span class="user-mention" data-user-id="110087">@Scott Morrison</span> or someone explain why limits are difficult to formalize or require <code>back</code>? Seems like the basics are just more definitions, and everyone I have seen talking about (co)limits don't seem to expect more than that</p>

<a name="135560302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135560302" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135560302">Johan Commelin (Oct 10 2018 at 18:44)</a>:</h4>
<p>I think it is mostly to make <code>obviously</code> do the right thing as auto_param.</p>

<a name="135560330"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135560330" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135560330">Johan Commelin (Oct 10 2018 at 18:45)</a>:</h4>
<p>But I'm only guessing.</p>

<a name="135571576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135571576" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135571576">Scott Morrison (Oct 10 2018 at 22:13)</a>:</h4>
<p>Yeah, it is mostly me being lame, and not wanting to give up my automation. Sorry for making everyone wait. I made <code>limits.lean</code> itself mathlib ready last night, and as it turned out removing the dependency on <code>rewrite_search</code> was much more painful than removing <code>back</code> would have been.</p>

<a name="135727023"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135727023" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135727023">Kevin Buzzard (Oct 13 2018 at 10:34)</a>:</h4>
<p>I am doing a review of the stacks project code, because this is far more interesting than all the crappy reference letter requests I have piling up and I can now legitimately claim that is part of a work project, because I have an MSc student who is going to work on it and I am speaking about it at AITP 2019.</p>

<a name="135727025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135727025" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135727025">Kevin Buzzard (Oct 13 2018 at 10:34)</a>:</h4>
<p>Are open immersions of topological spaces in mathlib?</p>

<a name="135727035"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135727035" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135727035">Kevin Buzzard (Oct 13 2018 at 10:35)</a>:</h4>
<p>Basic things such as composition of two open immersions is an open immersion, that sort of thing.</p>

<a name="135727250"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135727250" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135727250">Patrick Massot (Oct 13 2018 at 10:43)</a>:</h4>
<p>The closest that we almost have is <a href="https://github.com/leanprover-community/mathlib/blob/9d743bbb864234821c4ec881d4dc930ac3631838/analysis/topology/continuity.lean#L401" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/9d743bbb864234821c4ec881d4dc930ac3631838/analysis/topology/continuity.lean#L401">https://github.com/leanprover-community/mathlib/blob/9d743bbb864234821c4ec881d4dc930ac3631838/analysis/topology/continuity.lean#L401</a></p>

<a name="135906728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135906728" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135906728">Kevin Buzzard (Oct 16 2018 at 15:17)</a>:</h4>
<p>I want to define a locally ringed space in Lean (or rather get a student to define it). So this is a topological space plus a sheaf of rings plus an axiom about some direct limits (see <a href="https://stacks.math.columbia.edu/tag/01HA" target="_blank" title="https://stacks.math.columbia.edu/tag/01HA">stacks project</a> for more info). I don't see that we have to wait for categories for this to happen. But when categories arrive, will this work somehow be wasted? I am assuming not. I didn't ever define a locally ringed space in the schemes repo, I dodged it, but I think I want to do things more properly this time.</p>

<a name="135910198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135910198" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135910198">Reid Barton (Oct 16 2018 at 16:10)</a>:</h4>
<p>Well, what work is there? Certainly the bits to do with defining local rings and local ring maps will not be made redundant.</p>

<a name="135910259"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135910259" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135910259">Reid Barton (Oct 16 2018 at 16:10)</a>:</h4>
<p>We already have all the ingredients for presheaves of rings in mathlib.</p>

<a name="135910412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135910412" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135910412">Reid Barton (Oct 16 2018 at 16:13)</a>:</h4>
<p>There is an oper PR which includes equalizers and products and another WIP one which constructs them for rings, so then you can define sheaves in that language. Johan seemed interested in defining sites for the perfectoid space project, and that seems like a reasonably small amount of effort to "future-proof" sheaves for the zariski topology</p>

<a name="135910505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135910505" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135910505">Johan Commelin (Oct 16 2018 at 16:15)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> I think all the category theory will be there before your student has learned enough Lean to start working on this project.</p>

<a name="135910520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135910520" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135910520">Reid Barton (Oct 16 2018 at 16:15)</a>:</h4>
<p>I think the remaining bit is to construct directed colimits of rings. Here you probably cannot avoid spending some effort which, eventually, could be superseded by some general machinery on finitary algebraic theories</p>

<a name="135910526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135910526" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135910526">Kevin Buzzard (Oct 16 2018 at 16:15)</a>:</h4>
<p>My student is a 4th year joint maths and computing student that spent the summer working with Coq</p>

<a name="135910571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135910571" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135910571">Kevin Buzzard (Oct 16 2018 at 16:16)</a>:</h4>
<p>The issue is that he has to learn some commutative algebra</p>

<a name="135910634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135910634" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135910634">Kevin Buzzard (Oct 16 2018 at 16:17)</a>:</h4>
<blockquote>
<p>We already have all the ingredients for presheaves of rings in mathlib.</p>
</blockquote>
<p>So what does the definition of a locally ringed space look like now? It's going to be a structure consisting of a topological space, and then a presheaf of rings -- but I shouldn't define this by hand myself now? And then some lemma about a direct limit being local.</p>

<a name="135910706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135910706" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135910706">Johan Commelin (Oct 16 2018 at 16:18)</a>:</h4>
<p>Well, stalks are also done by Scott. This should land within a couple of weeks (at most).</p>

<a name="135910719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135910719" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135910719">Johan Commelin (Oct 16 2018 at 16:18)</a>:</h4>
<p>So you have to define a ring structure on the stalk. Local rings are already in mathlib.</p>

<a name="135910833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135910833" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135910833">Kevin Buzzard (Oct 16 2018 at 16:20)</a>:</h4>
<p>Stalks for sheaves of sets I guess?</p>

<a name="135910842"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135910842" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135910842">Kevin Buzzard (Oct 16 2018 at 16:20)</a>:</h4>
<p>or types in this case</p>

<a name="135911308"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135911308" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135911308">Johan Commelin (Oct 16 2018 at 16:27)</a>:</h4>
<p>Yes, exactly. That's what I meant with "you have to define a ring structure on the stalk". I really think that this project should try to make schemes mathlib-ready. And as corollary, use all the machinery that is (almost) available.</p>

<a name="135912622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135912622" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135912622">Reid Barton (Oct 16 2018 at 16:49)</a>:</h4>
<p>And the fact that you can define a ring structure on the stalk clearly has very little to do with the specific definition of a ring.</p>

<a name="135912651"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135912651" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135912651">Reid Barton (Oct 16 2018 at 16:49)</a>:</h4>
<p>So if you do it for rings in particular, then in the long run that particular effort is "wasted" (in some sense)</p>

<a name="135944821"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135944821" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135944821">Scott Morrison (Oct 17 2018 at 02:28)</a>:</h4>
<p>I have no idea what compiles here, but<br>
<a href="https://github.com/semorrison/lean-category-theory/blob/working/src/category_theory/presheaves/locally_ringed.lean" target="_blank" title="https://github.com/semorrison/lean-category-theory/blob/working/src/category_theory/presheaves/locally_ringed.lean">https://github.com/semorrison/lean-category-theory/blob/working/src/category_theory/presheaves/locally_ringed.lean</a></p>

<a name="135945243"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135945243" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135945243">Scott Morrison (Oct 17 2018 at 02:38)</a>:</h4>
<p>Certainly filtered colimits of rings is not done yet, and should be. Your student, Kevin, should do this!</p>

<a name="135948225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135948225" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135948225">Mario Carneiro (Oct 17 2018 at 04:12)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> I think that it would be best to do this with categories. Now that they are there, they should be put to some use! I recall you using this as an argument in favor of category theory last time this came up</p>

<a name="135954315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135954315" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135954315">Kevin Buzzard (Oct 17 2018 at 07:06)</a>:</h4>
<p>I think that when I was trying to write the code last Feb I would just keep saying "look these things are a category" without ever really thinking about what advantage this would actually give me. Here's a concrete question. A locally ringed space is a topological space, a functor from the category of open sets to the category of rings, an axiom about this functor (a statement about the values of the functor on open covers of open sets -- some kernel equals some image) and another axiom about this functor (about direct limits of rings which are values of the functor being local rings). I can write all of that without ever mentioning categories, but the language (functors, direct limits) is everywhere. I am still unclear about what the modern way to define this structure is (independent of my usual confusion about what should be bundled).</p>

<a name="135954380"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135954380" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135954380">Johan Commelin (Oct 17 2018 at 07:09)</a>:</h4>
<p>Kevin, you saw that I could extend a presheaf from a basis in 10 lines. Otoh now I'm struggling with topological bases, and it's a real pain.</p>

<a name="135954459"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135954459" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135954459">Kevin Buzzard (Oct 17 2018 at 07:11)</a>:</h4>
<p>I am not reading these technical threads carefully right now, I am really snowed under. I write in the beginner threads because those are the only ones where I can understand what's going on easily and quickly. I do remember your post though. And you can do this because you defined a presheaf to be a functor?</p>

<a name="135954738"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135954738" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135954738">Johan Commelin (Oct 17 2018 at 07:19)</a>:</h4>
<p>I can do this because of all Scott's magic. The automation takes care of a lot of painful noise.</p>

<a name="135955243"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/135955243" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#135955243">Kevin Buzzard (Oct 17 2018 at 07:32)</a>:</h4>
<p><a href="#narrow/stream/116395-maths/subject/extend.20presheaf.20from.20basis/near/135546628" title="#narrow/stream/116395-maths/subject/extend.20presheaf.20from.20basis/near/135546628">https://leanprover.zulipchat.com/#narrow/stream/116395-maths/subject/extend.20presheaf.20from.20basis/near/135546628</a> (for my own reference)</p>

<a name="136274105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136274105" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136274105">Kevin Buzzard (Oct 22 2018 at 15:20)</a>:</h4>
<p><a href="#narrow/stream/116395-maths/subject/extend.20presheaf.20from.20basis/near/135546628" title="#narrow/stream/116395-maths/subject/extend.20presheaf.20from.20basis/near/135546628">presheaf stuff</a></p>

<a name="136274134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136274134" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136274134">Kevin Buzzard (Oct 22 2018 at 15:21)</a>:</h4>
<p>(deleted)</p>

<a name="136274294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136274294" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136274294">Kevin Buzzard (Oct 22 2018 at 15:23)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> it's time that the people at Imperial College began to understand how presheaves work now. <span class="user-mention" data-user-id="132858">@Ramon Fernandez Mir</span> is hopefully going to be formalising a locally ringed space soon.</p>

<a name="136274857"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136274857" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136274857">Ramon Fernandez Mir (Oct 22 2018 at 15:30)</a>:</h4>
<p>Hello, I'm Ramon. I'm doing my Master's project with Kevin and we'll be formalising more parts of the Stacks project. As he said, I'm currently trying to formalise a locally ringed space. I was wondering where I could find the</p>
<blockquote>
<p><a href="#narrow/stream/116395-maths/subject/extend.20presheaf.20from.20basis/near/135546628" title="#narrow/stream/116395-maths/subject/extend.20presheaf.20from.20basis/near/135546628">presheaf stuff</a></p>
</blockquote>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span></p>

<a name="136279420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136279420" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136279420">Johan Commelin (Oct 22 2018 at 16:46)</a>:</h4>
<p><span class="user-mention" data-user-id="132858">@Ramon Fernandez Mir</span> Hi, nice to meet you! I'm pretty busy until next week Wednesday (2 guests are visiting), but after that I hope to return to this stuff. In the mean time I'll keep an I on these threads.</p>

<a name="136343084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136343084" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136343084">Kevin Buzzard (Oct 23 2018 at 15:14)</a>:</h4>
<p>So to do locally ringed spaces we need that stalks are local, so we need colimits in the category of commutative rings. If we were doing this in a category free way then I'd know what to do. How does this all work within the category theory framework? This would be a colimit over the set of all open sets containing a fixed point <code>a</code> in a topological space <code>X</code>.</p>

<a name="136343514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136343514" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136343514">Reid Barton (Oct 23 2018 at 15:20)</a>:</h4>
<p>I assume you also want a specific explicit description of the stalk. So under the current/near future state of category theory in mathlib, I would suggest just doing the "category-free" construction, and then if it seems useful or interesting, also show that what you built is actually a colimit, i.e., fits in a cocone with the expected universal property.</p>

<a name="136343663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136343663" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136343663">Reid Barton (Oct 23 2018 at 15:23)</a>:</h4>
<p>I guess proving that the stalk is a colimit should help you prove that a morphism of ringed spaces does induce maps on stalks, for example.</p>

<a name="136343856"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136343856" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136343856">Reid Barton (Oct 23 2018 at 15:25)</a>:</h4>
<p>But given the state of limits right now, "should" in that sentence is more of a design criterion for limits, not an assertion.</p>

<a name="136345079"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136345079" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136345079">Reid Barton (Oct 23 2018 at 15:40)</a>:</h4>
<p>Ah, but the <em>input</em> to the construction of a filtered (or directed) colimit of rings should already be in the category theory language.</p>

<a name="136345498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136345498" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136345498">Reid Barton (Oct 23 2018 at 15:44)</a>:</h4>
<p>Let me check what is actually in mathlib so far...</p>

<a name="136345838"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136345838" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136345838">Reid Barton (Oct 23 2018 at 15:49)</a>:</h4>
<p>I suggest starting from here</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">category_theory</span><span class="bp">.</span><span class="n">functor</span>
<span class="kn">import</span> <span class="n">category_theory</span><span class="bp">.</span><span class="n">examples</span><span class="bp">.</span><span class="n">rings</span>

<span class="kn">universe</span> <span class="n">u</span>

<span class="c">/-</span><span class="cm"> Copied from https://github.com/semorrison/lean-category-theory/blob/master/src/category_theory/filtered.lean -/</span>
<span class="c">/-</span><span class="cm"> Name collides with mathlib `directed`... -/</span>
<span class="n">class</span> <span class="n">directed_preorder</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">preorder</span> <span class="n">α</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">bound</span> <span class="o">(</span><span class="n">x₁</span> <span class="n">x₂</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span>
<span class="o">(</span><span class="n">i₁</span> <span class="o">(</span><span class="n">x₁</span> <span class="n">x₂</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">x₁</span> <span class="bp">≤</span> <span class="n">bound</span> <span class="n">x₁</span> <span class="n">x₂</span><span class="o">)</span>
<span class="o">(</span><span class="n">i₂</span> <span class="o">(</span><span class="n">x₁</span> <span class="n">x₂</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">x₂</span> <span class="bp">≤</span> <span class="n">bound</span> <span class="n">x₁</span> <span class="n">x₂</span><span class="o">)</span>

<span class="kn">open</span> <span class="n">category_theory</span><span class="bp">.</span><span class="n">examples</span>

<span class="n">def</span> <span class="n">directed_colimit_of_rings</span> <span class="o">{</span><span class="n">J</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">preorder</span> <span class="n">J</span><span class="o">]</span> <span class="o">[</span><span class="n">directed_preorder</span> <span class="n">J</span><span class="o">]</span>
  <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">J</span> <span class="err">⥤</span> <span class="n">Ring</span><span class="o">)</span> <span class="o">:</span> <span class="n">Ring</span> <span class="o">:=</span>
<span class="n">sorry</span>
</pre></div>

<a name="136346013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136346013" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136346013">Reid Barton (Oct 23 2018 at 15:51)</a>:</h4>
<p>and then also constructing morphisms in <code>Ring</code> from <code>F j</code> to <code>directed_colimit_of_rings F</code>, and checking that these are compatible with the diagram maps <code>F j -&gt; F k</code>, and then also that <code>directed_colimit_of_rings F</code> has the universal property</p>

<a name="136346088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136346088" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136346088">Reid Barton (Oct 23 2018 at 15:52)</a>:</h4>
<p>(and possibly you want to do filtered colimits instead, though directed ones would be enough for Zariski)</p>

<a name="136346609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136346609" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136346609">Reid Barton (Oct 23 2018 at 16:00)</a>:</h4>
<p>Then, I would suggest building the indexing category for the colimit "opens containing <code>x</code>" by hand, or possibly using <code>full_subcategory</code>, and check that its opposite category is filtered, and then define <code>stalk x F</code> as the <code>directed_colimit_of_rings</code> of <code>F</code> composed with the inclusion of "opens containing <code>x</code>" in <code>opens X</code></p>

<a name="136346750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136346750" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136346750">Reid Barton (Oct 23 2018 at 16:02)</a>:</h4>
<p>Oh, I see that that <code>directed_preorder</code> is missing the <code>inhabited</code> constraint</p>

<a name="136346863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136346863" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136346863">Reid Barton (Oct 23 2018 at 16:04)</a>:</h4>
<p>(I'm also not sure that <code>directed_preorder</code> should really contain data, rather than being a Prop or subsingleton)</p>

<a name="136348068"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/136348068" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#136348068">Kevin Buzzard (Oct 23 2018 at 16:22)</a>:</h4>
<p>Oh thanks a lot Reid! This is all for <span class="user-mention" data-user-id="132858">@Ramon Fernandez Mir</span> who knows a bunch of Coq but is just starting with Lean.</p>

<a name="156927907"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/156927907" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#156927907">Kevin Buzzard (Jan 26 2019 at 14:42)</a>:</h4>
<p>Should it be <code>H : scheme S</code> or <code>S : scheme</code>? In CS language I think this is asking whether schemes should be bundled or unbundled.</p>
<p>Any seasoned algebraic geometer will tell you that whilst the set underlying a scheme is of key technical importance, it does not play a completely central role, unlike the set underlying a group. For example, the set underlying a scheme has a topology on it, but the topology is grotesque -- on an irreducible scheme every non-empty open set is dense, there are typically many non-closed points and so on. One essentially never uses standard useful results from topology on this topological space, a standard way to prove things about schemes is to reduce them to questions about commutative rings and then do some commutative ring theory.</p>
<p>To give another example -- the category of schemes has products, but the underlying set of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo>×</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">S\times T</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span> is essentially never the product of the underlying sets of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.05764em;">S</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span>. So the kind of typeclass inference instances one sees for products of groups (<code>group G</code> and <code>group H</code> to <code>group (G x H)</code> ) is not correct for schemes.</p>
<p>Is this evidence that schemes should be bundled? I hope I got this the right way round -- I mean put the underlying topological space as a carrier and just have a structure called <code>scheme</code>? Or is the bundle/unbundle issue about other things?</p>
<p>We don't have much bundled stuff in mathlib. My naive understanding of what Cyril and Assia were telling us in Amsterdam was that perhaps if we did then we would begin to understand the power of unification hints. I am still very unclear about the general arguments for and against bundling, my impression is that when I ask a question of this nature the answer is often "try both and see which works best". But if we are to move forward with categories we'd better get the hang of bundling, right?</p>

<a name="156928424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/156928424" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#156928424">Reid Barton (Jan 26 2019 at 14:59)</a>:</h4>
<p>I would definitely recommend "bundled" (<code>S : scheme</code>)</p>

<a name="156928606"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/156928606" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#156928606">Reid Barton (Jan 26 2019 at 15:04)</a>:</h4>
<p>The underlying set of a scheme is basically never going to have any interesting kind of structure other than that which comes from being a scheme (this is related to the underlying set not commuting with products, so that the underlying set of a group scheme is not a group, etc.)</p>

<a name="156928672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/156928672" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#156928672">Reid Barton (Jan 26 2019 at 15:06)</a>:</h4>
<p>You can give <code>scheme</code> a <code>has_coe_to_sort</code> instance and write an instance for <code>(S : scheme) : topological_space S</code> so that you can still write <code>p : S</code>, <code>is_open U</code> where <code>U : set S</code>, etc.</p>

<a name="156928876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/156928876" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#156928876">Kevin Buzzard (Jan 26 2019 at 15:13)</a>:</h4>
<p><span class="user-mention" data-user-id="132858">@Ramon Fernandez Mir</span> the way I set it up in my schemes repo is perhaps a bad idea. Let's bundle!</p>

<a name="160308244"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160308244" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160308244">Ramon Fernandez Mir (Mar 08 2019 at 17:32)</a>:</h4>
<p>What do we think about:</p>
<div class="codehilite"><pre><span></span><span class="kn">structure</span> <span class="n">scheme</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">carrier</span>    <span class="o">:</span> <span class="n">locally_ringed_space</span> <span class="n">X</span><span class="o">)</span>
<span class="o">(</span><span class="n">Haffinecov</span> <span class="o">:</span>
  <span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="bp">∃</span> <span class="n">U</span> <span class="o">:</span> <span class="n">opens</span> <span class="n">X</span><span class="o">,</span>
      <span class="n">x</span> <span class="err">∈</span> <span class="n">U</span>
    <span class="bp">∧</span> <span class="bp">∃</span> <span class="n">R</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">OSpecR</span> <span class="o">:</span> <span class="n">locally_ringed_space</span> <span class="o">(</span><span class="n">Spec</span> <span class="n">R</span><span class="o">)),</span>
      <span class="o">(</span><span class="n">res</span> <span class="n">U</span> <span class="n">carrier</span><span class="o">)</span> <span class="err">≅</span> <span class="n">OSpecR</span><span class="o">)</span>
</pre></div>


<p>Here <code>res</code> follows from what I was saying in <a href="#narrow/stream/116395-maths/topic/Subspaces.20and.20opens" title="#narrow/stream/116395-maths/topic/Subspaces.20and.20opens">https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Subspaces.20and.20opens</a> and is the only bit missing. <code>≅</code> is an isomorphism of locally ringed spaces.</p>

<a name="160308401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160308401" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160308401">Johan Commelin (Mar 08 2019 at 17:35)</a>:</h4>
<p>It's great to see this progressing!</p>

<a name="160308436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160308436" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160308436">Johan Commelin (Mar 08 2019 at 17:35)</a>:</h4>
<p>I'm a bit confused by <code>(OSpecR : locally_ringed_space (Spec R))</code></p>

<a name="160308592"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160308592" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160308592">Johan Commelin (Mar 08 2019 at 17:37)</a>:</h4>
<p>Anyway, congrats for getting this far! Are you planning to PR stuff to mathlib?</p>

<a name="160308601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160308601" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160308601">Ramon Fernandez Mir (Mar 08 2019 at 17:37)</a>:</h4>
<p>Does this help?</p>
<div class="codehilite"><pre><span></span><span class="kn">structure</span> <span class="n">locally_ringed_space</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">OX</span>      <span class="o">:</span> <span class="n">sheaf_of_rings</span> <span class="n">X</span><span class="o">)</span>
<span class="o">(</span><span class="n">Hstalks</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">is_local_ring</span> <span class="o">(</span><span class="n">stalk_of_rings</span> <span class="n">OX</span><span class="bp">.</span><span class="n">F</span> <span class="n">x</span><span class="o">))</span>
</pre></div>

<a name="160308723"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160308723" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160308723">Johan Commelin (Mar 08 2019 at 17:39)</a>:</h4>
<p>You are asking for the existence of a locally_ringed_space structure on <code>Spec R</code>. But you don't just want that something exists...</p>

<a name="160308736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160308736" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160308736">Johan Commelin (Mar 08 2019 at 17:39)</a>:</h4>
<p>You want to use a carefully constructed one.</p>

<a name="160308879"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160308879" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160308879">Johan Commelin (Mar 08 2019 at 17:40)</a>:</h4>
<p>Somewhere you must have some definition</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">blah</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">:</span> <span class="n">locally_ringed_space</span> <span class="o">(</span><span class="n">Spec</span> <span class="n">R</span><span class="o">)</span>
</pre></div>

<a name="160308924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160308924" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160308924">Johan Commelin (Mar 08 2019 at 17:41)</a>:</h4>
<p>You want to use that definition here.</p>

<a name="160309251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160309251" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160309251">Johan Commelin (Mar 08 2019 at 17:45)</a>:</h4>
<p>Did you already formalise isomorphisms of locally ringed spaces? (Maybe even morphisms??)</p>

<a name="160309281"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160309281" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160309281">Ramon Fernandez Mir (Mar 08 2019 at 17:45)</a>:</h4>
<p>That's what I initially thought and I'm working on that definition. I thought this definition was correct though? Or is it a usability problem? Maybe my mistake is that I was just thinking about proving that an affine scheme is a scheme, which I think I can do with this definition.</p>

<a name="160309345"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160309345" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160309345">Johan Commelin (Mar 08 2019 at 17:46)</a>:</h4>
<p>No, this definition is not correct</p>

<a name="160309358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160309358" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160309358">Johan Commelin (Mar 08 2019 at 17:46)</a>:</h4>
<p>It is almost correct (-;</p>

<a name="160309384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160309384" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160309384">Johan Commelin (Mar 08 2019 at 17:46)</a>:</h4>
<p>Also, I'm surprised Lean would be happy with <code>\exists blabla, X \iso Y</code></p>

<a name="160309402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160309402" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160309402">Johan Commelin (Mar 08 2019 at 17:47)</a>:</h4>
<p>Because <code>X \iso Y</code> is not a <code>Prop</code>.</p>

<a name="160309509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160309509" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160309509">Johan Commelin (Mar 08 2019 at 17:48)</a>:</h4>
<p>So you will probably want to wrap that in a <code>nonempty</code>, or you save the isomorphism for later use, but then you can't use <code>\exists</code>.</p>

<a name="160309524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160309524" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160309524">Ramon Fernandez Mir (Mar 08 2019 at 17:48)</a>:</h4>
<p>That is actually my own local notation for isomorphism of locally ringed spaces. Probably should be using a different symbol, or simply <code>are_isomorphic</code>.</p>

<a name="160309614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160309614" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160309614">Johan Commelin (Mar 08 2019 at 17:49)</a>:</h4>
<p>The notation is fine. Just write <code>nonempty ((res _ _) \iso (Spec R))</code></p>

<a name="160309967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160309967" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160309967">Ramon Fernandez Mir (Mar 08 2019 at 17:53)</a>:</h4>
<p>I see I see, very useful advice. I'm glad I asked!</p>

<a name="160310205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160310205" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160310205">Johan Commelin (Mar 08 2019 at 17:56)</a>:</h4>
<p>But the bigger problem is the one I mentioned at the start.</p>

<a name="160310218"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160310218" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160310218">Johan Commelin (Mar 08 2019 at 17:56)</a>:</h4>
<p>Because that one wouldn't be caught by the type checker.</p>

<a name="160310231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160310231" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160310231">Johan Commelin (Mar 08 2019 at 17:56)</a>:</h4>
<p>Can you prove that affine schemes are schemes?</p>

<a name="160310247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160310247" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160310247">Johan Commelin (Mar 08 2019 at 17:57)</a>:</h4>
<p>Where is your proof that <code>Spec R</code> is a locally ringed space?</p>

<a name="160310597"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160310597" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160310597">Ramon Fernandez Mir (Mar 08 2019 at 18:01)</a>:</h4>
<p>I am hoping to be able to prove it soon. I have been working on the machinery to do so. Of course I need the right definition of a scheme first.</p>

<a name="160310654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160310654" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160310654">Ramon Fernandez Mir (Mar 08 2019 at 18:02)</a>:</h4>
<p>I mean that affine schemes are schemes.</p>

<a name="160310909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160310909" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160310909">Johan Commelin (Mar 08 2019 at 18:06)</a>:</h4>
<p>Can you prove that <code>Spec R</code> is a locally ringed space?</p>

<a name="160311175"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160311175" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160311175">Ramon Fernandez Mir (Mar 08 2019 at 18:09)</a>:</h4>
<p>I have a couple of bits missing but I should be able to. Now I think I fully understand the issue with my definition, I tried to be smart and skip a step and instead I did something dumb. In fact, proving that <code>Spec R</code> is a locally ringed space has just moved to the top of my TODO list.</p>

<a name="160311633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/160311633" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#160311633">Johan Commelin (Mar 08 2019 at 18:15)</a>:</h4>
<p>Great!</p>

<a name="163066733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163066733" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163066733">Kevin Buzzard (Apr 11 2019 at 03:28)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> Perhaps this is the place for the discussion about using categories. I discouraged Ramon from using them because this is an MSc project with a hard deadline so we couldn't afford to be waiting for PRs or becoming involved in technical design implementation decisions -- we needed everything to be done by around now. However if we forget about this and start taking the longer view then in principle I think it's natural to want to use the category theory language going forward.</p>

<a name="163066831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163066831" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163066831">Kevin Buzzard (Apr 11 2019 at 03:31)</a>:</h4>
<p>One reason I am beginning to think that this approach has its advantages is that as you know I've had questions over the last few days of the form "does Leave know that the category of topological rings has  limits?" If there was a topological ring category then I could just check the predicate and see where it leads me</p>

<a name="163068246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163068246" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163068246">Scott Morrison (Apr 11 2019 at 04:05)</a>:</h4>
<p>I think there's a lot of duplication that is happening because of not using the category theory library, as well as lots of missing generality.</p>

<a name="163068301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163068301" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163068301">Scott Morrison (Apr 11 2019 at 04:06)</a>:</h4>
<p>There does not need to be a proliferation of <code>equiv</code>s, and one can do (pre)sheaves of Xs for all Xs at once without any effort. Both are already problems in this definition of schemes.</p>

<a name="163068326"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163068326" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163068326">Scott Morrison (Apr 11 2019 at 04:07)</a>:</h4>
<p>I think the right way forward here is to start PRing all the zariski topology and localisation related stuff into mathlib, and as soon as general presheaves land in mathlib someone can start refactoring the (relatively small part) of the schemes code to use that style.</p>

<a name="163068377"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163068377" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163068377">Scott Morrison (Apr 11 2019 at 04:08)</a>:</h4>
<p>(I've actually just been looking through the <code>for_mathlib</code> directory of the perfectoid project... There's a lot to catch up on there!)</p>

<a name="163068903"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163068903" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163068903">Kevin Buzzard (Apr 11 2019 at 04:21)</a>:</h4>
<p>The reason there's a lot of stuff in there is there is that a lot of development happened recently when PRs were being slow so we made a decision to let it pile up there for now and get to the definition</p>

<a name="163068958"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163068958" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163068958">Scott Morrison (Apr 11 2019 at 04:22)</a>:</h4>
<p>Yes.</p>

<a name="163068975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163068975" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163068975">Kevin Buzzard (Apr 11 2019 at 04:23)</a>:</h4>
<p>There's a lot of infrastructure work needs doing in the perfectoid project.Tthere is also a <code>for_mathlib</code> directory in Ramon's schemes project but it's much more manageable</p>

<a name="163068998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163068998" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163068998">Scott Morrison (Apr 11 2019 at 04:23)</a>:</h4>
<p>I mean, everything in the schemes project should be in <code>for_mathlib</code>... :-)</p>

<a name="163069000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163069000" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163069000">Kevin Buzzard (Apr 11 2019 at 04:23)</a>:</h4>
<p>Ha ha</p>

<a name="163069002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163069002" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163069002">Scott Morrison (Apr 11 2019 at 04:24)</a>:</h4>
<p>No. I'm completely serious.</p>

<a name="163069051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163069051" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163069051">Scott Morrison (Apr 11 2019 at 04:24)</a>:</h4>
<p>In the (not so) long run anything that doesn't make it to mathlib will rot.</p>

<a name="163069054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163069054" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163069054">Kevin Buzzard (Apr 11 2019 at 04:24)</a>:</h4>
<p>Now it's been done in the correct generality I think there's a much more powerful argument for this .</p>

<a name="163069083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163069083" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163069083">Scott Morrison (Apr 11 2019 at 04:25)</a>:</h4>
<p>I think <code>for_mathlib</code> directories should be used to mean "ready for mathlib" (I just need to find some time to cut some PRs).</p>

<a name="163069098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163069098" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163069098">Kevin Buzzard (Apr 11 2019 at 04:25)</a>:</h4>
<p>We cut corners initially; starting again from scratch enabled me to ensure that things were constructed properly this time</p>

<a name="163069104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163069104" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163069104">Scott Morrison (Apr 11 2019 at 04:25)</a>:</h4>
<p>And everything else is "not ready for mathlib" rather than "not intended for mathlib".</p>

<a name="163069111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163069111" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163069111">Kevin Buzzard (Apr 11 2019 at 04:26)</a>:</h4>
<p>For example we have locally ringed spaces</p>

<a name="163069157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163069157" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163069157">Kevin Buzzard (Apr 11 2019 at 04:26)</a>:</h4>
<p>The development is done in a much more mathlibby style</p>

<a name="163069169"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163069169" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163069169">Kevin Buzzard (Apr 11 2019 at 04:27)</a>:</h4>
<p>The correct objects are defined rather than corners being cut</p>

<a name="163069181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163069181" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163069181">Kevin Buzzard (Apr 11 2019 at 04:27)</a>:</h4>
<p>In stark contrast to the perfectoid project :P</p>

<a name="163200175"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163200175" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163200175">Ramon Fernandez Mir (Apr 12 2019 at 15:24)</a>:</h4>
<p>Hi, sorry I didn't reply on the other thread. I won't be able to do much in the following month or so as I have exams. However, I agree with <span class="user-mention" data-user-id="110087">@Scott Morrison</span> that in order to eventually have schemes in the mathlib we need to use <a href="https://github.com/leanprover-community/mathlib/pull/886" target="_blank" title="https://github.com/leanprover-community/mathlib/pull/886">#886</a> and related. Since there are still a few pieces missing and I have to submit everything in two months, I don't think it's a good idea for me to start refactoring sheaves but I quite like the idea of PRing everything else and making the schemes repository as small as possible.</p>

<a name="163203231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163203231" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163203231">Johan Commelin (Apr 12 2019 at 16:00)</a>:</h4>
<p>That sounds like a reasonable plan.</p>

<a name="163580117"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163580117" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163580117">Kevin Buzzard (Apr 17 2019 at 17:00)</a>:</h4>
<p>OK so over the last day or two I had a good look at what Ramon has done. One reason I did this was that we need sheaves for the perfectoid project, and I really wanted to use categories, but I find it very hard to make them work because of (a) universe issues (b) the fact that much of the relevant stuff is not yet in mathlib (which breaks update-mathlib which breaks my workflow). Talking about this to Johan (who has had more experience using the category theory repo than me) he says that I'm trying to use it too quickly, and getting a solid API is even more crucial than when using non-category theory Lean.  </p>
<p>I have come to the conclusion that I shouldn't be running before I can walk. So <span class="user-mention" data-user-id="110087">@Scott Morrison</span> <span class="user-mention" data-user-id="112680">@Johan Commelin</span> <span class="user-mention" data-user-id="110032">@Reid Barton</span> <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> here is my current proposal. <span class="user-mention" data-user-id="132858">@Ramon Fernandez Mir</span> has made what looks to me like a very solid repo</p>
<p><a href="https://github.com/ramonfmir/lean-scheme" target="_blank" title="https://github.com/ramonfmir/lean-scheme">https://github.com/ramonfmir/lean-scheme</a></p>
<p>where he defines schemes and locally ringed spaces, and proves that an affine scheme is a scheme. He did not use category theory stuff at all. The code is an order of magnitude better than the code that Chris Kenny and I wrote when we were beginners. Most or all of my poor design decisions have been fixed. A crucial role is played by <span class="user-mention" data-user-id="130308">@Neil Strickland</span> 's localisation predicate (which Ramon has now turned into a proper API, because he has had to use it extensively in the code). </p>
<p>The "next" results in the development of schemes are: to define a morphism of locally ringed spaces, and to prove that Spec: comm_ring -&gt; locally ringed spaces and Gamma: locally ringed spaces -&gt; comm_ring are adjoint functors. I am confident that Ramon's code will be good enough to make a non-category-theory proof of this. But the very statement of this is more naturally expressed in category theory language.</p>
<p>So it seems to me that a <em>better</em> test than the perfectoid repo, for seeing if categories are, or could be, made usable in Lean in the future (and I am optimistic that they can be), is to see if we can do some or all of the following things:</p>
<p>1) prove the Gamma-Spec adjunction within the language of category theory, in Lean.</p>
<p>2) replace Ramon's "hand-coded" sheaves of types and rings with category sheaves of types and rings</p>
<p>3) replace Ramon's "sheaf on a basis" with a category-theoretical approach</p>
<p>This to me looks like a substantial task. However what I am <em>hoping</em> is that actually rather than having to completely refactor the repo, we can actually incrementally build upon it, replacing definitions one by one. Doing this will show us actually whether things like total code length is going down or up when the category theory language is used. </p>
<p>I am wondering whether the fact that the code is already there in non-categorified form will somehow make experiments here easier than having to develop the theory from first principles. This is what my interpretation of Johan's API comment is. Johan -- if we have made all the definitions and proved all the theorems already, how easy will it be to make new definitions and prove new theorems using the category theory language? I think this will be a good test for the category theory stuff.</p>
<p>I am in no hurry to do this project, and Ramon now has to worry about other things such as passing his exams and writing up a pdf document about his project. But it seems to me to be a good practical application of all this category theory language and it might shed some light on things like design decisions. For example it occurred to me when trying to use categories within perfectoids that I really had lost all sight of the reason that I was trying to be maximally universe polymorphic. I had objects living in universe u and morphism sets Hom(X,Y) living in universe v. Why? I have no idea. All the other people using perfectoid spaces have objects living in Type and morphisms living in Type. Every example of a perfectoid space we will ever make, will live in Type, as far as I can see. At the very least Scott and I realised that perhaps we should have objects in <code>Obj : Type u+1</code> and morphisms in <code>Hom X Y : Type u</code> (have I got this the right way round?). These "large categories" (if I've got it right) might make universes more manageable. The way I have started to think about them is like this: imagine I'm doing this stuff in ZFC (which was the way I always used to think about them). Where do the objects live there? Now call the ZFC universe u and see what happens. In particular I am suggesting that, just like the way Lean defines the reals to be a term of type Type rather than Type u, we define "concrete" categories such as the category of perfectoid spaces or the category of locally ringed spaces to only have one free universe variable rather than two. Even the category of sheaves of rings on a topological space -- I am now arguing that the rings should be in the same universe as the topological space, because that's how it actually works in maths and for the categories that come up in regular maths this doesn't seem to be an issue. I wish I knew more about e.g. Lurie's work on (infinity,1) categories to know whether this will be an issue. Reid do you have any comments on this?</p>

<a name="163824060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163824060" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163824060">Kevin Buzzard (Apr 20 2019 at 23:27)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> <span class="user-mention" data-user-id="132858">@Ramon Fernandez Mir</span> <span class="user-mention" data-user-id="110032">@Reid Barton</span> <span class="user-mention" data-user-id="110064">@Kenny Lau</span>  <span class="user-mention" data-user-id="110044">@Chris Hughes</span>  I finally understand branches. Here is the challenge. Ramon has made a <a href="https://github.com/ramonfmir/lean-scheme" target="_blank" title="https://github.com/ramonfmir/lean-scheme">schemes repository</a> which defines schemes and locally ringed spaces, and has proved that affine schemes are schemes. There are I think two interesting coding challenges with taking this project forward:</p>
<p>1) Prove that projective 1-space is a scheme. This would be our first non-affine scheme. Kenny -- this might be a neat project after exams. <br>
2) Completely rip out Ramon's sheaves code and replace it with Scott's category theory code. Scott -- let's make your code work as well as we can, to solve real world problems in pure maths formalization.</p>
<p>I finally understand now that we should be doing something like -- first figuring out how to host such a project, and then just running with our own branch of mathlib -- or fork, or whatever the terminology is.</p>
<p><span class="user-mention" data-user-id="110172">@Assia Mahboubi</span> <span class="user-mention" data-user-id="110193">@Cyril Cohen</span> <br>
Has anyone ever defined schemes in Coq? If so, did they use category theory or not? Do we have anything to learn from any Coq experiences in these areas?</p>
<p>PS Does it matter in which order one tries (1) and (2)?</p>

<a name="163824327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163824327" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163824327">Kevin Buzzard (Apr 20 2019 at 23:34)</a>:</h4>
<p>The two developments could run in parallel and we could see which worked best.</p>

<a name="163824347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163824347" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163824347">Kevin Buzzard (Apr 20 2019 at 23:35)</a>:</h4>
<p>The goal would be to define the category of locally ringed spaces in a way which looked presentable to a mathematician.</p>

<a name="163824401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163824401" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163824401">Kevin Buzzard (Apr 20 2019 at 23:36)</a>:</h4>
<p>And I personally would be fine if its type were just <code>Type</code> or <code>Type 3</code> or however high you have to go to make my life easy.</p>

<a name="163824402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163824402" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163824402">Kevin Buzzard (Apr 20 2019 at 23:36)</a>:</h4>
<p>I don't care about universes</p>

<a name="163824793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163824793" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163824793">Kevin Buzzard (Apr 20 2019 at 23:49)</a>:</h4>
<p><span class="user-mention" data-user-id="132858">@Ramon Fernandez Mir</span> can you get your objects and morphisms all defined within <code>Type</code>?  I should just try it myself -- I'm compiling.</p>

<a name="163826218"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163826218" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163826218">Ramon Fernandez Mir (Apr 21 2019 at 00:30)</a>:</h4>
<p>Hey, I still need to clean up the repository a bit to make it properly usable but should be ready soon. I still haven't looked into the potential universe issues we talked about. My impression is that they should be manageable. Is everything within one universe what we want?</p>
<p>Also, my ideal is to PR a fair amount of it to the mathlib, mainly the localization predicate and basic facts about Spec(R) (where should these go btw?).</p>
<p>Regarding the projective line, I'd really like to have it there before my deadline. We currently have two examples: the empty scheme :-))) and affine schemes. But I feel like three is a much nicer number. How hard do we think it'll be? Hopefully reasonably easy, right? I'd be happy to do it with you Kenny if it's something you'd be interested in.</p>

<a name="163826343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163826343" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163826343">Kevin Buzzard (Apr 21 2019 at 00:34)</a>:</h4>
<p>I know for sure that in the category of ZFC locally ringed spaces, the objects are all topological spaces equipped with some extra structure and hence the objects of the ZFC category form a proper class, which is the ZFC version of <code>Obj : Type 1</code>. However for any two objects <code>X</code> and <code>Y</code> of the category, <code>Mor X Y</code> has is a set, so <code>\Pi (X Y : Obj),Mor X Y : Type</code>.  I would be perfectly happy to make the category of locally ringed spaces in these restricted universe situations using either Scott's or Ramon's development. I have still not seen a convincing argument for why I as a pure mathematician should care about universes so I would like to push this until I do.</p>

<a name="163964998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Taking%20the%20Stacks%20Project%20formalisation%20forward/near/163964998" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/89037TakingtheStacksProjectformalisationforward.html#163964998">Johan Commelin (Apr 23 2019 at 06:12)</a>:</h4>
<p>I'm really excited about these developments. <span class="user-mention" data-user-id="132858">@Ramon Fernandez Mir</span> I'm looking forward to a boatload of PRs from your side (-;<br>
Concerning stress tests: I think the Gamma-Spec adjunction should be at the top of the list. Once we have that one under our belt, I think that constructing P^n (via charts, or maybe via Proj) is a good second step. After that we should prove that P^n is proper over the base scheme. Once we have those, I think it is safe to say that "we can start doing algebraic geometry".</p>


{% endraw %}

{% include archive_update.html %}