---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/116395maths/index.html">maths</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html">ring hom induces ring hom between mv_polynomials</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="130203646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130203646" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130203646">Johan Commelin (Jul 24 2018 at 10:43)</a>:</h4>
<p>I am stuck.</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">linear_algebra</span><span class="bp">.</span><span class="n">multivariate_polynomial</span>

<span class="n">universes</span> <span class="n">u</span> <span class="n">v</span> <span class="n">w</span>

<span class="c1">-- ### FOR_MATHLIB</span>
<span class="c1">-- everything in this section should move to other files</span>

<span class="kn">section</span> <span class="n">ring_hom_commutes_with_stuff</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">S</span><span class="o">]</span>
<span class="kn">variables</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">S</span><span class="o">)</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">i</span><span class="o">]</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">w</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">X</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">R</span><span class="o">)</span>

<span class="kn">open</span> <span class="n">finset</span>

<span class="kn">lemma</span> <span class="n">ring_hom_sum</span> <span class="o">:</span> <span class="n">i</span> <span class="o">(</span><span class="n">sum</span> <span class="n">s</span> <span class="n">f</span><span class="o">)</span> <span class="bp">=</span> <span class="n">sum</span> <span class="n">s</span> <span class="o">(</span><span class="n">i</span> <span class="err">∘</span> <span class="n">f</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">finset</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">s</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">repeat</span> <span class="o">{</span> <span class="n">rw</span> <span class="n">sum_empty</span> <span class="o">},</span>
    <span class="n">exact</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_zero</span> <span class="n">i</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">s&#39;</span> <span class="n">hx</span> <span class="n">ih</span><span class="o">,</span>
    <span class="n">repeat</span> <span class="o">{</span> <span class="n">rw</span> <span class="n">sum_insert</span> <span class="n">hx</span> <span class="o">},</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_add</span> <span class="n">i</span><span class="o">,</span> <span class="err">←</span><span class="n">ih</span><span class="o">]</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="kn">end</span> <span class="n">ring_hom_commutes_with_stuff</span>

<span class="kn">namespace</span> <span class="n">mv_polynomial</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">σ</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">σ</span><span class="o">]</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">S</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">S</span><span class="o">]</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">comm_ring</span> <span class="o">(</span><span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">to_comm_ring</span>

<span class="kn">instance</span> <span class="n">C_is_ring_hom</span> <span class="o">:</span> <span class="n">is_ring_hom</span> <span class="o">(</span><span class="n">C</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">map_one</span> <span class="o">:=</span> <span class="n">C_1</span><span class="o">,</span>
  <span class="n">map_add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">single_add</span><span class="o">,</span>
  <span class="n">map_mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">eq</span><span class="bp">.</span><span class="n">symm</span> <span class="err">$</span> <span class="n">C_mul_monomial</span> <span class="o">}</span>

<span class="kn">instance</span> <span class="n">functorial_is_ring_hom</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">S</span><span class="o">)</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">i</span><span class="o">]</span> <span class="o">:</span>
<span class="n">is_ring_hom</span> <span class="o">(</span><span class="n">functorial</span> <span class="n">i</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">S</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">map_one</span> <span class="o">:=</span>
  <span class="k">begin</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">functorial</span><span class="o">],</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">map_range</span><span class="o">],</span>
    <span class="c1">-- simp [function.comp],</span>
    <span class="n">apply</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">ext</span><span class="o">,</span>
    <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">on_finset_apply</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">single_apply</span><span class="o">],</span>
    <span class="n">sorry</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="n">map_add</span> <span class="o">:=</span>
  <span class="k">begin</span>
    <span class="n">intros</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">functorial</span><span class="o">,</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">map_range</span><span class="o">,</span><span class="n">function</span><span class="bp">.</span><span class="n">comp</span><span class="o">],</span>
    <span class="n">apply</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">ext</span><span class="o">,</span>
    <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">single_apply</span><span class="o">],</span>
    <span class="n">rw</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_add</span> <span class="n">i</span><span class="o">,</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="n">map_mul</span> <span class="o">:=</span>
  <span class="k">begin</span>
    <span class="n">intros</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">functorial</span><span class="o">,</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">map_range</span><span class="o">,</span><span class="n">function</span><span class="bp">.</span><span class="n">comp</span><span class="o">,</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">mul_def</span><span class="o">,</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">sum</span><span class="o">],</span>
    <span class="n">apply</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">ext</span><span class="o">,</span>
    <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">single_apply</span><span class="o">],</span>
    <span class="n">rw</span> <span class="n">ring_hom_sum</span> <span class="n">i</span><span class="o">,</span>
    <span class="n">sorry</span><span class="o">,</span>
  <span class="kn">end</span> <span class="o">}</span>
</pre></div>

<a name="130203649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130203649" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130203649">Johan Commelin (Jul 24 2018 at 10:43)</a>:</h4>
<p>There are two <code>sorry</code>s in that bit of code. I don't know how to get rid of them.</p>

<a name="130204295"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204295" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204295">Mario Carneiro (Jul 24 2018 at 11:01)</a>:</h4>
<p>I think you are going about this the wrong way, at least if you want a clean proof at the end</p>

<a name="130204348"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204348" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204348">Johan Commelin (Jul 24 2018 at 11:02)</a>:</h4>
<p>Hmmm, so what is the right way?</p>

<a name="130204353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204353" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204353">Mario Carneiro (Jul 24 2018 at 11:02)</a>:</h4>
<p>You should break the proof into smaller and more useful parts rather than just attacking the whole thing at once</p>

<a name="130204372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204372" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204372">Johan Commelin (Jul 24 2018 at 11:03)</a>:</h4>
<p>Ok, but I think I don't even really see the smaller useful parts...</p>

<a name="130204416"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204416" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204416">Mario Carneiro (Jul 24 2018 at 11:04)</a>:</h4>
<p>here's the first thing I would prove:</p>
<div class="codehilite"><pre><span></span>theorem map_monomial (f : α → β) [is_ring_hom f]
  (s : σ →₀ ℕ) (a : α) : map f (monomial s a) = monomial s (f a) :=
sorry
</pre></div>

<a name="130204420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204420" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204420">Mario Carneiro (Jul 24 2018 at 11:04)</a>:</h4>
<p>(I renamed <code>functorial</code> to <code>map</code>)</p>

<a name="130204431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204431" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204431">Johan Commelin (Jul 24 2018 at 11:05)</a>:</h4>
<p>It is still called <code>functorial</code> in mathlib right?</p>

<a name="130204437"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204437" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204437">Mario Carneiro (Jul 24 2018 at 11:05)</a>:</h4>
<p>not in my local copy as of a minute ago</p>

<a name="130204440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204440" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204440">Johan Commelin (Jul 24 2018 at 11:05)</a>:</h4>
<p>Aaah...</p>

<a name="130204444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204444" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204444">Mario Carneiro (Jul 24 2018 at 11:05)</a>:</h4>
<p>you can use <code>functorial</code> if it's easier</p>

<a name="130204565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204565" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204565">Johan Commelin (Jul 24 2018 at 11:08)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">map_monomial</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">S</span><span class="o">)</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">i</span><span class="o">]</span>
  <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">σ</span> <span class="bp">→</span><span class="err">₀</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="n">functorial</span> <span class="n">i</span> <span class="o">(</span><span class="n">monomial</span> <span class="n">x</span> <span class="n">r</span><span class="o">)</span> <span class="bp">=</span> <span class="n">monomial</span> <span class="n">x</span> <span class="o">(</span><span class="n">i</span> <span class="n">r</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">functorial</span><span class="o">,</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">map_range</span><span class="o">,</span><span class="n">function</span><span class="bp">.</span><span class="n">comp</span><span class="o">,</span><span class="n">monomial</span><span class="o">],</span>
  <span class="n">apply</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">ext</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">single_apply</span><span class="o">],</span>
  <span class="n">split_ifs</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">refl</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_zero</span> <span class="o">}</span>
<span class="kn">end</span>
</pre></div>

<a name="130204574"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204574" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204574">Mario Carneiro (Jul 24 2018 at 11:09)</a>:</h4>
<p>I am suspicious still</p>

<a name="130204577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204577" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204577">Mario Carneiro (Jul 24 2018 at 11:09)</a>:</h4>
<p>that proof is too complicated</p>

<a name="130204579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204579" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204579">Johan Commelin (Jul 24 2018 at 11:09)</a>:</h4>
<p>Hmmm, ok, I'll try to golf it.</p>

<a name="130204583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204583" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204583">Mario Carneiro (Jul 24 2018 at 11:09)</a>:</h4>
<p>it should be a one liner about the composition of <code>map_range</code> with <code>single</code></p>

<a name="130204641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204641" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204641">Chris Hughes (Jul 24 2018 at 11:10)</a>:</h4>
<p>Incidentally is <span class="user-mention" data-user-id="110294">@Johannes Hölzl</span>  planning on removing the use of <code>monomial</code> for <code>mv_polynomial</code>s like he did for univariate polys?</p>

<a name="130204650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204650" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204650">Mario Carneiro (Jul 24 2018 at 11:11)</a>:</h4>
<p>I don't know anything about this</p>

<a name="130204658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204658" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204658">Mario Carneiro (Jul 24 2018 at 11:11)</a>:</h4>
<p>oh, I see he just uses <code>single</code></p>

<a name="130204702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204702" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204702">Chris Hughes (Jul 24 2018 at 11:12)</a>:</h4>
<p>The idea is to use <code>C a * X^n</code> instead of <code>monomial</code></p>

<a name="130204707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204707" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204707">Mario Carneiro (Jul 24 2018 at 11:12)</a>:</h4>
<p>For foundational stuff that's no good</p>

<a name="130204716"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204716" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204716">Mario Carneiro (Jul 24 2018 at 11:13)</a>:</h4>
<p>because the theorems about <code>C a</code> and <code>X</code> come from a theorem on <code>single</code></p>

<a name="130204737"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204737" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204737">Chris Hughes (Jul 24 2018 at 11:14)</a>:</h4>
<p>Yeah, but once the foundations are done, users are supposed to use <code>C a * X^n</code> I think.</p>

<a name="130204772"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204772" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204772">Mario Carneiro (Jul 24 2018 at 11:14)</a>:</h4>
<p>sure</p>

<a name="130204773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204773" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204773">Johan Commelin (Jul 24 2018 at 11:14)</a>:</h4>
<p>/me seems to be a user who has to do some foundational stuff...</p>

<a name="130204777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204777" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204777">Mario Carneiro (Jul 24 2018 at 11:14)</a>:</h4>
<p>Johan Commelin has stumbled on a gap in mathlib</p>

<a name="130204785"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204785" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204785">Johan Commelin (Jul 24 2018 at 11:15)</a>:</h4>
<p>That's the same thing right?</p>

<a name="130204789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204789" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204789">Mario Carneiro (Jul 24 2018 at 11:15)</a>:</h4>
<p>not always</p>

<a name="130204793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204793" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204793">Johan Commelin (Jul 24 2018 at 11:15)</a>:</h4>
<p>fair enough</p>

<a name="130204794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204794" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204794">Mario Carneiro (Jul 24 2018 at 11:15)</a>:</h4>
<p>well, I guess that depends on what qualifies as "foundational"</p>

<a name="130204803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204803" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204803">Mario Carneiro (Jul 24 2018 at 11:15)</a>:</h4>
<p>in this case the API is clearly lacking, and there is even an "unfinished" comment</p>

<a name="130204843"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204843" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204843">Johan Commelin (Jul 24 2018 at 11:16)</a>:</h4>
<p>Written by?</p>

<a name="130204847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204847" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204847">Johan Commelin (Jul 24 2018 at 11:16)</a>:</h4>
<p>Johan Commelin (-;</p>

<a name="130204851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204851" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204851">Johan Commelin (Jul 24 2018 at 11:16)</a>:</h4>
<p>So, I can only blame myself</p>

<a name="130204856"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204856" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204856">Mario Carneiro (Jul 24 2018 at 11:16)</a>:</h4>
<p><a href="https://github.com/leanprover/mathlib/blob/master/linear_algebra/multivariate_polynomial.lean#L183" target="_blank" title="https://github.com/leanprover/mathlib/blob/master/linear_algebra/multivariate_polynomial.lean#L183">https://github.com/leanprover/mathlib/blob/master/linear_algebra/multivariate_polynomial.lean#L183</a></p>

<a name="130204857"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204857" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204857">Johan Commelin (Jul 24 2018 at 11:16)</a>:</h4>
<p>But you can guess why I wrote that comment... because back then I would have been even worse at proving this lemma.</p>

<a name="130204864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204864" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204864">Johan Commelin (Jul 24 2018 at 11:17)</a>:</h4>
<p>Yeah, the <code>git blame</code> is not accurate.</p>

<a name="130204865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204865" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204865">Kenny Lau (Jul 24 2018 at 11:17)</a>:</h4>
<p>I've removed 1 sorry (en hep nok 4 toegevoegt):</p>

<a name="130204868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204868" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204868">Kenny Lau (Jul 24 2018 at 11:17)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">linear_algebra</span><span class="bp">.</span><span class="n">multivariate_polynomial</span>

<span class="n">universes</span> <span class="n">u</span> <span class="n">v</span> <span class="n">w</span> <span class="n">u₁</span>

<span class="c1">-- ### FOR_MATHLIB</span>
<span class="c1">-- everything in this section should move to other files</span>

<span class="kn">section</span> <span class="n">ring_hom_commutes_with_stuff</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">S</span><span class="o">]</span>
<span class="kn">variables</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">S</span><span class="o">)</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">i</span><span class="o">]</span>

<span class="kn">section</span> <span class="n">finset</span>

<span class="kn">open</span> <span class="n">finset</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">w</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">X</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">R</span><span class="o">)</span>

<span class="kn">lemma</span> <span class="n">ring_hom_sum</span><span class="bp">.</span><span class="n">finset</span> <span class="o">:</span> <span class="n">i</span> <span class="o">(</span><span class="n">sum</span> <span class="n">s</span> <span class="n">f</span><span class="o">)</span> <span class="bp">=</span> <span class="n">sum</span> <span class="n">s</span> <span class="o">(</span><span class="n">i</span> <span class="err">∘</span> <span class="n">f</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">finset</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">s</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">repeat</span> <span class="o">{</span> <span class="n">rw</span> <span class="n">sum_empty</span> <span class="o">},</span>
    <span class="n">exact</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_zero</span> <span class="n">i</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">s&#39;</span> <span class="n">hx</span> <span class="n">ih</span><span class="o">,</span>
    <span class="n">repeat</span> <span class="o">{</span> <span class="n">rw</span> <span class="n">sum_insert</span> <span class="n">hx</span> <span class="o">},</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_add</span> <span class="n">i</span><span class="o">,</span> <span class="err">←</span><span class="n">ih</span><span class="o">]</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="kn">end</span> <span class="n">finset</span>

<span class="kn">section</span> <span class="n">finsupp</span>

<span class="kn">open</span> <span class="n">finsupp</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">w</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u₁</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">β</span><span class="o">]</span>
<span class="kn">variables</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">β</span><span class="o">]</span>
<span class="kn">variables</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span><span class="err">₀</span> <span class="n">β</span><span class="o">)</span>
<span class="kn">variables</span> <span class="o">(</span><span class="n">hf1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="mi">0</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span>
<span class="kn">variables</span> <span class="o">(</span><span class="n">hf2</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">b₁</span> <span class="n">b₂</span> <span class="o">:</span> <span class="n">β</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="o">(</span><span class="n">b₁</span> <span class="bp">+</span> <span class="n">b₂</span><span class="o">)</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">a</span> <span class="n">b₁</span> <span class="bp">+</span> <span class="n">f</span> <span class="n">a</span> <span class="n">b₂</span><span class="o">)</span>
<span class="n">include</span> <span class="n">hf1</span> <span class="n">hf2</span>

<span class="kn">lemma</span> <span class="n">ring_hom_sum</span><span class="bp">.</span><span class="n">finsupp</span> <span class="o">:</span> <span class="n">i</span> <span class="o">(</span><span class="n">sum</span> <span class="n">s</span> <span class="n">f</span><span class="o">)</span> <span class="bp">=</span> <span class="n">sum</span> <span class="n">s</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">i</span> <span class="o">(</span><span class="n">f</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">induction</span> <span class="n">s</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">repeat</span> <span class="o">{</span> <span class="n">rw</span> <span class="n">sum_zero_index</span> <span class="o">},</span>
    <span class="n">exact</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_zero</span> <span class="n">i</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span> <span class="n">f&#39;</span> <span class="n">H1</span> <span class="n">H2</span> <span class="n">ih</span><span class="o">,</span>
    <span class="n">repeat</span> <span class="o">{</span> <span class="n">rw</span> <span class="n">sum_add_index</span> <span class="o">},</span>
    <span class="n">repeat</span> <span class="o">{</span> <span class="n">rw</span> <span class="n">sum_single_index</span> <span class="o">},</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_add</span> <span class="n">i</span><span class="o">,</span> <span class="err">←</span> <span class="n">ih</span><span class="o">],</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="n">hf1</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_zero</span> <span class="n">i</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">apply</span> <span class="n">hf1</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span><span class="o">,</span> <span class="n">rw</span> <span class="n">hf1</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_zero</span> <span class="n">i</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span><span class="o">,</span> <span class="n">rw</span> <span class="n">hf2</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_add</span> <span class="n">i</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">apply</span> <span class="n">hf1</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">apply</span> <span class="n">hf2</span> <span class="o">}</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="kn">end</span> <span class="n">finsupp</span>

<span class="kn">end</span> <span class="n">ring_hom_commutes_with_stuff</span>

<span class="kn">namespace</span> <span class="n">mv_polynomial</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">σ</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">σ</span><span class="o">]</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">S</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">S</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">S</span><span class="o">]</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">comm_ring</span> <span class="o">(</span><span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">to_comm_ring</span>

<span class="kn">instance</span> <span class="n">C_is_ring_hom</span> <span class="o">:</span> <span class="n">is_ring_hom</span> <span class="o">(</span><span class="n">C</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">map_one</span> <span class="o">:=</span> <span class="n">C_1</span><span class="o">,</span>
  <span class="n">map_add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">single_add</span><span class="o">,</span>
  <span class="n">map_mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">eq</span><span class="bp">.</span><span class="n">symm</span> <span class="err">$</span> <span class="n">C_mul_monomial</span> <span class="o">}</span>

<span class="kn">instance</span> <span class="n">functorial_is_ring_hom</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">S</span><span class="o">)</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">i</span><span class="o">]</span> <span class="o">:</span>
<span class="n">is_ring_hom</span> <span class="o">(</span><span class="n">functorial</span> <span class="n">i</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">S</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">map_one</span> <span class="o">:=</span>
  <span class="k">begin</span>
    <span class="n">dsimp</span> <span class="o">[</span><span class="n">functorial</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">map_range</span><span class="o">],</span>
    <span class="n">ext</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">dsimp</span> <span class="o">[</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">on_finset_apply</span><span class="o">],</span>
    <span class="k">have</span> <span class="n">H1</span> <span class="o">:</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">R</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="o">(</span><span class="n">σ</span> <span class="bp">→</span><span class="err">₀</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="bp">→</span><span class="err">₀</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">H2</span> <span class="o">:</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">S</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="o">(</span><span class="n">σ</span> <span class="bp">→</span><span class="err">₀</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="bp">→</span><span class="err">₀</span> <span class="n">S</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">H1</span><span class="o">,</span> <span class="n">H2</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">one_def</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">one_def</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">single_apply</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">single_apply</span><span class="o">],</span>
    <span class="n">split_ifs</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">apply</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_one</span> <span class="n">i</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">apply</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_zero</span> <span class="n">i</span> <span class="o">}</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="n">map_add</span> <span class="o">:=</span>
  <span class="k">begin</span>
    <span class="n">intros</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span>
    <span class="n">dsimp</span> <span class="o">[</span><span class="n">functorial</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">map_range</span><span class="o">],</span>
    <span class="n">ext</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">single_apply</span><span class="o">,</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_add</span> <span class="n">i</span><span class="o">]</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="n">map_mul</span> <span class="o">:=</span>
  <span class="k">begin</span>
    <span class="n">intros</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span>
    <span class="n">dsimp</span> <span class="o">[</span><span class="n">functorial</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">map_range</span><span class="o">],</span>
    <span class="n">ext</span><span class="o">,</span>
    <span class="n">dsimp</span> <span class="o">[</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">on_finset_apply</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">mul_def</span><span class="o">],</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">sum_apply</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">sum_apply</span><span class="o">,</span> <span class="n">ring_hom_sum</span><span class="bp">.</span><span class="n">finsupp</span> <span class="n">i</span><span class="o">],</span>
    <span class="n">sorry</span><span class="o">,</span> <span class="n">sorry</span><span class="o">,</span> <span class="n">sorry</span><span class="o">,</span> <span class="n">sorry</span><span class="o">,</span> <span class="n">sorry</span>
  <span class="kn">end</span> <span class="o">}</span>

<span class="kn">end</span> <span class="n">mv_polynomial</span>
</pre></div>

<a name="130204870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204870" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204870">Johan Commelin (Jul 24 2018 at 11:18)</a>:</h4>
<p>I wrote that stuff, but didn't actually know what I was doing. So Johannes took my stuff and transformed it into something mathlib-ready.</p>

<a name="130204912"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204912" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204912">Mario Carneiro (Jul 24 2018 at 11:18)</a>:</h4>
<p>I didn't realize you were an author of the file, you aren't credited if so</p>

<a name="130204920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130204920" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130204920">Mario Carneiro (Jul 24 2018 at 11:18)</a>:</h4>
<p>I added you as an author</p>

<a name="130205097"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205097" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205097">Johan Commelin (Jul 24 2018 at 11:22)</a>:</h4>
<p>Does that bring responsibilities with it? Does that mean I should now be able to answer foundational questions about this file?</p>

<a name="130205103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205103" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205103">Mario Carneiro (Jul 24 2018 at 11:22)</a>:</h4>
<p>Not really</p>

<a name="130205235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205235" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205235">Johan Commelin (Jul 24 2018 at 11:26)</a>:</h4>
<p>By the way... I already had:</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">functorial_ring_hom_X</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">S</span><span class="o">)</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">i</span><span class="o">]</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">σ</span><span class="o">)</span>
 <span class="o">:</span> <span class="n">functorial</span> <span class="n">i</span> <span class="o">(</span><span class="n">X</span> <span class="n">n</span><span class="o">)</span> <span class="bp">=</span> <span class="n">X</span> <span class="n">n</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">functorial</span><span class="o">,</span><span class="n">X</span><span class="o">,</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">map_range</span><span class="o">,</span><span class="n">function</span><span class="bp">.</span><span class="n">comp</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">monomial</span><span class="o">,</span><span class="bp">*</span><span class="o">],</span>
  <span class="n">apply</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">ext</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">single_apply</span><span class="o">],</span>
  <span class="n">split_ifs</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_one</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_zero</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">functorial_ring_hom_C</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">S</span><span class="o">)</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">i</span><span class="o">]</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span>
<span class="o">:</span> <span class="n">functorial</span> <span class="n">i</span> <span class="o">(</span><span class="n">C</span> <span class="n">r</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">C</span> <span class="o">(</span><span class="n">i</span> <span class="n">r</span><span class="o">)</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">S</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">functorial</span><span class="o">,</span><span class="n">X</span><span class="o">,</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">map_range</span><span class="o">,</span><span class="n">function</span><span class="bp">.</span><span class="n">comp</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">monomial</span><span class="o">,</span><span class="bp">*</span><span class="o">],</span>
  <span class="n">apply</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">ext</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span><span class="n">finsupp</span><span class="bp">.</span><span class="n">single_apply</span><span class="o">],</span>
  <span class="n">split_ifs</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">refl</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_zero</span> <span class="o">}</span>
<span class="kn">end</span>
</pre></div>

<a name="130205239"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205239" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205239">Johan Commelin (Jul 24 2018 at 11:26)</a>:</h4>
<p>But I didn't see how to use them.</p>

<a name="130205241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205241" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205241">Johan Commelin (Jul 24 2018 at 11:26)</a>:</h4>
<p>But maybe I'm learning, because I think it was pretty close to your suggestion about monomials.</p>

<a name="130205242"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205242" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205242">Mario Carneiro (Jul 24 2018 at 11:26)</a>:</h4>
<p>almost there:</p>
<div class="codehilite"><pre><span></span>-- `mv_polynomial σ` is a functor (incomplete)
def map : mv_polynomial σ α → mv_polynomial σ β :=
map_range f (is_ring_hom.map_zero f)

theorem map_monomial (s : σ →₀ ℕ) (a : α) : map f (monomial s a) = monomial s (f a) :=
map_range_single

theorem map_C (f : α → β) [is_ring_hom f] (a : α) : map f (C a : mv_polynomial σ α) = C (f a) :=
map_monomial _ _ _

theorem map_one (f : α → β) [is_ring_hom f] : map f (1 : mv_polynomial σ α) = 1 :=
(map_C _ _).trans $ by simp [is_ring_hom.map_one f]

theorem map_add (f : α → β) [is_ring_hom f] (p q : mv_polynomial σ α) :
  map f (p + q) = map f p + map f q :=
by simp [map]; ext a; simp [is_ring_hom.map_add f]

theorem map_mul (f : α → β) [is_ring_hom f] (p q : mv_polynomial σ α) :
  map f (p * q) = map f p * map f q :=
sorry
</pre></div>

<a name="130205248"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205248" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205248">Johan Commelin (Jul 24 2018 at 11:27)</a>:</h4>
<p>Ok, please add <code>map_X</code>. It will turn out to be really useful.</p>

<a name="130205296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205296" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205296">Johan Commelin (Jul 24 2018 at 11:28)</a>:</h4>
<p>/me wonders when he will ever approximate the overlord-powers of Mario... <span class="emoji emoji-1f914" title="thinking face">:thinking_face:</span></p>

<a name="130205297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205297" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205297">Mario Carneiro (Jul 24 2018 at 11:28)</a>:</h4>
<div class="codehilite"><pre><span></span>theorem map_X (f : α → β) [is_ring_hom f] (n : σ) : map f (X n : mv_polynomial σ α) = X n :=
(map_monomial _ _ _).trans $ by simp [is_ring_hom.map_one f]
</pre></div>

<a name="130205313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205313" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205313">Mario Carneiro (Jul 24 2018 at 11:29)</a>:</h4>
<p>oh wait that doesn't work</p>
<div class="codehilite"><pre><span></span>theorem map_X (f : α → β) [is_ring_hom f] (n : σ) : map f (X n : mv_polynomial σ α) = X n :=
by simp [X, map_monomial, is_ring_hom.map_one f]
</pre></div>

<a name="130205321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205321" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205321">Johan Commelin (Jul 24 2018 at 11:29)</a>:</h4>
<p>You fixed it and made it shorter! Double win.</p>

<a name="130205398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205398" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205398">Mario Carneiro (Jul 24 2018 at 11:30)</a>:</h4>
<p>mul is probably the hard one</p>

<a name="130205402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205402" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205402">Johan Commelin (Jul 24 2018 at 11:30)</a>:</h4>
<p>Last man standing (-;</p>

<a name="130205492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205492" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205492">Johan Commelin (Jul 24 2018 at 11:32)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> I wouldn't be surprised if you need the <code>section ring_hom_commutes_with_stuff</code></p>

<a name="130205497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205497" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205497">Johan Commelin (Jul 24 2018 at 11:33)</a>:</h4>
<p>See Kenny's post a few lines up.</p>

<a name="130205500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205500" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205500">Mario Carneiro (Jul 24 2018 at 11:33)</a>:</h4>
<p>I was planning on using induction</p>

<a name="130205508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205508" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205508">Johan Commelin (Jul 24 2018 at 11:33)</a>:</h4>
<p>Right, that's what we did in that section.</p>

<a name="130205509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205509" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205509">Mario Carneiro (Jul 24 2018 at 11:33)</a>:</h4>
<p>no I mean to prove <code>map_mul</code></p>

<a name="130205570"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205570" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205570">Johan Commelin (Jul 24 2018 at 11:34)</a>:</h4>
<p>Yes, but that might mean duplicating effort... I don't know.</p>

<a name="130205580"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205580" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205580">Mario Carneiro (Jul 24 2018 at 11:35)</a>:</h4>
<p>well, commuting with <code>sum</code> still leaves commuting over <code>^</code></p>

<a name="130205770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205770" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205770">Johan Commelin (Jul 24 2018 at 11:39)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">ring_hom_powers</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">i</span><span class="o">(</span><span class="n">x</span><span class="err">^</span><span class="n">n</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">i</span> <span class="n">x</span><span class="o">)</span><span class="err">^</span><span class="n">n</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">ih</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">pow_zero</span><span class="o">,</span><span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_one</span> <span class="n">i</span><span class="o">]</span> <span class="o">},</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">pow_succ</span><span class="o">,</span><span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_mul</span> <span class="n">i</span><span class="o">,</span><span class="n">ih</span><span class="o">]</span>
<span class="kn">end</span>
</pre></div>

<a name="130205774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205774" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205774">Johan Commelin (Jul 24 2018 at 11:39)</a>:</h4>
<p>Was already in my file, but didn't copy it into the MWE.</p>

<a name="130205840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205840" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205840">Mario Carneiro (Jul 24 2018 at 11:41)</a>:</h4>
<p>I was hoping that <code>map</code> was defined using <code>eval</code>, but unfortunately it's a bit circular</p>

<a name="130205866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205866" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205866">Johan Commelin (Jul 24 2018 at 11:41)</a>:</h4>
<p>How would you define it using <code>eval</code>?</p>

<a name="130205923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205923" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205923">Mario Carneiro (Jul 24 2018 at 11:43)</a>:</h4>
<p>I was thinking something along the lines of "evaluate the constants using <code>C o f</code> and the variables using <code>X</code>"</p>

<a name="130205943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205943" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205943">Mario Carneiro (Jul 24 2018 at 11:43)</a>:</h4>
<p>but <code>eval</code> doesn't work like that; it maps everything into the coefficient ring rather than some other ring across a ring hom</p>

<a name="130205993"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205993" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205993">Johan Commelin (Jul 24 2018 at 11:44)</a>:</h4>
<p>True. So either you need a beefed up <code>eval</code>, or you need <code>map</code>.</p>

<a name="130205995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130205995" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130205995">Mario Carneiro (Jul 24 2018 at 11:44)</a>:</h4>
<p>exactly</p>

<a name="130206015"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206015" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206015">Johan Commelin (Jul 24 2018 at 11:45)</a>:</h4>
<p>Oooh, while you are editing that file. I was also thinking that the <code>instance</code> that <code>eval</code> is a ring hom should get a name. Because <code>C</code> is also a useful ring hom in that context.</p>

<a name="130206033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206033" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206033">Johan Commelin (Jul 24 2018 at 11:45)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">instance</span> <span class="n">C_is_ring_hom</span> <span class="o">:</span> <span class="n">is_ring_hom</span> <span class="o">(</span><span class="n">C</span> <span class="o">:</span> <span class="n">R</span> <span class="bp">→</span> <span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">map_one</span> <span class="o">:=</span> <span class="n">C_1</span><span class="o">,</span>
  <span class="n">map_add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">finsupp</span><span class="bp">.</span><span class="n">single_add</span><span class="o">,</span>
  <span class="n">map_mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">eq</span><span class="bp">.</span><span class="n">symm</span> <span class="err">$</span> <span class="n">C_mul_monomial</span> <span class="o">}</span>
</pre></div>

<a name="130206077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206077" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206077">Mario Carneiro (Jul 24 2018 at 11:46)</a>:</h4>
<p>I saw that</p>

<a name="130206082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206082" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206082">Mario Carneiro (Jul 24 2018 at 11:46)</a>:</h4>
<p>I agree that it is useful</p>

<a name="130206098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206098" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206098">Johan Commelin (Jul 24 2018 at 11:46)</a>:</h4>
<p>Yes, I'm currently using <code>map C</code> all over the place.</p>

<a name="130206125"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206125" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206125">Mario Carneiro (Jul 24 2018 at 11:47)</a>:</h4>
<p>I think I will define beefed up <code>eval</code>, what should it be called?</p>

<a name="130206277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206277" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206277">Johan Commelin (Jul 24 2018 at 11:50)</a>:</h4>
<p>Hmm, I don't know a TLA...</p>

<a name="130206281"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206281" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206281">Mario Carneiro (Jul 24 2018 at 11:50)</a>:</h4>
<p>oh dear, I need semiring homs</p>

<a name="130206285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206285" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206285">Johan Commelin (Jul 24 2018 at 11:50)</a>:</h4>
<p>You're kidding me (-;</p>

<a name="130206294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206294" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206294">Johan Commelin (Jul 24 2018 at 11:50)</a>:</h4>
<p>You don't <em>need</em> them. You only <em>want</em> them.</p>

<a name="130206301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206301" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206301">Mario Carneiro (Jul 24 2018 at 11:51)</a>:</h4>
<p>if I use beefed up eval to define eval, it won't work on semiring like it does now</p>

<a name="130206305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206305" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206305">Johan Commelin (Jul 24 2018 at 11:51)</a>:</h4>
<p>Mathematicians have survived over 3000 years without needing them.</p>

<a name="130206308"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206308" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206308">Mario Carneiro (Jul 24 2018 at 11:51)</a>:</h4>
<p>I'm sorry, but they really do come up in lean, a lot</p>

<a name="130206311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206311" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206311">Mario Carneiro (Jul 24 2018 at 11:51)</a>:</h4>
<p><code>nat</code> is a semiring, <code>ennreal</code> is a semiring. These get lots of use</p>

<a name="130206312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206312" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206312">Johan Commelin (Jul 24 2018 at 11:52)</a>:</h4>
<p>Only trolling (-;. I guess you stumbled on a gap in mathlib?</p>

<a name="130206360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206360" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206360">Mario Carneiro (Jul 24 2018 at 11:52)</a>:</h4>
<p>maybe because it was written by a bunch of blithe mathematicians ;)</p>

<a name="130206367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206367" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206367">Mario Carneiro (Jul 24 2018 at 11:52)</a>:</h4>
<p>who think semirings have no value</p>

<a name="130206786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206786" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206786">Johan Commelin (Jul 24 2018 at 12:03)</a>:</h4>
<p>You mean the definition of <code>is_ring_hom</code>? Lol. We really need <span class="user-mention" data-user-id="110087">@Scott Morrison</span> and you guys (Mario + <span class="user-mention" data-user-id="110294">@Johannes Hölzl</span> ) to get categories into mathlib. You will be amazed at how many <code>is_X_hom</code> definitions will be added by a bunch of blithe mathematicians (-;</p>

<a name="130206793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206793" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206793">Mario Carneiro (Jul 24 2018 at 12:03)</a>:</h4>
<p>Well, category theory doesn't save you from having to define the homs</p>

<a name="130206947"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206947" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206947">Johan Commelin (Jul 24 2018 at 12:07)</a>:</h4>
<p>No, I agree. But all of a sudden we will want to define a bunch of categories. And then we'll define the homs as well (-;</p>

<a name="130206988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130206988" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130206988">Johan Commelin (Jul 24 2018 at 12:08)</a>:</h4>
<p>Although maybe we will forget about the category of semirings...</p>

<a name="130207579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130207579" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130207579">Johan Commelin (Jul 24 2018 at 12:21)</a>:</h4>
<p>Aaaahrg, now I need to make sure that <code>eval</code> of polynomials is associative...</p>

<a name="130211457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130211457" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130211457">Johan Commelin (Jul 24 2018 at 13:37)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> How 's it going with <code>eval_on_steroids</code>?</p>

<a name="130220081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130220081" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130220081">Kevin Buzzard (Jul 24 2018 at 16:04)</a>:</h4>
<blockquote>
<p><code>nat</code> is a semiring, <code>ennreal</code> is a semiring. These get lots of use</p>
</blockquote>
<p><span class="user-mention" data-user-id="120256">@Ali Sever</span> (the guy formalising Euclid/Tarski geometry in Lean) was saying that he wanted to be able to say "the distance from a to b is q times the distance from c to d" where q&gt;=0 is rational. There is no formal definition of distance, we just have a predicate <code>eqd a b c d</code> interpreted as "dist(a,b)=dist(c,d)", but we defined distance anyway as point x point / equiv reln (formally these are "attainable distances") and they should indeed be a semi-vector space over the semi-ring of non-negative rationals.</p>

<a name="130259206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130259206" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130259206">Mario Carneiro (Jul 25 2018 at 07:09)</a>:</h4>
<p>I'm going to have to get back to you on <code>eval_on_steroids</code>, conferences tend to be a time sink so probably not until the weekend</p>

<a name="130259252"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130259252" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130259252">Johan Commelin (Jul 25 2018 at 07:10)</a>:</h4>
<p>Too bad. Have fun!</p>

<a name="130263243"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130263243" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130263243">Kevin Buzzard (Jul 25 2018 at 08:53)</a>:</h4>
<p>William Stein reported that he'd met Mario, so Mario at conferences does have advantages :-)</p>

<a name="130403696"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130403696" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130403696">Johan Commelin (Jul 27 2018 at 11:23)</a>:</h4>
<p>Mario, since you said you would take a stab at these problems, may I suggest you also consider <a href="https://gist.github.com/jcommelin/0e401d47ac3e0b7291c27d3313ea850f" target="_blank" title="https://gist.github.com/jcommelin/0e401d47ac3e0b7291c27d3313ea850f">https://gist.github.com/jcommelin/0e401d47ac3e0b7291c27d3313ea850f</a> while you're going at it...?</p>

<a name="130403711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130403711" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130403711">Johan Commelin (Jul 27 2018 at 11:23)</a>:</h4>
<p>Oooh, and <code>s/functorial/map/</code>.</p>

<a name="130766236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130766236" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130766236">Johan Commelin (Aug 02 2018 at 08:39)</a>:</h4>
<p>Hi Mario, any news here? Do you have a definition about which I could try to prove some lemmas?</p>

<a name="130908402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130908402" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130908402">Mario Carneiro (Aug 04 2018 at 23:59)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span>  News is here. I didn't prove the assoc lemmas but all the assoc lemmas on <code>eval</code> and <code>map</code> follow from the obvious composition lemma for <code>map2</code></p>

<a name="130953117"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/130953117" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#130953117">Mario Carneiro (Aug 06 2018 at 02:15)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> I think the second associativity lemma is false:</p>
<div class="codehilite"><pre><span></span>theorem eval_assoc₂_false
  {α} [comm_semiring α] [decidable_eq α]
  {σ} [decidable_eq σ]
  {τ} [decidable_eq τ]
  (f : σ → mv_polynomial τ α) (g : τ → α)
  (H : ∀ (p : mv_polynomial σ (mv_polynomial τ α)),
    C ((p.eval f).eval g) = p.eval (C ∘ eval g ∘ f))
  (a : τ) : C (g a) = X a :=
by simpa using H (C (X a))
</pre></div>

<a name="131023083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023083" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023083">Johan Commelin (Aug 07 2018 at 05:08)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Cool! This is adding a lot of flexibility. Do you think it makes sense to add <code>map2_neg</code> and <code>map2_sub</code>?</p>

<a name="131023091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023091" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023091">Mario Carneiro (Aug 07 2018 at 05:09)</a>:</h4>
<p>Sure. They should be direct applications of the <code>is_ring_hom</code> instance</p>

<a name="131023142"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023142" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023142">Johan Commelin (Aug 07 2018 at 05:10)</a>:</h4>
<p>Ok, do you want me to do that? Or have you already done it (-;</p>

<a name="131023151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023151" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023151">Mario Carneiro (Aug 07 2018 at 05:11)</a>:</h4>
<p>I haven't done it, it's up to you</p>

<a name="131023155"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023155" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023155">Johan Commelin (Aug 07 2018 at 05:11)</a>:</h4>
<p>Ok, I'll add them.</p>

<a name="131023374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023374" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023374">Johan Commelin (Aug 07 2018 at 05:19)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Is <code>rw</code> the "morally" correct way to prove such a thing?</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">map₂_sub</span> <span class="o">:</span> <span class="o">(</span><span class="n">p</span> <span class="bp">-</span> <span class="n">q</span><span class="o">)</span><span class="bp">.</span><span class="n">map₂</span> <span class="n">f</span> <span class="n">g</span> <span class="bp">=</span> <span class="n">p</span><span class="bp">.</span><span class="n">map₂</span> <span class="n">f</span> <span class="n">g</span> <span class="bp">-</span> <span class="n">q</span><span class="bp">.</span><span class="n">map₂</span> <span class="n">f</span> <span class="n">g</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">rw</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">map_sub</span> <span class="o">(</span><span class="n">map₂</span> <span class="n">f</span> <span class="n">g</span><span class="o">)</span>
</pre></div>

<a name="131023381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023381" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023381">Mario Carneiro (Aug 07 2018 at 05:20)</a>:</h4>
<p>you should be able to just apply the theorem, right? Does <code>is_ring_hom.map_sub _</code> work as a proof?</p>

<a name="131023437"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023437" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023437">Johan Commelin (Aug 07 2018 at 05:21)</a>:</h4>
<p>Yes, it does. Thanks! Do you want a 5 line PR?</p>

<a name="131023448"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023448" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023448">Mario Carneiro (Aug 07 2018 at 05:21)</a>:</h4>
<p>sure</p>

<a name="131023451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023451" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023451">Mario Carneiro (Aug 07 2018 at 05:21)</a>:</h4>
<p>You should have the same theorems for <code>eval</code> and <code>map</code> too</p>

<a name="131023496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023496" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023496">Mario Carneiro (Aug 07 2018 at 05:22)</a>:</h4>
<p>and <code>C</code></p>

<a name="131023578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023578" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023578">Johan Commelin (Aug 07 2018 at 05:24)</a>:</h4>
<p>Ok, I'll add those too</p>

<a name="131023734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023734" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023734">Johan Commelin (Aug 07 2018 at 05:28)</a>:</h4>
<p><code>map_add</code> and <code>map_mul</code> are simp lemmas</p>

<a name="131023735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023735" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023735">Johan Commelin (Aug 07 2018 at 05:28)</a>:</h4>
<p>But the corresponding lemmas for <code>map2</code> are not.</p>

<a name="131023737"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023737" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023737">Johan Commelin (Aug 07 2018 at 05:28)</a>:</h4>
<p>Is there a reason for this?</p>

<a name="131023962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023962" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023962">Johan Commelin (Aug 07 2018 at 05:34)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> If you can tell me which ones should be simp lemmas, then I think I'm done.</p>

<a name="131023966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023966" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023966">Mario Carneiro (Aug 07 2018 at 05:34)</a>:</h4>
<p>I think there was, but I don't think it was a good reason. Just make them all simp lemmas</p>

<a name="131023976"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023976" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023976">Mario Carneiro (Aug 07 2018 at 05:35)</a>:</h4>
<p><code>eval</code> too</p>

<a name="131023985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023985" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023985">Johan Commelin (Aug 07 2018 at 05:35)</a>:</h4>
<p>And <code>C</code> as well</p>

<a name="131023991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131023991" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131023991">Mario Carneiro (Aug 07 2018 at 05:35)</a>:</h4>
<p>There probably isn't any point in having the <code>_sub</code> theorems be simp lemmas, since the LHS is not in simp normal form</p>

<a name="131024076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131024076" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131024076">Johan Commelin (Aug 07 2018 at 05:37)</a>:</h4>
<p>Hmm, I don't think I know what that means. Nevertheless, it would be cool if <code>simp</code> would just do all those rewrites for me...</p>

<a name="131024219"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131024219" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131024219">Johan Commelin (Aug 07 2018 at 05:40)</a>:</h4>
<p>PR'd</p>

<a name="131028888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131028888" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131028888">Johan Commelin (Aug 07 2018 at 07:58)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Ok, so now there are some merge conflicts... The renaming is straightforward.</p>

<a name="131028928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131028928" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131028928">Johan Commelin (Aug 07 2018 at 07:58)</a>:</h4>
<p>Shall I make the <code>add</code> and <code>mul</code> lemmas into simp lemmas?</p>

<a name="131028937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131028937" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131028937">Mario Carneiro (Aug 07 2018 at 07:58)</a>:</h4>
<p>yeah, same as the last version of your PR</p>

<a name="131028949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131028949" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131028949">Johan Commelin (Aug 07 2018 at 07:59)</a>:</h4>
<p>Ok!</p>

<a name="131033604"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20hom%20induces%20ring%20hom%20between%20mv_polynomials/near/131033604" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/59703ringhominducesringhombetweenmvpolynomials.html#131033604">Johan Commelin (Aug 07 2018 at 09:47)</a>:</h4>
<p>Updated the PR</p>


{% endraw %}

{% include archive_update.html %}