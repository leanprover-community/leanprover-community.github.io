---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/116395maths/35255bundlingsubmonoids.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/116395maths/index.html">maths</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html">bundling submonoids</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="172494027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/172494027" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#172494027">Kevin Buzzard (Aug 05 2019 at 10:33)</a>:</h4>
<p>I've embarked on a refactor changing <code>is_submonoid</code> to <code>submonoid</code>. Do people have opinions about whether we should have</p>
<div class="codehilite"><pre><span></span><span class="kn">instance</span> <span class="o">:</span> <span class="n">has_le</span> <span class="o">(</span><span class="n">submonoid</span> <span class="n">M</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">⟨λ</span> <span class="n">S</span> <span class="n">T</span><span class="o">,</span> <span class="n">S</span><span class="bp">.</span><span class="n">carrier</span> <span class="err">⊆</span> <span class="n">T</span><span class="bp">.</span><span class="n">carrier</span><span class="bp">⟩</span>
</pre></div>


<p>or</p>
<div class="codehilite"><pre><span></span><span class="kn">instance</span> <span class="o">:</span> <span class="n">has_subset</span> <span class="o">(</span><span class="n">submonoid</span> <span class="n">M</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">⟨λ</span> <span class="n">S</span> <span class="n">T</span><span class="o">,</span> <span class="n">S</span><span class="bp">.</span><span class="n">carrier</span> <span class="err">⊆</span> <span class="n">T</span><span class="bp">.</span><span class="n">carrier</span><span class="bp">⟩</span>
</pre></div>


<p>or both?</p>

<a name="172494452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/172494452" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#172494452">Chris Hughes (Aug 05 2019 at 10:42)</a>:</h4>
<p><code>le</code></p>

<a name="172494457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/172494457" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#172494457">Kevin Buzzard (Aug 05 2019 at 10:42)</a>:</h4>
<p>what have you become, Hughes?</p>

<a name="172494465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/172494465" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#172494465">Chris Hughes (Aug 05 2019 at 10:43)</a>:</h4>
<p>Also, we shouldn't have <code>subset</code> for sets, just <code>le</code></p>

<a name="172494474"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/172494474" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#172494474">Kevin Buzzard (Aug 05 2019 at 10:43)</a>:</h4>
<p>Oh wow!</p>

<a name="172494481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/172494481" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#172494481">Kevin Buzzard (Aug 05 2019 at 10:43)</a>:</h4>
<p>Having learnt something about lattices, I am beginning to understand this point of view.</p>

<a name="172494525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/172494525" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#172494525">Kevin Buzzard (Aug 05 2019 at 10:44)</a>:</h4>
<p>One might wonder about a "mathematician's interface" to Lean though.</p>

<a name="172494706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/172494706" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#172494706">Chris Hughes (Aug 05 2019 at 10:48)</a>:</h4>
<p>I think it's almost always easier to learn some slightly different notation, than to force Lean into doing something that doesn't work very well in Lean. It's really not that hard to use <code>le</code> instead of <code>subset</code>.</p>

<a name="172494721"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/172494721" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#172494721">Kevin Buzzard (Aug 05 2019 at 10:49)</a>:</h4>
<p>I agree. But I am currently being an "engineer", editing mathlib. What about the undergraduate mathematician who doesn't care about the details but wants the interface that they expect?</p>

<a name="172495182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/172495182" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#172495182">Chris Hughes (Aug 05 2019 at 10:59)</a>:</h4>
<p>Good docs.</p>

<a name="172507663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/172507663" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#172507663">Kevin Buzzard (Aug 05 2019 at 14:16)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">inductive</span> <span class="n">in_closure</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">M</span><span class="o">)</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→</span> <span class="kt">Prop</span>
<span class="bp">|</span> <span class="n">basic</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">M</span><span class="o">}</span> <span class="o">:</span> <span class="n">a</span> <span class="err">∈</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">in_closure</span> <span class="n">a</span>
<span class="bp">|</span> <span class="n">one</span> <span class="o">:</span> <span class="n">in_closure</span> <span class="mi">1</span>
<span class="bp">|</span> <span class="n">mul</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">M</span><span class="o">}</span> <span class="o">:</span> <span class="n">in_closure</span> <span class="n">a</span> <span class="bp">→</span> <span class="n">in_closure</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">in_closure</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span>

<span class="n">def</span> <span class="n">closure</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">M</span><span class="o">)</span> <span class="o">:</span> <span class="n">submonoid</span> <span class="n">M</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">carrier</span> <span class="o">:=</span> <span class="n">in_closure</span> <span class="n">s</span><span class="o">,</span>
  <span class="n">one_mem&#39;</span> <span class="o">:=</span> <span class="n">in_closure</span><span class="bp">.</span><span class="n">one</span> <span class="n">s</span><span class="o">,</span>
  <span class="n">mul_mem&#39;</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">,</span> <span class="n">in_closure</span><span class="bp">.</span><span class="n">mul</span><span class="o">}</span>
</pre></div>


<p>There are two ways to do monoid closure of a subset. One is this inductive prop way, and the other is just taking the Inf of all the submonoids containing s. Should both be in mathlib? If not, which one?</p>

<a name="172507972"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/172507972" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#172507972">Chris Hughes (Aug 05 2019 at 14:20)</a>:</h4>
<p>It doesn't matter so long as you prove they're equivalent. You definitely want to define the recursor if you use the Inf definition.</p>

<a name="172507993"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/172507993" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#172507993">Johan Commelin (Aug 05 2019 at 14:21)</a>:</h4>
<p>Does it matter? The API should make sure that the user can not find out what the definition is (-;</p>

<a name="172508024"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/172508024" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#172508024">Kevin Buzzard (Aug 05 2019 at 14:21)</a>:</h4>
<p>I don't know if it matters. I just noted that for submonoids we had the inductive prop and for submodules we had the Inf</p>

<a name="172508114"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/172508114" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#172508114">Kevin Buzzard (Aug 05 2019 at 14:22)</a>:</h4>
<blockquote>
<p>Does it matter? The API should make sure that the user can not find out what the definition is (-;</p>
</blockquote>
<p>Oh right! I'll go back and mark everything as irreducible :-)</p>

<a name="172508177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/172508177" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#172508177">Johan Commelin (Aug 05 2019 at 14:23)</a>:</h4>
<p>I wouldn't mind if mathlib would experiment more with this (-;</p>

<a name="176840223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/176840223" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#176840223">Yury G. Kudryashov (Sep 28 2019 at 20:25)</a>:</h4>
<p>Hi, what is the current progress with bundling submonoids?</p>

<a name="176841062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/176841062" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#176841062">Yury G. Kudryashov (Sep 28 2019 at 20:48)</a>:</h4>
<p>Let me tag <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> <span class="user-mention" data-user-id="112680">@Johan Commelin</span> <span class="user-mention" data-user-id="110044">@Chris Hughes</span></p>

<a name="179152976"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/179152976" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#179152976">Amelia Livingston (Oct 27 2019 at 03:39)</a>:</h4>
<blockquote>
<p>Hi, what is the current progress with bundling submonoids?</p>
</blockquote>
<p>Hi <span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span> and others; sorry for the delay as I haven't been doing much Lean since term started. But the branch bundled_submonoids_etc is ready to PR (I think; I want to check it through in the morning). Unbundled submonoids are still there but bundled ones are too. The only things in the library that can be refactored to depend on these before we've also bundled subgroups are some lemmas in <code>group_theory\coset.lean</code>, <code>algebra\commute.lean</code> and <code>ring_theory\localization.lean</code>. I've done the first two but in this PR I haven't touched <code>localization</code>, because I've refactored that to PR a couple of PRs after this one.</p>
<p>There are also a couple of lemmas that I needed for later stuff about congruence relations/localization/etc. </p>
<p>I've started bundling subgroups, not on a branch, but I'm not prioritising it at the moment and I'm also unsure how to approach it. I extended bundled submonoids, and now I could just duplicate every lemma in <code>group_theory\submonoid.lean</code> so that given a subgroup S you can write <code>S.list_prod_mem</code> instead of having to write <code>S.1.list_prod_mem</code> or <code>S.to_submonoid.list_prod_mem</code>, for example. Or the user could just be told in the docs to write S.1 instead of S for some lemmas. I don't know. (I've got the same question about the localization refactor; I've commented out tons of lemmas where you can essentially use the version for localizations of comm monoids, which is another file, but it might confuse users.)</p>

<a name="179155734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/179155734" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#179155734">Johan Commelin (Oct 27 2019 at 05:19)</a>:</h4>
<p>I don't know the answer to this question. Can <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> or <span class="user-mention" data-user-id="110596">@Rob Lewis</span> or <span class="user-mention" data-user-id="110032">@Reid Barton</span> shed some light on how to deal with this? It sounds like bad design to duplicate the API. But <code>S.to_submonoid.foobar</code> isn't very nice either.</p>

<a name="179155834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/179155834" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#179155834">Mario Carneiro (Oct 27 2019 at 05:22)</a>:</h4>
<p>I think the easiest thing to do would be to just duplicate the api. The theorems should just be redirects, but note that the statements are actually different - things like <code>\mem</code> will be finding a different typeclass instance so it's not exactly the same thing (it is defeq though so the proof should be trivial)</p>

<a name="179155938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/179155938" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#179155938">Johan Commelin (Oct 27 2019 at 05:26)</a>:</h4>
<p>We have a similar thing with <code>{mv_,}power_series</code> and <code>*_hom</code>. Are we approaching enough examples to try to automate this?</p>

<a name="179155940"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/bundling%20submonoids/near/179155940" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/35255bundlingsubmonoids.html#179155940">Johan Commelin (Oct 27 2019 at 05:26)</a>:</h4>
<p>Because manually duplication will get out of sync <em>fast</em></p>


{% endraw %}

{% include archive_update.html %}