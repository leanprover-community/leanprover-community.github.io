---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/116395maths/23907CDGAs.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/116395maths/index.html">maths</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html">CDGAs</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="167848869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167848869" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167848869">Reid Barton (Jun 11 2019 at 13:19)</a>:</h4>
<p>I thought the discussion related to definitional associativity of addition and so on might benefit from a concrete example. So, here is a mini-challenge. A commutative differential graded algebra (CDGA) over a commutative ring <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.00773em;">R</span></span></span></span> consists of<br>
1. for each natural number <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">n</span></span></span></span>, an <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.00773em;">R</span></span></span></span>-module <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">A_n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span><br>
2. for each <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">i</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>, an <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.00773em;">R</span></span></span></span>-bilinear multiplication map <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><mo>×</mo><msub><mi>A</mi><mi>j</mi></msub><mo>→</mo><msub><mi>A</mi><mrow><mi>i</mi><mo>+</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">A_i \times A_j \to A_{i+j}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="base"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mbin">×</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"></span></span></span></span></span><span class="mrel">→</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"></span></span></span></span></span></span></span></span><br>
3. a unit <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>∈</mo><msub><mi>A</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">1 \in A_0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord mathrm">1</span><span class="mrel">∈</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span><br>
4. satisfying the obvious unitality and associativity conditions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>⋅</mo><mi>a</mi><mo>=</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">1 \cdot a = a</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">1</span><span class="mbin">⋅</span><span class="mord mathit">a</span><span class="mrel">=</span><span class="mord mathit">a</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>⋅</mo><mn>1</mn><mo>=</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">a \cdot 1 = a</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">a</span><span class="mbin">⋅</span><span class="mord mathrm">1</span><span class="mrel">=</span><span class="mord mathit">a</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>a</mi><mo>⋅</mo><mi>b</mi><mo>)</mo><mo>⋅</mo><mi>c</mi><mo>=</mo><mi>a</mi><mo>⋅</mo><mo>(</mo><mi>b</mi><mo>⋅</mo><mi>c</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(a \cdot b) \cdot c = a \cdot (b \cdot c)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mopen">(</span><span class="mord mathit">a</span><span class="mbin">⋅</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mbin">⋅</span><span class="mord mathit">c</span><span class="mrel">=</span><span class="mord mathit">a</span><span class="mbin">⋅</span><span class="mopen">(</span><span class="mord mathit">b</span><span class="mbin">⋅</span><span class="mord mathit">c</span><span class="mclose">)</span></span></span></span> for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>∈</mo><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a \in A_i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord mathit">a</span><span class="mrel">∈</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mo>∈</mo><msub><mi>A</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">b \in A_j</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="base"><span class="mord mathit">b</span><span class="mrel">∈</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi><mo>∈</mo><msub><mi>A</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">c \in A_k</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord mathit">c</span><span class="mrel">∈</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span><br>
5. as well as the graded commutativity relation <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mo>⋅</mo><mi>a</mi><mo>=</mo><mo>(</mo><mo>−</mo><mn>1</mn><msup><mo>)</mo><mrow><mi>i</mi><mi>j</mi></mrow></msup><mi>a</mi><mo>⋅</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">b \cdot a = (-1)^{ij} a \cdot b</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.824664em;"></span><span class="strut bottom" style="height:1.0746639999999998em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit">b</span><span class="mbin">⋅</span><span class="mord mathit">a</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathrm">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span></span></span></span></span></span><span class="mord mathit">a</span><span class="mbin">⋅</span><span class="mord mathit">b</span></span></span></span> for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>∈</mo><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a \in A_i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord mathit">a</span><span class="mrel">∈</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mo>∈</mo><msub><mi>A</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">b \in A_j</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="base"><span class="mord mathit">b</span><span class="mrel">∈</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"></span></span></span></span></span></span></span></span><br>
6. along with an <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.00773em;">R</span></span></span></span>-linear differential <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mo>:</mo><msub><mi>A</mi><mi>n</mi></msub><mo>→</mo><msub><mi>A</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">d : A_n \to A_{n+1}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="base"><span class="mord mathit">d</span><span class="mrel">:</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mrel">→</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mbin mtight">+</span><span class="mord mathrm mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"></span></span></span></span></span></span></span></span> for each <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">n</span></span></span></span><br>
7. satisfying <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>d</mi><mn>2</mn></msup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">d^2 = 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathit">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span></span></span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span><br>
8. as well as the Leibniz rule <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mo>(</mo><mi>a</mi><mo>⋅</mo><mi>b</mi><mo>)</mo><mo>=</mo><mi>d</mi><mi>a</mi><mo>⋅</mo><mi>b</mi><mo>+</mo><mo>(</mo><mo>−</mo><mn>1</mn><msup><mo>)</mo><mi>i</mi></msup><mi>a</mi><mo>⋅</mo><mi>d</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">d(a\cdot b) = da \cdot b + (-1)^i a \cdot db</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.824664em;"></span><span class="strut bottom" style="height:1.0746639999999998em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit">d</span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mbin">⋅</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">d</span><span class="mord mathit">a</span><span class="mbin">⋅</span><span class="mord mathit">b</span><span class="mbin">+</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathrm">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mord mathit">a</span><span class="mbin">⋅</span><span class="mord mathit">d</span><span class="mord mathit">b</span></span></span></span> for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>∈</mo><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a \in A_i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord mathit">a</span><span class="mrel">∈</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mo>∈</mo><msub><mi>A</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">b \in A_j</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="base"><span class="mord mathit">b</span><span class="mrel">∈</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"></span></span></span></span></span></span></span></span>.<br>
Note that the equations in 4, 5, 8 all involve reassociating and/or commuting i, j, k, 1 past one another.</p>
<p>If <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">A</span></span></span></span> is a CDGA then its cohomology <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>H</mi><mo>∗</mo></msup><mo>(</mo><mi>A</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">H^*(A)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">A</span><span class="mclose">)</span></span></span></span> is a graded commutative algebra. Basically this amounts to checking that</p>
<ul>
<li>if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>a</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">da = 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">d</span><span class="mord mathit">a</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>b</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">db = 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">d</span><span class="mord mathit">b</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>, then <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mo>(</mo><mi>a</mi><mo>⋅</mo><mi>b</mi><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">d(a \cdot b) = 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit">d</span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mbin">⋅</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span></li>
<li>if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>a</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">da = 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">d</span><span class="mord mathit">a</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mo>=</mo><mi>d</mi><msup><mi>b</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">b = db'</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">b</span><span class="mrel">=</span><span class="mord mathit">d</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>, then <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>⋅</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a \cdot b</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">a</span><span class="mbin">⋅</span><span class="mord mathit">b</span></span></span></span> is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">d</span></span></span></span> of something (namely <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mo>−</mo><mn>1</mn><msup><mo>)</mo><mi>i</mi></msup><mi>a</mi><mo>⋅</mo><msup><mi>b</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">(-1)^i a \cdot b'</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.824664em;"></span><span class="strut bottom" style="height:1.0746639999999998em;vertical-align:-0.25em;"></span><span class="base"><span class="mopen">(</span><span class="mord">−</span><span class="mord mathrm">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mord mathit">a</span><span class="mbin">⋅</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>∈</mo><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a \in A_i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord mathit">a</span><span class="mrel">∈</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span>),</li>
<li>similarly if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>=</mo><mi>d</mi><msup><mi>a</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">a = da'</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">a</span><span class="mrel">=</span><span class="mord mathit">d</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>b</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">db = 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">d</span><span class="mord mathit">b</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> then <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>⋅</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a \cdot b</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">a</span><span class="mbin">⋅</span><span class="mord mathit">b</span></span></span></span> is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">d</span></span></span></span> of something<br>
and therefore the multiplication <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><mo>×</mo><msub><mi>A</mi><mi>j</mi></msub><mo>→</mo><msub><mi>A</mi><mrow><mi>i</mi><mo>+</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">A_i \times A_j \to A_{i+j}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="base"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mbin">×</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"></span></span></span></span></span><span class="mrel">→</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"></span></span></span></span></span></span></span></span> restricts/descends to the kernel of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">d</span></span></span></span> modulo the image of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">d</span></span></span></span>.</li>
</ul>

<a name="167849707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167849707" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167849707">Johan Commelin (Jun 11 2019 at 13:29)</a>:</h4>
<p>And the challenge is... I guess: Implement CDGAs and prove that the cohomology is a graded commutative algebra?</p>

<a name="167850024"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167850024" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167850024">Reid Barton (Jun 11 2019 at 13:33)</a>:</h4>
<p>Right. Or just check the last three bulleted points if it's easier.</p>

<a name="167850325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167850325" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167850325">Johan Commelin (Jun 11 2019 at 13:36)</a>:</h4>
<p>And who are you challenging <span aria-label="stuck out tongue wink" class="emoji emoji-1f61c" role="img" title="stuck out tongue wink">:stuck_out_tongue_wink:</span>?</p>

<a name="167850552"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167850552" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167850552">Reid Barton (Jun 11 2019 at 13:39)</a>:</h4>
<p>Anyone who doesn't already believe that this will be a mess <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span></p>

<a name="167850695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167850695" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167850695">Kevin Buzzard (Jun 11 2019 at 13:41)</a>:</h4>
<p>I am sufficiently naive to believe that this will not be a mess. Why am I wrong?</p>

<a name="167850775"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167850775" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167850775">Reid Barton (Jun 11 2019 at 13:42)</a>:</h4>
<p>None of the equations in 4, 5, 8 or the trivial computations that need to be done to check the bulleted points type check if you write them down directly.</p>

<a name="167850824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167850824" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167850824">Reid Barton (Jun 11 2019 at 13:42)</a>:</h4>
<p>Well, maybe one of the unitality equations happens to type check. The issue with associativity for example is that one side is in <code>A ((i + j) + k)</code>, while the other side is in <code>A (i + (j + k))</code>.</p>

<a name="167850875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167850875" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167850875">Reid Barton (Jun 11 2019 at 13:43)</a>:</h4>
<p>The Leibniz rule involves three different types (I think, unless by chance two of them are defeq)</p>

<a name="167850969"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167850969" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167850969">Reid Barton (Jun 11 2019 at 13:44)</a>:</h4>
<p>To check <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>a</mi><mo>=</mo><mi>d</mi><mi>b</mi><mo>=</mo><mn>0</mn><mspace width="0.277778em"></mspace><mo>⟹</mo><mspace width="0.277778em"></mspace><mi>d</mi><mo>(</mo><mi>a</mi><mo>⋅</mo><mi>b</mi><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">da = db = 0 \implies d(a \cdot b) = 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit">d</span><span class="mord mathit">a</span><span class="mrel">=</span><span class="mord mathit">d</span><span class="mord mathit">b</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mrel"><span class="mspace thickspace"></span><span class="mrel">⟹</span></span><span class="mord mathit"><span class="mspace thickspace"></span><span class="mord mathit">d</span></span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mbin">⋅</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> you need to know that "being 0" is preserved across a cast <code>A ((i + 1) + j) \to A ((i + j) + 1)</code></p>

<a name="167851096"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167851096" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167851096">Reid Barton (Jun 11 2019 at 13:45)</a>:</h4>
<p>If defeq coincidences make it too easy, then change the degree of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">d</span></span></span></span> to -1.</p>

<a name="167851340"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167851340" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167851340">Reid Barton (Jun 11 2019 at 13:48)</a>:</h4>
<p>By the way, considering the signs in the Leibniz rule, it would really be more consistent to write <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">d</span></span></span></span> as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>n</mi></msub><mo>→</mo><msub><mi>A</mi><mrow><mn>1</mn><mo>+</mo><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">A_n \to A_{1+n}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="base"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mrel">→</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">1</span><span class="mbin mtight">+</span><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"></span></span></span></span></span></span></span></span>, but for some reason we don't do that.</p>

<a name="167851390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167851390" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167851390">Kevin Buzzard (Jun 11 2019 at 13:49)</a>:</h4>
<blockquote>
<p>By the way, considering the signs in the Leibniz rule, it would really be more consistent to write <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">d</span></span></span></span> as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>n</mi></msub><mo>→</mo><msub><mi>A</mi><mrow><mn>1</mn><mo>+</mo><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">A_n \to A_{1+n}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="base"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mrel">→</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">1</span><span class="mbin mtight">+</span><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"></span></span></span></span></span></span></span></span>, but for some reason we don't do that.</p>
</blockquote>
<p>That's because <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>+</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1+n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="base"><span class="mord mathrm">1</span><span class="mbin">+</span><span class="mord mathit">n</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n+1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="base"><span class="mord mathit">n</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span> are the same.</p>

<a name="167853480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167853480" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167853480">Kevin Buzzard (Jun 11 2019 at 14:10)</a>:</h4>
<p>(and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n+1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="base"><span class="mord mathit">n</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span> is the canonical form. )</p>

<a name="167854450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167854450" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167854450">Kevin Buzzard (Jun 11 2019 at 14:20)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">id&#39;</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">(</span><span class="n">i</span> <span class="n">j</span> <span class="n">k</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="o">(</span><span class="n">j</span> <span class="bp">+</span> <span class="n">k</span><span class="o">))</span> <span class="bp">→</span> <span class="n">A</span> <span class="o">((</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">)</span> <span class="bp">+</span> <span class="n">k</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">eq</span><span class="bp">.</span><span class="n">mpr</span> <span class="o">(</span><span class="k">by</span> <span class="n">rw</span> <span class="n">add_assoc</span><span class="o">)</span> <span class="n">x</span>
</pre></div>


<p>I don't really know what happens next. Does it get really horrible?</p>

<a name="167854628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167854628" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167854628">Kevin Buzzard (Jun 11 2019 at 14:22)</a>:</h4>
<p>Aah, and now the game is to prove that <code>id' 0 = 0</code></p>

<a name="167854840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167854840" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167854840">Kevin Buzzard (Jun 11 2019 at 14:24)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">id&#39;</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">has_zero</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>
<span class="o">(</span><span class="n">i</span> <span class="n">j</span> <span class="n">k</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="o">(</span><span class="n">j</span> <span class="bp">+</span> <span class="n">k</span><span class="o">))</span> <span class="bp">→</span> <span class="n">A</span> <span class="o">((</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">)</span> <span class="bp">+</span> <span class="n">k</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">eq</span><span class="bp">.</span><span class="n">mpr</span> <span class="o">(</span><span class="k">by</span> <span class="n">rw</span> <span class="n">add_assoc</span><span class="o">)</span> <span class="n">x</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">has_zero</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span> <span class="o">(</span><span class="n">i</span> <span class="n">j</span> <span class="n">k</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span>
<span class="n">id&#39;</span> <span class="n">A</span> <span class="n">i</span> <span class="n">j</span> <span class="n">k</span> <span class="mi">0</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">sorry</span>
<span class="kn">end</span>
</pre></div>

<a name="167855948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167855948" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167855948">Johan Commelin (Jun 11 2019 at 14:36)</a>:</h4>
<p>Kevin, this is certainly not what formalisation should impose on us.</p>

<a name="167855990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167855990" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167855990">Johan Commelin (Jun 11 2019 at 14:37)</a>:</h4>
<p>The system needs fixing, not just another work around</p>

<a name="167856267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167856267" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167856267">Neil Strickland (Jun 11 2019 at 14:39)</a>:</h4>
<p>I think that this is the main thing that we need:</p>
<div class="codehilite"><pre><span></span><span class="kn">variables</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>

<span class="kn">theorem</span> <span class="n">mp_hom</span> <span class="o">{</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">m</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">is_add_group_hom</span> <span class="o">((</span><span class="n">congr_arg</span> <span class="n">A</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="o">:</span> <span class="n">A</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">A</span> <span class="n">m</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rcases</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">change</span> <span class="n">is_add_group_hom</span> <span class="n">id</span><span class="o">,</span>
  <span class="n">exact</span> <span class="o">{</span><span class="n">map_add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">rfl</span><span class="o">}</span>
<span class="kn">end</span>
</pre></div>

<a name="167909957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167909957" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167909957">Floris van Doorn (Jun 12 2019 at 02:48)</a>:</h4>
<p>I have worked with a sequence of types before, in the Lean 2 HoTT library (e.g. in the folder <a href="https://github.com/cmu-phil/Spectral/tree/master/colimit" target="_blank" title="https://github.com/cmu-phil/Spectral/tree/master/colimit">https://github.com/cmu-phil/Spectral/tree/master/colimit</a> see <code>sequence</code> and <code>seq_colim</code>or <a href="https://github.com/cmu-phil/Spectral/blob/master/algebra/graded.hlean" target="_blank" title="https://github.com/cmu-phil/Spectral/blob/master/algebra/graded.hlean">https://github.com/cmu-phil/Spectral/blob/master/algebra/graded.hlean</a>)<br>
Here are some thoughts:</p>
<ul>
<li>This is definitely doable over the ordinary natural numbers if you know what you are doing. It will be tricky if you're not used to dependent types.</li>
<li>Definitional associativity of addition will still be very useful. </li>
<li>For point 8, you also want <code>(n+m)+1=(n+1)+m=n+(m+1)</code> definitionally, which we probably won't get with any version of <code>(d)nat</code>. So we still have to reason with cast/heq/...</li>
<li>If we replace the indexing type by <code>int</code> instead of <code>nat</code> we have an additional problem that we want <code>(n - 1) + 1</code> to be definitionally equal to <code>n</code> to define cohomology (there is no <code>d</code> which has <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">A_n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span> as codomain, only <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mrow><mo>(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo>)</mo><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">A_{(n-1)+1}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class="base"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">n</span><span class="mbin mtight">−</span><span class="mord mathrm mtight">1</span><span class="mclose mtight">)</span><span class="mbin mtight">+</span><span class="mord mathrm mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"></span></span></span></span></span></span></span></span>). See <a href="https://github.com/cmu-phil/Spectral/blob/master/algebra/graded.hlean#L17-L34" target="_blank" title="https://github.com/cmu-phil/Spectral/blob/master/algebra/graded.hlean#L17-L34">https://github.com/cmu-phil/Spectral/blob/master/algebra/graded.hlean#L17-L34</a> for some design considerations when I did graded morphisms and homology. For <code>nat</code> this will probably not be a problem, if we only define cohomology for <code>n+1</code>, since <code>(n+1)-1+1=n+1</code> definitionally.</li>
<li>When doing this over <code>nat</code>, I would definitely use <code>heq</code> everywhere for every equation. <code>heq</code>s aren't that bad to work with, IMO (the pathovers I worked with in HoTT are worse). I would probably write point 8 as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mo>(</mo><mi>a</mi><mo>⋅</mo><mi>b</mi><mo>)</mo><mo>+</mo><mo>(</mo><mo>−</mo><mn>1</mn><msup><mo>)</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><mi>a</mi><mo>⋅</mo><mi>d</mi><mi>b</mi><mo>=</mo><mo>=</mo><mi>d</mi><mi>a</mi><mo>⋅</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">d(a\cdot b)+(-1)^{i+1}a\cdot db==da\cdot b</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.824664em;"></span><span class="strut bottom" style="height:1.0746639999999998em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit">d</span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mbin">⋅</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mbin">+</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathrm">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mathrm mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathit">a</span><span class="mbin">⋅</span><span class="mord mathit">d</span><span class="mord mathit">b</span><span class="mrel">=</span><span class="mrel">=</span><span class="mord mathit">d</span><span class="mord mathit">a</span><span class="mbin">⋅</span><span class="mord mathit">b</span></span></span></span> (otherwise you have to insert a cast on one side of the addition)</li>
</ul>

<a name="167925695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167925695" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167925695">Kevin Buzzard (Jun 12 2019 at 08:29)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">mp_hom</span> <span class="o">{</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">m</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">is_add_group_hom</span> <span class="o">((</span><span class="n">congr_arg</span> <span class="n">A</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="o">:</span> <span class="n">A</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">A</span> <span class="n">m</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">subst</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">is_add_group_hom</span><span class="bp">.</span><span class="n">id</span>
<span class="kn">end</span>
</pre></div>

<a name="167925759"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167925759" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167925759">Kevin Buzzard (Jun 12 2019 at 08:30)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">group</span>
<span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">module</span>

<span class="kn">universe</span> <span class="n">u</span>

<span class="kn">structure</span> <span class="n">cdga</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="c1">-- universe monomorphism FTW</span>
<span class="o">[</span><span class="n">hA</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>
<span class="o">[</span><span class="n">hRA</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>
<span class="o">(</span><span class="n">a2</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span> <span class="o">,</span> <span class="o">(</span><span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">A</span> <span class="n">j</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">)))</span>
<span class="o">(</span><span class="n">h21</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">,</span> <span class="n">a2</span> <span class="o">(</span><span class="n">r</span> <span class="err">•</span> <span class="n">a</span><span class="o">)</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">r</span> <span class="err">•</span> <span class="o">(</span><span class="n">a2</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span>
<span class="o">(</span><span class="n">h22</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">,</span> <span class="n">a2</span> <span class="n">a</span> <span class="o">(</span><span class="n">r</span> <span class="err">•</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span> <span class="n">r</span> <span class="err">•</span> <span class="o">(</span><span class="n">a2</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span>
<span class="o">(</span><span class="n">h23</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">a₁</span> <span class="n">a₂</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">,</span> <span class="n">a2</span> <span class="o">(</span><span class="n">a₁</span> <span class="bp">+</span> <span class="n">a₂</span><span class="o">)</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">a2</span> <span class="n">a₁</span> <span class="n">b</span> <span class="bp">+</span> <span class="n">a2</span> <span class="n">a₂</span> <span class="n">b</span><span class="o">)</span>
<span class="o">(</span><span class="n">h24</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">b₁</span> <span class="n">b₂</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">,</span> <span class="n">a2</span> <span class="n">a</span> <span class="o">(</span><span class="n">b₁</span> <span class="bp">+</span> <span class="n">b₂</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a2</span> <span class="n">a</span> <span class="n">b₁</span> <span class="bp">+</span> <span class="n">a2</span> <span class="n">a</span> <span class="n">b₂</span><span class="o">)</span>

<span class="c1">-- deterministic timeout :-(</span>
</pre></div>

<a name="167926136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167926136" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167926136">Kevin Buzzard (Jun 12 2019 at 08:37)</a>:</h4>
<p>Oh my bad, I forgot some ints.</p>

<a name="167926219"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167926219" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167926219">Kevin Buzzard (Jun 12 2019 at 08:38)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">group</span>
<span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">module</span>

<span class="kn">universe</span> <span class="n">u</span>

<span class="kn">structure</span> <span class="n">cdga</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="c1">-- universe monomorphism FTW</span>
<span class="o">[</span><span class="n">hA</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>
<span class="o">[</span><span class="n">hRA</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>
<span class="o">(</span><span class="n">a2</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span> <span class="o">,</span> <span class="o">(</span><span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">A</span> <span class="n">j</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">)))</span>
<span class="o">(</span><span class="n">h21</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">,</span> <span class="n">a2</span> <span class="n">i</span> <span class="n">j</span> <span class="o">(</span><span class="n">r</span> <span class="err">•</span> <span class="n">a</span><span class="o">)</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">r</span> <span class="err">•</span> <span class="o">(</span><span class="n">a2</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span>
<span class="o">(</span><span class="n">h22</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">,</span> <span class="n">a2</span> <span class="n">i</span> <span class="n">j</span> <span class="n">a</span> <span class="o">(</span><span class="n">r</span> <span class="err">•</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span> <span class="n">r</span> <span class="err">•</span> <span class="o">(</span><span class="n">a2</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span>
<span class="o">(</span><span class="n">h23</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">a₁</span> <span class="n">a₂</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">,</span> <span class="n">a2</span> <span class="n">i</span> <span class="n">j</span> <span class="o">(</span><span class="n">a₁</span> <span class="bp">+</span> <span class="n">a₂</span><span class="o">)</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">a2</span> <span class="n">a₁</span> <span class="n">b</span> <span class="bp">+</span> <span class="n">a2</span> <span class="n">a₂</span> <span class="n">b</span><span class="o">)</span>
<span class="o">(</span><span class="n">h24</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">b₁</span> <span class="n">b₂</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">,</span> <span class="n">a2</span> <span class="n">i</span> <span class="n">j</span> <span class="n">a</span> <span class="o">(</span><span class="n">b₁</span> <span class="bp">+</span> <span class="n">b₂</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a2</span> <span class="n">a</span> <span class="n">b₁</span> <span class="bp">+</span> <span class="n">a2</span> <span class="n">a</span> <span class="n">b₂</span><span class="o">)</span>
</pre></div>


<p>Hmm, maybe the computer scientists would have chosen different names...</p>

<a name="167926310"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167926310" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167926310">Johan Commelin (Jun 12 2019 at 08:40)</a>:</h4>
<p>We have bilinear maps in mathlib, don't we?</p>

<a name="167926317"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167926317" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167926317">Kevin Buzzard (Jun 12 2019 at 08:40)</a>:</h4>
<p>That would be good.</p>

<a name="167926322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167926322" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167926322">Kevin Buzzard (Jun 12 2019 at 08:40)</a>:</h4>
<p>Not least because it would tell me the correct names ;-)</p>

<a name="167926342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167926342" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167926342">Kevin Buzzard (Jun 12 2019 at 08:41)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">structure</span> <span class="n">cdga</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="c1">-- universe monomorphism FTW</span>
<span class="o">[</span><span class="n">hA</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>
<span class="o">[</span><span class="n">hRA</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>
<span class="o">(</span><span class="n">mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">i</span> <span class="n">j</span><span class="o">}</span> <span class="o">,</span> <span class="o">(</span><span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">A</span> <span class="n">j</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">)))</span>
<span class="o">(</span><span class="n">lin_left</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">,</span> <span class="n">mul</span> <span class="o">(</span><span class="n">r</span> <span class="err">•</span> <span class="n">a</span><span class="o">)</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">r</span> <span class="err">•</span> <span class="o">(</span><span class="n">mul</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span>
<span class="o">(</span><span class="n">lin_right</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">,</span> <span class="n">mul</span> <span class="n">a</span> <span class="o">(</span><span class="n">r</span> <span class="err">•</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span> <span class="n">r</span> <span class="err">•</span> <span class="o">(</span><span class="n">mul</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span>
<span class="o">(</span><span class="n">add_left</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">a₁</span> <span class="n">a₂</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">,</span> <span class="n">mul</span> <span class="o">(</span><span class="n">a₁</span> <span class="bp">+</span> <span class="n">a₂</span><span class="o">)</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">mul</span> <span class="n">a₁</span> <span class="n">b</span> <span class="bp">+</span> <span class="n">mul</span> <span class="n">a₂</span> <span class="n">b</span><span class="o">)</span>
<span class="o">(</span><span class="n">add_right</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">b₁</span> <span class="n">b₂</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">,</span> <span class="n">mul</span> <span class="n">a</span> <span class="o">(</span><span class="n">b₁</span> <span class="bp">+</span> <span class="n">b₂</span><span class="o">)</span> <span class="bp">=</span> <span class="n">mul</span> <span class="n">a</span> <span class="n">b₁</span> <span class="bp">+</span> <span class="n">mul</span> <span class="n">a</span> <span class="n">b₂</span><span class="o">)</span>
</pre></div>

<a name="167974483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167974483" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167974483">Kevin Buzzard (Jun 12 2019 at 18:31)</a>:</h4>
<blockquote>
<p>We have bilinear maps in mathlib, don't we?</p>
</blockquote>
<p>I can't find them, and I sort-of don't know how to search for them.</p>

<a name="167974671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167974671" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167974671">Johan Commelin (Jun 12 2019 at 18:33)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/blob/66a86ffe010ffc32ee92e2e92cbdaf83487af168/src/linear_algebra/tensor_product.lean#L24" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/66a86ffe010ffc32ee92e2e92cbdaf83487af168/src/linear_algebra/tensor_product.lean#L24">https://github.com/leanprover-community/mathlib/blob/66a86ffe010ffc32ee92e2e92cbdaf83487af168/src/linear_algebra/tensor_product.lean#L24</a></p>

<a name="167974747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167974747" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167974747">Kevin Buzzard (Jun 12 2019 at 18:34)</a>:</h4>
<p>All the bilinearity hypotheses are _inputs_ to that function. Is that what I'm looking for?</p>

<a name="167974761"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167974761" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167974761">Kevin Buzzard (Jun 12 2019 at 18:34)</a>:</h4>
<p>I just want to say <code>is_bilinear_map</code> or something, right?</p>

<a name="167974762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167974762" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167974762">Johan Commelin (Jun 12 2019 at 18:34)</a>:</h4>
<p>The output is a bilinear map</p>

<a name="167974775"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167974775" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167974775">Johan Commelin (Jun 12 2019 at 18:34)</a>:</h4>
<p>So you just want a term of such a type.</p>

<a name="167974794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167974794" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167974794">Johan Commelin (Jun 12 2019 at 18:35)</a>:</h4>
<p>I.e., add subscript <code>l</code> to your arrows, and you're done</p>

<a name="167975071"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167975071" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167975071">Kevin Buzzard (Jun 12 2019 at 18:38)</a>:</h4>
<p><code>failed to synthesize type class instance for add_comm_group (A j →ₗ[R] A (i + j))</code> :-/ Maybe I need to turn up the heat.</p>

<a name="167975231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167975231" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167975231">Kevin Buzzard (Jun 12 2019 at 18:40)</a>:</h4>
<p>darn it, why is this error not in the mathlib file but I'm getting it :-/</p>

<a name="167975370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167975370" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167975370">Reid Barton (Jun 12 2019 at 18:42)</a>:</h4>
<p>hmm, maybe you need to import something?</p>

<a name="167975402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167975402" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167975402">Kevin Buzzard (Jun 12 2019 at 18:42)</a>:</h4>
<p>I'm importing the file Johan linked to :-)</p>

<a name="167975428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167975428" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167975428">Kevin Buzzard (Jun 12 2019 at 18:43)</a>:</h4>
<p>Oh! No I'm not! <em>doh</em></p>

<a name="167975555"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167975555" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167975555">Kevin Buzzard (Jun 12 2019 at 18:44)</a>:</h4>
<p>Ha ha I'd already explictly checked to see if that was the problem :-) Thanks.</p>

<a name="167976539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167976539" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167976539">Kevin Buzzard (Jun 12 2019 at 18:55)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">group</span>
<span class="kn">import</span> <span class="n">linear_algebra</span><span class="bp">.</span><span class="n">tensor_product</span>

<span class="kn">universe</span> <span class="n">u</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">n</span><span class="o">)</span>
  <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>

<span class="n">def</span> <span class="n">canonical_map</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">A</span> <span class="n">m</span> <span class="bp">→</span> <span class="n">A</span> <span class="n">n</span> <span class="o">:=</span> <span class="o">(</span><span class="n">congr_arg</span> <span class="n">A</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span>

<span class="kn">instance</span> <span class="n">canonical_hom</span> <span class="o">:</span> <span class="n">is_add_group_hom</span> <span class="o">(</span><span class="n">canonical_map</span> <span class="n">h</span> <span class="o">:</span> <span class="n">A</span> <span class="n">m</span> <span class="bp">→</span> <span class="n">A</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">subst</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">is_add_group_hom</span><span class="bp">.</span><span class="n">id</span>
<span class="kn">end</span>

<span class="n">def</span> <span class="n">canonical_R_hom</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">linear_map</span> <span class="n">R</span> <span class="o">(</span><span class="n">A</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">subst</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">linear_map</span><span class="bp">.</span><span class="n">id</span>
<span class="kn">end</span>

<span class="kn">structure</span> <span class="n">cdga</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="c1">-- universe monomorphism FTW</span>
<span class="o">[</span><span class="n">hA</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>
<span class="o">[</span><span class="n">hRA</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>
<span class="o">(</span><span class="n">mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span> <span class="o">,</span> <span class="o">(</span><span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="n">j</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">)))</span>
<span class="o">(</span><span class="n">one</span> <span class="o">:</span> <span class="n">A</span> <span class="mi">0</span><span class="o">)</span>
<span class="o">(</span><span class="n">one_mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">j</span><span class="o">},</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">),</span> <span class="n">canonical_map</span> <span class="o">(</span><span class="n">zero_add</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">mul</span> <span class="mi">0</span> <span class="n">j</span> <span class="n">one</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="n">mul_one</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">j</span><span class="o">},</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">),</span> <span class="n">canonical_map</span> <span class="o">(</span><span class="n">add_zero</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">mul</span> <span class="n">j</span> <span class="mi">0</span> <span class="n">a</span> <span class="n">one</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="n">mul_assoc</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">i</span> <span class="n">j</span> <span class="n">k</span><span class="o">},</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">A</span> <span class="n">k</span><span class="o">),</span>
   <span class="n">canonical_map</span> <span class="o">(</span><span class="n">add_assoc</span> <span class="n">i</span> <span class="n">j</span> <span class="n">k</span><span class="o">)</span> <span class="o">(</span><span class="n">mul</span> <span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="n">j</span><span class="o">)</span> <span class="n">k</span> <span class="o">(</span><span class="n">mul</span> <span class="n">i</span> <span class="n">j</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="n">c</span><span class="o">)</span> <span class="bp">=</span> <span class="n">mul</span> <span class="n">i</span> <span class="o">(</span><span class="n">j</span> <span class="bp">+</span> <span class="n">k</span><span class="o">)</span> <span class="n">a</span> <span class="o">(</span><span class="n">mul</span> <span class="n">j</span> <span class="n">k</span> <span class="n">b</span> <span class="n">c</span><span class="o">))</span>
</pre></div>


<p>Does this count as a "mess" so far?</p>

<a name="167976663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167976663" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167976663">Kevin Buzzard (Jun 12 2019 at 18:56)</a>:</h4>
<p>It's kind of annoying that <code>M →ₗ[R] N</code> has a coercion to <code>M -&gt; N</code> but it doesn't seem to kick in if you leave i and j implicit. Am I missing a trick?</p>

<a name="167976675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167976675" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167976675">Reid Barton (Jun 12 2019 at 18:56)</a>:</h4>
<p>Well, ... oh</p>

<a name="167976698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167976698" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167976698">Reid Barton (Jun 12 2019 at 18:56)</a>:</h4>
<p>I was about to say you could make i and j implicit</p>

<a name="167976953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167976953" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167976953">Kevin Buzzard (Jun 12 2019 at 18:58)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">cool_id</span> <span class="o">{</span><span class="n">i</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="o">(</span><span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span> <span class="n">linear_map</span><span class="bp">.</span><span class="n">id</span>

<span class="kn">variables</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">)</span>

<span class="bp">#</span><span class="kn">check</span> <span class="n">cool_id</span> <span class="n">a</span>
<span class="c">/-</span><span class="cm"></span>
<span class="cm">function expected at</span>
<span class="cm">  cool_id</span>
<span class="cm">term has type</span>
<span class="cm">  ?m_2 ?m_3 →ₗ[?m_1] ?m_2 ?m_3</span>
<span class="cm">-/</span>
</pre></div>

<a name="167976982"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167976982" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167976982">Reid Barton (Jun 12 2019 at 18:58)</a>:</h4>
<p>Currently it took you 93 characters to say <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>a</mi><mi>b</mi><mo>)</mo><mi>c</mi><mo>=</mo><mi>a</mi><mo>(</mo><mi>b</mi><mi>c</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(ab)c = a(bc)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mopen">(</span><span class="mord mathit">a</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mord mathit">c</span><span class="mrel">=</span><span class="mord mathit">a</span><span class="mopen">(</span><span class="mord mathit">b</span><span class="mord mathit">c</span><span class="mclose">)</span></span></span></span>, which doesn't seem ideal, but surely we can improve it</p>

<a name="167977013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167977013" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167977013">Kevin Buzzard (Jun 12 2019 at 18:59)</a>:</h4>
<p>Shall I remove all unnecessary spaces?</p>

<a name="167977074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167977074" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167977074">Kevin Buzzard (Jun 12 2019 at 18:59)</a>:</h4>
<p>There will be some way of using notation I guess; I just didn't see immediately how to do it once I switched to this R-linear stuff.</p>

<a name="167977165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167977165" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167977165">Reid Barton (Jun 12 2019 at 19:00)</a>:</h4>
<p>How about we instead add some unnecessary spaces to the tex source</p>

<a name="167977304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167977304" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167977304">Kevin Buzzard (Jun 12 2019 at 19:01)</a>:</h4>
<p>If I'd left <code>mul</code> as the actual map with <code>i</code> and <code>j</code> implicit we'd save a few characters. Calling it <code>m</code> would save more though; but I don't know how to get the notation <code>*</code> working, even if I start splitting up the structure into smaller <code>aux</code> structures first</p>

<a name="167977927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167977927" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167977927">Kevin Buzzard (Jun 12 2019 at 19:09)</a>:</h4>
<p>Every 2 minutes Lean segfaults, for some reason, when I'm writing this structure. "There's something fishy about structures" someone once said on this chat, and I think they're right.</p>

<a name="167979072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167979072" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167979072">Kevin Buzzard (Jun 12 2019 at 19:24)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">structure</span> <span class="n">cdga</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="c1">-- universe monomorphism FTW</span>
<span class="o">[</span><span class="n">hA</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>
<span class="o">[</span><span class="n">hRA</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>
<span class="o">(</span><span class="n">mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span> <span class="o">,</span> <span class="o">(</span><span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="n">j</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">)))</span>
<span class="o">(</span><span class="n">one</span> <span class="o">:</span> <span class="n">A</span> <span class="mi">0</span><span class="o">)</span>
<span class="o">(</span><span class="n">one_mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">j</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">),</span> <span class="n">canonical_map</span> <span class="o">(</span><span class="n">zero_add</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">mul</span> <span class="mi">0</span> <span class="n">j</span> <span class="n">one</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="n">mul_one</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">j</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">),</span> <span class="n">canonical_map</span> <span class="o">(</span><span class="n">add_zero</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">mul</span> <span class="n">j</span> <span class="mi">0</span> <span class="n">a</span> <span class="n">one</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="n">mul_assoc</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">i</span> <span class="n">j</span> <span class="n">k</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">A</span> <span class="n">k</span><span class="o">),</span>
   <span class="n">canonical_map</span> <span class="o">(</span><span class="n">add_assoc</span> <span class="n">i</span> <span class="n">j</span> <span class="n">k</span><span class="o">)</span> <span class="o">(</span><span class="n">mul</span> <span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="n">j</span><span class="o">)</span> <span class="n">k</span> <span class="o">(</span><span class="n">mul</span> <span class="n">i</span> <span class="n">j</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="n">c</span><span class="o">)</span> <span class="bp">=</span> <span class="n">mul</span> <span class="n">i</span> <span class="o">(</span><span class="n">j</span> <span class="bp">+</span> <span class="n">k</span><span class="o">)</span> <span class="n">a</span> <span class="o">(</span><span class="n">mul</span> <span class="n">j</span> <span class="n">k</span> <span class="n">b</span> <span class="n">c</span><span class="o">))</span>
<span class="o">(</span><span class="n">graded_comm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">i</span> <span class="n">j</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">),</span>
  <span class="n">canonical_map</span> <span class="o">(</span><span class="n">add_comm</span> <span class="n">j</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">mul</span> <span class="n">j</span> <span class="n">i</span> <span class="n">b</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span><span class="err">^</span><span class="o">(</span><span class="n">i</span> <span class="bp">*</span> <span class="n">j</span><span class="o">)</span> <span class="err">•</span> <span class="n">mul</span> <span class="n">i</span> <span class="n">j</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span>
<span class="o">(</span><span class="n">d</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)))</span>
<span class="o">(</span><span class="n">d_squared</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">n</span><span class="o">),</span> <span class="o">(</span><span class="n">d</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="n">A</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="n">A</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">2</span><span class="o">))</span> <span class="o">(</span><span class="n">d</span> <span class="n">n</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span>
<span class="o">(</span><span class="n">Leibniz</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">),</span> <span class="n">d</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">mul</span> <span class="n">i</span> <span class="n">j</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span>
   <span class="n">canonical_map</span> <span class="o">(</span><span class="k">show</span> <span class="n">i</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">+</span> <span class="n">j</span> <span class="bp">=</span> <span class="n">i</span> <span class="bp">+</span> <span class="n">j</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span><span class="o">)</span>
     <span class="o">((</span><span class="n">mul</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="n">j</span> <span class="o">:</span> <span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">A</span> <span class="n">j</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">+</span> <span class="n">j</span><span class="o">)))</span> <span class="o">(</span><span class="n">d</span> <span class="n">i</span> <span class="n">a</span><span class="o">)</span> <span class="n">b</span><span class="o">)</span> <span class="bp">+</span>
   <span class="o">(</span><span class="bp">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="err">^</span> <span class="n">i</span> <span class="err">•</span> <span class="n">canonical_map</span> <span class="o">(</span><span class="k">show</span> <span class="n">i</span> <span class="bp">+</span> <span class="o">(</span><span class="n">j</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="n">i</span> <span class="bp">+</span> <span class="n">j</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span><span class="o">)</span>
     <span class="o">((</span><span class="n">mul</span> <span class="n">i</span> <span class="o">(</span><span class="n">j</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span> <span class="bp">→</span> <span class="o">(</span><span class="n">A</span> <span class="o">(</span><span class="n">j</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="o">(</span><span class="n">j</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))))</span> <span class="n">a</span> <span class="o">(</span><span class="n">d</span> <span class="n">j</span> <span class="n">b</span><span class="o">)))</span>
</pre></div>


<p>Leibniz didn't go too well.</p>

<a name="167979134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167979134" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167979134">Kevin Buzzard (Jun 12 2019 at 19:25)</a>:</h4>
<p>The <code>mul</code>s for some reason refused to coerce to functions.</p>

<a name="167980193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167980193" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167980193">Johan Commelin (Jun 12 2019 at 19:37)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span> Seems like you picked a good topic for the challenge. <span class="user-mention" data-user-id="110031">@Patrick Massot</span> posted about this formalization "olympiad" kind of thing. Maybe this would make a nice exercise (-; And maybe <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> could give us some hints how to solve it...</p>

<a name="167980281"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167980281" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167980281">Kevin Buzzard (Jun 12 2019 at 19:39)</a>:</h4>
<p>I'm about to start the challenge; I have just got enough time to try d(ab)=0 before I need to go and do other things. The file is getting long so I'll post a gist when I finish / give up / have to go</p>

<a name="167980548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167980548" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167980548">Reid Barton (Jun 12 2019 at 19:42)</a>:</h4>
<p>Can you replace all the proof arguments to <code>canonical_map</code> by <code>by ring</code> or similar? Or does the elaborator not yet know what types it's trying to prove equal?</p>

<a name="167980805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167980805" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167980805">Kevin Buzzard (Jun 12 2019 at 19:46)</a>:</h4>
<p>It has worked for the two examples I've tried. There's some way of getting it to do it automatically isn't there. Some dot notation thing.</p>

<a name="167981011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167981011" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167981011">Kevin Buzzard (Jun 12 2019 at 19:48)</a>:</h4>
<p>It looks something like <code>def canonical_R_hom (h : m = n . ring) : linear_map R (A m) (A n) :=</code> but I need to create something of type <code>tactic unit</code> which does <code>ring</code></p>

<a name="167981139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167981139" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167981139">Kevin Buzzard (Jun 12 2019 at 19:50)</a>:</h4>
<p>Yeah, it doesn't always work :-( The elaborator makes the wrong guess sometimes, <code>ring</code> proves it (<code>rfl</code> would probably also prove it) and then I run into trouble later.</p>

<a name="167982582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167982582" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167982582">Kevin Buzzard (Jun 12 2019 at 20:05)</a>:</h4>
<p><a href="https://gist.github.com/kbuzzard/f5ee35457c5d257ceec58c66d7da0c38" target="_blank" title="https://gist.github.com/kbuzzard/f5ee35457c5d257ceec58c66d7da0c38">https://gist.github.com/kbuzzard/f5ee35457c5d257ceec58c66d7da0c38</a></p>
<p>I didn't quite finish :-( I have to prove 0 = 0. I was hoping <code>rw is_add_group_hom.zero</code> would work but it didn't, and now I have to go for a while.</p>

<a name="167982714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167982714" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167982714">Reid Barton (Jun 12 2019 at 20:06)</a>:</h4>
<p>I wonder whether it matters which side you put the <code>canonical_map</code> on</p>

<a name="167982757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167982757" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167982757">Reid Barton (Jun 12 2019 at 20:07)</a>:</h4>
<p>If the elaborator could figure out the types involved at the right time, the entire <code>canonical_map (by ring)</code> could become a bit of notation</p>

<a name="167982956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167982956" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167982956">Reid Barton (Jun 12 2019 at 20:09)</a>:</h4>
<p>Maybe <code>a = canonical_map (_) b</code> is easier than <code>canonical_map (_) a = b</code></p>

<a name="167988490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167988490" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167988490">Kevin Buzzard (Jun 12 2019 at 21:10)</a>:</h4>
<p>It's not going to be a <code>simp</code> lemma that way around ;-)</p>

<a name="167989313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167989313" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167989313">Kevin Buzzard (Jun 12 2019 at 21:21)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="c1">--set_option pp.proofs true</span>
<span class="kn">lemma</span> <span class="n">ker_d_prod</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">cdga</span> <span class="n">R</span><span class="o">)</span> <span class="o">{</span><span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span><span class="bp">.</span><span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">A</span><span class="bp">.</span><span class="n">A</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="o">(</span><span class="err">⇑</span><span class="o">(</span><span class="n">A</span><span class="bp">.</span><span class="n">d</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="n">A</span><span class="bp">.</span><span class="n">A</span> <span class="n">i</span> <span class="bp">→</span> <span class="n">A</span><span class="bp">.</span><span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">hb</span> <span class="o">:</span> <span class="n">A</span><span class="bp">.</span><span class="n">d</span> <span class="n">j</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">A</span><span class="bp">.</span><span class="n">d</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">A</span><span class="bp">.</span><span class="n">mul</span> <span class="n">i</span> <span class="n">j</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">A</span><span class="bp">.</span><span class="n">Leibniz</span><span class="o">,</span> <span class="n">ha</span><span class="o">,</span> <span class="n">hb</span><span class="o">,</span> <span class="n">zero_mul</span><span class="o">,</span> <span class="n">mul_zero</span><span class="o">],</span>
  <span class="n">rw</span> <span class="bp">@</span><span class="n">is_add_group_hom</span><span class="bp">.</span><span class="n">map_zero</span> <span class="o">(</span><span class="n">A</span><span class="bp">.</span><span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">+</span> <span class="n">j</span><span class="o">))</span> <span class="o">(</span><span class="n">A</span><span class="bp">.</span><span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span> <span class="bp">_</span> <span class="bp">_</span> <span class="o">(</span><span class="n">canonical_map</span> <span class="o">(</span><span class="k">show</span> <span class="n">i</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">+</span> <span class="n">j</span> <span class="bp">=</span> <span class="n">i</span> <span class="bp">+</span> <span class="n">j</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span> <span class="k">by</span> <span class="n">ring</span><span class="o">)),</span>
  <span class="n">rw</span> <span class="bp">@</span><span class="n">is_add_group_hom</span><span class="bp">.</span><span class="n">map_zero</span> <span class="o">(</span><span class="n">A</span><span class="bp">.</span><span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="o">(</span><span class="n">j</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)))</span> <span class="o">(</span><span class="n">A</span><span class="bp">.</span><span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span> <span class="bp">_</span> <span class="bp">_</span> <span class="o">(</span><span class="n">canonical_map</span> <span class="o">(</span><span class="k">show</span> <span class="n">i</span> <span class="bp">+</span> <span class="o">(</span><span class="n">j</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="n">i</span> <span class="bp">+</span> <span class="n">j</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span> <span class="k">by</span> <span class="n">ring</span><span class="o">)),</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">zero_add</span><span class="o">,</span> <span class="n">smul_zero</span><span class="o">],</span>
<span class="kn">end</span>
</pre></div>


<p>What was that about "messy"?</p>

<a name="167989450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167989450" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167989450">Kevin Buzzard (Jun 12 2019 at 21:23)</a>:</h4>
<p>I updated the gist and now I'm back to cleaning the kitchen. <span class="user-mention" data-user-id="110064">@Kenny Lau</span> <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> I'm sure both of you will see ways to tidy this up.</p>

<a name="167989460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167989460" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167989460">Kevin Buzzard (Jun 12 2019 at 21:23)</a>:</h4>
<p><a href="https://gist.github.com/kbuzzard/f5ee35457c5d257ceec58c66d7da0c38" target="_blank" title="https://gist.github.com/kbuzzard/f5ee35457c5d257ceec58c66d7da0c38">https://gist.github.com/kbuzzard/f5ee35457c5d257ceec58c66d7da0c38</a></p>

<a name="167989766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167989766" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167989766">Kevin Buzzard (Jun 12 2019 at 21:27)</a>:</h4>
<p>See Reid's initial post for the maths</p>

<a name="167991130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167991130" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167991130">Kenny Lau (Jun 12 2019 at 21:42)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">group</span>
<span class="kn">import</span> <span class="n">linear_algebra</span><span class="bp">.</span><span class="n">tensor_product</span>
<span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span>

<span class="n">universes</span> <span class="n">v</span> <span class="n">u</span>

<span class="kn">section</span> <span class="n">canonical</span>

<span class="kn">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span>
<span class="kn">variables</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">n</span><span class="o">)</span>
<span class="n">include</span> <span class="n">h</span>

<span class="n">def</span> <span class="n">canonical_map</span> <span class="o">:</span> <span class="n">A</span> <span class="n">m</span> <span class="bp">→</span> <span class="n">A</span> <span class="n">n</span> <span class="o">:=</span> <span class="o">(</span><span class="n">congr_arg</span> <span class="n">A</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span>

<span class="kn">instance</span> <span class="n">canonical_hom</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span> <span class="o">:</span> <span class="n">is_add_group_hom</span> <span class="o">(</span><span class="n">canonical_map</span> <span class="n">A</span> <span class="n">h</span> <span class="o">:</span> <span class="n">A</span> <span class="n">m</span> <span class="bp">→</span> <span class="n">A</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">subst</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">is_add_group_hom</span><span class="bp">.</span><span class="n">id</span>
<span class="kn">end</span>

<span class="n">def</span> <span class="n">canonical_R_hom</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span> <span class="o">:</span> <span class="o">(</span><span class="n">A</span> <span class="n">m</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">subst</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">linear_map</span><span class="bp">.</span><span class="n">id</span>
<span class="kn">end</span>

<span class="kn">end</span> <span class="n">canonical</span>

<span class="kn">structure</span> <span class="n">cdga</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="c1">-- universe polymorphism FTW</span>
<span class="o">[</span><span class="n">hA</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>
<span class="o">[</span><span class="n">hRA</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>
<span class="o">(</span><span class="n">mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span> <span class="o">,</span> <span class="o">(</span><span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="n">j</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">)))</span>
<span class="o">(</span><span class="n">one</span> <span class="o">:</span> <span class="n">A</span> <span class="mi">0</span><span class="o">)</span>
<span class="o">(</span><span class="n">one_mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">j</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">),</span> <span class="n">canonical_R_hom</span> <span class="n">R</span> <span class="n">A</span> <span class="o">(</span><span class="n">zero_add</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">mul</span> <span class="mi">0</span> <span class="n">j</span> <span class="n">one</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="n">mul_one</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">j</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">),</span> <span class="n">canonical_R_hom</span> <span class="n">R</span> <span class="n">A</span> <span class="o">(</span><span class="n">add_zero</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">mul</span> <span class="n">j</span> <span class="mi">0</span> <span class="n">a</span> <span class="n">one</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="n">mul_assoc</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">i</span> <span class="n">j</span> <span class="n">k</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">A</span> <span class="n">k</span><span class="o">),</span>
   <span class="n">canonical_R_hom</span> <span class="n">R</span> <span class="n">A</span> <span class="o">(</span><span class="n">add_assoc</span> <span class="n">i</span> <span class="n">j</span> <span class="n">k</span><span class="o">)</span> <span class="o">(</span><span class="n">mul</span> <span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="n">j</span><span class="o">)</span> <span class="n">k</span> <span class="o">(</span><span class="n">mul</span> <span class="n">i</span> <span class="n">j</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="n">c</span><span class="o">)</span> <span class="bp">=</span> <span class="n">mul</span> <span class="n">i</span> <span class="o">(</span><span class="n">j</span> <span class="bp">+</span> <span class="n">k</span><span class="o">)</span> <span class="n">a</span> <span class="o">(</span><span class="n">mul</span> <span class="n">j</span> <span class="n">k</span> <span class="n">b</span> <span class="n">c</span><span class="o">))</span>
<span class="o">(</span><span class="n">graded_comm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">i</span> <span class="n">j</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">),</span>
  <span class="n">canonical_R_hom</span> <span class="n">R</span> <span class="n">A</span> <span class="o">(</span><span class="n">add_comm</span> <span class="n">j</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">mul</span> <span class="n">j</span> <span class="n">i</span> <span class="n">b</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span><span class="err">^</span><span class="o">(</span><span class="n">i</span> <span class="bp">*</span> <span class="n">j</span><span class="o">)</span> <span class="err">•</span> <span class="n">mul</span> <span class="n">i</span> <span class="n">j</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span>
<span class="o">(</span><span class="n">d</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)))</span>
<span class="o">(</span><span class="n">d_squared</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">n</span><span class="o">),</span> <span class="o">(</span><span class="n">d</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="n">A</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="n">A</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">2</span><span class="o">))</span> <span class="o">(</span><span class="n">d</span> <span class="n">n</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span>
<span class="o">(</span><span class="n">Leibniz</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">),</span> <span class="n">d</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">mul</span> <span class="n">i</span> <span class="n">j</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span>
   <span class="n">canonical_R_hom</span> <span class="n">R</span> <span class="n">A</span> <span class="o">(</span><span class="n">add_right_comm</span> <span class="n">i</span> <span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">)</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">mul</span> <span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">))</span> <span class="n">j</span> <span class="o">(</span><span class="n">d</span> <span class="n">i</span> <span class="n">a</span><span class="o">)</span> <span class="n">b</span><span class="o">)</span> <span class="bp">+</span>
   <span class="o">(</span><span class="bp">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="err">^</span> <span class="n">i</span> <span class="err">•</span> <span class="n">canonical_R_hom</span> <span class="n">R</span> <span class="n">A</span> <span class="o">(</span><span class="n">add_assoc</span> <span class="n">i</span> <span class="n">j</span> <span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">))</span><span class="bp">.</span><span class="n">symm</span> <span class="o">(</span><span class="n">mul</span> <span class="n">i</span> <span class="o">(</span><span class="n">j</span><span class="bp">+</span><span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">))</span> <span class="n">a</span> <span class="o">(</span><span class="n">d</span> <span class="n">j</span> <span class="n">b</span><span class="o">)))</span>
<span class="n">attribute</span> <span class="o">[</span><span class="kn">instance</span><span class="o">]</span> <span class="n">cdga</span><span class="bp">.</span><span class="n">hA</span> <span class="n">cdga</span><span class="bp">.</span><span class="n">hRA</span>

<span class="c">/-</span><span class="cm"></span>
<span class="cm">If AAA is a CDGA then its cohomology H∗(A)H^*(A)H∗(A) is a graded commutative algebra. Basically this amounts to checking that</span>

<span class="cm">    if da=0da = 0da=0 and db=0db = 0db=0, then d(a⋅b)=0d(a \cdot b) = 0d(a⋅b)=0</span>
<span class="cm">    if da=0da = 0da=0 and b=db′b = db&#39;b=db′, then a⋅ba \cdot ba⋅b is ddd of something (namely (−1)ia⋅b′(-1)^i a \cdot b&#39;(−1)ia⋅b′ where a∈Aia \in A_ia∈Ai​),</span>
<span class="cm">    similarly if a=da′a = da&#39;a=da′ and db=0db = 0db=0 then a⋅ba \cdot ba⋅b is ddd of something</span>
<span class="cm">    and therefore the multiplication Ai×Aj→Ai+jA_i \times A_j \to A_{i+j}Ai​×Aj​→Ai+j​ restricts/descends to the kernel of ddd modulo the image of ddd.</span>

<span class="cm">-/</span>
<span class="kn">namespace</span> <span class="n">cdga</span>

<span class="kn">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">cdga</span> <span class="n">R</span><span class="o">)</span>

<span class="kn">lemma</span> <span class="n">zero_mul</span> <span class="o">{</span><span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">A</span><span class="bp">.</span><span class="n">A</span> <span class="n">j</span><span class="o">)</span> <span class="o">:</span> <span class="n">A</span><span class="bp">.</span><span class="n">mul</span> <span class="n">i</span> <span class="n">j</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">A</span><span class="bp">.</span><span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">linear_map</span><span class="bp">.</span><span class="n">map_zero</span><span class="o">,</span> <span class="n">linear_map</span><span class="bp">.</span><span class="n">zero_apply</span><span class="o">]</span>

<span class="kn">lemma</span> <span class="n">mul_zero</span> <span class="o">{</span><span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span><span class="bp">.</span><span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="n">A</span><span class="bp">.</span><span class="n">mul</span> <span class="n">i</span> <span class="n">j</span> <span class="n">a</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">A</span><span class="bp">.</span><span class="n">A</span> <span class="n">j</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="n">linear_map</span><span class="bp">.</span><span class="n">map_zero</span> <span class="bp">_</span>

<span class="c1">--set_option pp.proofs true</span>
<span class="kn">lemma</span> <span class="n">ker_d_prod</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">cdga</span> <span class="n">R</span><span class="o">)</span> <span class="o">{</span><span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span><span class="bp">.</span><span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">A</span><span class="bp">.</span><span class="n">A</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">A</span><span class="bp">.</span><span class="n">d</span> <span class="n">i</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">hb</span> <span class="o">:</span> <span class="n">A</span><span class="bp">.</span><span class="n">d</span> <span class="n">j</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">A</span><span class="bp">.</span><span class="n">d</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">A</span><span class="bp">.</span><span class="n">mul</span> <span class="n">i</span> <span class="n">j</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">A</span><span class="bp">.</span><span class="n">Leibniz</span><span class="o">,</span> <span class="n">ha</span><span class="o">,</span> <span class="n">hb</span><span class="o">,</span> <span class="n">zero_mul</span><span class="o">,</span> <span class="n">mul_zero</span><span class="o">,</span> <span class="n">linear_map</span><span class="bp">.</span><span class="n">map_zero</span><span class="o">,</span> <span class="n">linear_map</span><span class="bp">.</span><span class="n">map_zero</span><span class="o">,</span> <span class="n">zero_add</span><span class="o">,</span> <span class="n">smul_zero</span><span class="o">]</span>

<span class="kn">end</span> <span class="n">cdga</span>
</pre></div>

<a name="167993809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167993809" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167993809">Kevin Buzzard (Jun 12 2019 at 22:18)</a>:</h4>
<p>I couldn't get map_zero to work with unbundled homs. You have changed to bundled homs and now it works?</p>

<a name="167993854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167993854" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167993854">Kevin Buzzard (Jun 12 2019 at 22:18)</a>:</h4>
<p>Or was it the change to universe polymorphism which was decisive? ;-)</p>

<a name="167995078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167995078" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167995078">Kenny Lau (Jun 12 2019 at 22:36)</a>:</h4>
<p>well you didn't use the linear map, so of course you couldn't access <code>map_zero</code></p>

<a name="167995086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167995086" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167995086">Kevin Buzzard (Jun 12 2019 at 22:37)</a>:</h4>
<p>I was using is_add_group_hom.map_zero IIRC</p>

<a name="167995115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167995115" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167995115">Kevin Buzzard (Jun 12 2019 at 22:37)</a>:</h4>
<p>and I made that an instance. I'm looking at your changes. I made the bundled and unbundled maps and you have completely switched to bundled maps.</p>

<a name="167995180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167995180" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167995180">Kevin Buzzard (Jun 12 2019 at 22:38)</a>:</h4>
<p>I had problems with coercions to functions not kicking in but you seem to have solved them. Is this because of the bundling?</p>

<a name="167995223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167995223" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167995223">Kevin Buzzard (Jun 12 2019 at 22:38)</a>:</h4>
<div class="codehilite"><pre><span></span> <span class="n">rw</span> <span class="bp">@</span><span class="n">is_add_group_hom</span><span class="bp">.</span><span class="n">map_zero</span> <span class="o">(</span><span class="n">A</span><span class="bp">.</span><span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">+</span> <span class="n">j</span><span class="o">))</span> <span class="o">(</span><span class="n">A</span><span class="bp">.</span><span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span> <span class="bp">_</span> <span class="bp">_</span> <span class="o">(</span><span class="n">canonical_map</span> <span class="o">(</span><span class="k">show</span> <span class="n">i</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">+</span> <span class="n">j</span> <span class="bp">=</span> <span class="n">i</span> <span class="bp">+</span> <span class="n">j</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span> <span class="k">by</span> <span class="n">ring</span><span class="o">)),</span>
</pre></div>

<a name="167995286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167995286" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167995286">Kenny Lau (Jun 12 2019 at 22:40)</a>:</h4>
<p>I turned on <code>pp.all</code> and it turns out that <code>1</code> was the problem</p>

<a name="167995342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167995342" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167995342">Kenny Lau (Jun 12 2019 at 22:40)</a>:</h4>
<p>changing it to <code>(1:ℕ)</code> resolves the issue</p>

<a name="167997025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167997025" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167997025">Mario Carneiro (Jun 12 2019 at 23:04)</a>:</h4>
<p>I want to see if an untyped formulation is easier</p>

<a name="167998204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167998204" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167998204">Kenny Lau (Jun 12 2019 at 23:22)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> what does that mean?</p>

<a name="167998216"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167998216" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167998216">Mario Carneiro (Jun 12 2019 at 23:23)</a>:</h4>
<p>stay tuned</p>

<a name="167999328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999328" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999328">Mario Carneiro (Jun 12 2019 at 23:43)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">linear_algebra</span><span class="bp">.</span><span class="n">basic</span>
<span class="n">universes</span> <span class="n">v</span> <span class="n">u</span>
<span class="n">def</span> <span class="n">env</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">:=</span> <span class="n">option</span> <span class="o">(</span><span class="err">Σ</span> <span class="n">n</span><span class="o">,</span> <span class="n">A</span> <span class="n">n</span><span class="o">)</span>

<span class="n">def</span> <span class="n">env</span><span class="bp">.</span><span class="n">as</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">env</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">option</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">do</span> <span class="bp">⟨</span><span class="n">m</span><span class="o">,</span> <span class="o">(</span><span class="n">a</span><span class="o">:</span><span class="n">A</span> <span class="n">m</span><span class="o">)</span><span class="bp">⟩</span> <span class="err">←</span> <span class="n">e</span><span class="o">,</span>
  <span class="k">if</span> <span class="n">h</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">n</span> <span class="k">then</span> <span class="n">some</span> <span class="o">(</span><span class="k">by</span> <span class="n">rw</span> <span class="err">←</span> <span class="n">h</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">a</span><span class="o">)</span> <span class="k">else</span> <span class="n">none</span>

<span class="kn">instance</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">has_coe</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">env</span> <span class="n">A</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">⟨λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">some</span> <span class="bp">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">x</span><span class="bp">⟩⟩</span>

<span class="kn">instance</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">has_add</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span> <span class="o">:</span> <span class="n">has_add</span> <span class="o">(</span><span class="n">env</span> <span class="n">A</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">do</span> <span class="bp">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">a</span><span class="bp">⟩</span> <span class="err">←</span> <span class="n">x</span><span class="o">,</span> <span class="n">b</span> <span class="err">←</span> <span class="n">y</span><span class="bp">.</span><span class="n">as</span> <span class="n">n</span><span class="o">,</span> <span class="n">some</span> <span class="bp">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="bp">⟩⟩</span>

<span class="kn">instance</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">has_scalar</span> <span class="n">R</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span> <span class="o">:</span> <span class="n">has_scalar</span> <span class="n">R</span> <span class="o">(</span><span class="n">env</span> <span class="n">A</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨λ</span> <span class="n">r</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span> <span class="bp">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">a</span><span class="bp">⟩</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">r</span> <span class="err">•</span> <span class="n">a</span><span class="bp">⟩</span><span class="o">)</span><span class="bp">⟩</span>

<span class="n">def</span> <span class="n">env</span><span class="bp">.</span><span class="n">mul</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="n">A</span> <span class="n">i</span> <span class="bp">→</span> <span class="n">A</span> <span class="n">j</span> <span class="bp">→</span>  <span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">))</span>
  <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">env</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span> <span class="n">env</span> <span class="n">A</span> <span class="o">:=</span>
<span class="n">do</span> <span class="bp">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">a</span><span class="bp">⟩</span> <span class="err">←</span> <span class="n">x</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">j</span><span class="o">,</span> <span class="n">b</span><span class="bp">⟩</span> <span class="err">←</span> <span class="n">y</span><span class="o">,</span> <span class="n">some</span> <span class="bp">⟨</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span> <span class="n">j</span> <span class="n">a</span> <span class="n">b</span><span class="bp">⟩</span>

<span class="n">def</span> <span class="n">cdga_mul</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span>
  <span class="o">[</span><span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>
  <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="n">A</span> <span class="n">i</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">A</span> <span class="n">j</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">env</span> <span class="n">A</span> <span class="bp">→</span> <span class="n">env</span> <span class="n">A</span> <span class="bp">→</span> <span class="n">env</span> <span class="n">A</span> <span class="o">:=</span>
<span class="n">env</span><span class="bp">.</span><span class="n">mul</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span> <span class="n">j</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span> <span class="n">j</span> <span class="n">x</span> <span class="n">y</span><span class="o">)</span>

<span class="n">def</span> <span class="n">cdga_d</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span>
  <span class="o">[</span><span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>
  <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">A</span> <span class="n">n</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">A</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span>
  <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">env</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span> <span class="n">env</span> <span class="n">A</span> <span class="o">:=</span>
<span class="n">x</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span> <span class="bp">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">a</span><span class="bp">⟩</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">f</span> <span class="n">n</span> <span class="n">a</span><span class="bp">⟩</span><span class="o">)</span>

<span class="kn">structure</span> <span class="n">cdga</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="c1">-- universe polymorphism FTW</span>
<span class="o">[</span><span class="n">hA</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">add_comm_group</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>
<span class="o">[</span><span class="n">hRA</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">A</span> <span class="n">n</span><span class="o">)]</span>
<span class="o">(</span><span class="n">mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="o">(</span><span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="n">j</span><span class="o">)</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">j</span><span class="o">)))</span>
<span class="o">(</span><span class="kn">infix</span> <span class="bp">`</span> <span class="bp">*</span> <span class="bp">`</span> <span class="o">:=</span> <span class="n">cdga_mul</span> <span class="n">mul</span><span class="o">)</span>
<span class="o">(</span><span class="n">one</span> <span class="o">:</span> <span class="n">A</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="kn">notation</span> <span class="bp">`</span><span class="mi">𝟙</span><span class="bp">`</span> <span class="o">:=</span> <span class="o">(</span><span class="n">one</span> <span class="o">:</span> <span class="n">env</span> <span class="n">A</span><span class="o">))</span>
<span class="o">(</span><span class="n">one_mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">j</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">),</span> <span class="mi">𝟙</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="n">mul_one</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">j</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="mi">𝟙</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="n">mul_assoc</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">i</span> <span class="n">j</span> <span class="n">k</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">A</span> <span class="n">k</span><span class="o">),</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">*</span> <span class="o">(</span><span class="n">b</span> <span class="bp">*</span> <span class="n">c</span><span class="o">))</span>
<span class="o">(</span><span class="n">graded_comm</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">i</span> <span class="n">j</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">),</span>
  <span class="n">b</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">=</span> <span class="o">((</span><span class="bp">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span><span class="err">^</span><span class="o">(</span><span class="n">has_mul</span><span class="bp">.</span><span class="n">mul</span> <span class="n">i</span> <span class="n">j</span><span class="o">))</span> <span class="err">•</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span>
<span class="o">(</span><span class="n">d</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="n">A</span> <span class="n">n</span> <span class="bp">→</span><span class="err">ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">A</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span>
<span class="o">(</span><span class="kn">notation</span> <span class="bp">`</span><span class="n">D</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">cdga_d</span> <span class="n">d</span><span class="o">)</span>
<span class="o">(</span><span class="n">d_squared</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">n</span><span class="o">),</span> <span class="n">D</span> <span class="o">(</span><span class="n">D</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">A</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">2</span><span class="o">)))</span>
<span class="o">(</span><span class="n">Leibniz</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">A</span> <span class="n">j</span><span class="o">),</span> <span class="n">D</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span> <span class="n">D</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">:</span><span class="n">R</span><span class="o">)</span><span class="err">^</span><span class="n">i</span> <span class="err">•</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">D</span> <span class="n">b</span><span class="o">)</span>
</pre></div>

<a name="167999415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999415" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999415">Kenny Lau (Jun 12 2019 at 23:44)</a>:</h4>
<p>why did you reverse my <code>universes v u</code>?</p>

<a name="167999433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999433" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999433">Mario Carneiro (Jun 12 2019 at 23:44)</a>:</h4>
<p>I wrote it myself, didn't see that</p>

<a name="167999456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999456" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999456">Kenny Lau (Jun 12 2019 at 23:45)</a>:</h4>
<p>how on earth does <code>(mul_assoc : ∀ {i j k} (a : A i) (b : A j) (c : A k), (a * b) * c = a * (b * c))</code> work?</p>

<a name="167999464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999464" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999464">Mario Carneiro (Jun 12 2019 at 23:45)</a>:</h4>
<p>because untyped is awesome</p>

<a name="167999522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999522" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999522">Kenny Lau (Jun 12 2019 at 23:46)</a>:</h4>
<p>I don't understand</p>

<a name="167999530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999530" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999530">Kenny Lau (Jun 12 2019 at 23:46)</a>:</h4>
<p>oh wait nothing</p>

<a name="167999533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999533" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999533">Mario Carneiro (Jun 12 2019 at 23:46)</a>:</h4>
<p><code>a,b,c</code> are coerced to <code>env A</code>, and <code>env A</code> is closed under multiplication</p>

<a name="167999573"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999573" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999573">Kenny Lau (Jun 12 2019 at 23:47)</a>:</h4>
<p>ok now how on earth does it work</p>

<a name="167999579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999579" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999579">Mario Carneiro (Jun 12 2019 at 23:47)</a>:</h4>
<p>just like that...?</p>

<a name="167999586"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999586" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999586">Kenny Lau (Jun 12 2019 at 23:47)</a>:</h4>
<p>oh I understand now</p>

<a name="167999587"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999587" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999587">Mario Carneiro (Jun 12 2019 at 23:47)</a>:</h4>
<p>there are no add comm manipulations this way</p>

<a name="167999588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999588" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999588">Kenny Lau (Jun 12 2019 at 23:47)</a>:</h4>
<p>ok this is interesting</p>

<a name="167999640"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999640" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999640">Kenny Lau (Jun 12 2019 at 23:48)</a>:</h4>
<p>but I'm not very convinced that it will be easy to use</p>

<a name="167999646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999646" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999646">Mario Carneiro (Jun 12 2019 at 23:48)</a>:</h4>
<p>you have to hide the unfolding of mul and such</p>

<a name="167999650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999650" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999650">Mario Carneiro (Jun 12 2019 at 23:48)</a>:</h4>
<p>you just rewrite with the equations</p>

<a name="167999747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999747" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999747">Mario Carneiro (Jun 12 2019 at 23:50)</a>:</h4>
<p>You can use a typeclass predicate <code>has_type : env A -&gt; out_param nat -&gt; Prop</code> to find that an expression is well defined, and extract the value from there</p>

<a name="167999781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999781" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999781">Mario Carneiro (Jun 12 2019 at 23:52)</a>:</h4>
<p>Obviously this is very different from the usual way of doing stuff in lean, but it totally works; this is how ZFC formalization goes</p>

<a name="167999860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999860" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999860">Kenny Lau (Jun 12 2019 at 23:53)</a>:</h4>
<p>I'm not convinced the <code>option</code> is necessary</p>

<a name="167999871"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999871" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999871">Mario Carneiro (Jun 12 2019 at 23:53)</a>:</h4>
<p>It's not</p>

<a name="167999919"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999919" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999919">Mario Carneiro (Jun 12 2019 at 23:54)</a>:</h4>
<p>it's slightly better hygiene, but you could use &lt;0,0&gt; instead</p>

<a name="167999930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999930" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999930">Mario Carneiro (Jun 12 2019 at 23:54)</a>:</h4>
<p>it doesn't really matter as long as you promise not to write bad expressions</p>

<a name="167999959"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999959" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999959">Reid Barton (Jun 12 2019 at 23:55)</a>:</h4>
<p>BTW in math we often just add together things in different <code>A n</code>s and work in the direct sum or direct product as appropriate</p>

<a name="167999977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999977" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999977">Reid Barton (Jun 12 2019 at 23:55)</a>:</h4>
<p>however I intentionally didn't mention this to avoid biasing the approaches that people came up with</p>

<a name="167999979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/167999979" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#167999979">Mario Carneiro (Jun 12 2019 at 23:55)</a>:</h4>
<p>ah, that might be the better choice since then you get some saner closure conditions</p>

<a name="168000051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/168000051" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#168000051">Reid Barton (Jun 12 2019 at 23:56)</a>:</h4>
<p>In fact the stacks project defines one of these as an algebra <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>=</mo><msub><mo>⨁</mo><mi>i</mi></msub><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A = \bigoplus_i A_i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span class="base"><span class="mord mathit">A</span><span class="mrel">=</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">⨁</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span> (direct sum of modules) with the property that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>A</mi><mi>j</mi></msub><mo>⊂</mo><msub><mi>A</mi><mrow><mi>i</mi><mo>+</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">A_i \cdot A_j \subset A_{i+j}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="base"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mbin">⋅</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"></span></span></span></span></span><span class="mrel">⊂</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"></span></span></span></span></span></span></span></span> etc.</p>

<a name="168000084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/168000084" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#168000084">Reid Barton (Jun 12 2019 at 23:57)</a>:</h4>
<p>but it's more common to see a definition of the sort that I gave originally</p>

<a name="168000099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/168000099" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#168000099">Mario Carneiro (Jun 12 2019 at 23:57)</a>:</h4>
<p>the major downside of my approach is that <code>env</code> isn't any reasonable kind of algebraic class</p>

<a name="168000189"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/168000189" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#168000189">Mario Carneiro (Jun 12 2019 at 23:59)</a>:</h4>
<p>I have long been of the opinion that doing anything nontrivial with expressions in a type dependency is possible but inadvisable in DTT</p>

<a name="168003454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/168003454" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#168003454">Kenny Lau (Jun 13 2019 at 01:02)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> now I understand why you want <code>i+1-1 = i = i-1+1</code> to be defeq</p>

<a name="168011156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/168011156" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#168011156">Johan Commelin (Jun 13 2019 at 03:49)</a>:</h4>
<p>Just wait till we seriously start doing complexes and long exact sequences etc...</p>

<a name="168029953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/168029953" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#168029953">Kevin Buzzard (Jun 13 2019 at 09:49)</a>:</h4>
<blockquote>
<p>I have long been of the opinion that doing anything nontrivial with expressions in a type dependency is possible but inadvisable in DTT</p>
</blockquote>
<p>Yeah but the thing is that we're going to make all of mathematics in DTT so we'd better come up with some coherent way of approaching these issues.</p>

<a name="168030490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/168030490" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#168030490">Kevin Buzzard (Jun 13 2019 at 09:57)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">structure</span> <span class="n">cdga</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="c1">-- universe polymorphism FTW</span>
</pre></div>


<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> I thought it was bad to randomly mention extra universes in a structure, when they couldn't be inferred from the input.</p>

<a name="168050522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/168050522" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#168050522">Kenny Lau (Jun 13 2019 at 14:32)</a>:</h4>
<p>talk to the category theorists</p>

<a name="168056553"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/168056553" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#168056553">Mario Carneiro (Jun 13 2019 at 15:36)</a>:</h4>
<p>I wasn't touching that aspect. More likely <code>A</code> and stuff would be a parameter, but I don't know all that goes into the math surrounding this</p>

<a name="168063824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/CDGAs/near/168063824" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/23907CDGAs.html#168063824">Reid Barton (Jun 13 2019 at 17:00)</a>:</h4>
<p>From a math perspective it doesn't make much sense to have just the underlying types <code>A</code> a parameter, but then the same is true about unbundled rings and so on</p>


{% endraw %}
