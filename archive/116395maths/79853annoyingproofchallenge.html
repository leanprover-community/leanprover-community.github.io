---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/116395maths/79853annoyingproofchallenge.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/116395maths/index.html">maths</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/116395maths/79853annoyingproofchallenge.html">annoying proof challenge</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="150698181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/annoying%20proof%20challenge/near/150698181" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/79853annoyingproofchallenge.html#150698181">Chris Hughes (Dec 01 2018 at 21:49)</a>:</h4>
<p>Is there a nice way to prove this?</p>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">with_bot</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">0</span>
</pre></div>

<a name="150698441"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/annoying%20proof%20challenge/near/150698441" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/79853annoyingproofchallenge.html#150698441">Kenny Lau (Dec 01 2018 at 21:58)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">ordered_group</span> <span class="n">data</span><span class="bp">.</span><span class="n">nat</span><span class="bp">.</span><span class="n">basic</span>

<span class="kn">example</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">with_bot</span> <span class="bp">ℕ</span><span class="o">},</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">some</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">some</span> <span class="mi">0</span><span class="o">)</span> <span class="n">H</span> <span class="o">:=</span> <span class="n">or</span><span class="bp">.</span><span class="n">inr</span> <span class="n">rfl</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">some</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">some</span> <span class="o">(</span><span class="n">b</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="n">H</span> <span class="o">:=</span> <span class="n">or</span><span class="bp">.</span><span class="n">inl</span> <span class="err">$</span> <span class="o">(</span><span class="n">add_eq_zero_iff</span><span class="bp">.</span><span class="mi">1</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">succ_inj</span> <span class="err">$</span> <span class="n">option</span><span class="bp">.</span><span class="n">some</span><span class="bp">.</span><span class="n">inj</span> <span class="n">H</span><span class="o">))</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="n">symm</span> <span class="bp">▸</span>
</pre></div>

<a name="150698444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/annoying%20proof%20challenge/near/150698444" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/79853annoyingproofchallenge.html#150698444">Kenny Lau (Dec 01 2018 at 21:58)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span></p>

<a name="150698524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/annoying%20proof%20challenge/near/150698524" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/79853annoyingproofchallenge.html#150698524">Kevin Buzzard (Dec 01 2018 at 22:01)</a>:</h4>
<p>Didn't your mother tell you never to end a sentence with a <code>▸</code>?</p>

<a name="150698586"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/annoying%20proof%20challenge/near/150698586" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/79853annoyingproofchallenge.html#150698586">Chris Hughes (Dec 01 2018 at 22:03)</a>:</h4>
<p>Maybe it's some super duper eta reduction.</p>

<a name="150698638"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/annoying%20proof%20challenge/near/150698638" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/79853annoyingproofchallenge.html#150698638">Kenny Lau (Dec 01 2018 at 22:04)</a>:</h4>
<p>oops it's supposed to end in <code>rfl</code></p>

<a name="150698639"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/annoying%20proof%20challenge/near/150698639" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/79853annoyingproofchallenge.html#150698639">Kenny Lau (Dec 01 2018 at 22:04)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">ordered_group</span> <span class="n">data</span><span class="bp">.</span><span class="n">nat</span><span class="bp">.</span><span class="n">basic</span>

<span class="kn">example</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">with_bot</span> <span class="bp">ℕ</span><span class="o">},</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">some</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">some</span> <span class="mi">0</span><span class="o">)</span> <span class="n">H</span> <span class="o">:=</span> <span class="n">or</span><span class="bp">.</span><span class="n">inr</span> <span class="n">rfl</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">some</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">some</span> <span class="o">(</span><span class="n">b</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="n">H</span> <span class="o">:=</span> <span class="n">or</span><span class="bp">.</span><span class="n">inl</span> <span class="err">$</span> <span class="o">(</span><span class="n">add_eq_zero_iff</span><span class="bp">.</span><span class="mi">1</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">succ_inj</span> <span class="err">$</span> <span class="n">option</span><span class="bp">.</span><span class="n">some</span><span class="bp">.</span><span class="n">inj</span> <span class="n">H</span><span class="o">))</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="n">symm</span> <span class="bp">▸</span> <span class="n">rfl</span>
</pre></div>

<a name="150698647"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/annoying%20proof%20challenge/near/150698647" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/79853annoyingproofchallenge.html#150698647">Kevin Buzzard (Dec 01 2018 at 22:05)</a>:</h4>
<p>oh that works better :-)</p>

<a name="150698701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/annoying%20proof%20challenge/near/150698701" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/79853annoyingproofchallenge.html#150698701">Kevin Buzzard (Dec 01 2018 at 22:06)</a>:</h4>
<p>What does the equation compiler actually <em>do</em> to decide that it can ignore the <code>none</code> cases? I mean, what does it try?</p>

<a name="150698712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/annoying%20proof%20challenge/near/150698712" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/79853annoyingproofchallenge.html#150698712">Kenny Lau (Dec 01 2018 at 22:07)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">ordered_group</span> <span class="n">data</span><span class="bp">.</span><span class="n">nat</span><span class="bp">.</span><span class="n">basic</span>

<span class="kn">theorem</span> <span class="n">test</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">with_bot</span> <span class="bp">ℕ</span><span class="o">},</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">some</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">some</span> <span class="mi">0</span><span class="o">)</span> <span class="n">H</span> <span class="o">:=</span> <span class="n">or</span><span class="bp">.</span><span class="n">inr</span> <span class="n">rfl</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">some</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">some</span> <span class="o">(</span><span class="n">b</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="n">H</span> <span class="o">:=</span> <span class="n">or</span><span class="bp">.</span><span class="n">inl</span> <span class="err">$</span> <span class="o">(</span><span class="n">add_eq_zero_iff</span><span class="bp">.</span><span class="mi">1</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">succ_inj</span> <span class="err">$</span> <span class="n">option</span><span class="bp">.</span><span class="n">some</span><span class="bp">.</span><span class="n">inj</span> <span class="n">H</span><span class="o">))</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="n">symm</span> <span class="bp">▸</span> <span class="n">rfl</span>

<span class="bp">#</span><span class="kn">print</span> <span class="n">test</span>
<span class="c">/-</span><span class="cm"></span>
<span class="cm">theorem test : ∀ {a b : with_bot ℕ}, a + b = 1 → a = 0 ∨ b = 0 :=</span>
<span class="cm">λ {a b : with_bot ℕ} (a_1 : a + b = 1),</span>
<span class="cm">  option.cases_on a</span>
<span class="cm">    (λ (a : none + b = 1),</span>
<span class="cm">       option.cases_on b</span>
<span class="cm">         (λ (a : none + none = 1),</span>
<span class="cm">            eq.dcases_on a (λ (a_1 : some 1 = none), option.no_confusion a_1) (eq.refl 1) (heq.refl a))</span>
<span class="cm">         (λ (b : ℕ) (a : none + some b = 1),</span>
<span class="cm">            eq.dcases_on a (λ (a_1 : some 1 = none), option.no_confusion a_1) (eq.refl 1) (heq.refl a))</span>
<span class="cm">         a)</span>
<span class="cm">    (λ (a : ℕ) (a_1 : some a + b = 1),</span>
<span class="cm">       option.cases_on b</span>
<span class="cm">         (λ (a_1 : some a + none = 1),</span>
<span class="cm">            eq.dcases_on a_1 (λ (a_2 : some 1 = none), option.no_confusion a_2) (eq.refl 1) (heq.refl a_1))</span>
<span class="cm">         (λ (b : ℕ) (a_1 : some a + some b = 1),</span>
<span class="cm">            nat.cases_on b (λ (a_1 : some a + some 0 = 1), id_rhs (some a = 0 ∨ some 0 = 0) (or.inr rfl))</span>
<span class="cm">              (λ (b : ℕ) (a_1 : some a + some (nat.succ b) = 1),</span>
<span class="cm">                 id_rhs (some a = 0 ∨ some (b + 1) = 0)</span>
<span class="cm">                   (or.inl (eq.symm ((add_eq_zero_iff.mp (nat.succ_inj (option.some.inj a_1))).left) ▸ rfl)))</span>
<span class="cm">              a_1)</span>
<span class="cm">         a_1)</span>
<span class="cm">    a_1</span>
<span class="cm">-/</span>
</pre></div>

<a name="150698713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/annoying%20proof%20challenge/near/150698713" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/79853annoyingproofchallenge.html#150698713">Kenny Lau (Dec 01 2018 at 22:07)</a>:</h4>
<p>it does <code>option.no_confusion</code></p>

<a name="150698763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/annoying%20proof%20challenge/near/150698763" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/79853annoyingproofchallenge.html#150698763">Kevin Buzzard (Dec 01 2018 at 22:09)</a>:</h4>
<p><code>option.no_confusion</code> is such a great name for a function. I might get it on a t-shirt.</p>


{% endraw %}

{% include archive_update.html %}