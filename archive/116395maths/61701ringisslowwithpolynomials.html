---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/116395maths/61701ringisslowwithpolynomials.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/116395maths/index.html">maths</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html">ring is slow with polynomials</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="192978896"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/192978896" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#192978896">Kevin Buzzard (Apr 05 2020 at 21:22)</a>:</h4>
<p>Is this just a fact of life for some reason:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">polynomial</span>

<span class="kn">set_option</span> <span class="n">profiler</span> <span class="n">true</span>

<span class="kn">open</span> <span class="n">polynomial</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="err">^</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">x</span><span class="err">^</span><span class="mi">4</span> <span class="bp">+</span> <span class="n">x</span><span class="err">^</span><span class="mi">6</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span><span class="bp">+</span><span class="n">x</span><span class="bp">+</span><span class="n">x</span><span class="err">^</span><span class="mi">2</span><span class="bp">+</span><span class="n">x</span><span class="err">^</span><span class="mi">3</span><span class="bp">+</span><span class="n">x</span><span class="err">^</span><span class="mi">4</span><span class="bp">+</span><span class="n">x</span><span class="err">^</span><span class="mi">5</span><span class="bp">+</span><span class="n">x</span><span class="err">^</span><span class="mi">6</span><span class="bp">+</span><span class="n">x</span><span class="err">^</span><span class="mi">7</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">ring</span> <span class="c1">-- 5 seconds</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">:</span>
  <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">X</span><span class="err">^</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">X</span><span class="err">^</span><span class="mi">4</span> <span class="bp">+</span> <span class="n">X</span><span class="err">^</span><span class="mi">6</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">X</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span><span class="bp">+</span><span class="n">X</span><span class="bp">+</span><span class="n">X</span><span class="err">^</span><span class="mi">2</span><span class="bp">+</span><span class="n">X</span><span class="err">^</span><span class="mi">3</span><span class="bp">+</span><span class="n">X</span><span class="err">^</span><span class="mi">4</span><span class="bp">+</span><span class="n">X</span><span class="err">^</span><span class="mi">5</span><span class="bp">+</span><span class="n">X</span><span class="err">^</span><span class="mi">6</span><span class="bp">+</span><span class="n">X</span><span class="err">^</span><span class="mi">7</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">ring</span> <span class="c1">-- 18 seconds</span>
</pre></div>

<a name="192979198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/192979198" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#192979198">Mario Carneiro (Apr 05 2020 at 21:30)</a>:</h4>
<p>I suspect that the majority of the time is coming from the few times I "save some time" by calling lean builtins instead of hand rolling exprs using the constructor</p>

<a name="192979238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/192979238" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#192979238">Kevin Buzzard (Apr 05 2020 at 21:31)</a>:</h4>
<p>My workaround is to prove the top one and deduce the bottom one with a rw.</p>

<a name="192979304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/192979304" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#192979304">Mario Carneiro (Apr 05 2020 at 21:33)</a>:</h4>
<div class="codehilite"><pre><span></span> 8612ms    37.1%   tactic.mk_mapp
...
 3405ms    14.7%   tactic.mk_app
...
    5ms     0.0%   expr.app
    3ms     0.0%   tactic.ring.cache.cs_app
</pre></div>


<p>the ones on the top are the lean builtins, the ones on the bottom are the hand rolled ones</p>

<a name="192979322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/192979322" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#192979322">Mario Carneiro (Apr 05 2020 at 21:33)</a>:</h4>
<p>there is something seriously wrong with the lean internals here</p>

<a name="192979367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/192979367" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#192979367">Mario Carneiro (Apr 05 2020 at 21:34)</a>:</h4>
<p>it's almost certainly calling typeclass inference, and that's responsible for the time spent, but I don't understand why the typeclass cache isn't working</p>

<a name="192979432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/192979432" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#192979432">Mario Carneiro (Apr 05 2020 at 21:36)</a>:</h4>
<p>Actually, it might not be a bad idea to do something like that inside ring, that is, generalize the type of the expression before starting the proof proper</p>

<a name="192979443"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/192979443" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#192979443">Mario Carneiro (Apr 05 2020 at 21:36)</a>:</h4>
<p>that way those monstrous typeclass arguments are not copied everywhere, but rather are passed in via a <code>have</code></p>

<a name="192979872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/192979872" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#192979872">orlando (Apr 05 2020 at 21:47)</a>:</h4>
<p>Hey  Kevin,  with my computer it's faster with the polynomial ? It's normal ?  15 for the first and 11 for the second <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span></p>

<a name="192980805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/192980805" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#192980805">Ryan Lahfa (Apr 05 2020 at 22:09)</a>:</h4>
<p>FWIW, on a Intel(R) Core(TM) i7-8550U CPU @ 1.80GHz, got 7 seconds for the first and 28 seconds for the second.</p>
<p>Profile for the 2nd one:</p>
<div class="codehilite"><pre><span></span>elaboration: tactic execution took 28.9s
num. allocated objects:  7769
num. allocated closures: 10240
28887ms   100.0%   _interaction._lambda_2
28887ms   100.0%   scope_trace
28887ms   100.0%   tactic.interactive.ring1._lambda_3
28887ms   100.0%   tactic.interactive.ring1
28887ms   100.0%   tactic.step
28887ms   100.0%   tactic.istep
28887ms   100.0%   tactic.interactive.ring
28887ms   100.0%   _interaction
28887ms   100.0%   interaction_monad_orelse
28887ms   100.0%   tactic.istep._lambda_1
28887ms   100.0%   tactic.interactive.ring._lambda_1
28886ms   100.0%   tactic.ring.ring_m.run
28886ms   100.0%   interaction_monad.monad._lambda_9
28872ms    99.9%   tactic.ring.lift
13373ms    46.3%   tactic.norm_num
10911ms    37.8%   tactic.mk_mapp
 9164ms    31.7%   tactic.ring.eval_add._main._lambda_2
 7687ms    26.6%   tactic.ring.eval_pow._main._lambda_2
 7154ms    24.8%   norm_num.eval_pow
 5977ms    20.7%   norm_num.derive
 5977ms    20.7%   tactic.ext_simplify_core
 5861ms    20.3%   norm_num.derive._main._lambda_3
 4157ms    14.4%   tactic.mk_app
 1846ms     6.4%   expr.of_nat._lambda_1
</pre></div>


<p>Profile for the 1st:</p>
<div class="codehilite"><pre><span></span>elaboration: tactic execution took 7.45s
num. allocated objects:  7771
num. allocated closures: 10240
 7445ms   100.0%   interaction_monad_orelse
 7445ms   100.0%   tactic.interactive.ring._lambda_1
 7445ms   100.0%   tactic.istep._lambda_1
 7445ms   100.0%   _interaction
 7445ms   100.0%   tactic.interactive.ring
 7445ms   100.0%   tactic.istep
 7445ms   100.0%   _interaction._lambda_2
 7445ms   100.0%   tactic.step
 7445ms   100.0%   scope_trace
 7445ms   100.0%   tactic.interactive.ring1
 7445ms   100.0%   tactic.interactive.ring1._lambda_3
 7444ms   100.0%   interaction_monad.monad._lambda_9
 7444ms   100.0%   tactic.ring.ring_m.run
 7434ms    99.9%   tactic.ring.lift
 3567ms    47.9%   tactic.norm_num
 2348ms    31.5%   tactic.ring.eval_add._main._lambda_2
 2147ms    28.8%   tactic.ring.eval_pow._main._lambda_2
 2120ms    28.5%   tactic.mk_mapp
 2050ms    27.5%   norm_num.eval_pow
 1698ms    22.8%   tactic.ext_simplify_core
 1698ms    22.8%   norm_num.derive
 1593ms    21.4%   norm_num.derive._main._lambda_3
 1440ms    19.3%   tactic.mk_app
</pre></div>

<a name="193006130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193006130" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193006130">Anne Baanen (Apr 06 2020 at 07:55)</a>:</h4>
<p><a href="#narrow/stream/116395-maths/topic/.60by.20ring.60.20is.20slow" title="#narrow/stream/116395-maths/topic/.60by.20ring.60.20is.20slow">I don't want to sound too repetitive,</a>, but you should use <code>ring_exp</code> here too <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>

<a name="193006743"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193006743" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193006743">Anne Baanen (Apr 06 2020 at 08:01)</a>:</h4>
<p>I get approximately the same times as Kevin for <code>ring</code>, but 150ms and 500ms for <code>ring_exp</code>. I'm actually surprised that the difference is so large</p>

<a name="193007925"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193007925" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193007925">Kevin Buzzard (Apr 06 2020 at 08:11)</a>:</h4>
<p>Being repetitive is very helpful for me -- I have to hear something several times before it sinks in. Does <code>ring_exp</code> not use <code>ring</code> then??</p>

<a name="193008302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193008302" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193008302">Kevin Buzzard (Apr 06 2020 at 08:15)</a>:</h4>
<p><span class="user-mention" data-user-id="238446">@Anne Baanen</span> you just shaved 10 seconds off a Codewars Kata I'm working on, which might move it from "too slow to work on the site" to "killer question" :-)</p>

<a name="193008811"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193008811" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193008811">Anne Baanen (Apr 06 2020 at 08:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/116395-maths/topic/ring.20is.20slow.20with.20polynomials/near/193007925" title="#narrow/stream/116395-maths/topic/ring.20is.20slow.20with.20polynomials/near/193007925">said</a>:</p>
<blockquote>
<p>Being repetitive is very helpful for me -- I have to hear something several times before it sinks in. Does <code>ring_exp</code> not use <code>ring</code> then??</p>
</blockquote>
<p>It doesn't! Basically <code>ring</code> only knows how to represent <code>+</code> and <code>*</code>, but can do so efficiently (using the Horner form), and <code>ring_exp</code> trades in the efficiency on simpler problems to also deal with <code>^</code></p>

<a name="193009545"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193009545" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193009545">Yury G. Kudryashov (Apr 06 2020 at 08:28)</a>:</h4>
<p>I like "trades in the efficiency" together with "runs much faster".</p>

<a name="193009957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193009957" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193009957">Sebastien Gouezel (Apr 06 2020 at 08:31)</a>:</h4>
<p>If in practice <code>ring_exp</code> is most often faster on reasonable problems, shouldn't we rename <code>ring</code> to <code>ring_horner</code> and <code>ring_exp</code> to <code>ring</code>? <span class="user-mention" data-user-id="110049">@Mario Carneiro</span></p>

<a name="193009959"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193009959" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193009959">Patrick Massot (Apr 06 2020 at 08:31)</a>:</h4>
<p>Reading assignment for student Kevin: <a href="https://lean-forward.github.io/ring_exp/paper.pdf" title="https://lean-forward.github.io/ring_exp/paper.pdf">https://lean-forward.github.io/ring_exp/paper.pdf</a></p>

<a name="193010269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193010269" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193010269">Kevin Buzzard (Apr 06 2020 at 08:34)</a>:</h4>
<p>This looks like some implementation issue to me</p>

<a name="193010281"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193010281" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193010281">Kevin Buzzard (Apr 06 2020 at 08:34)</a>:</h4>
<p>ring = ring_exp, right? By ext.</p>

<a name="193010537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193010537" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193010537">Kevin Buzzard (Apr 06 2020 at 08:37)</a>:</h4>
<p>So should Grégoire-Mahboubi be called "proving equalities in a comm ring done wrong in coq"? :P (sorry Assia, I love your paper!)</p>

<a name="193011403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193011403" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193011403">Johan Commelin (Apr 06 2020 at 08:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/116395-maths/topic/ring.20is.20slow.20with.20polynomials/near/193010281" title="#narrow/stream/116395-maths/topic/ring.20is.20slow.20with.20polynomials/near/193010281">said</a>:</p>
<blockquote>
<p>ring = ring_exp, right? By ext.</p>
</blockquote>
<p>No, I don't think so. <code>ring</code> can't deal with <code>(a + b)^2</code>, whereas <code>ring_exp</code> can.</p>

<a name="193012303"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193012303" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193012303">Anne Baanen (Apr 06 2020 at 08:52)</a>:</h4>
<p>I wouldn't say that <code>ring_exp</code> is always faster in practice: <code>linarith</code> uses <code>ring</code> internally, and linear expressions are exactly the simpler kind that <code>ring</code> is better at. The Horner form is optimal in theory (if you use the correct definition of "optimal")</p>

<a name="193012327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193012327" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193012327">Rob Lewis (Apr 06 2020 at 08:53)</a>:</h4>
<p>IIRC, there are some situations where <code>ring</code> is faster than <code>ring_exp</code>. Anne and I did some investigation when they were working on <code>ring_exp</code> and there was a performance regression when we just replaced <code>ring</code> entirely.</p>
<p>(Yep, what Anne said!)</p>

<a name="193012448"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193012448" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193012448">Rob Lewis (Apr 06 2020 at 08:54)</a>:</h4>
<p>Of course implementation details in both can shift the performance either way for specific problems.</p>

<a name="193012524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193012524" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193012524">Rob Lewis (Apr 06 2020 at 08:54)</a>:</h4>
<p>It's probably possible to backport some of the <code>ring_exp</code> optimizations to <code>ring</code>.</p>

<a name="193012530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193012530" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193012530">Anne Baanen (Apr 06 2020 at 08:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/116395-maths/topic/ring.20is.20slow.20with.20polynomials/near/193011403" title="#narrow/stream/116395-maths/topic/ring.20is.20slow.20with.20polynomials/near/193011403">said</a>:</p>
<blockquote>
<p><code>ring</code> can't deal with <code>(a + b)^2</code>, whereas <code>ring_exp</code> can.</p>
</blockquote>
<p>It can deal with that specific case, because it first rewrites <code>(a + b)^2</code> to <code>(a + b)*(a + b)</code>. You can replace the <code>2</code> with <code>n : ℕ</code> to get a real counterexample</p>

<a name="193012666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193012666" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193012666">Rob Lewis (Apr 06 2020 at 08:56)</a>:</h4>
<p>But what I'm hearing from all these questions about <code>ring</code> and polynomials is that there are still type class issues with polynomials. The inefficiency in <code>ring</code> is probably that it's repeating unnecessary searches, but these searches are slow, and that's the root issue.</p>

<a name="193012910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193012910" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193012910">Kevin Buzzard (Apr 06 2020 at 08:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/116395-maths/topic/ring.20is.20slow.20with.20polynomials/near/193009959" title="#narrow/stream/116395-maths/topic/ring.20is.20slow.20with.20polynomials/near/193009959">said</a>:</p>
<blockquote>
<p>Reading assignment for student Kevin: <a href="https://lean-forward.github.io/ring_exp/paper.pdf" title="https://lean-forward.github.io/ring_exp/paper.pdf">https://lean-forward.github.io/ring_exp/paper.pdf</a></p>
</blockquote>
<p><span class="user-mention" data-user-id="238446">@Anne Baanen</span> typo in table of p3: "<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mrow><mi>b</mi><mo>+</mo><mi>c</mi></mrow></msup><mo>=</mo><msup><mi>a</mi><mi>b</mi></msup><mo>+</mo><msup><mi>a</mi><mi>c</mi></msup></mrow><annotation encoding="application/x-tex">a^{b+c}=a^b+a^c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">c</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.932438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span></span></span></span></span></span></span>"</p>

<a name="193013273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193013273" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193013273">Kevin Buzzard (Apr 06 2020 at 09:01)</a>:</h4>
<p>section 4 you seem to say "we tried random identities and <code>ring_exp</code> was slower" -- but I'm trying identities that come up in practice and <code>ring_exp</code> is a lot quicker :-)</p>

<a name="193013633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193013633" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193013633">Anne Baanen (Apr 06 2020 at 09:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/116395-maths/topic/ring.20is.20slow.20with.20polynomials/near/193012910" title="#narrow/stream/116395-maths/topic/ring.20is.20slow.20with.20polynomials/near/193012910">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="238446">Anne Baanen</span> typo in table of p3: "<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mrow><mi>b</mi><mo>+</mo><mi>c</mi></mrow></msup><mo>=</mo><msup><mi>a</mi><mi>b</mi></msup><mo>+</mo><msup><mi>a</mi><mi>c</mi></msup></mrow><annotation encoding="application/x-tex">a^{b+c}=a^b+a^c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">c</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.932438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span></span></span></span></span></span></span>"</p>
</blockquote>
<p>Well spotted! I already fixed it in the updated version of the paper, which should be available soon.</p>

<a name="193014179"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193014179" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193014179">Anne Baanen (Apr 06 2020 at 09:11)</a>:</h4>
<p>Indeed, it's not the most informative comparison, but it's objective and can be explained in a few sentences when there is a 5 page limit, so I think I will have to live with it appearing a bit slower <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>

<a name="193025367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193025367" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193025367">Mario Carneiro (Apr 06 2020 at 11:04)</a>:</h4>
<p>To repeat: the reason <code>ring</code> is slow here has little to do with <code>ring</code>, it has to do with the lean functions that <code>ring</code> calls that are slow when they should not be. Yes, it is possible to make <code>ring</code> faster by avoiding these functions, but this essentially means that you aren't allowed to use the elaborator at all, you have to build a fully formed expr by hand if you want to get performance and that's ridiculous. I'll do it, ring is already 99% implemented like this and the remaning 1% of lean is causing the problem, but this really should be fixed at a lower level</p>

<a name="193027885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193027885" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193027885">Jasmin Blanchette (Apr 06 2020 at 11:30)</a>:</h4>
<p>But Anne, you will have 6 pages for the final version, right? Maybe you can also show some examples from this thread.</p>

<a name="193027961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193027961" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193027961">Kevin Buzzard (Apr 06 2020 at 11:31)</a>:</h4>
<p>and <a href="#narrow/stream/116395-maths/topic/.60by.20ring.60.20is.20slow" title="#narrow/stream/116395-maths/topic/.60by.20ring.60.20is.20slow">this thread</a></p>

<a name="193029286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193029286" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193029286">Anne Baanen (Apr 06 2020 at 11:45)</a>:</h4>
<p>Yeah, I want to add a few more positive examples. But space is still pretty tight, since there are some places that the reviewers pointed out that they want more explanation. And also Mario's objection that the same optimizations can be applied to <code>ring</code>.</p>

<a name="193049392"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193049392" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193049392">Mario Carneiro (Apr 06 2020 at 14:26)</a>:</h4>
<p>Okay, I did a bunch of optimization (which is to say, <code>mk_app</code> considered harmful) and managed to get it down to 11 s. There are a lot of places that implicitly assume that calling <code>mk_app</code> is not that bad, so it's not easy going and the result looks horrible, but that's what you get for trying to circumvent lean internals. I don't think this is likely to get much better until I rewrite <code>tactic.norm_num</code>.</p>
<div class="codehilite"><pre><span></span><span class="n">elaboration</span><span class="o">:</span> <span class="n">tactic</span> <span class="n">compilation</span> <span class="n">took</span> <span class="mi">5</span><span class="bp">.</span><span class="mi">97</span><span class="n">ms</span>
<span class="n">elaboration</span><span class="o">:</span> <span class="n">tactic</span> <span class="n">compilation</span> <span class="n">took</span> <span class="mi">4</span><span class="bp">.</span><span class="mi">2</span><span class="n">ms</span>
<span class="n">elaboration</span><span class="o">:</span> <span class="n">tactic</span> <span class="n">execution</span> <span class="n">took</span> <span class="mi">3</span><span class="bp">.</span><span class="mi">59</span><span class="n">s</span>
<span class="n">num</span><span class="bp">.</span> <span class="n">allocated</span> <span class="n">objects</span><span class="o">:</span>  <span class="mi">7909</span>
<span class="n">num</span><span class="bp">.</span> <span class="n">allocated</span> <span class="n">closures</span><span class="o">:</span> <span class="mi">11047</span>
 <span class="mi">3594</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">interactive</span><span class="bp">.</span><span class="n">ring1</span>
 <span class="mi">3594</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">scope_trace</span>
 <span class="mi">3594</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">interactive</span><span class="bp">.</span><span class="n">ring1</span><span class="bp">._</span><span class="n">lambda_3</span>
 <span class="mi">3594</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">step</span>
 <span class="mi">3594</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="bp">_</span><span class="n">interaction</span><span class="bp">._</span><span class="n">lambda_2</span>
 <span class="mi">3594</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">istep</span>
 <span class="mi">3594</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">interactive</span><span class="bp">.</span><span class="n">ring</span>
 <span class="mi">3594</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="bp">_</span><span class="n">interaction</span>
 <span class="mi">3594</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">interaction_monad_orelse</span>
 <span class="mi">3594</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">istep</span><span class="bp">._</span><span class="n">lambda_1</span>
 <span class="mi">3594</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">interactive</span><span class="bp">.</span><span class="n">ring</span><span class="bp">._</span><span class="n">lambda_1</span>
 <span class="mi">3593</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">ring_m</span><span class="bp">.</span><span class="n">run</span>
 <span class="mi">3590</span><span class="n">ms</span>    <span class="mi">99</span><span class="bp">.</span><span class="mi">9</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">ring_m</span><span class="bp">.</span><span class="n">run</span><span class="bp">._</span><span class="n">lambda_1</span>
 <span class="mi">3590</span><span class="n">ms</span>    <span class="mi">99</span><span class="bp">.</span><span class="mi">9</span><span class="err">%</span>   <span class="n">interaction_monad</span><span class="bp">.</span><span class="n">monad</span><span class="bp">._</span><span class="n">lambda_9</span>
 <span class="mi">3590</span><span class="n">ms</span>    <span class="mi">99</span><span class="bp">.</span><span class="mi">9</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">using_new_ref</span>
 <span class="mi">2770</span><span class="n">ms</span>    <span class="mi">77</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">norm_num</span>
 <span class="mi">1559</span><span class="n">ms</span>    <span class="mi">43</span><span class="bp">.</span><span class="mi">4</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_add</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_2</span>
 <span class="mi">1519</span><span class="n">ms</span>    <span class="mi">42</span><span class="bp">.</span><span class="mi">3</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_pow</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_2</span>
 <span class="mi">1517</span><span class="n">ms</span>    <span class="mi">42</span><span class="bp">.</span><span class="mi">2</span><span class="err">%</span>   <span class="n">norm_num</span><span class="bp">.</span><span class="n">eval_pow</span>
 <span class="mi">1240</span><span class="n">ms</span>    <span class="mi">34</span><span class="bp">.</span><span class="mi">5</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ext_simplify_core</span>
 <span class="mi">1240</span><span class="n">ms</span>    <span class="mi">34</span><span class="bp">.</span><span class="mi">5</span><span class="err">%</span>   <span class="n">norm_num</span><span class="bp">.</span><span class="n">derive</span>
 <span class="mi">1166</span><span class="n">ms</span>    <span class="mi">32</span><span class="bp">.</span><span class="mi">4</span><span class="err">%</span>   <span class="n">norm_num</span><span class="bp">.</span><span class="n">derive</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_3</span>
  <span class="mi">603</span><span class="n">ms</span>    <span class="mi">16</span><span class="bp">.</span><span class="mi">8</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">mk_app</span>
  <span class="mi">202</span><span class="n">ms</span>     <span class="mi">5</span><span class="bp">.</span><span class="mi">6</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_add</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_21</span>
  <span class="mi">141</span><span class="n">ms</span>     <span class="mi">3</span><span class="bp">.</span><span class="mi">9</span><span class="err">%</span>   <span class="n">expr</span><span class="bp">.</span><span class="n">of_nat</span><span class="bp">._</span><span class="n">lambda_1</span>
  <span class="mi">107</span><span class="n">ms</span>     <span class="mi">3</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_add</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_20</span>
   <span class="mi">85</span><span class="n">ms</span>     <span class="mi">2</span><span class="bp">.</span><span class="mi">4</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">mk_mapp</span>
   <span class="mi">78</span><span class="n">ms</span>     <span class="mi">2</span><span class="bp">.</span><span class="mi">2</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_pow</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_19</span>
   <span class="mi">42</span><span class="n">ms</span>     <span class="mi">1</span><span class="bp">.</span><span class="mi">2</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_mul</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_2</span>
   <span class="mi">28</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">8</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_atom</span><span class="bp">._</span><span class="n">lambda_2</span>
   <span class="mi">18</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">5</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_add</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_14</span>
   <span class="mi">16</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">4</span><span class="err">%</span>   <span class="n">state_t</span><span class="bp">.</span><span class="n">monad</span><span class="bp">._</span><span class="n">lambda_19</span>
   <span class="mi">15</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">4</span><span class="err">%</span>   <span class="n">reader_t</span><span class="bp">.</span><span class="n">monad</span><span class="bp">._</span><span class="n">lambda_19</span>
   <span class="mi">15</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">4</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="kn">eval</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_42</span>
   <span class="mi">12</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">3</span><span class="err">%</span>   <span class="n">char</span><span class="bp">.</span><span class="n">of_nat</span>
    <span class="mi">7</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">2</span><span class="err">%</span>   <span class="n">interaction_monad</span><span class="bp">.</span><span class="n">failed</span>
    <span class="mi">6</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">2</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">failed</span>
    <span class="mi">6</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">2</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_add</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_13</span>
    <span class="mi">4</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">norm_num</span><span class="bp">.</span><span class="n">derive</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_2</span>
    <span class="mi">4</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_add</span>
    <span class="mi">3</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">horner_expr</span><span class="bp">.</span><span class="n">xadd&#39;</span>
    <span class="mi">3</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_add</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_23</span>
    <span class="mi">3</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">mk_instance</span>
    <span class="mi">3</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">expr</span><span class="bp">.</span><span class="n">app</span>
    <span class="mi">2</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">ring_m</span><span class="bp">.</span><span class="n">mk_app</span><span class="bp">._</span><span class="n">lambda_2</span>
    <span class="mi">2</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_add</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_22</span>
    <span class="mi">2</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">and</span><span class="bp">.</span><span class="n">decidable</span>
    <span class="mi">2</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="kn">eval</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_43</span>
    <span class="mi">2</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_add</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_4</span>
    <span class="mi">2</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">norm_num</span><span class="bp">.</span><span class="n">eval_div_ext</span>
    <span class="mi">2</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">expr</span><span class="bp">.</span><span class="n">mk_app</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_atom</span><span class="bp">._</span><span class="n">lambda_3</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_add</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_6</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">interaction_monad</span><span class="bp">.</span><span class="n">fail</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="kn">eval</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_add</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_15</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">state_t</span><span class="bp">.</span><span class="n">monad</span><span class="bp">._</span><span class="n">lambda_20</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">string</span><span class="bp">.</span><span class="n">empty</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">expr</span><span class="bp">.</span><span class="n">to_pos_nat</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">exact</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">or</span><span class="bp">.</span><span class="n">decidable</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="kn">eval</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_29</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">expr</span><span class="bp">.</span><span class="n">to_nat</span>
<span class="n">elaboration</span><span class="o">:</span> <span class="n">tactic</span> <span class="n">execution</span> <span class="n">took</span> <span class="mi">11</span><span class="bp">.</span><span class="mi">5</span><span class="n">s</span>
<span class="n">num</span><span class="bp">.</span> <span class="n">allocated</span> <span class="n">objects</span><span class="o">:</span>  <span class="mi">7909</span>
<span class="n">num</span><span class="bp">.</span> <span class="n">allocated</span> <span class="n">closures</span><span class="o">:</span> <span class="mi">11047</span>
<span class="mi">11461</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">interactive</span><span class="bp">.</span><span class="n">ring</span><span class="bp">._</span><span class="n">lambda_1</span>
<span class="mi">11461</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">istep</span><span class="bp">._</span><span class="n">lambda_1</span>
<span class="mi">11461</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">interaction_monad_orelse</span>
<span class="mi">11461</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="bp">_</span><span class="n">interaction</span>
<span class="mi">11461</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">interactive</span><span class="bp">.</span><span class="n">ring</span>
<span class="mi">11461</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">istep</span>
<span class="mi">11461</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="bp">_</span><span class="n">interaction</span><span class="bp">._</span><span class="n">lambda_2</span>
<span class="mi">11461</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">step</span>
<span class="mi">11461</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">interactive</span><span class="bp">.</span><span class="n">ring1</span>
<span class="mi">11461</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">scope_trace</span>
<span class="mi">11461</span><span class="n">ms</span>   <span class="mi">100</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">interactive</span><span class="bp">.</span><span class="n">ring1</span><span class="bp">._</span><span class="n">lambda_3</span>
<span class="mi">11453</span><span class="n">ms</span>    <span class="mi">99</span><span class="bp">.</span><span class="mi">9</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">ring_m</span><span class="bp">.</span><span class="n">run</span><span class="bp">._</span><span class="n">lambda_1</span>
<span class="mi">11453</span><span class="n">ms</span>    <span class="mi">99</span><span class="bp">.</span><span class="mi">9</span><span class="err">%</span>   <span class="n">interaction_monad</span><span class="bp">.</span><span class="n">monad</span><span class="bp">._</span><span class="n">lambda_9</span>
<span class="mi">11453</span><span class="n">ms</span>    <span class="mi">99</span><span class="bp">.</span><span class="mi">9</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">using_new_ref</span>
<span class="mi">11453</span><span class="n">ms</span>    <span class="mi">99</span><span class="bp">.</span><span class="mi">9</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">ring_m</span><span class="bp">.</span><span class="n">run</span>
 <span class="mi">9524</span><span class="n">ms</span>    <span class="mi">83</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">norm_num</span>
 <span class="mi">5637</span><span class="n">ms</span>    <span class="mi">49</span><span class="bp">.</span><span class="mi">2</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_add</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_2</span>
 <span class="mi">5253</span><span class="n">ms</span>    <span class="mi">45</span><span class="bp">.</span><span class="mi">8</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_pow</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_2</span>
 <span class="mi">5251</span><span class="n">ms</span>    <span class="mi">45</span><span class="bp">.</span><span class="mi">8</span><span class="err">%</span>   <span class="n">norm_num</span><span class="bp">.</span><span class="n">eval_pow</span>
 <span class="mi">4390</span><span class="n">ms</span>    <span class="mi">38</span><span class="bp">.</span><span class="mi">3</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ext_simplify_core</span>
 <span class="mi">4390</span><span class="n">ms</span>    <span class="mi">38</span><span class="bp">.</span><span class="mi">3</span><span class="err">%</span>   <span class="n">norm_num</span><span class="bp">.</span><span class="n">derive</span>
 <span class="mi">4308</span><span class="n">ms</span>    <span class="mi">37</span><span class="bp">.</span><span class="mi">6</span><span class="err">%</span>   <span class="n">norm_num</span><span class="bp">.</span><span class="n">derive</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_3</span>
 <span class="mi">1710</span><span class="n">ms</span>    <span class="mi">14</span><span class="bp">.</span><span class="mi">9</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">mk_app</span>
  <span class="mi">180</span><span class="n">ms</span>     <span class="mi">1</span><span class="bp">.</span><span class="mi">6</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_mul</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_2</span>
  <span class="mi">156</span><span class="n">ms</span>     <span class="mi">1</span><span class="bp">.</span><span class="mi">4</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_add</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_21</span>
  <span class="mi">115</span><span class="n">ms</span>     <span class="mi">1</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">expr</span><span class="bp">.</span><span class="n">of_nat</span><span class="bp">._</span><span class="n">lambda_1</span>
   <span class="mi">90</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">8</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_add</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_20</span>
   <span class="mi">66</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">6</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_pow</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_19</span>
   <span class="mi">62</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">5</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">mk_mapp</span>
   <span class="mi">21</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">2</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_atom</span><span class="bp">._</span><span class="n">lambda_2</span>
   <span class="mi">18</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">2</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_add</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_14</span>
   <span class="mi">17</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="kn">eval</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_42</span>
    <span class="mi">8</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">char</span><span class="bp">.</span><span class="n">of_nat</span>
    <span class="mi">8</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">exact</span>
    <span class="mi">8</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">state_t</span><span class="bp">.</span><span class="n">monad</span><span class="bp">._</span><span class="n">lambda_19</span>
    <span class="mi">7</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">reader_t</span><span class="bp">.</span><span class="n">monad</span><span class="bp">._</span><span class="n">lambda_19</span>
    <span class="mi">7</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span><span class="err">%</span>   <span class="n">interaction_monad</span><span class="bp">.</span><span class="n">failed</span>
    <span class="mi">5</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">failed</span>
    <span class="mi">5</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_add</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_13</span>
    <span class="mi">5</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">expr</span><span class="bp">.</span><span class="n">app</span>
    <span class="mi">3</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">norm_num</span><span class="bp">.</span><span class="n">eval_div_ext</span>
    <span class="mi">2</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">expr</span><span class="bp">.</span><span class="n">mk_app</span>
    <span class="mi">2</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">horner_expr</span><span class="bp">.</span><span class="n">xadd&#39;</span>
    <span class="mi">2</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">ring_m</span><span class="bp">.</span><span class="n">mk_app</span><span class="bp">._</span><span class="n">lambda_2</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">nat</span><span class="bp">.</span><span class="n">binary_rec</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_pow</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_20</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">interaction_monad</span><span class="bp">.</span><span class="n">monad</span><span class="bp">._</span><span class="n">lambda_4</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_add</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_22</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">nat</span><span class="bp">.</span><span class="n">bodd</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">string</span><span class="bp">.</span><span class="n">push</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">norm_num</span><span class="bp">.</span><span class="n">eval_ineq</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_pow</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_23</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_pow</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_22</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="n">eval_pow</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">state_t</span><span class="bp">.</span><span class="n">monad</span><span class="bp">._</span><span class="n">lambda_20</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">norm_num</span><span class="bp">.</span><span class="n">derive</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">lambda_2</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">nat</span><span class="bp">.</span><span class="n">decidable_lt</span>
    <span class="mi">1</span><span class="n">ms</span>     <span class="mi">0</span><span class="bp">.</span><span class="mi">0</span><span class="err">%</span>   <span class="n">reader_t</span><span class="bp">.</span><span class="n">monad</span><span class="bp">._</span><span class="n">lambda_20</span>
</pre></div>

<a name="193050030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193050030" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193050030">Mario Carneiro (Apr 06 2020 at 14:30)</a>:</h4>
<p>(as always, I am frustrated because I know that this job can be done in &lt;1ms if you consider what literally has to happen to produce the term; everything beyond that is lean/vm bloat)</p>

<a name="193050222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193050222" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193050222">Patrick Massot (Apr 06 2020 at 14:31)</a>:</h4>
<p>Why don't you hack^W develop Lean, instead? Would that be much harder?</p>

<a name="193050583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193050583" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193050583">Mario Carneiro (Apr 06 2020 at 14:34)</a>:</h4>
<p>I don't want to touch typeclass inference with a ten foot pole</p>

<a name="193050654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/ring%20is%20slow%20with%20polynomials/near/193050654" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/61701ringisslowwithpolynomials.html#193050654">Mario Carneiro (Apr 06 2020 at 14:34)</a>:</h4>
<p>maybe the issue in <code>mk_app</code> has a simple fix, maybe not</p>


{% endraw %}

{% include archive_update.html %}