---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/116395maths/82180functionextension.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/116395maths/index.html">maths</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html">function extension</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="169392596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169392596" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169392596">Patrick Massot (Jul 01 2019 at 12:57)</a>:</h4>
<p>Currently we have a hack at <a href="https://github.com/leanprover-community/mathlib/blob/master/src/topology/maps.lean#L178-L180" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/master/src/topology/maps.lean#L178-L180">https://github.com/leanprover-community/mathlib/blob/master/src/topology/maps.lean#L178-L180</a> ensuring that we could potentially extend by contuity some functions with values in a space which is not regular. Is there any use to this? The trade-off is we need to assume the dense embedding of the original space into the space we want to extend to is injective. I don't know any case where we want to target to be non-regular whereas there is a clear use case for dropping the injectivity assumption: the completion of uniform spaces.</p>

<a name="169404110"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169404110" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169404110">Patrick Massot (Jul 01 2019 at 15:17)</a>:</h4>
<p>Looking at the history of this "feature", I see <span class="user-mention" data-user-id="110294">@Johannes Hölzl</span> made me change that last summer, so it's probably safe to assume nothing will be impacted.</p>

<a name="169426195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169426195" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169426195">Johannes Hölzl (Jul 01 2019 at 20:00)</a>:</h4>
<p>Which properties can you show if the dense embedding is not injective? How do you state universality (is this the right term?). Otherwise, I'm fine with changing it as long as the extensions like the Bochner integral works.</p>

<a name="169479591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169479591" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169479591">Patrick Massot (Jul 02 2019 at 13:19)</a>:</h4>
<p>Johannes, I think I can prove almost everything without injectivity. I don't understand what universality you don't see how to state. I'm not worried about Bochner integration, I don't see any non-separated spaces could show up there</p>

<a name="169558446"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169558446" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169558446">Patrick Massot (Jul 03 2019 at 11:36)</a>:</h4>
<p>What would be a good name for a function from a topological space to another one with the property that it pulls back the target topology to the source topology? This is half of what <a href="https://github.com/leanprover-community/mathlib/blob/master/src/topology/maps.lean#L20-L21" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/master/src/topology/maps.lean#L20-L21">we ask</a> of a topological embedding. The other half is injectivity which is actually completely irrelevant in almost every lemma we prove about topological embedding. So I think we should really have a name for the crucial part.</p>

<a name="169558904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169558904" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169558904">Patrick Massot (Jul 03 2019 at 11:45)</a>:</h4>
<p>Another issue with the definition I linked to is it is stated as an <code>and</code> instead of a structure with two fields. And then we have <a href="https://github.com/leanprover-community/mathlib/blob/master/src/topology/maps.lean#L81-L82" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/master/src/topology/maps.lean#L81-L82">https://github.com/leanprover-community/mathlib/blob/master/src/topology/maps.lean#L81-L82</a> which first complains it doesn't use the previous definition, and then is defined as a structure with three fields. <span class="user-mention" data-user-id="110049">@Mario Carneiro</span>, <span class="user-mention" data-user-id="110294">@Johannes Hölzl</span>, <span class="user-mention" data-user-id="110032">@Reid Barton</span>, <span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span> how would you feel if we had a web of structures extending each other here? The bases would be structures with only one axiom, either the induced topology axiom or a density axiom, then structures combining them, with variants adding an injectivity assumption or not. And then variations with uniform structures. Note that I don't suggest making any of these classes, only structures in Prop. One thing that I like with this approach is that proofs can use fields names instead of anonymous <code>and</code> constructors, and using the various parts also goes through meaningful names like <code>hf.inj</code> instead of <code>hf.1</code>. The down-side is you get a bunch of <code>hf.to_something.some_property</code>, unless we restated <code>some_property</code> for every extending structure. Or should we use flat (aka "old") structures?</p>

<a name="169560057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169560057" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169560057">Mario Carneiro (Jul 03 2019 at 12:03)</a>:</h4>
<p>Actually lean does some magic so that <code>hf.some_property</code> means <code>hf.to_something.some_property</code></p>

<a name="169560149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169560149" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169560149">Patrick Massot (Jul 03 2019 at 12:04)</a>:</h4>
<p>Sorry I was unclear. I'm not only talking about <code>some_property</code> being a field of a parent structure, but also a lemma in the namespace of a parent structure</p>

<a name="169560170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169560170" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169560170">Patrick Massot (Jul 03 2019 at 12:05)</a>:</h4>
<p>I think the magic doesn't go that far</p>

<a name="169560184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169560184" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169560184">Patrick Massot (Jul 03 2019 at 12:05)</a>:</h4>
<p>and probably using old_structure would solve that</p>

<a name="169560359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169560359" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169560359">Mario Carneiro (Jul 03 2019 at 12:07)</a>:</h4>
<p>I don't think it would. You still have to insert a parent coercion before using it in a lemma</p>

<a name="169560424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169560424" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169560424">Patrick Massot (Jul 03 2019 at 12:08)</a>:</h4>
<p>So what do you think about my global question?</p>

<a name="169560480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169560480" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169560480">Mario Carneiro (Jul 03 2019 at 12:09)</a>:</h4>
<p>I'm fine with changing this to a structure</p>

<a name="169560495"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169560495" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169560495">Patrick Massot (Jul 03 2019 at 12:09)</a>:</h4>
<p>New or old?</p>

<a name="169560582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169560582" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169560582">Mario Carneiro (Jul 03 2019 at 12:10)</a>:</h4>
<p>It doesn't really matter since it's a proof</p>

<a name="169560614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169560614" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169560614">Patrick Massot (Jul 03 2019 at 12:11)</a>:</h4>
<p>Could you quickly recap when it does matter? I'm very fuzzy about this distinction</p>

<a name="169561828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169561828" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169561828">Mario Carneiro (Jul 03 2019 at 12:30)</a>:</h4>
<p>When the structure is a proposition, all parent coercions and projections are just theorems, so it doesn't really matter how things get packed as long as the statements are the same. The only thing that is affected is the time it takes to compile the structure definition itself</p>

<a name="169561902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169561902" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169561902">Mario Carneiro (Jul 03 2019 at 12:31)</a>:</h4>
<p>When the structure is data, structure instances will need to be unfolded to get at the projections. This is especially true for classes, which do this implicitly all over the place</p>

<a name="169561953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169561953" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169561953">Mario Carneiro (Jul 03 2019 at 12:32)</a>:</h4>
<p>If those structure instances are huge then there is a performance penalty as a result</p>

<a name="169562168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169562168" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169562168">Patrick Massot (Jul 03 2019 at 12:36)</a>:</h4>
<p>Thanks</p>

<a name="169870600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169870600" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169870600">Patrick Massot (Jul 08 2019 at 13:49)</a>:</h4>
<p>I'm done with this refactor. Monster refactor PR at <a href="https://github.com/leanprover-community/mathlib/pull/1193" target="_blank" title="https://github.com/leanprover-community/mathlib/pull/1193">https://github.com/leanprover-community/mathlib/pull/1193</a> <span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span> <span class="user-mention" data-user-id="110032">@Reid Barton</span> <span class="user-mention" data-user-id="110294">@Johannes Hölzl</span> It would be really really nice to review this as soon as possible, since it will conflict any present or future topology PR as long as it isn't merged. I'm sorry about the size of the PR, but dense embeddings and their useless injectivity assumptions were everywhere, and I needed to go all the way to removing the separation assumption in ring completion to prove my point.</p>

<a name="169878221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/function%20extension/near/169878221" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/82180functionextension.html#169878221">Johan Commelin (Jul 08 2019 at 15:17)</a>:</h4>
<p>Congrats!</p>


{% endraw %}

{% include archive_update.html %}