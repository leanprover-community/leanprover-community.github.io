---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/116395maths/94495Separationstuff.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/116395maths/index.html">maths</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html">Separation stuff</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="134237694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134237694" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134237694">Patrick Massot (Sep 19 2018 at 14:59)</a>:</h4>
<p><span class="user-mention" data-user-id="110294">@Johannes Hölzl</span> I'm working on uniform spaces again, and I have a couple of question. </p>
<ul>
<li>First, at <a href="https://github.com/leanprover/mathlib/blob/master/analysis/topology/topological_space.lean#L638-L640" target="_blank" title="https://github.com/leanprover/mathlib/blob/master/analysis/topology/topological_space.lean#L638-L640">https://github.com/leanprover/mathlib/blob/master/analysis/topology/topological_space.lean#L638-L640</a> the comment mentions two possible definitions of T1 spaces. Am I right to think the equivalence of those definitions is not in mathlib?</li>
<li>Bourbaki defines separated uniform spaces as uniform spaces whose underlying topology is T2. You define them in terms of the separation relation, and prove the underlying topological space is T2. But you don't prove the converse implication, do you?</li>
<li>When trying to prove the converse implication on paper, I get that T1 underlying topology is enough. Is this fishy? Or is it only that topologies coming from uniform structures are special and T1 implies T2 (and regular)?</li>
</ul>

<a name="134239354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134239354" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134239354">Reid Barton (Sep 19 2018 at 15:23)</a>:</h4>
<p>T1 implies T2 for uniform spaces should be the same epsilon/2 as shows metric spaces are T2</p>

<a name="134239449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134239449" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134239449">Reid Barton (Sep 19 2018 at 15:25)</a>:</h4>
<p>Uh, on my phone and apparently can't form complete sentences but I guess you understand what I mean.</p>

<a name="134239563"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134239563" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134239563">Patrick Massot (Sep 19 2018 at 15:26)</a>:</h4>
<p>Indeed it looks very plausible, but I wanted to check with our local expert before starting to Lean it</p>

<a name="134240553"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134240553" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134240553">Patrick Massot (Sep 19 2018 at 15:43)</a>:</h4>
<p>I now have a really detailed paper proof of the fact that the group uniform structure on the completion of a group is the same as the completion of the group uniform structure. I have about 15 lemmas to state and prove in Lean. I'm really afraid because lots of them involve different uniform structures on the same type, and I don't know how to fight the type class resolution system here.</p>

<a name="134253310"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134253310" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134253310">Patrick Massot (Sep 19 2018 at 16:37)</a>:</h4>
<p>Ok, I decided to start with a lemma which is independent of all the group theory stuff and openly involves different uniform structures on the same type. </p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">topology</span><span class="bp">.</span><span class="n">uniform_space</span>
<span class="kn">open</span> <span class="n">set</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kn">lemma</span> <span class="n">uniform_continuous_id_of_emb</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">u</span> <span class="n">u&#39;</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">top</span> <span class="o">:</span> <span class="n">u</span><span class="bp">.</span><span class="n">to_topological_space</span> <span class="bp">=</span> <span class="n">u&#39;</span><span class="bp">.</span><span class="n">to_topological_space</span><span class="o">)</span>
  <span class="o">{</span><span class="n">e</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">ue</span> <span class="o">:</span> <span class="bp">@</span><span class="n">uniform_embedding</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">u</span> <span class="n">e</span><span class="o">)</span> <span class="o">(</span><span class="n">dense</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">closure</span> <span class="o">(</span><span class="n">range</span> <span class="n">e</span><span class="o">))</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">@</span><span class="n">uniform_continuous</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">u&#39;</span> <span class="n">e</span><span class="o">)</span> <span class="o">:</span>  <span class="n">u</span> <span class="bp">≤</span> <span class="n">u&#39;</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">let</span> <span class="n">e₀</span> <span class="o">:=</span> <span class="o">(</span><span class="n">ue</span><span class="bp">.</span><span class="n">dense_embedding</span> <span class="n">dense</span><span class="o">)</span><span class="bp">.</span><span class="n">extend</span> <span class="n">e</span><span class="o">,</span>

  <span class="n">sorry</span>
<span class="kn">end</span>
</pre></div>


<p>As expected, lots of @/_ flying around. First surprise: how does Lean accepts the <code>dense</code> hypothesis? Where does it get a topology on beta? I was expecting to need to need @ here, pick at random from <code>u</code> to <code>u'</code> and then use the <code>topo</code> hypothesis in the proof. And then Lean complains when I define <code>e₀</code>: <code>synthesized type class instance is not definitionally equal to expression inferred by typing rules, synthesized u' inferred u</code>. Here I want to use uniform structure <code>u</code>. How can I proceed?</p>

<a name="134259187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134259187" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134259187">Patrick Massot (Sep 19 2018 at 18:17)</a>:</h4>
<p>Any hint about this?</p>

<a name="134259425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134259425" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134259425">Johannes Hölzl (Sep 19 2018 at 18:20)</a>:</h4>
<p>first observation: in <code>dense</code>, the type class instances find somehow <code>u'</code></p>

<a name="134259461"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134259461" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134259461">Johannes Hölzl (Sep 19 2018 at 18:21)</a>:</h4>
<p>For some reasons it also uses non-type class parameters...</p>

<a name="134259548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134259548" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134259548">Patrick Massot (Sep 19 2018 at 18:22)</a>:</h4>
<p>Yes, this is what confuses me</p>

<a name="134259575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134259575" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134259575">Johannes Hölzl (Sep 19 2018 at 18:22)</a>:</h4>
<p>the type class inference will use <code>u</code> if you swap <code>u'</code> and <code>u</code>. then <code>u</code> will be used in <code>dense</code>, and <code>e₀</code> works</p>

<a name="134259585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134259585" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134259585">Johannes Hölzl (Sep 19 2018 at 18:22)</a>:</h4>
<p>but this is surely not reliable.</p>

<a name="134259601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134259601" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134259601">Patrick Massot (Sep 19 2018 at 18:23)</a>:</h4>
<p>Of course square brackets are meant to indicate how these arguments will be supplied when applying the lemma. But somehow I thought they also indicated what to put in the type class system for immediate use in following arguments</p>

<a name="134259626"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134259626" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134259626">Patrick Massot (Sep 19 2018 at 18:23)</a>:</h4>
<p>I thought about swapping, but I wanted a robust solution</p>

<a name="134259705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134259705" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134259705">Patrick Massot (Sep 19 2018 at 18:24)</a>:</h4>
<p>And , while you're here, this thread starts with three questions for you...</p>

<a name="134259709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134259709" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134259709">Johannes Hölzl (Sep 19 2018 at 18:24)</a>:</h4>
<p>to have it robust you need to use the <code>@...</code> notation</p>

<a name="134259913"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134259913" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134259913">Patrick Massot (Sep 19 2018 at 18:26)</a>:</h4>
<p>My son requires me, you have some extra thinking time <span class="emoji emoji-263a" title="smile">:smile:</span></p>

<a name="134259939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134259939" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134259939">Johannes Hölzl (Sep 19 2018 at 18:27)</a>:</h4>
<p>1) heh, the comment is the wrong way around. All we have specifically for T1 is the three theorem below the <code>class</code>.  So AFAIR: no this equivalence is not in mathlib.</p>

<a name="134259948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134259948" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134259948">Kevin Buzzard (Sep 19 2018 at 18:27)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">topology</span><span class="bp">.</span><span class="n">uniform_space</span>
<span class="kn">open</span> <span class="n">set</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="c1">--set_option trace.class_instances true</span>
<span class="kn">lemma</span> <span class="n">uniform_continuous_id_of_emb</span> <span class="o">(</span><span class="n">u</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">)</span>
 <span class="o">:</span> <span class="n">false</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">have</span> <span class="n">u&#39;</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span><span class="o">,</span> <span class="c1">-- works??</span>
<span class="c1">--  have : u = u&#39; := rfl, -- fails??</span>
  <span class="n">sorry</span>
<span class="kn">end</span>
</pre></div>

<a name="134259975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134259975" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134259975">Kevin Buzzard (Sep 19 2018 at 18:27)</a>:</h4>
<p>this is horrible</p>

<a name="134260041"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134260041" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134260041">Johannes Hölzl (Sep 19 2018 at 18:28)</a>:</h4>
<p>2) no the converse is not proved</p>

<a name="134260187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134260187" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134260187">Johannes Hölzl (Sep 19 2018 at 18:30)</a>:</h4>
<p>3) Reid's comment makes sense to me.</p>

<a name="134260195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134260195" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134260195">Chris Hughes (Sep 19 2018 at 18:30)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> you used have instead of let.</p>

<a name="134260216"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134260216" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134260216">Kevin Buzzard (Sep 19 2018 at 18:31)</a>:</h4>
<p>thank goodness for that</p>

<a name="134260225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134260225" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134260225">Kevin Buzzard (Sep 19 2018 at 18:31)</a>:</h4>
<p>and not for the first time</p>

<a name="134260341"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134260341" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134260341">Johannes Hölzl (Sep 19 2018 at 18:33)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span>  do you work with: <strong>I. M. James: Topologies and Uniformities</strong>? This is what I used to formalize most of uniform spaces.</p>

<a name="134260347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134260347" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134260347">Kevin Buzzard (Sep 19 2018 at 18:33)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">topology</span><span class="bp">.</span><span class="n">uniform_space</span>
<span class="kn">open</span> <span class="n">set</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kn">lemma</span> <span class="n">uniform_continuous_id_of_emb</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">u</span> <span class="n">u&#39;</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">)</span>
 <span class="o">:</span> <span class="n">false</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">let</span> <span class="n">βtop</span> <span class="o">:</span> <span class="n">topological_space</span> <span class="n">β</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span><span class="o">,</span> <span class="c1">-- ??</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">βtop</span> <span class="bp">=</span> <span class="bp">@</span><span class="n">uniform_space</span><span class="bp">.</span><span class="n">to_topological_space</span> <span class="n">β</span> <span class="n">u&#39;</span> <span class="o">:=</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">sorry</span>
<span class="kn">end</span>
</pre></div>

<a name="134260400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134260400" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134260400">Kevin Buzzard (Sep 19 2018 at 18:34)</a>:</h4>
<p>So as Johannes says, type class inference picks up <code>u'</code> and it's not clear why</p>

<a name="134260910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134260910" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134260910">Kevin Buzzard (Sep 19 2018 at 18:43)</a>:</h4>
<blockquote>
<p>How can I proceed?</p>
</blockquote>
<p>Well we now see the problem; type class inference succeeds when it shouldn't, so...</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">topology</span><span class="bp">.</span><span class="n">uniform_space</span>
<span class="kn">open</span> <span class="n">set</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kn">lemma</span> <span class="n">uniform_continuous_id_of_emb</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">u</span> <span class="n">u&#39;</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">top</span> <span class="o">:</span> <span class="n">u</span><span class="bp">.</span><span class="n">to_topological_space</span> <span class="bp">=</span> <span class="n">u&#39;</span><span class="bp">.</span><span class="n">to_topological_space</span><span class="o">)</span>
  <span class="o">{</span><span class="n">e</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">ue</span> <span class="o">:</span> <span class="bp">@</span><span class="n">uniform_embedding</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">u</span> <span class="n">e</span><span class="o">)</span> <span class="o">(</span><span class="n">dense</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="err">∈</span> <span class="bp">@</span><span class="n">closure</span> <span class="n">β</span> <span class="o">(</span><span class="n">u</span><span class="bp">.</span><span class="n">to_topological_space</span><span class="o">)</span> <span class="o">(</span><span class="n">range</span> <span class="n">e</span><span class="o">))</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">@</span><span class="n">uniform_continuous</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">u&#39;</span> <span class="n">e</span><span class="o">)</span> <span class="o">:</span>  <span class="n">u</span> <span class="bp">≤</span> <span class="n">u&#39;</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">let</span> <span class="n">e₀</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">dense_embedding</span><span class="bp">.</span><span class="n">extend</span> <span class="bp">_</span> <span class="n">β</span> <span class="n">β</span> <span class="bp">_</span> <span class="o">(</span><span class="n">u</span><span class="bp">.</span><span class="n">to_topological_space</span><span class="o">)</span> <span class="n">e</span> <span class="o">(</span><span class="n">u&#39;</span><span class="bp">.</span><span class="n">to_topological_space</span><span class="o">)</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">uniform_embedding</span><span class="bp">.</span><span class="n">dense_embedding</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">u</span> <span class="bp">_</span> <span class="n">ue</span> <span class="n">dense</span><span class="o">)</span> <span class="n">e</span><span class="o">,</span>

  <span class="n">sorry</span>
<span class="kn">end</span>
</pre></div>


<p>I don't know what you're complaining about :-)</p>

<a name="134260981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134260981" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134260981">Johan Commelin (Sep 19 2018 at 18:44)</a>:</h4>
<p>Did you steel Scott's monitor?</p>

<a name="134260988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134260988" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134260988">Johan Commelin (Sep 19 2018 at 18:44)</a>:</h4>
<p>Those lines are way too long. <span class="emoji emoji-1f923" title="rolling on the floor laughing">:rolling_on_the_floor_laughing:</span></p>

<a name="134260990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134260990" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134260990">Kevin Buzzard (Sep 19 2018 at 18:44)</a>:</h4>
<p>Here is a possible workaround: use beta and gamma with an equiv, let u be the uniform structure on beta and u' on gamma</p>

<a name="134261001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261001" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261001">Kevin Buzzard (Sep 19 2018 at 18:44)</a>:</h4>
<blockquote>
<p>Those lines are way too long. <span class="emoji emoji-1f923" title="rolling on the floor laughing">:rolling_on_the_floor_laughing:</span></p>
</blockquote>
<p>I even halved the longest one!</p>

<a name="134261022"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261022" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261022">Kevin Buzzard (Sep 19 2018 at 18:45)</a>:</h4>
<p>and then you won't get the problems</p>

<a name="134261028"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261028" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261028">Kevin Buzzard (Sep 19 2018 at 18:45)</a>:</h4>
<p>and you can just push forward and pull back the uniformities.</p>

<a name="134261100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261100" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261100">Kevin Buzzard (Sep 19 2018 at 18:46)</a>:</h4>
<p>This might actually work. But of course the question still remains as to how type class inference is stealing your uniformities. This is very funny. It's <em>exactly</em> the opposite of the complaint most of my student have -- "I can see it in the local context, how come Lean doesn't know why R is a ring?"</p>

<a name="134261241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261241" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261241">Johannes Hölzl (Sep 19 2018 at 18:49)</a>:</h4>
<p>ah yes, when you move the parameters <code>u</code> and <code>u'</code> to the right side of <code>:</code>, then it doesn't work anymore:</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">uniform_continuous_id_of_emb</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span>
  <span class="bp">∀</span><span class="o">(</span><span class="n">u</span> <span class="n">u&#39;</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">top</span> <span class="o">:</span> <span class="n">u</span><span class="bp">.</span><span class="n">to_topological_space</span> <span class="bp">=</span> <span class="n">u&#39;</span><span class="bp">.</span><span class="n">to_topological_space</span><span class="o">)</span>
  <span class="o">{</span><span class="n">e</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">ue</span> <span class="o">:</span> <span class="bp">@</span><span class="n">uniform_embedding</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">u</span> <span class="n">e</span><span class="o">)</span>
  <span class="o">(</span><span class="n">dense</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">closure</span> <span class="o">(</span><span class="n">range</span> <span class="n">e</span><span class="o">))</span> <span class="c1">-- fails here</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">@</span><span class="n">uniform_continuous</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">u&#39;</span> <span class="n">e</span><span class="o">),</span> <span class="n">u</span> <span class="bp">≤</span> <span class="n">u&#39;</span> <span class="o">:=</span> <span class="bp">...</span>
</pre></div>

<a name="134261338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261338" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261338">Kevin Buzzard (Sep 19 2018 at 18:50)</a>:</h4>
<p>So when Leo said only stuff to the left of the colon could be used for type class inference, I didn't realise he meant that even stuff which we didn't want to use would get used...</p>

<a name="134261347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261347" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261347">Kevin Buzzard (Sep 19 2018 at 18:50)</a>:</h4>
<p>Is this just for uniform spaces or does everything do this?</p>

<a name="134261357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261357" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261357">Johannes Hölzl (Sep 19 2018 at 18:50)</a>:</h4>
<p>I guess everything?!</p>

<a name="134261372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261372" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261372">Johannes Hölzl (Sep 19 2018 at 18:51)</a>:</h4>
<p>maybe only things which are marked as <code>@[class]</code>?</p>

<a name="134261392"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261392" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261392">Kevin Buzzard (Sep 19 2018 at 18:51)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">test</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">(</span><span class="n">u</span> <span class="o">:</span> <span class="n">ring</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">false</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">let</span> <span class="n">v</span> <span class="o">:</span> <span class="n">ring</span> <span class="n">α</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span><span class="o">,</span>
  <span class="c1">-- who knew that this worked??</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">v</span> <span class="o">:=</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">sorry</span>
<span class="kn">end</span>
</pre></div>

<a name="134261407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261407" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261407">Kevin Buzzard (Sep 19 2018 at 18:51)</a>:</h4>
<p>Is this a bug??</p>

<a name="134261471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261471" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261471">Mario Carneiro (Sep 19 2018 at 18:52)</a>:</h4>
<p>I'm confused, why is this a surprise</p>

<a name="134261498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261498" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261498">Mario Carneiro (Sep 19 2018 at 18:52)</a>:</h4>
<p>you asked for an instance, it found one</p>

<a name="134261505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261505" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261505">Kevin Buzzard (Sep 19 2018 at 18:52)</a>:</h4>
<p>Patrick, even though Johannes has pointed out a fix, the more I think about the gamma trick the more I think you should consider it seriously. Then you can just use type class inference for beta with u and gamma with u', and deduce the actual thing you want afterwards with a minimal amount of <code>@</code></p>

<a name="134261512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261512" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261512">Kevin Buzzard (Sep 19 2018 at 18:52)</a>:</h4>
<p>I just had absolutely no idea that it would look there</p>

<a name="134261523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261523" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261523">Mario Carneiro (Sep 19 2018 at 18:53)</a>:</h4>
<p>isn't that where it normally looks?</p>

<a name="134261535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261535" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261535">Kevin Buzzard (Sep 19 2018 at 18:53)</a>:</h4>
<p>I thought there was the square bracket stuff and the round bracket stuff</p>

<a name="134261541"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261541" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261541">Kevin Buzzard (Sep 19 2018 at 18:53)</a>:</h4>
<p>and it only looked in the square bracket stuff</p>

<a name="134261591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261591" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261591">Mario Carneiro (Sep 19 2018 at 18:54)</a>:</h4>
<p>Ah, I see. The square bracket only affects users of the theorem, it doesn't matter what you mark it when it's in the context</p>

<a name="134261614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261614" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261614">Mario Carneiro (Sep 19 2018 at 18:54)</a>:</h4>
<p>the only thing that matters inside the theorem is whether the head constant is a <code>@[class]</code></p>

<a name="134261627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261627" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261627">Kevin Buzzard (Sep 19 2018 at 18:54)</a>:</h4>
<p>I see!</p>

<a name="134261666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261666" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261666">Johannes Hölzl (Sep 19 2018 at 18:55)</a>:</h4>
<p>Hm, this is also news to me!</p>

<a name="134261709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261709" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261709">Kevin Buzzard (Sep 19 2018 at 18:56)</a>:</h4>
<p>In which case Patrick I think this is an even bigger indication that you should just work with two different types and maps between them, and in the application make the types the same</p>

<a name="134261780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261780" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261780">Kevin Buzzard (Sep 19 2018 at 18:57)</a>:</h4>
<p>Hopefully this solves some blockages higher up the chain of problems as well. I didn't know things worked like this, and presumably Patrick didn't either -- but I do remember him saying that he could not actually solve some problems with type classes because he could not direct his instances in the right direction. This will hopefully clear a lot of stuff up.</p>

<a name="134261857"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261857" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261857">Johannes Hölzl (Sep 19 2018 at 18:58)</a>:</h4>
<p>I also think it is a good idea to use two types and a uniform equivalence between them. The annoying this is: this may force you to prove for a lot of constants, that they are invariant under equivalences</p>

<a name="134261869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261869" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261869">Kevin Buzzard (Sep 19 2018 at 18:59)</a>:</h4>
<p>I guess the reason many users didn't notice this is simply because it is very rare to actually have two terms of type <code>foo X</code> with <code>foo</code> a class, which you actually want to be distinct; usually users are wrestling to prove that they are the equal, not the other way around.</p>

<a name="134261902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261902" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261902">Johannes Hölzl (Sep 19 2018 at 18:59)</a>:</h4>
<p>yes, type classes work so well, exactly for this reason: if you assume two different structures, you usually have two different types</p>

<a name="134261948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134261948" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134261948">Kevin Buzzard (Sep 19 2018 at 19:00)</a>:</h4>
<blockquote>
<p>I also think it is a good idea to use two types and a uniform equivalence between them. The annoying this is: this may force you to prove for a lot of constants, that they are invariant under equivalences</p>
</blockquote>
<p><span class="user-mention" data-user-id="110026">@Simon Hudon</span> This is back to transport de structure. Deligne emphasized this concept in his IAS lecture last week.</p>

<a name="134262036"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134262036" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134262036">Kevin Buzzard (Sep 19 2018 at 19:01)</a>:</h4>
<p>Patrick is about to need the fact that if he has <code>h : equiv X Y</code> and a topological space structure on X, then all topology-like theorems he proves for X should have an analogue for Y obtained by mapping and co-mapping along h.</p>

<a name="134262303"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134262303" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134262303">Johannes Hölzl (Sep 19 2018 at 19:05)</a>:</h4>
<p>we need to extensions of <code>equiv</code>: <code>continuous_equiv</code> and <code>uniform_equiv</code>. We also assume a topological structure on <code>Y</code> (it may be the one induced by <code>h</code>, but this shouldn't be necessary def-equal)</p>

<a name="134262810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134262810" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134262810">Mario Carneiro (Sep 19 2018 at 19:14)</a>:</h4>
<p>isn't <code>continuous_equiv</code> just <code>homeo</code>?</p>

<a name="134262868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134262868" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134262868">Johannes Hölzl (Sep 19 2018 at 19:15)</a>:</h4>
<p>yes</p>

<a name="134263238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134263238" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134263238">Kevin Buzzard (Sep 19 2018 at 19:22)</a>:</h4>
<p>I feel like we have taken a big step forward here though. My solution with long lines would have been hell and Patrick was complaining some time ago that he could not control his instances. I realised the other reason that this phenomenon was not well known -- if you have a term whose type is a class, 99% of the time you put it in square brackets in the statement of a theorem or definition</p>

<a name="134263651"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134263651" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134263651">Patrick Massot (Sep 19 2018 at 19:30)</a>:</h4>
<p>I'm back. Thanks everybody for your work on this.</p>

<a name="134263681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134263681" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134263681">Patrick Massot (Sep 19 2018 at 19:31)</a>:</h4>
<p>I'm not sure I'm buying the two types solutions. The problem is that I'm not intersted in this lemma in isolation, it's a tiny step in a much bigger proof</p>

<a name="134263692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134263692" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134263692">Patrick Massot (Sep 19 2018 at 19:31)</a>:</h4>
<p>So I'll actually need to apply this lemma</p>

<a name="134264311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134264311" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134264311">Simon Hudon (Sep 19 2018 at 19:45)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span>: <span class="user-mention" data-user-id="110294">@Johannes Hölzl</span> keeps pointing out that <code>transport</code> overlaps with his <code>transfer</code> machinery. I think it would be worth checking if <code>transfer</code> solves your problems right out of the box.</p>

<a name="134264380"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134264380" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134264380">Johannes Hölzl (Sep 19 2018 at 19:46)</a>:</h4>
<p>it doesn't solve them right out of the box. It still requires quite some infrastructure. But I think it is less work to extend <code>transfer</code> than to implement a <code>transport</code></p>

<a name="134265117"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134265117" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134265117">Kevin Buzzard (Sep 19 2018 at 20:01)</a>:</h4>
<p>I would like to hear much more about what is going on here. I don't know what either of these words are. Are they tactics? I remember having a lot of fun working towards <code>transport</code>. Maybe we have an actual use case here. Presumably Johannes in his message above has pinpointed exactly what we need in this situation</p>

<a name="134265223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134265223" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134265223">Kevin Buzzard (Sep 19 2018 at 20:03)</a>:</h4>
<p>Patrick if you try and prove the lemma using just one beta then you have an @ nightmare. If you prove it using beta and gamma then you have a different problem which might be easily solvable and furthermore your lemma will be a more general result. You can get the lemma you want by applying the more general one in the case beta = gamma and then you are only in @ hell for a few lines</p>

<a name="134265278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134265278" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134265278">Patrick Massot (Sep 19 2018 at 20:04)</a>:</h4>
<p>I think this is a very important topic, so I'll probably try a couple of solutions</p>

<a name="134265294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134265294" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134265294">Patrick Massot (Sep 19 2018 at 20:04)</a>:</h4>
<p>I still need to know how I can use my "same topology hypothesis" to deduce that the range of e is dense for for topologies</p>

<a name="134265322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134265322" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134265322">Kevin Buzzard (Sep 19 2018 at 20:05)</a>:</h4>
<p>This is very much like how transport de structure works in Galois theory. You first do it with an isomorphism X = Y and then apply it with X=Y but the isomorphism not equal to the identity and you deduce something which might look like a nontrivial computation with no work</p>

<a name="134265376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134265376" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134265376">Andrew Ashworth (Sep 19 2018 at 20:06)</a>:</h4>
<p><code>transfer</code> is a tactic, used in core lean to prove various properties of integers</p>

<a name="134265497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134265497" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134265497">Patrick Massot (Sep 19 2018 at 20:08)</a>:</h4>
<p>Kevin, you heard about it in Orsay</p>

<a name="134265731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134265731" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134265731">Kevin Buzzard (Sep 19 2018 at 20:12)</a>:</h4>
<p>Oh I remember! I hadn't put two and two together.</p>

<a name="134266139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134266139" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134266139">Patrick Massot (Sep 19 2018 at 20:19)</a>:</h4>
<p>This fight against @ is epic. Did I tell you I forgot to assume both uniformities on β are complete and separated?</p>

<a name="134266198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134266198" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134266198">Patrick Massot (Sep 19 2018 at 20:20)</a>:</h4>
<p>I tried to cut my proof into so many tiny lemmas that I forgot to copy-paste a couple of assumptions</p>

<a name="134266574"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134266574" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134266574">Patrick Massot (Sep 19 2018 at 20:26)</a>:</h4>
<p><code>set_option pp.all true</code> is my only ally</p>

<a name="134266643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134266643" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134266643">Patrick Massot (Sep 19 2018 at 20:27)</a>:</h4>
<p><code>rewrite tactic failed, motive is not type correct nested exception message: check failed, application type mismatch (use 'set_option trace.check true' for additional details)</code> is my enemy</p>

<a name="134266705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134266705" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134266705">Kevin Buzzard (Sep 19 2018 at 20:28)</a>:</h4>
<p>Now I am confused about why something which transfers proofs from N x N to Z can help. I think I need to think about how transfer actually works. But with the beta gamma approach there are no @s at all and you can just use type class inference as usual.</p>

<a name="134266720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134266720" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134266720">Kevin Buzzard (Sep 19 2018 at 20:29)</a>:</h4>
<p>In fact I would be tempted to see how much you can do with beta not assumed equal to gamma and not ever prove anything with beta = gamma unless you absolutely have to.</p>

<a name="134266778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134266778" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134266778">Patrick Massot (Sep 19 2018 at 20:30)</a>:</h4>
<p>You can try to prove the lemma if you want (without forgetting to assume both structures on target are complete and separated)</p>

<a name="134266850"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134266850" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134266850">Johannes Hölzl (Sep 19 2018 at 20:31)</a>:</h4>
<p><code>transfer</code> doesn't require an equivalence, just a relation and proofs about terms related terms. That's how proofs about <code>Z</code> can be reduced to proofs about <code>N x N</code></p>

<a name="134267045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267045" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267045">Kevin Buzzard (Sep 19 2018 at 20:34)</a>:</h4>
<p>I guess I would need to know the maths statement and proof...</p>

<a name="134267138"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267138" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267138">Patrick Massot (Sep 19 2018 at 20:36)</a>:</h4>
<p>Here is the real world story (using A and B instead of greek letters for typing convenience). We have A with a fixed uniform structure, and B with two complete separated uniform structure u and u', which induce the same topology on B. We have e : A to B which is a uniform embedding into (B, u) with dense image. We assume e is uniformly continuous from A to (B, u'). Hence it can be extended by continuity to some uniformly continuous e0 from (B, u) to (B, u'). Since e0 \circ e = e, we learn the e0 is the identity on the image of e. But the later is dense, so by continuity, e0 = Id. So we learned that Id is uniformly continuous from (B, u) to (B, u'), QED.</p>

<a name="134267191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267191" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267191">Patrick Massot (Sep 19 2018 at 20:37)</a>:</h4>
<p>As is often the case, the paper I have in front of me contains only an annotated commutative diagram.</p>

<a name="134267273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267273" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267273">Kevin Buzzard (Sep 19 2018 at 20:38)</a>:</h4>
<p>Can we work on this together at cocalc (possibly at different times)?</p>

<a name="134267286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267286" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267286">Kevin Buzzard (Sep 19 2018 at 20:39)</a>:</h4>
<p>or is it easier just to spam the chat with gists?</p>

<a name="134267302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267302" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267302">Patrick Massot (Sep 19 2018 at 20:39)</a>:</h4>
<p>Here my full Lean so far:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">topology</span><span class="bp">.</span><span class="n">uniform_space</span>

<span class="kn">open</span> <span class="n">set</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="n">def</span> <span class="n">unif_emb</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">u_α</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">u_β</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="n">uniform_embedding</span> <span class="n">f</span>

<span class="n">def</span> <span class="n">unif_cont</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">u_α</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">u_β</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="n">uniform_continuous</span> <span class="n">f</span>

<span class="n">def</span> <span class="n">top</span> <span class="o">(</span><span class="n">u</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">):=</span> <span class="n">u</span><span class="bp">.</span><span class="n">to_topological_space</span>

<span class="n">def</span> <span class="n">complete</span> <span class="o">(</span><span class="n">u</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="n">complete_space</span> <span class="n">α</span>

<span class="n">def</span> <span class="n">hausdorff</span> <span class="o">(</span><span class="n">u</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="n">separated</span> <span class="n">α</span>

<span class="kn">set_option</span> <span class="n">pp</span><span class="bp">.</span><span class="n">all</span> <span class="n">true</span>
<span class="kn">lemma</span> <span class="n">uniform_continuous_id_of_emb</span> <span class="o">[</span><span class="n">uα</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">u&#39;</span> <span class="n">u</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">)</span>
  <span class="o">[</span><span class="n">cu</span> <span class="o">:</span> <span class="n">complete</span> <span class="n">u</span><span class="o">]</span> <span class="o">[</span><span class="n">hu</span> <span class="o">:</span> <span class="n">hausdorff</span> <span class="n">u</span><span class="o">]</span> <span class="o">[</span><span class="n">cu&#39;</span> <span class="o">:</span> <span class="n">complete</span> <span class="n">u&#39;</span><span class="o">]</span> <span class="o">[</span><span class="n">hu&#39;</span> <span class="o">:</span> <span class="n">hausdorff</span> <span class="n">u&#39;</span><span class="o">]</span> <span class="o">(</span><span class="n">htop</span> <span class="o">:</span> <span class="n">top</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">top</span> <span class="n">u&#39;</span><span class="o">)</span>
  <span class="o">{</span><span class="n">e</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">ue</span> <span class="o">:</span> <span class="n">unif_emb</span> <span class="n">uα</span> <span class="n">u</span> <span class="n">e</span><span class="o">)</span> <span class="o">(</span><span class="n">dense</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">closure</span> <span class="o">(</span><span class="n">range</span> <span class="n">e</span><span class="o">))</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">unif_cont</span> <span class="n">uα</span> <span class="n">u&#39;</span> <span class="n">e</span><span class="o">)</span> <span class="o">:</span>  <span class="n">u</span> <span class="bp">≤</span> <span class="n">u&#39;</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">let</span> <span class="n">e₀</span> <span class="o">:=</span> <span class="o">(</span><span class="n">ue</span><span class="bp">.</span><span class="n">dense_embedding</span> <span class="n">dense</span><span class="o">)</span><span class="bp">.</span><span class="n">extend</span> <span class="n">e</span><span class="o">,</span>
  <span class="n">haveI</span> <span class="o">:</span> <span class="n">separated</span> <span class="n">β</span> <span class="o">:=</span> <span class="n">hu</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">unif_cont</span> <span class="n">u</span> <span class="n">u&#39;</span> <span class="n">e₀</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">dsimp</span> <span class="o">[</span><span class="n">unif_cont</span><span class="o">,</span> <span class="n">e₀</span><span class="o">],</span>
    <span class="k">have</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">uniform_continuous_uniformly_extend</span> <span class="n">β</span> <span class="n">α</span> <span class="n">β</span> <span class="n">u</span> <span class="n">uα</span> <span class="n">u&#39;</span> <span class="n">e</span> <span class="n">ue</span> <span class="n">dense</span> <span class="n">e</span> <span class="n">h</span> <span class="n">cu&#39;</span> <span class="n">hu&#39;</span><span class="o">,</span>
    <span class="n">dsimp</span> <span class="o">[</span><span class="n">top</span><span class="o">]</span> <span class="n">at</span> <span class="n">htop</span><span class="o">,</span>

    <span class="n">sorry</span> <span class="o">},</span>

  <span class="n">sorry</span>
<span class="kn">end</span>
</pre></div>

<a name="134267307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267307" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267307">Kevin Buzzard (Sep 19 2018 at 20:39)</a>:</h4>
<p>I am trying to help my daughter with biology homework, clean the kitchen, eat some dinner and prove a lemma</p>

<a name="134267315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267315" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267315">Patrick Massot (Sep 19 2018 at 20:39)</a>:</h4>
<p>A CoCalc effort would probably be fun</p>

<a name="134267377"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267377" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267377">Patrick Massot (Sep 19 2018 at 20:40)</a>:</h4>
<p>As you can see, I tried to hide a bunch of @ in new definitions which simply change binders</p>

<a name="134267413"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267413" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267413">Patrick Massot (Sep 19 2018 at 20:41)</a>:</h4>
<p>The bad side is we need <code>dsimp</code> then</p>

<a name="134267624"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267624" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267624">Mario Carneiro (Sep 19 2018 at 20:45)</a>:</h4>
<p>That real world proof looks applicable where the types are different. The only tricky bit is "generating the same topology", but I think this just means that the equiv is a quotient map (in the topological sense)</p>

<a name="134267625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267625" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267625">Patrick Massot (Sep 19 2018 at 20:45)</a>:</h4>
<p>The relevant part of state is then</p>
<div class="codehilite"><pre><span></span><span class="n">this</span> <span class="o">:</span>
  <span class="bp">@</span><span class="n">uniform_continuous</span><span class="bp">.</span><span class="o">{</span><span class="n">u_2</span> <span class="n">u_2</span><span class="o">}</span> <span class="n">β</span> <span class="n">β</span> <span class="n">u</span> <span class="n">u&#39;</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">dense_embedding</span><span class="bp">.</span><span class="n">extend</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span> <span class="n">u_2</span> <span class="n">u_2</span><span class="o">}</span> <span class="n">α</span> <span class="n">β</span> <span class="n">β</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniform_space</span><span class="bp">.</span><span class="n">to_topological_space</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="n">uα</span><span class="o">)</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">uniform_space</span><span class="bp">.</span><span class="n">to_topological_space</span><span class="bp">.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">β</span> <span class="n">u</span><span class="o">)</span>
       <span class="n">e</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">uniform_space</span><span class="bp">.</span><span class="n">to_topological_space</span><span class="bp">.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">β</span> <span class="n">u&#39;</span><span class="o">)</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">uniform_embedding</span><span class="bp">.</span><span class="n">dense_embedding</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span> <span class="n">u_2</span><span class="o">}</span> <span class="n">α</span> <span class="n">β</span> <span class="n">uα</span> <span class="n">u</span> <span class="n">e</span> <span class="n">ue</span> <span class="n">dense</span><span class="o">)</span>
       <span class="n">e</span><span class="o">),</span>
<span class="n">htop</span> <span class="o">:</span>
  <span class="bp">@</span><span class="n">eq</span><span class="bp">.</span><span class="o">{</span><span class="n">u_2</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="o">(</span><span class="n">topological_space</span><span class="bp">.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniform_space</span><span class="bp">.</span><span class="n">to_topological_space</span><span class="bp">.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">β</span> <span class="n">u</span><span class="o">)</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">uniform_space</span><span class="bp">.</span><span class="n">to_topological_space</span><span class="bp">.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">β</span> <span class="n">u&#39;</span><span class="o">)</span>
<span class="err">⊢</span> <span class="bp">@</span><span class="n">uniform_continuous</span><span class="bp">.</span><span class="o">{</span><span class="n">u_2</span> <span class="n">u_2</span><span class="o">}</span> <span class="n">β</span> <span class="n">β</span> <span class="n">u</span> <span class="n">u&#39;</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">dense_embedding</span><span class="bp">.</span><span class="n">extend</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span> <span class="n">u_2</span> <span class="n">u_2</span><span class="o">}</span> <span class="n">α</span> <span class="n">β</span> <span class="n">β</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniform_space</span><span class="bp">.</span><span class="n">to_topological_space</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span><span class="o">}</span> <span class="n">α</span> <span class="n">uα</span><span class="o">)</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">uniform_space</span><span class="bp">.</span><span class="n">to_topological_space</span><span class="bp">.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">β</span> <span class="n">u</span><span class="o">)</span>
       <span class="n">e</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">uniform_space</span><span class="bp">.</span><span class="n">to_topological_space</span><span class="bp">.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">β</span> <span class="n">u</span><span class="o">)</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">uniform_embedding</span><span class="bp">.</span><span class="n">dense_embedding</span><span class="bp">.</span><span class="o">{</span><span class="n">u_1</span> <span class="n">u_2</span><span class="o">}</span> <span class="n">α</span> <span class="n">β</span> <span class="n">uα</span> <span class="n">u</span> <span class="n">e</span> <span class="n">ue</span> <span class="n">dense</span><span class="o">)</span>
       <span class="n">e</span><span class="o">)</span>
</pre></div>


<p>So it looks like <code>rwa htop at this</code> should close the goal, but I get a that nasty error instead</p>

<a name="134267727"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267727" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267727">Patrick Massot (Sep 19 2018 at 20:46)</a>:</h4>
<p>(deleted)</p>

<a name="134267732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267732" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267732">Kevin Buzzard (Sep 19 2018 at 20:46)</a>:</h4>
<p>Here is the version which is written in what I believe is the correct generality (using A and B and C instead of greek letters for typing convenience). We have A, B, C uniform spaces, with B and C uniform and complete, and a homeo j : B -&gt; C.  We have e : A to B which is a uniform embedding into B with dense image. We assume j circ e is uniformly continuous from A to C. Hence it can be extended by continuity to some uniformly continuous j' from B to C. Since j = j' on e(A), j = j' and hence j is uniformly continuous from B to C, QED <em>without a single @</em></p>

<a name="134267846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267846" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267846">Patrick Massot (Sep 19 2018 at 20:48)</a>:</h4>
<p>I'll try to prove that tomorrow, but I fear this is only pushing the pain to the moment I will need to apply the lemma</p>

<a name="134267863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267863" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267863">Mario Carneiro (Sep 19 2018 at 20:49)</a>:</h4>
<p>we need the theorem that <code>id</code> is uniformly continuous from <code>u</code> to <code>u'</code> iff <code>u &lt;= u'</code></p>

<a name="134267879"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267879" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267879">Mario Carneiro (Sep 19 2018 at 20:49)</a>:</h4>
<p>that is the only part that really needs <code>@</code> work, and the proof is trivial using <code>map_id</code> on filters</p>

<a name="134267939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267939" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267939">Patrick Massot (Sep 19 2018 at 20:50)</a>:</h4>
<p>Sure, we need this id stuff.</p>

<a name="134267956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134267956" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134267956">Patrick Massot (Sep 19 2018 at 20:50)</a>:</h4>
<p>But I don't understand the next sentence</p>

<a name="134268016"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134268016" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134268016">Patrick Massot (Sep 19 2018 at 20:51)</a>:</h4>
<p>And I don't understand why rewrite doesn't work in my attempt.</p>

<a name="134268122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134268122" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134268122">Johannes Hölzl (Sep 19 2018 at 20:53)</a>:</h4>
<p>uniform continuity works on pairs of function, i.e. you need to prove <code>(λx:α×α, (x.1, x.2)) = id</code></p>

<a name="134268196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134268196" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134268196">Johannes Hölzl (Sep 19 2018 at 20:54)</a>:</h4>
<p>and then unfold <code>uniform_continuity</code> and rewrite with this equality</p>

<a name="134268304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134268304" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134268304">Patrick Massot (Sep 19 2018 at 20:56)</a>:</h4>
<p>Sure, but this is completely orthogonal to my problem, right?</p>

<a name="134268321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134268321" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134268321">Patrick Massot (Sep 19 2018 at 20:56)</a>:</h4>
<p>I'm far away from having that id is uniformly continuous here</p>

<a name="134268507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134268507" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134268507">Kevin Buzzard (Sep 19 2018 at 20:59)</a>:</h4>
<p>Do we have homeomorphisms in the strong sense of a continuous equiv with a continuous inverse?</p>

<a name="134268530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134268530" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134268530">Johannes Hölzl (Sep 19 2018 at 21:00)</a>:</h4>
<p>no :(</p>

<a name="134268631"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134268631" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134268631">Patrick Massot (Sep 19 2018 at 21:01)</a>:</h4>
<p><a href="https://github.com/PatrickMassot/lean-differential-topology/blob/master/src/homeos.lean" target="_blank" title="https://github.com/PatrickMassot/lean-differential-topology/blob/master/src/homeos.lean">https://github.com/PatrickMassot/lean-differential-topology/blob/master/src/homeos.lean</a></p>

<a name="134268639"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134268639" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134268639">Patrick Massot (Sep 19 2018 at 21:01)</a>:</h4>
<p>Would you like to get this in mathlib?</p>

<a name="134268698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134268698" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134268698">Patrick Massot (Sep 19 2018 at 21:02)</a>:</h4>
<p>I need to go sleeping, but don't hesitate to unblock this. I hope I could then imitate the solution in many other such lemmas</p>

<a name="134268794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134268794" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134268794">Kevin Buzzard (Sep 19 2018 at 21:04)</a>:</h4>
<p>Patrick here is the statement with beta ne gamma:</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">uniform_continuous_id_of_emb&#39;</span> <span class="o">[</span><span class="n">uα</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">β</span><span class="o">]</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">γ</span><span class="o">]</span>
  <span class="o">[</span><span class="n">complete_space</span> <span class="n">β</span><span class="o">]</span> <span class="o">[</span><span class="n">separated</span> <span class="n">β</span><span class="o">]</span> <span class="o">[</span><span class="n">complete_space</span> <span class="n">γ</span><span class="o">]</span> <span class="o">[</span><span class="n">separated</span> <span class="n">γ</span><span class="o">]</span> <span class="o">(</span><span class="n">j</span> <span class="o">:</span> <span class="n">equiv</span> <span class="n">β</span> <span class="n">γ</span><span class="o">)</span> <span class="c1">-- need cts</span>
  <span class="o">{</span><span class="n">e</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">ue</span> <span class="o">:</span> <span class="n">uniform_embedding</span> <span class="n">e</span><span class="o">)</span> <span class="o">(</span><span class="n">dense</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">closure</span> <span class="o">(</span><span class="n">range</span> <span class="n">e</span><span class="o">))</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">uniform_continuous</span> <span class="o">(</span><span class="n">j</span> <span class="err">∘</span> <span class="n">e</span><span class="o">))</span> <span class="o">:</span>  <span class="n">uniform_continuous</span> <span class="n">j</span> <span class="o">:=</span> <span class="n">sorry</span>
</pre></div>


<p>I had to use none of your five binder-changing defs</p>

<a name="134269048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134269048" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134269048">Patrick Massot (Sep 19 2018 at 21:09)</a>:</h4>
<p>Weird! My rewrite now works</p>

<a name="134269054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134269054" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134269054">Patrick Massot (Sep 19 2018 at 21:09)</a>:</h4>
<p>I wanted to try one more time. I have no idea what changed</p>

<a name="134269137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134269137" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134269137">Patrick Massot (Sep 19 2018 at 21:11)</a>:</h4>
<p>Thanks Kevin. I'll definitely try this road tomorrow</p>

<a name="134269145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134269145" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134269145">Patrick Massot (Sep 19 2018 at 21:11)</a>:</h4>
<p>But, as I wrote earlier, I think it's important enough that I try several things</p>

<a name="134269235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134269235" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134269235">Johannes Hölzl (Sep 19 2018 at 21:13)</a>:</h4>
<p>wait, does the statement hold at all?</p>

<a name="134269249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134269249" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134269249">Johannes Hölzl (Sep 19 2018 at 21:13)</a>:</h4>
<p>How do you want to prove it? (ah, reading your previous description)</p>

<a name="134269434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134269434" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134269434">Johannes Hölzl (Sep 19 2018 at 21:17)</a>:</h4>
<div class="codehilite"><pre><span></span>  <span class="k">have</span> <span class="o">:</span> <span class="n">unif_cont</span> <span class="n">u</span> <span class="n">u&#39;</span> <span class="n">e₀</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">dsimp</span> <span class="o">[</span><span class="n">unif_cont</span><span class="o">,</span> <span class="n">e₀</span><span class="o">],</span>
    <span class="k">have</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">uniform_continuous_uniformly_extend</span> <span class="n">β</span> <span class="n">α</span> <span class="n">β</span> <span class="n">u</span> <span class="n">uα</span> <span class="n">u&#39;</span> <span class="n">e</span> <span class="n">ue</span> <span class="n">dense</span> <span class="n">e</span> <span class="n">h</span> <span class="n">cu&#39;</span> <span class="n">hu&#39;</span><span class="o">,</span>
    <span class="n">dsimp</span> <span class="o">[</span><span class="n">top</span><span class="o">]</span> <span class="n">at</span> <span class="n">htop</span><span class="o">,</span>
    <span class="n">rwa</span> <span class="o">[</span><span class="n">htop</span><span class="o">]</span> <span class="o">{</span><span class="n">occs</span> <span class="o">:=</span> <span class="n">occurrences</span><span class="bp">.</span><span class="n">pos</span> <span class="o">[</span><span class="mi">2</span><span class="o">]}</span> <span class="o">},</span>
</pre></div>


<p>the have can be proved fixing the occurence. I guess the <code>e₀ = id</code> proof doesn't mention any uniformities?</p>

<a name="134269643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134269643" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134269643">Kevin Buzzard (Sep 19 2018 at 21:22)</a>:</h4>
<p>Oh -- I should add that my formalisation is not quite correct because the <code>equiv</code> should be a <code>homeo</code></p>

<a name="134269735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134269735" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134269735">Kevin Buzzard (Sep 19 2018 at 21:25)</a>:</h4>
<p>Hmm, we seem to need the theorem that <code>id</code> is uniformly continuous from <code>u</code> to <code>u'</code> iff <code>u &lt;= u'</code>. But I would rather prove a statement that an equiv is uniformly continuous iff some pushforward of a uniformity is <code>&lt;=</code> the other one. Is this already in Lean?</p>

<a name="134269997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134269997" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134269997">Johannes Hölzl (Sep 19 2018 at 21:30)</a>:</h4>
<p>this holds by definitional equality. EDIT: no, it doesn't</p>

<a name="134270448"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134270448" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134270448">Kevin Buzzard (Sep 19 2018 at 21:40)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">unif_cont</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">u_α</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">u_β</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="n">uniform_continuous</span> <span class="n">f</span>
</pre></div>


<p>Is this OK if alpha = beta? I'm not so sure. I think type class inference chooses the same uniform structure twice. <span class="user-mention" data-user-id="110031">@Patrick Massot</span> I think there's a bug here. Thoughts anyone?</p>

<a name="134270861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134270861" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134270861">Johannes Hölzl (Sep 19 2018 at 21:47)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">uniform_continuous_iff</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span><span class="o">}</span> <span class="o">[</span><span class="n">uα</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">uβ</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">):</span>
  <span class="n">uniform_continuous</span> <span class="n">f</span> <span class="bp">↔</span> <span class="n">uβ</span><span class="bp">.</span><span class="n">comap</span> <span class="n">f</span> <span class="bp">≤</span> <span class="n">uα</span> <span class="o">:=</span>
<span class="n">filter</span><span class="bp">.</span><span class="n">map_le_iff_le_comap</span>
</pre></div>

<a name="134271113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134271113" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134271113">Johannes Hölzl (Sep 19 2018 at 21:49)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> the content of <code>unif_cont</code> is fully elaborated. The elaborator doesn't do a type class search when it is used in <code>uniform_continuous_id_of_emb</code></p>

<a name="134271209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134271209" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134271209">Kevin Buzzard (Sep 19 2018 at 21:50)</a>:</h4>
<p>Oh I see. So it's Ok.</p>

<a name="134271228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134271228" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134271228">Kevin Buzzard (Sep 19 2018 at 21:50)</a>:</h4>
<p>As you can see, I am still coming to terms with my new knowledge about how typeclass inference works. Patrick -- sorry -- it's Ok.</p>

<a name="134271543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134271543" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134271543">Kevin Buzzard (Sep 19 2018 at 21:56)</a>:</h4>
<p>Patrick's version --</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">uniform_continuous_id_of_emb</span> <span class="o">[</span><span class="n">uα</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">u&#39;</span> <span class="n">u</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">)</span>
  <span class="o">[</span><span class="n">cu</span> <span class="o">:</span> <span class="n">complete</span> <span class="n">u</span><span class="o">]</span> <span class="o">[</span><span class="n">hu</span> <span class="o">:</span> <span class="n">hausdorff</span> <span class="n">u</span><span class="o">]</span> <span class="o">[</span><span class="n">cu&#39;</span> <span class="o">:</span> <span class="n">complete</span> <span class="n">u&#39;</span><span class="o">]</span> <span class="o">[</span><span class="n">hu&#39;</span> <span class="o">:</span> <span class="n">hausdorff</span> <span class="n">u&#39;</span><span class="o">]</span> <span class="o">(</span><span class="n">htop</span> <span class="o">:</span> <span class="n">top</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">top</span> <span class="n">u&#39;</span><span class="o">)</span>
  <span class="o">{</span><span class="n">e</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">ue</span> <span class="o">:</span> <span class="n">unif_emb</span> <span class="n">uα</span> <span class="n">u</span> <span class="n">e</span><span class="o">)</span> <span class="o">(</span><span class="n">dense</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">closure</span> <span class="o">(</span><span class="n">range</span> <span class="n">e</span><span class="o">))</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">unif_cont</span> <span class="n">uα</span> <span class="n">u&#39;</span> <span class="n">e</span><span class="o">)</span> <span class="o">:</span>  <span class="n">u</span> <span class="bp">≤</span> <span class="n">u&#39;</span> <span class="o">:=</span>
</pre></div>


<p>Should the conclusion be <code>u' &lt;= u</code>? I'm not an expert in uniform spaces.</p>

<a name="134271658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134271658" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134271658">Kevin Buzzard (Sep 19 2018 at 21:58)</a>:</h4>
<p>I ask because Patrick seemed to be saying that the conclusion was that id was continuous from u to u', and Johannes seems to want to conclude from this that <code>u' &lt;= u</code>. But this could easily be some situation where <code>&lt;=</code> is defined as <code>&gt;=</code> for some people (as far as I know)</p>

<a name="134272056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134272056" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134272056">Kevin Buzzard (Sep 19 2018 at 22:07)</a>:</h4>
<p>There is no <code>uniform_space.comap_id</code> :-(</p>

<a name="134274017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134274017" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134274017">Kevin Buzzard (Sep 19 2018 at 22:57)</a>:</h4>
<p>gaargh there seems to be no <code>ext</code></p>

<a name="134274344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134274344" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134274344">Kevin Buzzard (Sep 19 2018 at 23:04)</a>:</h4>
<p><code>⊢ u' = uniform_space.comap id u'</code></p>

<a name="134275140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134275140" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134275140">Kevin Buzzard (Sep 19 2018 at 23:23)</a>:</h4>
<blockquote>
<div class="codehilite"><pre><span></span>  <span class="k">have</span> <span class="o">:</span> <span class="n">unif_cont</span> <span class="n">u</span> <span class="n">u&#39;</span> <span class="n">e₀</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">dsimp</span> <span class="o">[</span><span class="n">unif_cont</span><span class="o">,</span> <span class="n">e₀</span><span class="o">],</span>
    <span class="k">have</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">uniform_continuous_uniformly_extend</span> <span class="n">β</span> <span class="n">α</span> <span class="n">β</span> <span class="n">u</span> <span class="n">uα</span> <span class="n">u&#39;</span> <span class="n">e</span> <span class="n">ue</span> <span class="n">dense</span> <span class="n">e</span> <span class="n">h</span> <span class="n">cu&#39;</span> <span class="n">hu&#39;</span><span class="o">,</span>
    <span class="n">dsimp</span> <span class="o">[</span><span class="n">top</span><span class="o">]</span> <span class="n">at</span> <span class="n">htop</span><span class="o">,</span>
    <span class="n">rwa</span> <span class="o">[</span><span class="n">htop</span><span class="o">]</span> <span class="o">{</span><span class="n">occs</span> <span class="o">:=</span> <span class="n">occurrences</span><span class="bp">.</span><span class="n">pos</span> <span class="o">[</span><span class="mi">2</span><span class="o">]}</span> <span class="o">},</span>
</pre></div>


</blockquote>
<p>With the gamma version it's just</p>
<div class="codehilite"><pre><span></span>  <span class="k">let</span> <span class="n">e₀</span> <span class="o">:=</span> <span class="o">(</span><span class="n">ue</span><span class="bp">.</span><span class="n">dense_embedding</span> <span class="n">dense</span><span class="o">)</span><span class="bp">.</span><span class="n">extend</span> <span class="o">(</span><span class="n">j</span> <span class="err">∘</span> <span class="n">e</span><span class="o">),</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">uniform_continuous</span> <span class="n">e₀</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">dsimp</span> <span class="o">[</span><span class="n">unif_cont</span><span class="o">,</span> <span class="n">e₀</span><span class="o">],</span>
    <span class="n">exact</span> <span class="n">uniform_continuous_uniformly_extend</span> <span class="n">ue</span> <span class="n">dense</span> <span class="n">h</span><span class="o">,</span>
  <span class="o">},</span>
</pre></div>

<a name="134275198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134275198" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134275198">Kevin Buzzard (Sep 19 2018 at 23:24)</a>:</h4>
<p>Everything is easier this way, switching to gamma is a no-brainer</p>

<a name="134275275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134275275" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134275275">Kevin Buzzard (Sep 19 2018 at 23:26)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">topology</span><span class="bp">.</span><span class="n">uniform_space</span>

<span class="kn">open</span> <span class="n">set</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">γ</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kn">lemma</span> <span class="n">uniform_continuous_id_of_emb&#39;</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">β</span><span class="o">]</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">γ</span><span class="o">]</span>
  <span class="o">[</span><span class="n">complete_space</span> <span class="n">β</span><span class="o">]</span> <span class="o">[</span><span class="n">separated</span> <span class="n">β</span><span class="o">]</span> <span class="o">[</span><span class="n">complete_space</span> <span class="n">γ</span><span class="o">]</span> <span class="o">[</span><span class="n">separated</span> <span class="n">γ</span><span class="o">]</span> <span class="o">(</span><span class="n">j</span> <span class="o">:</span> <span class="n">equiv</span> <span class="n">β</span> <span class="n">γ</span><span class="o">)</span> <span class="c1">-- need continuity assumption</span>
  <span class="o">{</span><span class="n">e</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">ue</span> <span class="o">:</span> <span class="n">uniform_embedding</span> <span class="n">e</span><span class="o">)</span> <span class="o">(</span><span class="n">dense</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">closure</span> <span class="o">(</span><span class="n">range</span> <span class="n">e</span><span class="o">))</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">uniform_continuous</span> <span class="o">(</span><span class="n">j</span> <span class="err">∘</span> <span class="n">e</span><span class="o">))</span> <span class="o">:</span> <span class="n">uniform_continuous</span> <span class="n">j</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">let</span> <span class="n">e₀</span> <span class="o">:=</span> <span class="o">(</span><span class="n">ue</span><span class="bp">.</span><span class="n">dense_embedding</span> <span class="n">dense</span><span class="o">)</span><span class="bp">.</span><span class="n">extend</span> <span class="o">(</span><span class="n">j</span> <span class="err">∘</span> <span class="n">e</span><span class="o">),</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">uniform_continuous</span> <span class="n">e₀</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">dsimp</span> <span class="o">[</span><span class="n">e₀</span><span class="o">],</span>
    <span class="n">exact</span> <span class="n">uniform_continuous_uniformly_extend</span> <span class="n">ue</span> <span class="n">dense</span> <span class="n">h</span><span class="o">,</span>
  <span class="o">},</span>
  <span class="n">sorry</span> <span class="c1">-- I need that j is a homeo and this isn&#39;t in the assumptions</span>
<span class="kn">end</span>
</pre></div>


<p>but it's bedtime now</p>

<a name="134275281"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134275281" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134275281">Kevin Buzzard (Sep 19 2018 at 23:26)</a>:</h4>
<p>and we need to say that <code>j</code> is a homeo not just an equiv.</p>

<a name="134275359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134275359" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134275359">Kevin Buzzard (Sep 19 2018 at 23:28)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">uniform_continuous_iff</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span><span class="o">}</span> <span class="o">[</span><span class="n">uα</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">uβ</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">):</span>
  <span class="n">uniform_continuous</span> <span class="n">f</span> <span class="bp">↔</span> <span class="n">uβ</span><span class="bp">.</span><span class="n">comap</span> <span class="n">f</span> <span class="bp">≤</span> <span class="n">uα</span> <span class="o">:=</span>
<span class="n">filter</span><span class="bp">.</span><span class="n">map_le_iff_le_comap</span>

<span class="n">def</span> <span class="n">unif_emb</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">u_α</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">u_β</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="n">uniform_embedding</span> <span class="n">f</span>

<span class="n">def</span> <span class="n">unif_cont</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">u_α</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">u_β</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="n">uniform_continuous</span> <span class="n">f</span>

<span class="n">def</span> <span class="n">top</span> <span class="o">(</span><span class="n">u</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">):=</span> <span class="n">u</span><span class="bp">.</span><span class="n">to_topological_space</span>

<span class="n">def</span> <span class="n">complete</span> <span class="o">(</span><span class="n">u</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="n">complete_space</span> <span class="n">α</span>

<span class="n">def</span> <span class="n">hausdorff</span> <span class="o">(</span><span class="n">u</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="n">separated</span> <span class="n">α</span>

<span class="kn">lemma</span> <span class="n">uniform_continuous_id_of_emb</span> <span class="o">[</span><span class="n">uα</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">u&#39;</span> <span class="n">u</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">)</span>
  <span class="o">[</span><span class="n">cu</span> <span class="o">:</span> <span class="n">complete</span> <span class="n">u</span><span class="o">]</span> <span class="o">[</span><span class="n">hu</span> <span class="o">:</span> <span class="n">hausdorff</span> <span class="n">u</span><span class="o">]</span> <span class="o">[</span><span class="n">cu&#39;</span> <span class="o">:</span> <span class="n">complete</span> <span class="n">u&#39;</span><span class="o">]</span> <span class="o">[</span><span class="n">hu&#39;</span> <span class="o">:</span> <span class="n">hausdorff</span> <span class="n">u&#39;</span><span class="o">]</span> <span class="o">(</span><span class="n">htop</span> <span class="o">:</span> <span class="n">top</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">top</span> <span class="n">u&#39;</span><span class="o">)</span>
  <span class="o">{</span><span class="n">e</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">ue</span> <span class="o">:</span> <span class="n">unif_emb</span> <span class="n">uα</span> <span class="n">u</span> <span class="n">e</span><span class="o">)</span> <span class="o">(</span><span class="n">dense</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">closure</span> <span class="o">(</span><span class="n">range</span> <span class="n">e</span><span class="o">))</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">unif_cont</span> <span class="n">uα</span> <span class="n">u&#39;</span> <span class="n">e</span><span class="o">)</span> <span class="o">:</span>  <span class="n">u&#39;</span> <span class="bp">≤</span> <span class="n">u</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">have</span> <span class="n">H</span> <span class="o">:</span> <span class="n">unif_cont</span> <span class="n">u</span> <span class="n">u&#39;</span> <span class="n">id</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">uniform_continuous_id_of_emb&#39;</span> <span class="n">α</span> <span class="n">β</span> <span class="n">β</span> <span class="n">uα</span> <span class="n">u</span> <span class="n">u&#39;</span> <span class="n">cu</span> <span class="n">hu</span> <span class="n">cu&#39;</span> <span class="n">hu&#39;</span> <span class="o">(</span><span class="n">equiv</span><span class="bp">.</span><span class="n">refl</span> <span class="n">β</span><span class="o">)</span> <span class="n">e</span> <span class="n">ue</span> <span class="n">dense</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">unfold</span> <span class="n">unif_cont</span> <span class="n">at</span> <span class="n">H</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">uniform_continuous_iff</span> <span class="n">at</span> <span class="n">H</span><span class="o">,</span>
  <span class="n">convert</span> <span class="n">H</span><span class="o">,</span>
  <span class="c1">-- ⊢ u&#39; = uniform_space.comap id u&#39;</span>
  <span class="c1">-- should be trivial?</span>
  <span class="n">sorry</span>
<span class="kn">end</span>
</pre></div>

<a name="134275590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134275590" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134275590">Kevin Buzzard (Sep 19 2018 at 23:35)</a>:</h4>
<p><code>  have : uniform_continuous e₀ :=
    uniform_continuous_uniformly_extend ue dense h,</code></p>

<a name="134291887"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134291887" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134291887">Patrick Massot (Sep 20 2018 at 07:21)</a>:</h4>
<p>Indeed it seems the following is missing:</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">id_prod</span> <span class="o">:</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">α</span><span class="o">),</span> <span class="o">(</span><span class="n">p</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span> <span class="n">p</span><span class="bp">.</span><span class="mi">2</span><span class="o">))</span> <span class="bp">=</span> <span class="n">id</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">ext</span> <span class="bp">;</span> <span class="n">simp</span>

<span class="n">attribute</span> <span class="o">[</span><span class="n">extensionality</span><span class="o">]</span> <span class="n">uniform_space_eq</span>

<span class="kn">lemma</span> <span class="n">uniform_space_comap_id</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">:</span> <span class="n">uniform_space</span><span class="bp">.</span><span class="n">comap</span> <span class="o">(</span><span class="n">id</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="n">id</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">ext</span> <span class="n">u</span><span class="o">,</span>
  <span class="n">dsimp</span> <span class="o">[</span><span class="n">uniform_space</span><span class="bp">.</span><span class="n">comap</span><span class="o">],</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">id_prod</span><span class="o">,</span> <span class="n">filter</span><span class="bp">.</span><span class="n">comap_id</span><span class="o">]</span>
<span class="kn">end</span>
</pre></div>


<p>The first one is strange, but I couldn't find it <span class="user-mention" data-user-id="110294">@Johannes Hölzl</span> any thought?</p>

<a name="134291938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134291938" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134291938">Patrick Massot (Sep 20 2018 at 07:22)</a>:</h4>
<p>Should we add this to mathlib? make the first one a simp lemma?</p>

<a name="134291941"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134291941" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134291941">Johannes Hölzl (Sep 20 2018 at 07:22)</a>:</h4>
<p>you mean <code>id_prod</code>? I don't think we have it yet</p>

<a name="134291947"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134291947" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134291947">Patrick Massot (Sep 20 2018 at 07:22)</a>:</h4>
<p>Yes, id_prod</p>

<a name="134291951"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134291951" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134291951">Kevin Buzzard (Sep 20 2018 at 07:22)</a>:</h4>
<p>I feel like a child collecting football cards again</p>

<a name="134291955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134291955" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134291955">Kevin Buzzard (Sep 20 2018 at 07:22)</a>:</h4>
<p>great excitement when we discover a new basic lemma we don't have</p>

<a name="134291967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134291967" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134291967">Patrick Massot (Sep 20 2018 at 07:23)</a>:</h4>
<p>simp or not simp?</p>

<a name="134291968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134291968" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134291968">Johannes Hölzl (Sep 20 2018 at 07:23)</a>:</h4>
<p>I guess we will never run out of basic lemmas</p>

<a name="134291971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134291971" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134291971">Johannes Hölzl (Sep 20 2018 at 07:23)</a>:</h4>
<p>currently I'm in favor of not simp</p>

<a name="134291975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134291975" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134291975">Kevin Buzzard (Sep 20 2018 at 07:23)</a>:</h4>
<p>I ran out of football cards once; I remember the joy of getting the last one. Bryan Flynn, Leeds United.</p>

<a name="134291976"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134291976" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134291976">Johannes Hölzl (Sep 20 2018 at 07:24)</a>:</h4>
<p>I don't think we have a lot of eta-rule like these in the simp-set. And it might get confusing. But then this rule is quiet nice...</p>

<a name="134292015"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134292015" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134292015">Kevin Buzzard (Sep 20 2018 at 07:24)</a>:</h4>
<p>But I thought we would ultimately find that every basic lemma is either easy or has a tactic-free and simple proof</p>

<a name="134292016"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134292016" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134292016">Patrick Massot (Sep 20 2018 at 07:24)</a>:</h4>
<p>What about tagging uniform_space_eq?</p>

<a name="134292107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134292107" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134292107">Johannes Hölzl (Sep 20 2018 at 07:27)</a>:</h4>
<p>yes, <code>uniform_space_eq</code> should be tagged with <code>@[extensionality]</code>.</p>

<a name="134292424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134292424" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134292424">Patrick Massot (Sep 20 2018 at 07:36)</a>:</h4>
<p>Ok, I first PR'ed id_prod, then I'll do the other two</p>

<a name="134292533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134292533" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134292533">Johannes Hölzl (Sep 20 2018 at 07:39)</a>:</h4>
<p>just waiting for Travis</p>

<a name="134316246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134316246" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134316246">Patrick Massot (Sep 20 2018 at 15:23)</a>:</h4>
<p>Quick update on this topic: mathlib got <a href="https://github.com/leanprover/mathlib/commit/d0f1b21a9df64f48a8d28203bf292eb80e05a6da" target="_blank" title="https://github.com/leanprover/mathlib/commit/d0f1b21a9df64f48a8d28203bf292eb80e05a6da">https://github.com/leanprover/mathlib/commit/d0f1b21a9df64f48a8d28203bf292eb80e05a6da</a> and <a href="https://github.com/leanprover/mathlib/commit/1da8cc51854c2e75f456878b195b162dc8dbb130" target="_blank" title="https://github.com/leanprover/mathlib/commit/1da8cc51854c2e75f456878b195b162dc8dbb130">https://github.com/leanprover/mathlib/commit/1da8cc51854c2e75f456878b195b162dc8dbb130</a> then I added <a href="https://github.com/PatrickMassot/lean-differential-topology/blob/master/src/homeos.lean" target="_blank" title="https://github.com/PatrickMassot/lean-differential-topology/blob/master/src/homeos.lean">https://github.com/PatrickMassot/lean-differential-topology/blob/master/src/homeos.lean</a> to the perfectoid project (I think I still don't whether mathlib wants it). We can then write the two versions of the lemma (following my real life sketch and Kevin's Lean  start) as:</p>
<div class="codehilite"><pre><span></span><span class="kn">open</span> <span class="n">set</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">γ</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kn">lemma</span> <span class="n">uniform_continuous_id_of_emb&#39;</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">β</span><span class="o">]</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">γ</span><span class="o">]</span>
  <span class="o">[</span><span class="n">complete_space</span> <span class="n">β</span><span class="o">]</span> <span class="o">[</span><span class="n">separated</span> <span class="n">β</span><span class="o">]</span> <span class="o">[</span><span class="n">complete_space</span> <span class="n">γ</span><span class="o">]</span> <span class="o">[</span><span class="n">separated</span> <span class="n">γ</span><span class="o">]</span> <span class="o">(</span><span class="n">j</span> <span class="o">:</span> <span class="n">homeo</span> <span class="n">β</span> <span class="n">γ</span><span class="o">)</span>
  <span class="o">{</span><span class="n">e</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">ue</span> <span class="o">:</span> <span class="n">uniform_embedding</span> <span class="n">e</span><span class="o">)</span> <span class="o">(</span><span class="n">dense</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">closure</span> <span class="o">(</span><span class="n">range</span> <span class="n">e</span><span class="o">))</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">uniform_continuous</span> <span class="o">(</span><span class="n">j</span> <span class="err">∘</span> <span class="n">e</span><span class="o">))</span> <span class="o">:</span> <span class="n">uniform_continuous</span> <span class="n">j</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">let</span> <span class="n">e₀</span> <span class="o">:=</span> <span class="o">(</span><span class="n">ue</span><span class="bp">.</span><span class="n">dense_embedding</span> <span class="n">dense</span><span class="o">)</span><span class="bp">.</span><span class="n">extend</span> <span class="o">(</span><span class="n">j</span> <span class="err">∘</span> <span class="n">e</span><span class="o">),</span>
  <span class="k">have</span> <span class="n">uc_e₀</span> <span class="o">:</span> <span class="n">uniform_continuous</span> <span class="n">e₀</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">dsimp</span> <span class="o">[</span><span class="n">e₀</span><span class="o">],</span>
    <span class="n">exact</span> <span class="n">uniform_continuous_uniformly_extend</span> <span class="n">ue</span> <span class="n">dense</span> <span class="n">h</span> <span class="o">},</span>
  <span class="n">convert</span> <span class="n">uc_e₀</span><span class="o">,</span>
  <span class="n">ext</span> <span class="n">b</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">closed</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">β</span> <span class="bp">|</span> <span class="n">j</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">e₀</span> <span class="n">b</span><span class="o">}</span> <span class="o">:=</span> <span class="o">(</span><span class="n">is_closed_eq</span> <span class="n">j</span><span class="bp">.</span><span class="n">fun_con</span> <span class="n">uc_e₀</span><span class="bp">.</span><span class="n">continuous</span><span class="o">),</span>
  <span class="k">have</span> <span class="n">dense&#39;</span> <span class="o">:</span> <span class="n">closure</span> <span class="o">(</span><span class="n">range</span> <span class="n">e</span><span class="o">)</span> <span class="bp">=</span> <span class="n">univ</span><span class="o">,</span> <span class="k">by</span> <span class="n">rwa</span> <span class="n">eq_univ_iff_forall</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">is_closed_property</span> <span class="n">dense&#39;</span> <span class="n">closed</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">eq</span><span class="bp">.</span><span class="n">symm</span> <span class="err">$</span> <span class="n">uniformly_extend_of_emb</span> <span class="n">ue</span> <span class="n">dense</span> <span class="n">h</span><span class="o">)</span>
<span class="kn">end</span>

<span class="n">def</span> <span class="n">unif_emb</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">u_α</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">u_β</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="n">uniform_embedding</span> <span class="n">f</span>

<span class="n">def</span> <span class="n">unif_cont</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">u_α</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">u_β</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="n">uniform_continuous</span> <span class="n">f</span>

<span class="n">def</span> <span class="n">top</span> <span class="o">(</span><span class="n">u</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">):=</span> <span class="n">u</span><span class="bp">.</span><span class="n">to_topological_space</span>

<span class="n">def</span> <span class="n">complete</span> <span class="o">(</span><span class="n">u</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="n">complete_space</span> <span class="n">α</span>

<span class="n">def</span> <span class="n">hausdorff</span> <span class="o">(</span><span class="n">u</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="n">separated</span> <span class="n">α</span>

<span class="kn">lemma</span> <span class="n">uniform_continuous_id_of_emb</span> <span class="o">[</span><span class="n">uα</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">u&#39;</span> <span class="n">u</span> <span class="o">:</span> <span class="n">uniform_space</span> <span class="n">β</span><span class="o">)</span>
  <span class="o">[</span><span class="n">cu</span> <span class="o">:</span> <span class="n">complete</span> <span class="n">u</span><span class="o">]</span> <span class="o">[</span><span class="n">hu</span> <span class="o">:</span> <span class="n">hausdorff</span> <span class="n">u</span><span class="o">]</span> <span class="o">[</span><span class="n">cu&#39;</span> <span class="o">:</span> <span class="n">complete</span> <span class="n">u&#39;</span><span class="o">]</span> <span class="o">[</span><span class="n">hu&#39;</span> <span class="o">:</span> <span class="n">hausdorff</span> <span class="n">u&#39;</span><span class="o">]</span> <span class="o">(</span><span class="n">htop</span> <span class="o">:</span> <span class="n">top</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">top</span> <span class="n">u&#39;</span><span class="o">)</span>
  <span class="o">{</span><span class="n">e</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">ue</span> <span class="o">:</span> <span class="n">unif_emb</span> <span class="n">uα</span> <span class="n">u</span> <span class="n">e</span><span class="o">)</span> <span class="o">(</span><span class="n">dense</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">closure</span> <span class="o">(</span><span class="n">range</span> <span class="n">e</span><span class="o">))</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">unif_cont</span> <span class="n">uα</span> <span class="n">u&#39;</span> <span class="n">e</span><span class="o">)</span> <span class="o">:</span>  <span class="n">u&#39;</span> <span class="bp">≤</span> <span class="n">u</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">let</span> <span class="n">iduu&#39;</span> <span class="o">:</span> <span class="bp">@</span><span class="n">homeo</span> <span class="n">β</span> <span class="n">β</span> <span class="o">(</span><span class="n">top</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">top</span> <span class="n">u&#39;</span><span class="o">)</span> <span class="o">:=</span>
  <span class="o">{</span> <span class="n">to_fun</span> <span class="o">:=</span> <span class="n">id</span><span class="o">,</span>
    <span class="n">inv_fun</span> <span class="o">:=</span> <span class="n">id</span><span class="o">,</span>
    <span class="n">left_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">rfl</span><span class="o">,</span>
    <span class="n">right_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">rfl</span><span class="o">,</span>
    <span class="n">fun_con</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">rw</span> <span class="err">←</span><span class="n">htop</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">continuous_id</span><span class="o">,</span>
    <span class="n">inv_con</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">rw</span> <span class="err">←</span><span class="n">htop</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">continuous_id</span> <span class="o">},</span>

  <span class="n">rw</span> <span class="k">show</span> <span class="n">e</span> <span class="bp">=</span> <span class="n">iduu&#39;</span> <span class="err">∘</span> <span class="n">e</span><span class="o">,</span> <span class="k">by</span> <span class="n">refl</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">H</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">uniform_continuous_id_of_emb&#39;</span> <span class="n">α</span> <span class="n">β</span> <span class="n">β</span> <span class="n">uα</span> <span class="n">u</span> <span class="n">u&#39;</span> <span class="n">cu</span> <span class="n">hu</span> <span class="n">cu&#39;</span> <span class="n">hu&#39;</span> <span class="n">iduu&#39;</span> <span class="n">e</span> <span class="n">ue</span> <span class="n">dense</span> <span class="n">h</span><span class="o">,</span>

  <span class="n">rw</span> <span class="n">uniform_continuous_iff</span> <span class="n">at</span> <span class="n">H</span><span class="o">,</span>
  <span class="n">convert</span> <span class="n">H</span><span class="o">,</span>
  <span class="n">rw</span> <span class="k">show</span> <span class="o">(</span><span class="n">iduu&#39;</span> <span class="o">:</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="bp">=</span> <span class="n">id</span><span class="o">,</span> <span class="k">by</span> <span class="n">refl</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">uniform_space_comap_id</span><span class="o">]</span>
<span class="kn">end</span>
</pre></div>

<a name="134316471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134316471" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134316471">Patrick Massot (Sep 20 2018 at 15:26)</a>:</h4>
<p>Of course the first proof has no @, we are not fighting mathlib here. The second one is not too bad in my opinion. The statement is clean, because of the "rebinded" definitions, which cost nothing in the proof.</p>

<a name="134316535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134316535" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134316535">Patrick Massot (Sep 20 2018 at 15:27)</a>:</h4>
<p>The main @ thing is the definition of the identity seen as a homeo between different topologies, which costs two slightly awkwards <code>rw show ..., by refl</code>.</p>

<a name="134316601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134316601" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134316601">Patrick Massot (Sep 20 2018 at 15:28)</a>:</h4>
<p>What do you guys think about all this?</p>

<a name="134316684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134316684" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134316684">Mario Carneiro (Sep 20 2018 at 15:29)</a>:</h4>
<p>I think the identity homeo should be a theorem</p>

<a name="134316753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134316753" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134316753">Patrick Massot (Sep 20 2018 at 15:30)</a>:</h4>
<p>Stating what?</p>

<a name="134316771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134316771" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134316771">Mario Carneiro (Sep 20 2018 at 15:30)</a>:</h4>
<p>just like the theorem that identity is continuous iff the topologies are le, the identity is a homeo iff the topologies are eq</p>

<a name="134316811"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134316811" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134316811">Patrick Massot (Sep 20 2018 at 15:31)</a>:</h4>
<p>This bundled definition of a homeo doesn't seem so nice when it comes to stating that some map is a homeo</p>

<a name="134316836"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134316836" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134316836">Mario Carneiro (Sep 20 2018 at 15:31)</a>:</h4>
<p>this is true. Maybe settle for one direction, the one you proved</p>

<a name="134316920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134316920" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134316920">Mario Carneiro (Sep 20 2018 at 15:33)</a>:</h4>
<p>The reverse direction says that if <code>f : homeo A A T1 T2</code> and <code>f x = x</code> for all <code>x</code>, then <code>T1 = T2</code></p>

<a name="134316930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134316930" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134316930">Patrick Massot (Sep 20 2018 at 15:33)</a>:</h4>
<p>So it would be a <code>def</code>, not a <code>lemma</code>, right?</p>

<a name="134316939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134316939" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134316939">Mario Carneiro (Sep 20 2018 at 15:33)</a>:</h4>
<p>yes</p>

<a name="134317018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317018" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317018">Mario Carneiro (Sep 20 2018 at 15:35)</a>:</h4>
<p>After all this refactoring, I would ask whether you really need <code>uniform_continuous_id_of_emb</code> though</p>

<a name="134317045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317045" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317045">Mario Carneiro (Sep 20 2018 at 15:35)</a>:</h4>
<p>we treated it as the endgame but maybe you can avoid le on uniformities to begin with</p>

<a name="134317110"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317110" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317110">Kevin Buzzard (Sep 20 2018 at 15:36)</a>:</h4>
<p>I was wondering the same</p>

<a name="134317111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317111" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317111">Patrick Massot (Sep 20 2018 at 15:36)</a>:</h4>
<p>Of course this is also a legitimate question. But this thread is also used as an exercise in type class hell survival.</p>

<a name="134317153"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317153" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317153">Kevin Buzzard (Sep 20 2018 at 15:37)</a>:</h4>
<p>Patrick's original question was whether the completion of a top group "equalled" (in a mathematician-like way) the completion of the underlying uniform space. But these two completions are just two different types so you could instead ask if they are uniform-equiv, not that this exists.</p>

<a name="134317201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317201" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317201">Kevin Buzzard (Sep 20 2018 at 15:38)</a>:</h4>
<p>On the other hand Johannes, if I recall correctly, put a bunch of stuff in <code>topological_space.lean</code> about different topologies on the same space...</p>

<a name="134317202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317202" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317202">Patrick Massot (Sep 20 2018 at 15:38)</a>:</h4>
<p>What do you mean "different types"?</p>

<a name="134317249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317249" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317249">Kevin Buzzard (Sep 20 2018 at 15:39)</a>:</h4>
<p>Isn't there one "complete-a-group" function which completes a group and spits out one type, and one "complete-a-uniform-space" function which completes a uniform space and spits out a second type? And we think of them as "equal" but they're two different types. That's all I mean, and you know all this already.</p>

<a name="134317315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317315" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317315">Kevin Buzzard (Sep 20 2018 at 15:40)</a>:</h4>
<p>I was wondering if you ever needed to compare two uniformities on the same type, but I don't know the full story</p>

<a name="134317340"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317340" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317340">Patrick Massot (Sep 20 2018 at 15:40)</a>:</h4>
<p>No, there is a complete a uniform space structure, an instance saying that the result has a uniform structure, and there are instances saying that abelian top groups are uniform spaces, and that the completion of a group is a top group</p>

<a name="134317355"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317355" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317355">Patrick Massot (Sep 20 2018 at 15:41)</a>:</h4>
<p>The full story is still at <a href="https://github.com/leanprover-community/mathlib/blob/completions/analysis/topology/group_completion.lean#L124" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/completions/analysis/topology/group_completion.lean#L124">https://github.com/leanprover-community/mathlib/blob/completions/analysis/topology/group_completion.lean#L124</a></p>

<a name="134317382"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317382" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317382">Patrick Massot (Sep 20 2018 at 15:41)</a>:</h4>
<p>and <a href="https://github.com/kbuzzard/lean-perfectoid-spaces/blob/master/src/for_mathlib/group_completion.lean#L118" target="_blank" title="https://github.com/kbuzzard/lean-perfectoid-spaces/blob/master/src/for_mathlib/group_completion.lean#L118">https://github.com/kbuzzard/lean-perfectoid-spaces/blob/master/src/for_mathlib/group_completion.lean#L118</a> of course (maybe with tiny differences)</p>

<a name="134317454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317454" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317454">Patrick Massot (Sep 20 2018 at 15:42)</a>:</h4>
<p>So we really have two uniform space structures on the same type. But of course I wonder whether I could cook up more functions to hide things to the type class system</p>

<a name="134317655"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317655" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317655">Kevin Buzzard (Sep 20 2018 at 15:46)</a>:</h4>
<p>So should that line 124 even make sense?</p>

<a name="134317662"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317662" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317662">Kevin Buzzard (Sep 20 2018 at 15:46)</a>:</h4>
<p>That's what I'm thinking</p>

<a name="134317668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317668" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317668">Kevin Buzzard (Sep 20 2018 at 15:46)</a>:</h4>
<p>Given some top group H</p>

<a name="134317670"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317670" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317670">Kevin Buzzard (Sep 20 2018 at 15:47)</a>:</h4>
<p>there is an associated uniform space which is also H</p>

<a name="134317685"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317685" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317685">Kevin Buzzard (Sep 20 2018 at 15:47)</a>:</h4>
<p>but then isn't there <code>topological_add_group.completion H</code> (one type) and <code>uniform_space.completion H</code> (a different type)?</p>

<a name="134317756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317756" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317756">Kevin Buzzard (Sep 20 2018 at 15:48)</a>:</h4>
<p>And then maybe you prove a theorem saying that two uniform structures are the same</p>

<a name="134317768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317768" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317768">Mario Carneiro (Sep 20 2018 at 15:49)</a>:</h4>
<p>I guess there is a single (uniform) completion operation which additionally has the property that it lifts topological group structure</p>

<a name="134317774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317774" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317774">Kevin Buzzard (Sep 20 2018 at 15:49)</a>:</h4>
<p>right, but should it be like that?</p>

<a name="134317777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317777" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317777">Kevin Buzzard (Sep 20 2018 at 15:49)</a>:</h4>
<p>should the theorem be that there's a uniform space equiv?</p>

<a name="134317778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317778" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317778">Mario Carneiro (Sep 20 2018 at 15:49)</a>:</h4>
<p>Obviously <code>topological_group</code> should have a uniform component so that this can be by defeq</p>

<a name="134317847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317847" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317847">Kevin Buzzard (Sep 20 2018 at 15:50)</a>:</h4>
<blockquote>
<p>Obviously <code>topological_group</code> should have a uniform component</p>
</blockquote>
<p>This is when it gets silly.</p>

<a name="134317853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317853" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317853">Patrick Massot (Sep 20 2018 at 15:50)</a>:</h4>
<p>The theorem that is sorried there has mathematical content, it won't become trivial</p>

<a name="134317857"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317857" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317857">Kevin Buzzard (Sep 20 2018 at 15:50)</a>:</h4>
<p>right</p>

<a name="134317866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317866" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317866">Patrick Massot (Sep 20 2018 at 15:50)</a>:</h4>
<p>So I don't know what Mario wants to see defeq</p>

<a name="134317867"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317867" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317867">Mario Carneiro (Sep 20 2018 at 15:50)</a>:</h4>
<p>of course, the content is shifted to the definition of the topological group</p>

<a name="134317879"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317879" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317879">Kevin Buzzard (Sep 20 2018 at 15:51)</a>:</h4>
<p>Is there no way of making all this sensible?</p>

<a name="134317884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317884" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317884">Mario Carneiro (Sep 20 2018 at 15:51)</a>:</h4>
<p>There are zero cases where you want a topological group with a uniform structure that doesn't agree with it</p>

<a name="134317890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317890" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317890">Kevin Buzzard (Sep 20 2018 at 15:51)</a>:</h4>
<p>It's like the product of metric spaces example, but it's even better, because we don't even have to take a product.</p>

<a name="134317894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317894" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317894">Patrick Massot (Sep 20 2018 at 15:51)</a>:</h4>
<p>Except for non-commutative groups where there are two choices</p>

<a name="134317895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317895" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317895">Kevin Buzzard (Sep 20 2018 at 15:51)</a>:</h4>
<p>rofl</p>

<a name="134317944"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317944" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317944">Patrick Massot (Sep 20 2018 at 15:52)</a>:</h4>
<p>Left uniformity and right uniformity</p>

<a name="134317945"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317945" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317945">Kevin Buzzard (Sep 20 2018 at 15:52)</a>:</h4>
<p>two different uniformities giving the same topology, right?</p>

<a name="134317950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317950" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317950">Patrick Massot (Sep 20 2018 at 15:52)</a>:</h4>
<p>sure</p>

<a name="134317959"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317959" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317959">Kevin Buzzard (Sep 20 2018 at 15:52)</a>:</h4>
<p>Let's cross that bridge when we come to it</p>

<a name="134317960"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317960" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317960">Patrick Massot (Sep 20 2018 at 15:52)</a>:</h4>
<p>I assumed everything was commutative because I aimed for addition in rings</p>

<a name="134317964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317964" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317964">Patrick Massot (Sep 20 2018 at 15:52)</a>:</h4>
<p>and it was complicated enough</p>

<a name="134317967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317967" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317967">Kevin Buzzard (Sep 20 2018 at 15:53)</a>:</h4>
<p>I want to end up in a situation where there are no diamonds. Is this possible?</p>

<a name="134317977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317977" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317977">Mario Carneiro (Sep 20 2018 at 15:53)</a>:</h4>
<p>yes</p>

<a name="134317978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317978" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317978">Kevin Buzzard (Sep 20 2018 at 15:53)</a>:</h4>
<p>Given a uniform space I want to be able to complete it</p>

<a name="134317982"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317982" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317982">Patrick Massot (Sep 20 2018 at 15:53)</a>:</h4>
<p>I don't mind seeing the uniform structure as part of the abelian top group</p>

<a name="134317985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317985" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317985">Mario Carneiro (Sep 20 2018 at 15:53)</a>:</h4>
<p>I assume you mean the diamonds commute by defeq</p>

<a name="134317987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134317987" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134317987">Kevin Buzzard (Sep 20 2018 at 15:53)</a>:</h4>
<p>yes</p>

<a name="134318005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318005" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318005">Kevin Buzzard (Sep 20 2018 at 15:53)</a>:</h4>
<p>What I was thinking is that the group completion should have a different name.</p>

<a name="134318006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318006" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318006">Patrick Massot (Sep 20 2018 at 15:53)</a>:</h4>
<p>But I don't see how this will help when proving the actual theorem, even if this proof is now part of the construction of the top group instance</p>

<a name="134318053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318053" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318053">Kevin Buzzard (Sep 20 2018 at 15:54)</a>:</h4>
<p>this is not supposed to help proving the theorem</p>

<a name="134318059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318059" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318059">Kevin Buzzard (Sep 20 2018 at 15:54)</a>:</h4>
<p>yes I was just wondering about how to make the theorem part of the infrastructure. Is this just clear to both of you?</p>

<a name="134318060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318060" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318060">Patrick Massot (Sep 20 2018 at 15:54)</a>:</h4>
<p>I mean help in the Lean sense, not maths sense</p>

<a name="134318076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318076" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318076">Patrick Massot (Sep 20 2018 at 15:54)</a>:</h4>
<p>Nothing is clear to me here (except the proof I see on paper in front of me)</p>

<a name="134318084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318084" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318084">Kevin Buzzard (Sep 20 2018 at 15:54)</a>:</h4>
<p>I want to give the top group completion a different name, make it a different type to the uniform space completion</p>

<a name="134318110"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318110" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318110">Kevin Buzzard (Sep 20 2018 at 15:55)</a>:</h4>
<p>hmm but it still has to be a top group</p>

<a name="134318113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318113" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318113">Mario Carneiro (Sep 20 2018 at 15:55)</a>:</h4>
<p>It will make that <code>same_uniformity</code> theorem true by defeq, so you won't have to muck about with rewriting instance arguments</p>

<a name="134318165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318165" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318165">Mario Carneiro (Sep 20 2018 at 15:56)</a>:</h4>
<p>But it's true that the theorem still has to be proved, and it is an equality of uniformities</p>

<a name="134318169"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318169" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318169">Kevin Buzzard (Sep 20 2018 at 15:56)</a>:</h4>
<p>top groups and uniform spaces -- they are going to be classes, right? Let's make that assumption</p>

<a name="134318172"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318172" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318172">Mario Carneiro (Sep 20 2018 at 15:56)</a>:</h4>
<p>yes, are they not already?</p>

<a name="134318173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318173" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318173">Kevin Buzzard (Sep 20 2018 at 15:56)</a>:</h4>
<p>And there's always going to be an instance from top group to uniform space, right?</p>

<a name="134318174"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318174" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318174">Mario Carneiro (Sep 20 2018 at 15:56)</a>:</h4>
<p>right</p>

<a name="134318184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318184" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318184">Patrick Massot (Sep 20 2018 at 15:56)</a>:</h4>
<p>but it may be generated by <code>extends</code></p>

<a name="134318198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318198" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318198">Mario Carneiro (Sep 20 2018 at 15:57)</a>:</h4>
<p>?</p>

<a name="134318208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318208" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318208">Kevin Buzzard (Sep 20 2018 at 15:57)</a>:</h4>
<p>and will a top group definitely have a uniformity component?</p>

<a name="134318215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318215" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318215">Kevin Buzzard (Sep 20 2018 at 15:57)</a>:</h4>
<p>so the instance is a forgetful functor?</p>

<a name="134318219"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318219" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318219">Patrick Massot (Sep 20 2018 at 15:57)</a>:</h4>
<p>If <code>class top_group extends uniform_space</code></p>

<a name="134318222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318222" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318222">Mario Carneiro (Sep 20 2018 at 15:57)</a>:</h4>
<p>right</p>

<a name="134318225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318225" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318225">Kevin Buzzard (Sep 20 2018 at 15:57)</a>:</h4>
<p>But with the completion construction</p>

<a name="134318230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318230" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318230">Kevin Buzzard (Sep 20 2018 at 15:57)</a>:</h4>
<p>you can insert the theorem into the construction, can you not?</p>

<a name="134318236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318236" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318236">Mario Carneiro (Sep 20 2018 at 15:57)</a>:</h4>
<p>yes, that's the idea</p>

<a name="134318239"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318239" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318239">Kevin Buzzard (Sep 20 2018 at 15:57)</a>:</h4>
<p>right</p>

<a name="134318313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318313" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318313">Kevin Buzzard (Sep 20 2018 at 15:59)</a>:</h4>
<p>so the top group completion <em>must</em> have the "uniform space generated by the top group structure" uniform space</p>

<a name="134318321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318321" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318321">Patrick Massot (Sep 20 2018 at 15:59)</a>:</h4>
<p>So the gain would be when I wanted to use the <code>same_uniformity</code> theorem, in <a href="https://github.com/leanprover-community/mathlib/blob/completions/analysis/topology/group_completion.lean#L161" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/completions/analysis/topology/group_completion.lean#L161">https://github.com/leanprover-community/mathlib/blob/completions/analysis/topology/group_completion.lean#L161</a> not when I want to prove it</p>

<a name="134318401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318401" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318401">Mario Carneiro (Sep 20 2018 at 16:00)</a>:</h4>
<p>yes</p>

<a name="134318406"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318406" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318406">Patrick Massot (Sep 20 2018 at 16:00)</a>:</h4>
<p>sounds very good</p>

<a name="134318411"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318411" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318411">Kevin Buzzard (Sep 20 2018 at 16:00)</a>:</h4>
<p>I think I'm there</p>

<a name="134318434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318434" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318434">Patrick Massot (Sep 20 2018 at 16:01)</a>:</h4>
<p>Kevin, do you want to know why we need this theorem? It's easy to explain</p>

<a name="134318451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318451" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318451">Patrick Massot (Sep 20 2018 at 16:01)</a>:</h4>
<p>Mario, the trouble is I tried to do this "top_group extends uniform space" trick after the Orsay meeting but couldn't handle everything that broke when I started</p>

<a name="134318512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318512" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318512">Kevin Buzzard (Sep 20 2018 at 16:03)</a>:</h4>
<p>I can see for maths reasons why we want to prove the two uniformities are equal.</p>

<a name="134318529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318529" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318529">Kevin Buzzard (Sep 20 2018 at 16:03)</a>:</h4>
<p>What I was thinking about was how all this could play well with the type class system.</p>

<a name="134318544"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318544" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318544">Kevin Buzzard (Sep 20 2018 at 16:03)</a>:</h4>
<p>That is exactly why I changed your beta,beta to beta,gamma, because then the theorem you were struggling on suddenly seemed much easier</p>

<a name="134318545"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318545" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318545">Patrick Massot (Sep 20 2018 at 16:03)</a>:</h4>
<p>ok, we're on the same page</p>

<a name="134318717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318717" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318717">Kevin Buzzard (Sep 20 2018 at 16:06)</a>:</h4>
<p>but if topological_group extends uniform_space (I don't know if it does or if it should) then we have to be careful, but it sounds like it's OK. I guess it doesn't matter whether it extends or not -- you probably still want an instance. Eew. Is top group -&gt; uniform space -&gt; top space defeq to top group -&gt; top space?</p>

<a name="134318744"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318744" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318744">Patrick Massot (Sep 20 2018 at 16:06)</a>:</h4>
<p>Yes, I made sure this is true back in June</p>

<a name="134318765"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318765" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318765">Kevin Buzzard (Sep 20 2018 at 16:07)</a>:</h4>
<p>It's ridiculous that this sort of thing is important. I think the system is not quite fit for purpose.</p>

<a name="134318790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318790" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318790">Patrick Massot (Sep 20 2018 at 16:07)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/blob/completions/analysis/topology/topological_structures.lean#L353" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/completions/analysis/topology/topological_structures.lean#L353">https://github.com/leanprover-community/mathlib/blob/completions/analysis/topology/topological_structures.lean#L353</a></p>

<a name="134318805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318805" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318805">Kevin Buzzard (Sep 20 2018 at 16:07)</a>:</h4>
<p>I'm with Chris. He had trouble with two instances which were provably equivalent but not defeq. There should be a way to make this work by brandishing a theorem at the type class inference system and saying "use this if stuck"</p>

<a name="134318890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318890" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318890">Patrick Massot (Sep 20 2018 at 16:09)</a>:</h4>
<blockquote>
<p>just like the theorem that identity is continuous iff the topologies are le</p>
</blockquote>
<p>Do we actually have this theorem in mathlib? I can't find it</p>

<a name="134318891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318891" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318891">Kevin Buzzard (Sep 20 2018 at 16:09)</a>:</h4>
<p>It would be wonderful if the default setting was "if it's a class, then you will have one instance and that's the end of it. If there are two instances, then you had better supply the proof that they're the same"</p>

<a name="134318900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134318900" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134318900">Kevin Buzzard (Sep 20 2018 at 16:09)</a>:</h4>
<p>and you had to explicitly switch this off.</p>

<a name="134319419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134319419" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134319419">Patrick Massot (Sep 20 2018 at 16:18)</a>:</h4>
<p>Let's try to use the existing Lean. <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> what do you suggest I should do? Should I try to refactor everything about commutative additive top groups? Should I start with <code>class topological_abelian_group (α : Type u) extends uniform_space α, add_comm_group α</code>?</p>

<a name="134319450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134319450" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134319450">Patrick Massot (Sep 20 2018 at 16:18)</a>:</h4>
<p>and then prove an instance converting this to the existing topological group classes?</p>

<a name="134320701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134320701" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134320701">Kevin Buzzard (Sep 20 2018 at 16:39)</a>:</h4>
<p>he'll make you call it <code>topological_add_comm_group</code></p>

<a name="134321783"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134321783" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134321783">Mario Carneiro (Sep 20 2018 at 16:57)</a>:</h4>
<p>I'm okay with saying <code>top</code> instead of <code>topological</code></p>

<a name="134321834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134321834" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134321834">Mario Carneiro (Sep 20 2018 at 16:58)</a>:</h4>
<p>exactly because you want to stack adjectives like this</p>

<a name="134324250"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134324250" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134324250">Patrick Massot (Sep 20 2018 at 17:39)</a>:</h4>
<p>What about my question?</p>

<a name="134325399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134325399" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134325399">Mario Carneiro (Sep 20 2018 at 17:56)</a>:</h4>
<p>I hate to answer a question like that with yes, but yes</p>

<a name="134325445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134325445" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134325445">Mario Carneiro (Sep 20 2018 at 17:57)</a>:</h4>
<p>then again, I think <span class="user-mention" data-user-id="110294">@Johannes Hölzl</span> had a part in the original formulation so maybe he should say something here</p>

<a name="134325826"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134325826" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134325826">Patrick Massot (Sep 20 2018 at 18:02)</a>:</h4>
<blockquote>
<p>I hate to answer a question like that with yes, but yes</p>
</blockquote>
<p>What would you prefer?</p>

<a name="134326342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134326342" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134326342">Mario Carneiro (Sep 20 2018 at 18:11)</a>:</h4>
<p>what you said: a class <code>top_add_comm_group</code> that extends <code>uniform_space</code> and <code>add_comm_group</code></p>

<a name="134377971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134377971" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134377971">Patrick Massot (Sep 21 2018 at 13:32)</a>:</h4>
<p>I tried various things today, but clearly I'm not doing it right. Recall I defined the Hausdorff completion functor in <a href="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/master/src/for_mathlib/completion.lean" target="_blank" title="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/master/src/for_mathlib/completion.lean">https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/master/src/for_mathlib/completion.lean</a> I also defined a uniform structure on commutative topological groups in <a href="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/master/src/for_mathlib/topological_structures.lean#L109" target="_blank" title="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/master/src/for_mathlib/topological_structures.lean#L109">https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/master/src/for_mathlib/topological_structures.lean#L109</a>, and wanted to get a group completion functor. For this it seems we need closer integration of topological groups and uniform structures. I made a first attempt at <a href="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/e44b49e7bd9f77f59246f725cc38bf879c2af50f/src/for_mathlib/top_groups.lean" target="_blank" title="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/e44b49e7bd9f77f59246f725cc38bf879c2af50f/src/for_mathlib/top_groups.lean">https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/e44b49e7bd9f77f59246f725cc38bf879c2af50f/src/for_mathlib/top_groups.lean</a> There I have an axiom relating a uniform structure and a group structure, but the uniform structure is a parameter. There are only two sorries in that file, and the completion stuff is available right from the beginning, seemingly without diamond issue. However I'd like a way to produce a <code>top_add_comm_group</code> from a topological space structure and a group structure, building the uniform space structure automatically using a version of my previous unbundled work. I don't see how to do that. Then I tried <a href="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/master/src/for_mathlib/top_groups.lean" target="_blank" title="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/master/src/for_mathlib/top_groups.lean">https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/master/src/for_mathlib/top_groups.lean</a> where the only parameter of <code>top_add_comm_group</code> is the carrier type. But then I had to setup much more wrapping around my completion stuff, and <a href="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/master/src/for_mathlib/top_groups.lean#L45" target="_blank" title="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/master/src/for_mathlib/top_groups.lean#L45">https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/master/src/for_mathlib/top_groups.lean#L45</a> completely fails. I really need help from <span class="user-mention" data-user-id="110294">@Johannes Hölzl</span>  or <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> in order to now which attempt (if any) goes in the right direction.</p>

<a name="134391084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134391084" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134391084">Johannes Hölzl (Sep 21 2018 at 17:13)</a>:</h4>
<p>I'm taking a look at it</p>

<a name="134432236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134432236" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134432236">Johannes Hölzl (Sep 22 2018 at 10:48)</a>:</h4>
<p>Do you need <code>topological_add_group</code> in your definition of <code>top_add_comm_group</code>? Shouldn't <code>topological_add_group</code> be derived from <code>unif_group</code>?</p>

<a name="134434646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134434646" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134434646">Patrick Massot (Sep 22 2018 at 11:44)</a>:</h4>
<p>You're probably right</p>

<a name="134434933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134434933" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134434933">Johannes Hölzl (Sep 22 2018 at 11:53)</a>:</h4>
<p>I forked your repo: <a href="https://github.com/johoelzl/lean-perfectoid-spaces" target="_blank" title="https://github.com/johoelzl/lean-perfectoid-spaces">https://github.com/johoelzl/lean-perfectoid-spaces</a></p>

<a name="134434980"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134434980" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134434980">Johannes Hölzl (Sep 22 2018 at 11:54)</a>:</h4>
<p>So in <code>top_groups</code> you need to prove that the group is a group, and then that the uniformity fits</p>

<a name="134435010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134435010" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134435010">Johannes Hölzl (Sep 22 2018 at 11:55)</a>:</h4>
<p>first we need to show that <code>-</code> and <code>+</code> are (uniform) continuous, and reduce to <code>-</code>, <code>+</code> on <code>G</code> under <code>to_completion</code>. Then we can proof the group properties by the embedding along <code>to_completion</code>.</p>

<a name="134435042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134435042" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134435042">Johannes Hölzl (Sep 22 2018 at 11:56)</a>:</h4>
<p>is this what you expected or do you want something different?</p>

<a name="134435676"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134435676" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134435676">Patrick Massot (Sep 22 2018 at 12:19)</a>:</h4>
<p>I want to be able to manipulate topological groups and their completions. The mathematical story is extremely clear, and I already formalized large parts of it, but they don't want to fit together. Have you seen my two recent attempts? There are successive commits. The older attempts are in neighboring files. Would you like me to LaTeX the math story?</p>

<a name="134435734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134435734" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134435734">Johannes Hölzl (Sep 22 2018 at 12:21)</a>:</h4>
<p>I think LaTeX is not yet necessary. But what kind of manipulations do you want to make?</p>

<a name="134435834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134435834" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134435834">Patrick Massot (Sep 22 2018 at 12:24)</a>:</h4>
<p>The same thing we want from the beginning: a completion functor, left adjoint to the inclusion of complete hausdorff group into all topological groups. That's all!</p>

<a name="134435843"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134435843" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134435843">Patrick Massot (Sep 22 2018 at 12:25)</a>:</h4>
<p>We do have it for uniform space, in my <code>completion.lean</code></p>

<a name="134435897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134435897" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134435897">Johannes Hölzl (Sep 22 2018 at 12:26)</a>:</h4>
<p>hm, this is a little bit too far for me. but you are currently stuck in proving that the completion of a topological group (with the induced uniformity) is again a group. This is what I see in <code>top_groups</code>. is this correct?</p>

<a name="134435910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134435910" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134435910">Johannes Hölzl (Sep 22 2018 at 12:27)</a>:</h4>
<p>or did you just <code>sorry</code> this part, because you wanted to see how this way works for later proofs?</p>

<a name="134436031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134436031" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134436031">Patrick Massot (Sep 22 2018 at 12:30)</a>:</h4>
<p>The key fact is we start with a completion which is a universal solution to the problem of factoring maps into complete hausdorff spaces:</p>
<ul>
<li><a href="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/completion.lean#L51" target="_blank" title="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/completion.lean#L51">https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/completion.lean#L51</a></li>
<li><a href="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/completion.lean#L132" target="_blank" title="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/completion.lean#L132">https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/completion.lean#L132</a></li>
<li><a href="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/completion.lean#L157" target="_blank" title="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/completion.lean#L157">https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/completion.lean#L157</a></li>
<li><a href="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/completion.lean#L171" target="_blank" title="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/completion.lean#L171">https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/completion.lean#L171</a><br>
Then the action of the completion functor on maps comes for free: <a href="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/completion.lean#L144" target="_blank" title="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/completion.lean#L144">https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/completion.lean#L144</a></li>
</ul>
<p>When moving to topological groups, we want all those maps to be group morphisms. It looks like extending operation by continuity and running the same abstract non-sense will do it without any work. But when you think about how to prove that <code>completion.map f</code> is a group morphisms you see you need commutation of the two constructions (from top group to uniform space and from uniform space to completion)</p>

<a name="134436032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134436032" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134436032">Johannes Hölzl (Sep 22 2018 at 12:30)</a>:</h4>
<p>so what I propose is:</p>
<ul>
<li>we get obviously that <code>group_completion G</code> is a complete, separated uniformity (and everything we know about them). This is a couple of instances.</li>
<li>then we proof that it is a <code>group</code>. This requires some work, we need to lift the group operations and show that they are uniform and invariant under coerion</li>
</ul>

<a name="134436086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134436086" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134436086">Patrick Massot (Sep 22 2018 at 12:32)</a>:</h4>
<p>I did all that in my first attempt in <a href="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/topological_structures.lean" target="_blank" title="https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/topological_structures.lean">https://github.com/PatrickMassot/lean-perfectoid-spaces/blob/completions/src/for_mathlib/topological_structures.lean</a></p>

<a name="134436096"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134436096" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134436096">Patrick Massot (Sep 22 2018 at 12:33)</a>:</h4>
<p>But then the last instance fail completely because of the diamond issue, and even sorrying an equality of uniform structures didn't help because I couldn't manage rewriting instances</p>

<a name="134436140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134436140" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134436140">Patrick Massot (Sep 22 2018 at 12:34)</a>:</h4>
<p>I'm sorry I need to take care of my family. But in any case I don't think this problem can be solved without investing some time into reading my various attempts</p>

<a name="134436141"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134436141" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134436141">Patrick Massot (Sep 22 2018 at 12:34)</a>:</h4>
<p>Thank you very much for trying to help me</p>

<a name="134436154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134436154" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134436154">Kevin Buzzard (Sep 22 2018 at 12:35)</a>:</h4>
<p>I am of course actively interested in making all this work so let me know if I can help somehow.</p>

<a name="134446757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134446757" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134446757">Johannes Hölzl (Sep 22 2018 at 18:07)</a>:</h4>
<p>So it turns out that <code>top_add_comm_group</code> is equivalent to <code>uniform_add_group</code>. From <code>uniform_add_group</code> we can derive <code>uniformity = comap (λx:α×α, x.2 - x.1) (nhds (0:α))</code>.</p>
<p>so the only complicated lift is the group structure itself</p>

<a name="134515389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134515389" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134515389">Patrick Massot (Sep 24 2018 at 09:27)</a>:</h4>
<p><span class="user-mention" data-user-id="110294">@Johannes Hölzl</span> I see you made some progress in your fork. Are you still working on this? Or do you think I should try to copy your work and try to proceed?</p>

<a name="134515432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134515432" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134515432">Johannes Hölzl (Sep 24 2018 at 09:28)</a>:</h4>
<p>I didn't continue on this yet. But I want to continue today</p>

<a name="134515457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134515457" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134515457">Patrick Massot (Sep 24 2018 at 09:29)</a>:</h4>
<p>In particular, does it mean you think that the definition of <code>top_add_comm_group</code> is the correct starting point, and wrapping the completion stuff in <code>group_completion</code> is the right thing to do?</p>

<a name="134515513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134515513" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134515513">Patrick Massot (Sep 24 2018 at 09:30)</a>:</h4>
<p>Ok, great. I'll wait and see then</p>

<a name="134515522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134515522" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134515522">Johannes Hölzl (Sep 24 2018 at 09:30)</a>:</h4>
<p>But I think I will take a look again at your <code>completion</code> branch in <code>leanprover-community</code>.</p>

<a name="134515619"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134515619" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134515619">Johannes Hölzl (Sep 24 2018 at 09:33)</a>:</h4>
<p>I think <code>top_add_comm_group</code> is not necessary. I think <code>uniform_add_group</code> can also be used instead of it.</p>

<a name="134515669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134515669" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134515669">Johannes Hölzl (Sep 24 2018 at 09:34)</a>:</h4>
<p>But if you want you can finish the proofs in <code>top_groups.lean</code>. In the meantime I look at your <code>completion</code> branch and try to bring it up to current <code>mathlib</code> and see how I want to merge it. What do you think about this?</p>

<a name="134515861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134515861" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134515861">Patrick Massot (Sep 24 2018 at 09:38)</a>:</h4>
<p>I still don't understand what is <code>uniform_add_group</code> This notion doesn't exist in real world maths, and it seems equivalent to topological groups, at least in the communtative case. What's the point?</p>

<a name="134516035"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134516035" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134516035">Johannes Hölzl (Sep 24 2018 at 09:43)</a>:</h4>
<p>The difference is just that <code>topological_add_group</code> doesn't know about its uniformity. So I called the type class which requires the uniformity <code>uniform_add_group</code>. We can change <code>topological_add_group</code> to require an uniform space, and change the axiom to assume that <code>-</code> is uniformly continuous.</p>

<a name="134516077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134516077" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134516077">Johannes Hölzl (Sep 24 2018 at 09:44)</a>:</h4>
<p>The difference to <code>top_add_comm_group</code> will be that <code>topological_add_group</code> is still unbundled.</p>

<a name="134516170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134516170" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134516170">Patrick Massot (Sep 24 2018 at 09:46)</a>:</h4>
<p>I don't understand. What is unbundled?</p>

<a name="134516284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134516284" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134516284">Johannes Hölzl (Sep 24 2018 at 09:49)</a>:</h4>
<p>Okay, <strong>bundled</strong> is not the right word in this context. What I mean is that <code>topological_add_group</code> has the topology and the group structure as <strong>parameter</strong>. <code>top_add_group</code> has it as the uniformity and its group as fields in its structure.</p>

<a name="134516888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134516888" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134516888">Patrick Massot (Sep 24 2018 at 10:03)</a>:</h4>
<p>I'm sorry this conversation is not smoother, but my youngest daughter is sick, and I have to take care of her</p>

<a name="134516966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134516966" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134516966">Patrick Massot (Sep 24 2018 at 10:05)</a>:</h4>
<p>The point of the "bundled" version was to try to make sure the work of proving the uniform structure compatibility in group completions would be hidden in the instance building, and would never be an issue afterwards</p>

<a name="134517026"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134517026" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134517026">Patrick Massot (Sep 24 2018 at 10:06)</a>:</h4>
<p>But of course this version needs a constructor which only takes group law axioms, a topology and a bunch of continuity proofs, in the same way as a metric space can be constructed from a distance without providing a uniformity</p>

<a name="134517460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134517460" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134517460">Johannes Hölzl (Sep 24 2018 at 10:15)</a>:</h4>
<p>I will see how much of the actual construction can be hidden. Also, note that I will rebase your <code>completions</code> branch in <code>leanprover-community</code> after lunch. I hope you don't have any local changes</p>

<a name="134517551"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134517551" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134517551">Patrick Massot (Sep 24 2018 at 10:16)</a>:</h4>
<p>It's a bit of a mess that this work is somewhat split between this mathlib branch and the prefectoid repository, but I think the only substantial difference is the new <code>top_groups.lean</code> in the perfectoid repository, so you can work on the community mathlib branch</p>

<a name="134522077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134522077" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134522077">Patrick Massot (Sep 24 2018 at 12:08)</a>:</h4>
<p>I worked a bit, see <a href="https://github.com/johoelzl/lean-perfectoid-spaces/compare/master...PatrickMassot:master" target="_blank" title="https://github.com/johoelzl/lean-perfectoid-spaces/compare/master...PatrickMassot:master">https://github.com/johoelzl/lean-perfectoid-spaces/compare/master...PatrickMassot:master</a> I unsorried the <code>add_comm_group</code> structure by porting my previous work. Hopefully this could save you some time. This required adding a couple of lemmas first. I tried to follow the mathlib convention in naming <code>group_completion.continuous_add</code> and <code>group_completion.continuous_add'</code> but I noticed you didn't. Also, I shortened the name since it's all in the <code>group_completion</code> namespace, but since the purely topological <code>continuous_add</code> is in root namespace, it's a but of a mess. Hopefully all this will be much simpler in the end</p>

<a name="134522483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134522483" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134522483">Johannes Hölzl (Sep 24 2018 at 12:18)</a>:</h4>
<p>Thanks! I'm currently reorganizing <code>uniform_space.lean</code> and move the separated quotient type and <code>Cauchy</code> to <code>completions.lean</code>.</p>

<a name="134522579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134522579" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134522579">Patrick Massot (Sep 24 2018 at 12:21)</a>:</h4>
<p>Great!</p>

<a name="134522595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134522595" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134522595">Patrick Massot (Sep 24 2018 at 12:21)</a>:</h4>
<p>I'm very excited and grateful to get some help here</p>

<a name="134524646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134524646" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134524646">Patrick Massot (Sep 24 2018 at 13:02)</a>:</h4>
<p>Also note that the proofs in <a href="https://github.com/johoelzl/lean-perfectoid-spaces/blob/fa721c6aa863c79b22ce463358c2b616c413e38c/src/for_mathlib/top_groups.lean#L194" target="_blank" title="https://github.com/johoelzl/lean-perfectoid-spaces/blob/fa721c6aa863c79b22ce463358c2b616c413e38c/src/for_mathlib/top_groups.lean#L194">https://github.com/johoelzl/lean-perfectoid-spaces/blob/fa721c6aa863c79b22ce463358c2b616c413e38c/src/for_mathlib/top_groups.lean#L194</a> are not as abstract as we'd like them to be. Ideally they would all follow from things like <a href="https://github.com/leanprover-community/mathlib/blob/a5da4d5acccc9910d921cfadb2c8e4cce59e1d80/analysis/topology/completion.lean#L726" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/a5da4d5acccc9910d921cfadb2c8e4cce59e1d80/analysis/topology/completion.lean#L726">https://github.com/leanprover-community/mathlib/blob/a5da4d5acccc9910d921cfadb2c8e4cce59e1d80/analysis/topology/completion.lean#L726</a>. So all topological argument would ultimately be in <a href="https://github.com/leanprover-community/mathlib/blob/a5da4d5acccc9910d921cfadb2c8e4cce59e1d80/analysis/topology/completion.lean#L552" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/a5da4d5acccc9910d921cfadb2c8e4cce59e1d80/analysis/topology/completion.lean#L552">https://github.com/leanprover-community/mathlib/blob/a5da4d5acccc9910d921cfadb2c8e4cce59e1d80/analysis/topology/completion.lean#L552</a>, as they should be. But the trouble is that group axioms in mathlib are stated as equalities between elements, instead of functions. So a lot of packing and unpacking would be required. I hesitated to setup all this, with a new group structure constructor inspired by <a href="https://en.wikipedia.org/wiki/Universal_algebra" target="_blank" title="https://en.wikipedia.org/wiki/Universal_algebra">universal algebra</a> but I preferred to move on.</p>

<a name="134615079"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134615079" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134615079">Johannes Hölzl (Sep 25 2018 at 17:53)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> I moved now most of the completion stiff to its own lean theory <code>analysis.topology.completion</code>. I added the group completion instances to the <code>completion</code> type itself. I guess this makes sense.<br>
the only thing missing is a nice setup for topological groups, where one only needs to define the zero nighbourhood and get a topological group, or where one proofs that we have a topological group and get the uniformity. This is currently in <code>analysis/topology/topological_groups</code> but needs to be restructured.</p>

<a name="134619925"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134619925" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134619925">Patrick Massot (Sep 25 2018 at 19:05)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="110294">@Johannes Hölzl</span> It all looks nice, except that I still don't know what we are talking about. What is this theory of <code>uniform_add_group</code>? Is this meant to be only an intermediate definition? Is the missing piece the piece were you make connection with topological groups as they are defined in math books?</p>

<a name="134620301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134620301" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134620301">Patrick Massot (Sep 25 2018 at 19:10)</a>:</h4>
<p>Also, I'm confused about when the diamond problem will return to hit us. The fact that the group uniform structure on the completion of a group is the completion of the group uniform structure is a non-empty mathematical content. In my approach it seemed necessary in order to get a functorial group completion. Where will this be needed in your way of building the theory?</p>

<a name="134620397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134620397" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134620397">Johannes Hölzl (Sep 25 2018 at 19:12)</a>:</h4>
<p><code>uniform_add_group</code> is a technical device. I don't want to force each appearance of a topological group to be a uniform space. That's why it is split into a <code>topological_add_group</code> (topology + group) and <code>uniform_add_group</code> (uniformity + group). We know also that we can derive a canonical uniform space for a topological group, but this is not setup as a type class instance.</p>

<a name="134620466"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134620466" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134620466">Johannes Hölzl (Sep 25 2018 at 19:13)</a>:</h4>
<p>What is exactly the diamond? We have <code>add_group (completion A)</code> and <code>uniform_space (completion A)</code>. Both have currently only one way to construct them. What are the alternatives?</p>

<a name="134620573"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134620573" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134620573">Patrick Massot (Sep 25 2018 at 19:14)</a>:</h4>
<p><code>topological_add_group.to_uniform_space (completion A) = completion (topological_add_group.to_uniform_space A)</code></p>

<a name="134620584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134620584" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134620584">Patrick Massot (Sep 25 2018 at 19:14)</a>:</h4>
<p>That's a non-empty mathematical result</p>

<a name="134620608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134620608" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134620608">Johannes Hölzl (Sep 25 2018 at 19:15)</a>:</h4>
<p>but <code>topological_add_group.to_uniform_space</code> is currently not in our type class hierarchy</p>

<a name="134620712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134620712" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134620712">Patrick Massot (Sep 25 2018 at 19:16)</a>:</h4>
<p>I don't understand why this theorem can be avoided while constructing the completion functor for commutative topological groups</p>

<a name="134620730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134620730" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134620730">Patrick Massot (Sep 25 2018 at 19:16)</a>:</h4>
<p>It's independent of the discussion of have instances or def</p>

<a name="134621075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134621075" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134621075">Johannes Hölzl (Sep 25 2018 at 19:21)</a>:</h4>
<p>With <code>uniformity_eq_comap_nhds_zero</code> (<a href="https://github.com/leanprover-community/mathlib/blob/completions/analysis/topology/topological_structures.lean#L276" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/completions/analysis/topology/topological_structures.lean#L276">https://github.com/leanprover-community/mathlib/blob/completions/analysis/topology/topological_structures.lean#L276</a>) it should be easy to prove this. In the one direction this is how we define the uniformity, in the other direction we have a <code>uniform_add_group</code> and can use <code>uniformity_eq_comap_nhds_zero</code>.</p>
<p>But maybe I misunderstand the problem. I will try to prove this diamond tomorrow.</p>

<a name="134621323"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134621323" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134621323">Patrick Massot (Sep 25 2018 at 19:25)</a>:</h4>
<p>Ok, thank you very much. I would really love to see the finished thing (including the link with topological groups). I hope I'll be able to learn something from this, since I spend quite a lot of time thinking about more naive (ie. straight from maths books) approaches</p>

<a name="134625736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134625736" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134625736">Patrick Massot (Sep 25 2018 at 20:24)</a>:</h4>
<p>Indeed <code>uniformity_eq_comap_nhds_zero</code> looks like a characterization of the uniform structure that could be very important. The first step of the proof looks like it has nothing to do with groups:</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">johannes_lemma</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">α</span><span class="bp">×</span><span class="n">α</span><span class="o">)}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">},</span>
  <span class="n">uniform_continuous</span> <span class="o">(</span><span class="bp">λ</span><span class="n">p</span><span class="o">:</span><span class="n">α</span><span class="bp">×</span><span class="n">α</span><span class="o">,</span> <span class="n">f</span> <span class="n">p</span><span class="bp">.</span><span class="mi">1</span> <span class="n">p</span><span class="bp">.</span><span class="mi">2</span><span class="o">)</span> <span class="bp">→</span> <span class="n">s</span> <span class="err">∈</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniformity</span> <span class="n">α</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">sets</span> <span class="bp">→</span>
  <span class="bp">∃</span> <span class="n">u</span> <span class="err">∈</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniformity</span> <span class="n">α</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">sets</span><span class="o">,</span> <span class="bp">∀</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="err">∈</span> <span class="n">u</span> <span class="bp">→</span> <span class="o">(</span><span class="n">f</span> <span class="n">a</span> <span class="n">c</span><span class="o">,</span> <span class="n">f</span> <span class="n">b</span> <span class="n">c</span><span class="o">)</span> <span class="err">∈</span> <span class="n">s</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">assume</span> <span class="n">s</span> <span class="n">f</span> <span class="n">hf</span> <span class="n">hs</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">uniform_continuous</span><span class="o">,</span> <span class="n">uniformity_prod_eq_prod</span><span class="o">,</span> <span class="n">tendsto_map&#39;_iff</span><span class="o">,</span> <span class="o">(</span><span class="err">∘</span><span class="o">)]</span> <span class="n">at</span> <span class="n">hf</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">mem_map_sets_iff</span><span class="bp">.</span><span class="mi">1</span> <span class="o">(</span><span class="n">hf</span> <span class="n">hs</span><span class="o">)</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">t</span><span class="o">,</span> <span class="n">ht</span><span class="o">,</span> <span class="n">hts</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">clear</span> <span class="n">hf</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">mem_prod_iff</span><span class="bp">.</span><span class="mi">1</span> <span class="n">ht</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">u</span><span class="o">,</span> <span class="n">hu</span><span class="o">,</span> <span class="n">v</span><span class="o">,</span> <span class="n">hv</span><span class="o">,</span> <span class="n">huvt</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">clear</span> <span class="n">ht</span><span class="o">,</span>
  <span class="n">refine</span> <span class="bp">⟨</span><span class="n">u</span><span class="o">,</span> <span class="n">hu</span><span class="o">,</span> <span class="k">assume</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">hab</span><span class="o">,</span> <span class="n">hts</span> <span class="err">$</span> <span class="o">(</span><span class="n">mem_image</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span> <span class="bp">⟨⟨⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="bp">⟩</span><span class="o">,</span> <span class="bp">⟨</span><span class="n">c</span><span class="o">,</span> <span class="n">c</span><span class="bp">⟩⟩</span><span class="o">,</span> <span class="n">huvt</span> <span class="bp">⟨_</span><span class="o">,</span> <span class="bp">_⟩</span><span class="o">,</span> <span class="bp">_⟩⟩</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hab</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">refl_mem_uniformity</span> <span class="n">hv</span><span class="o">,</span>
  <span class="n">refl</span>
<span class="kn">end</span>
</pre></div>


<p>I don't know what would be a better mathlib name.</p>

<a name="134625920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134625920" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134625920">Patrick Massot (Sep 25 2018 at 20:28)</a>:</h4>
<p>Better statement:</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">johannes_lemma</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">β</span><span class="o">]</span>
<span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">β</span> <span class="bp">×</span> <span class="n">β</span><span class="o">)}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">},</span>
  <span class="n">uniform_continuous</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">p</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">α</span><span class="o">,</span> <span class="n">f</span> <span class="n">p</span><span class="bp">.</span><span class="mi">1</span> <span class="n">p</span><span class="bp">.</span><span class="mi">2</span><span class="o">)</span> <span class="bp">→</span> <span class="n">s</span> <span class="err">∈</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniformity</span> <span class="n">β</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">sets</span> <span class="bp">→</span>
  <span class="bp">∃</span> <span class="n">u</span> <span class="err">∈</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniformity</span> <span class="n">α</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">sets</span><span class="o">,</span> <span class="bp">∀</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="err">∈</span> <span class="n">u</span> <span class="bp">→</span> <span class="o">(</span><span class="n">f</span> <span class="n">a</span> <span class="n">c</span><span class="o">,</span> <span class="n">f</span> <span class="n">b</span> <span class="n">c</span><span class="o">)</span> <span class="err">∈</span> <span class="n">s</span> <span class="o">:=</span>
</pre></div>

<a name="134625951"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134625951" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134625951">Patrick Massot (Sep 25 2018 at 20:29)</a>:</h4>
<p>And I don't change any character from the proof! I love that. Usually when we wrote in real world math: "the same proof shows that..." it's a polite lie</p>

<a name="134626147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134626147" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134626147">Patrick Massot (Sep 25 2018 at 20:32)</a>:</h4>
<p>Of course we can also write this as:</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">johannes_lemma</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">uniform_space</span> <span class="n">β</span><span class="o">]</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span>
<span class="o">:</span> <span class="n">uniform_continuous</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">p</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">α</span><span class="o">,</span> <span class="n">f</span> <span class="n">p</span><span class="bp">.</span><span class="mi">1</span> <span class="n">p</span><span class="bp">.</span><span class="mi">2</span><span class="o">)</span> <span class="bp">→</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">β</span> <span class="bp">×</span> <span class="n">β</span><span class="o">)},</span> <span class="n">s</span> <span class="err">∈</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniformity</span> <span class="n">β</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">sets</span> <span class="bp">→</span>
  <span class="bp">∃</span> <span class="n">u</span> <span class="err">∈</span> <span class="o">(</span><span class="bp">@</span><span class="n">uniformity</span> <span class="n">α</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">sets</span><span class="o">,</span> <span class="bp">∀</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">,</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="err">∈</span> <span class="n">u</span> <span class="bp">→</span> <span class="o">(</span><span class="n">f</span> <span class="n">a</span> <span class="n">c</span><span class="o">,</span> <span class="n">f</span> <span class="n">b</span> <span class="n">c</span><span class="o">)</span> <span class="err">∈</span> <span class="n">s</span>
</pre></div>


<p>Isn't it an <code>iff</code> then?</p>

<a name="134626187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134626187" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134626187">Reid Barton (Sep 25 2018 at 20:33)</a>:</h4>
<p>I'm trying to process the "better statement". Is it essentially saying that if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>:</mo><mi>A</mi><mo>×</mo><mi>A</mi><mo>→</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">f : A \times A \to B</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mrel">:</span><span class="mord mathit">A</span><span class="mbin">×</span><span class="mord mathit">A</span><span class="mrel">→</span><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span> is uniformly continuous, then so is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mo>−</mo><mo separator="true">,</mo><mi>c</mi><mo>)</mo><mo>:</mo><mi>A</mi><mo>→</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">f(-, c) : A \to B</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">−</span><span class="mpunct">,</span><span class="mord mathit">c</span><span class="mclose">)</span><span class="mrel">:</span><span class="mord mathit">A</span><span class="mrel">→</span><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span> for any <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi><mo>∈</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">c \in A</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="base"><span class="mord mathit">c</span><span class="mrel">∈</span><span class="mord mathit">A</span></span></span></span>?</p>

<a name="134626239"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134626239" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134626239">Patrick Massot (Sep 25 2018 at 20:34)</a>:</h4>
<p>I'm also trying to process it</p>

<a name="134626262"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134626262" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134626262">Patrick Massot (Sep 25 2018 at 20:34)</a>:</h4>
<p>But I don't think it means what you wrote</p>

<a name="134626280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134626280" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134626280">Patrick Massot (Sep 25 2018 at 20:35)</a>:</h4>
<p>but you may be right</p>

<a name="134626303"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134626303" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134626303">Reid Barton (Sep 25 2018 at 20:35)</a>:</h4>
<p>Oh no I am not right.</p>

<a name="134626314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134626314" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134626314">Reid Barton (Sep 25 2018 at 20:35)</a>:</h4>
<p>I see. I had the quantifier involving <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">c</span></span></span></span> in the wrong place.</p>

<a name="134626333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134626333" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134626333">Patrick Massot (Sep 25 2018 at 20:36)</a>:</h4>
<p>Yeah, it's a tricky statement</p>

<a name="134626410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134626410" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134626410">Patrick Massot (Sep 25 2018 at 20:37)</a>:</h4>
<p>Still there is an asymmetry between the two A factors, so it's probably not an iff</p>

<a name="134627274"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134627274" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134627274">Patrick Massot (Sep 25 2018 at 20:50)</a>:</h4>
<p>Anyway, this lemma, in its latest version allows to reduce the crucial proof to:</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">uniformity_eq_comap_nhds_zero</span> <span class="o">:</span> <span class="n">uniformity</span> <span class="bp">=</span> <span class="n">comap</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">:</span><span class="n">α</span><span class="bp">×</span><span class="n">α</span><span class="o">,</span> <span class="n">x</span><span class="bp">.</span><span class="mi">2</span> <span class="bp">-</span> <span class="n">x</span><span class="bp">.</span><span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">nhds</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">α</span><span class="o">))</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">nhds_eq_comap_uniformity</span><span class="o">,</span> <span class="n">filter</span><span class="bp">.</span><span class="n">comap_comap_comp</span><span class="o">],</span>
  <span class="n">refine</span> <span class="n">le_antisymm</span> <span class="o">(</span><span class="n">filter</span><span class="bp">.</span><span class="n">map_le_iff_le_comap</span><span class="bp">.</span><span class="mi">1</span> <span class="bp">_</span><span class="o">)</span> <span class="bp">_</span> <span class="bp">;</span> <span class="n">intros</span> <span class="n">s</span> <span class="n">hs</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rcases</span> <span class="n">johannes_lemma</span> <span class="n">uniform_continuous_sub&#39;</span> <span class="n">hs</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">t</span><span class="o">,</span> <span class="n">ht</span><span class="o">,</span> <span class="n">hts</span><span class="bp">⟩</span><span class="o">,</span>
    <span class="n">refine</span> <span class="n">mem_map</span><span class="bp">.</span><span class="mi">2</span> <span class="o">(</span><span class="n">mem_sets_of_superset</span> <span class="n">ht</span> <span class="bp">_</span><span class="o">),</span>
    <span class="n">rintros</span> <span class="bp">⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="bp">⟩</span><span class="o">,</span>
    <span class="n">simpa</span> <span class="o">[</span><span class="n">subset_def</span><span class="o">]</span> <span class="kn">using</span> <span class="n">hts</span> <span class="n">a</span> <span class="n">b</span> <span class="n">a</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rcases</span> <span class="n">johannes_lemma</span> <span class="n">uniform_continuous_add&#39;</span> <span class="n">hs</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">t</span><span class="o">,</span> <span class="n">ht</span><span class="o">,</span> <span class="n">hts</span><span class="bp">⟩</span><span class="o">,</span>
    <span class="n">refine</span> <span class="bp">⟨_</span><span class="o">,</span> <span class="n">ht</span><span class="o">,</span> <span class="bp">_⟩</span><span class="o">,</span>
    <span class="n">rintros</span> <span class="bp">⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">simpa</span> <span class="o">[</span><span class="n">subset_def</span><span class="o">]</span> <span class="kn">using</span> <span class="n">hts</span> <span class="mi">0</span> <span class="o">(</span><span class="n">b</span> <span class="bp">-</span> <span class="n">a</span><span class="o">)</span> <span class="n">a</span> <span class="o">}</span>
<span class="kn">end</span>
</pre></div>

<a name="134627304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134627304" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134627304">Patrick Massot (Sep 25 2018 at 20:51)</a>:</h4>
<p>And I still don't understand the magic trick that seems to have removed the diamond issue (I mean removed from the maths discussion, I'm not even talking about Lean). I guess I'll see it when everything will be in place.</p>

<a name="134627409"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134627409" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134627409">Patrick Massot (Sep 25 2018 at 20:53)</a>:</h4>
<p>I also don't understand at all <a href="https://github.com/leanprover-community/mathlib/commit/85b19e23d45f14a210d0b7491c66477d0c560c9a" target="_blank" title="https://github.com/leanprover-community/mathlib/commit/85b19e23d45f14a210d0b7491c66477d0c560c9a">https://github.com/leanprover-community/mathlib/commit/85b19e23d45f14a210d0b7491c66477d0c560c9a</a> Why did you remove all this? It contains a lot of maths that don't appear anywhere else</p>

<a name="134652519"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134652519" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134652519">Johannes Hölzl (Sep 26 2018 at 07:41)</a>:</h4>
<p>Urgs, I removed the wrong file.</p>

<a name="134697940"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134697940" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134697940">Patrick Massot (Sep 26 2018 at 19:39)</a>:</h4>
<p><span class="user-mention" data-user-id="110294">@Johannes Hölzl</span> Did you try to go from <code>topological_add_group</code> to the completion and still get everything?</p>

<a name="134698069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134698069" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134698069">Mario Carneiro (Sep 26 2018 at 19:41)</a>:</h4>
<p>(deleted)</p>

<a name="134698176"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134698176" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134698176">Reid Barton (Sep 26 2018 at 19:43)</a>:</h4>
<p>Mario did you just respond to a question asked on the wrong topic with an answer posted on the wrong stream</p>

<a name="134698232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134698232" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134698232">Mario Carneiro (Sep 26 2018 at 19:44)</a>:</h4>
<p>yes. yes I did.</p>

<a name="134698240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134698240" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134698240">Patrick Massot (Sep 26 2018 at 19:44)</a>:</h4>
<p>This topic was only distantly related to separation stuff anyway</p>

<a name="134698271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134698271" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134698271">Patrick Massot (Sep 26 2018 at 19:44)</a>:</h4>
<p>Somehow, deep down, I guess we miss Gitter's mess</p>

<a name="134698719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134698719" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134698719">Patrick Massot (Sep 26 2018 at 19:52)</a>:</h4>
<p>The stuff about group topologies generated from a neighborhood filter around zero will probably be very convenient for the perfectoid project, which  uses adic topology</p>

<a name="134699310"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134699310" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134699310">Johannes Hölzl (Sep 26 2018 at 20:00)</a>:</h4>
<p>I didn't work yet on the diamond, I got side tracked by the topological space construction</p>

<a name="134699347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134699347" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134699347">Patrick Massot (Sep 26 2018 at 20:01)</a>:</h4>
<p>Ok, I understand.</p>

<a name="134731658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/Separation%20stuff/near/134731658" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/94495Separationstuff.html#134731658">Johannes Hölzl (Sep 27 2018 at 08:58)</a>:</h4>
<p>I added now <code>topological_add_comm_group.to_uniform_space_eq</code>. It doesn't look to be directly a diamond. The reason is the following:<br>
For <code>completion α</code> to be a group, we already need to know that <code>α</code> has a uniform space, and that the group structure is compatible with this uniformity (i.e. <code>uniform_add_group</code>).</p>
<p>A diamond would mean we have <code>group_to_uniform ∘ completion = completion ∘group_to_uniform</code>. But <code>completion</code> doesn't work on groups without the uniformity. So we actually have <code>group_to_uniform ∘ completion ∘group_to_uniform = completion ∘group_to_uniform</code>. Now it is enough to prove <code>group_to_uniform ∘ G = G</code>, where <code>G</code> is already a group with compatible uniformity.</p>


{% endraw %}
