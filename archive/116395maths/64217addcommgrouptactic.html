---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/116395maths/64217addcommgrouptactic.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/116395maths/index.html">maths</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html">add_comm_group tactic</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="131120526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131120526" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131120526">Patrick Massot (Aug 08 2018 at 17:09)</a>:</h4>
<p>Could we get a scaled down <code>ring</code> tactic handling <code>add_comm_group</code>? My current goal is <code>φ (x', y') - φ (x, y) =   φ (x', y₁) - φ (x, y₁) + (φ (x', y') - φ (x', y₁) - (φ (x, y') - φ (x, y₁))) + (φ (x₁, y') - φ (x₁, y)) + (φ (x, y') - φ (x, y) - (φ (x₁, y') - φ (x₁, y)))</code> and I can't face proving it by hand</p>

<a name="131120596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131120596" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131120596">Mario Carneiro (Aug 08 2018 at 17:10)</a>:</h4>
<p>it's on the todo list</p>

<a name="131120597"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131120597" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131120597">Patrick Massot (Aug 08 2018 at 17:10)</a>:</h4>
<p>(this is a generalization of the thing I called a <code>ring</code> bug the other day because I forgot to tell Lean rings are commutative)</p>

<a name="131120730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131120730" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131120730">Kevin Buzzard (Aug 08 2018 at 17:13)</a>:</h4>
<p>Why not put a ring structure on your group? ;-)</p>

<a name="131120750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131120750" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131120750">Kevin Buzzard (Aug 08 2018 at 17:13)</a>:</h4>
<p>I think once someone showed me a group for which they could prove that this could not be done, unfortunately.</p>

<a name="131120759"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131120759" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131120759">Mario Carneiro (Aug 08 2018 at 17:13)</a>:</h4>
<p>I think I know how to do modules; maybe you could use that</p>

<a name="131120813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131120813" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131120813">Kevin Buzzard (Aug 08 2018 at 17:14)</a>:</h4>
<p>Oh yeah, Q/Z. No possibility for 1 because it would be killed by some n, but not everything is killed by n</p>

<a name="131120860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131120860" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131120860">Mario Carneiro (Aug 08 2018 at 17:15)</a>:</h4>
<p>any non-unital ring satisfies this criterion</p>

<a name="131120979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131120979" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131120979">Mario Carneiro (Aug 08 2018 at 17:17)</a>:</h4>
<p>oh, actually I think you stand to gain just a bit by using a module tactic to solve abelian group problems</p>

<a name="131120989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131120989" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131120989">Patrick Massot (Aug 08 2018 at 17:18)</a>:</h4>
<p>It makes me think I should try the <code>rcases_hint</code> tactic now that you pushed it</p>

<a name="131121036"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131121036" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131121036">Mario Carneiro (Aug 08 2018 at 17:18)</a>:</h4>
<p>since it would be able to handle <code>(m * n) . x = m . (n . x)</code> where m,n : Z</p>

<a name="131121042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131121042" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131121042">Mario Carneiro (Aug 08 2018 at 17:18)</a>:</h4>
<p>but a standard abelian group tactic can't deal with Z variables</p>

<a name="131121067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131121067" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131121067">Mario Carneiro (Aug 08 2018 at 17:19)</a>:</h4>
<p>You should definitely try <code>rcases_hint</code>. I wrote 200 lines of lean in one sitting and tested it once at the end, and it seemed to work</p>

<a name="131121113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131121113" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131121113">Mario Carneiro (Aug 08 2018 at 17:20)</a>:</h4>
<p>...at least it's type correct</p>

<a name="131121736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131121736" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131121736">Johan Commelin (Aug 08 2018 at 17:32)</a>:</h4>
<p>Unfortunately, <code>add_comm_group</code> is not the same as <code>module \Z</code></p>

<a name="131121833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131121833" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131121833">Mario Carneiro (Aug 08 2018 at 17:34)</a>:</h4>
<p>that's not a significant problem for a tactic, it can supply the instance when needed</p>

<a name="131121859"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131121859" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131121859">Mario Carneiro (Aug 08 2018 at 17:35)</a>:</h4>
<p>speaking of which, someone should prove that instance. All the hard work is already done</p>

<a name="131123895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131123895" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131123895">Patrick Massot (Aug 08 2018 at 18:07)</a>:</h4>
<p>I can't use the depth parameter</p>

<a name="131123968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131123968" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131123968">Mario Carneiro (Aug 08 2018 at 18:08)</a>:</h4>
<p>The syntax is <code>rcases_hint e {depth := 4}</code> or <code>rintro_hint {depth := 4}</code></p>

<a name="131123979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131123979" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131123979">Mario Carneiro (Aug 08 2018 at 18:08)</a>:</h4>
<p>the lack of delimiter between <code>e</code> and the cfg may cause a problem</p>

<a name="131123982"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131123982" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131123982">Patrick Massot (Aug 08 2018 at 18:08)</a>:</h4>
<p>it complains <code>e</code> is not a function</p>

<a name="131123992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131123992" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131123992">Patrick Massot (Aug 08 2018 at 18:09)</a>:</h4>
<p>so yes, a delimiter may help</p>

<a name="131123998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131123998" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131123998">Mario Carneiro (Aug 08 2018 at 18:09)</a>:</h4>
<p>I'm open to suggestions</p>

<a name="131124080"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131124080" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131124080">Mario Carneiro (Aug 08 2018 at 18:11)</a>:</h4>
<p>would <code>rcases_hint e : 4</code> be too weird?</p>

<a name="131124093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131124093" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131124093">Patrick Massot (Aug 08 2018 at 18:11)</a>:</h4>
<p>it's not meant to stay in the final Lean file anyway</p>

<a name="131124101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131124101" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131124101">Patrick Massot (Aug 08 2018 at 18:11)</a>:</h4>
<p>so I would say it's fine</p>

<a name="131124410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131124410" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131124410">Patrick Massot (Aug 08 2018 at 18:17)</a>:</h4>
<p>What about trying to guess better names?</p>

<a name="131125303"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131125303" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131125303">Johan Commelin (Aug 08 2018 at 18:34)</a>:</h4>
<blockquote>
<p>speaking of which, someone should prove that instance. All the hard work is already done</p>
</blockquote>
<p>Do we want an actual <code>instance</code>, or just 2 lemmas that convert either way. I think we can't have instances both ways, right? That would blow up the type class system <span class="emoji emoji-1f4a5" title="boom">:boom:</span></p>

<a name="131125618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131125618" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131125618">Mario Carneiro (Aug 08 2018 at 18:40)</a>:</h4>
<p>We already have an instance one way, the other one should just be a def</p>

<a name="131125639"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131125639" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131125639">Mario Carneiro (Aug 08 2018 at 18:41)</a>:</h4>
<p>I changed <code>rcases_hint</code> to <code>rcases?</code>, <code>hint</code>  takes too long to write</p>

<a name="131125657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131125657" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131125657">Mario Carneiro (Aug 08 2018 at 18:41)</a>:</h4>
<p>the depth thing should be fixed</p>

<a name="131131422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131131422" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131131422">Patrick Massot (Aug 08 2018 at 20:38)</a>:</h4>
<blockquote>
<p>My current goal is <code>φ (x', y') - φ (x, y) =   φ (x', y₁) - φ (x, y₁) + (φ (x', y') - φ (x', y₁) - (φ (x, y') - φ (x, y₁))) + (φ (x₁, y') - φ (x₁, y)) + (φ (x, y') - φ (x, y) - (φ (x₁, y') - φ (x₁, y)))</code> and I can't face proving it by hand</p>
</blockquote>
<p>This was the last missing piece, so I decided to try it. After about 15 minutes of misery, I found out that <code>apply eq_of_sub_eq_zero, simp</code> does the trick!</p>

<a name="131133991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131133991" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131133991">Kevin Buzzard (Aug 08 2018 at 21:35)</a>:</h4>
<blockquote>
<p>Unfortunately, <code>add_comm_group</code> is not the same as <code>module \Z</code></p>
</blockquote>
<p>OK so in the perfectoid mathlib pile-up there is <code>quotient_group.lean</code>, which I wrote based on <code>quotient_module.lean</code>. But what I actually want is <code>quotient_add_group.lean</code> so I can use it to improve <code>quotient_ring.lean</code>. I see three possibilities for making <code>quotient_add_group.lean</code> : </p>
<p>(1) just copy <code>quotient_group.lean</code> changing all the <code>*</code>s to <code>+</code>s etc. </p>
<p>(2) Some sort of tactic magic</p>
<p>(3) <em>deduce</em> the results from <code>quotient_module.lean</code> using the fact that, as we mathematicians say, an abelian group "is" a <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="double-struck">Z</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbb{Z}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68889em;"></span><span class="strut bottom" style="height:0.68889em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathbb">Z</span></span></span></span></span>-module.</p>
<p>Which is the best idea?</p>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> Do you mind if I put our names on the top of <code>quotient_group.lean</code> (remember -- I wrote it, basically copying from <code>quotient_module.lean</code> and then you fixed up a bunch of stuff and made it better) and PR it to mathlib via the community mathlib?</p>

<a name="131134156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/add_comm_group%20tactic/near/131134156" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/64217addcommgrouptactic.html#131134156">Patrick Massot (Aug 08 2018 at 21:38)</a>:</h4>
<p>No problem, go ahead</p>


{% endraw %}

{% include archive_update.html %}