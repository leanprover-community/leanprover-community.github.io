---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/116395maths/44057wolfgoatcabbage.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/116395maths/index.html">maths</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html">wolf goat cabbage</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="174608128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174608128" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174608128">Johan Commelin (Aug 31 2019 at 08:13)</a>:</h4>
<p>Can we formalise the wolf-goat-cabbage problem, and its solution? As nice as possible...</p>

<a name="174608170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174608170" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174608170">Johan Commelin (Aug 31 2019 at 08:14)</a>:</h4>
<p>Would the game theory PR help here?</p>

<a name="174608186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174608186" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174608186">Johan Commelin (Aug 31 2019 at 08:15)</a>:</h4>
<p>I would like to have a tactic proof that works as an actual game.</p>

<a name="174608231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174608231" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174608231">Johan Commelin (Aug 31 2019 at 08:16)</a>:</h4>
<p>So that my kids can write the tactic <code>carry_in_boat wolf</code>, and it will fail with the error message: "Can't do that, the goat would eat the cabbage".</p>

<a name="174608235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174608235" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174608235">Johan Commelin (Aug 31 2019 at 08:17)</a>:</h4>
<p>And the tactic state should reflect in a clean way where all the protagonists are.</p>

<a name="174608840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174608840" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174608840">Mario Carneiro (Aug 31 2019 at 08:38)</a>:</h4>
<p>You mean like this?</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">list</span><span class="bp">.</span><span class="n">defs</span>

<span class="kn">namespace</span> <span class="n">list</span>

<span class="kn">instance</span> <span class="n">decidable_chain₂</span> <span class="o">{</span><span class="n">α</span> <span class="n">R</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_rel</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">decidable</span> <span class="o">(</span><span class="n">chain</span> <span class="n">R</span> <span class="n">a</span> <span class="n">l</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">induction</span> <span class="n">l</span> <span class="n">generalizing</span> <span class="n">a</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">is_true</span> <span class="n">chain</span><span class="bp">.</span><span class="n">nil</span><span class="o">,</span>
  <span class="n">exactI</span> <span class="n">decidable_of_iff&#39;</span> <span class="bp">_</span> <span class="n">chain_cons</span>
<span class="kn">end</span>

<span class="kn">instance</span> <span class="n">decidable_chain&#39;₂</span> <span class="o">{</span><span class="n">α</span> <span class="n">R</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_rel</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">decidable</span> <span class="o">(</span><span class="n">chain&#39;</span> <span class="n">R</span> <span class="n">l</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">cases</span> <span class="n">l</span><span class="bp">;</span> <span class="n">dunfold</span> <span class="n">chain&#39;</span><span class="bp">;</span> <span class="n">apply_instance</span>

<span class="kn">end</span> <span class="n">list</span>

<span class="kn">namespace</span> <span class="n">WGC</span>

<span class="bp">@</span><span class="o">[</span><span class="n">derive</span> <span class="n">decidable_eq</span><span class="o">]</span>
<span class="kn">structure</span> <span class="n">state</span> <span class="o">:=</span> <span class="o">(</span><span class="n">wolf</span> <span class="n">goat</span> <span class="n">cabbage</span> <span class="n">farmer</span> <span class="o">:</span> <span class="n">bool</span><span class="o">)</span>

<span class="n">def</span> <span class="n">valid</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">state</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">¬</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">=</span> <span class="n">s</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">∧</span> <span class="n">s</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">≠</span> <span class="n">s</span><span class="bp">.</span><span class="n">wolf</span><span class="o">)</span> <span class="bp">∧</span>
<span class="bp">¬</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">=</span> <span class="n">s</span><span class="bp">.</span><span class="n">cabbage</span> <span class="bp">∧</span> <span class="n">s</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">≠</span> <span class="n">s</span><span class="bp">.</span><span class="n">goat</span><span class="o">)</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">decidable_pred</span> <span class="n">valid</span> <span class="bp">|</span> <span class="n">s</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">unfold</span> <span class="n">valid</span><span class="bp">;</span> <span class="n">apply_instance</span>

<span class="n">def</span> <span class="n">step</span> <span class="o">(</span><span class="n">s₁</span> <span class="n">s₂</span> <span class="o">:</span> <span class="n">state</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">s₁</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">≠</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">∧</span>
<span class="o">((</span><span class="n">s₁</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">∧</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">∧</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">cabbage</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">cabbage</span><span class="o">)</span> <span class="bp">∨</span>
 <span class="o">(</span><span class="n">s₁</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">∧</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">∧</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">cabbage</span> <span class="bp">=</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">∧</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">cabbage</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">farmer</span><span class="o">)</span> <span class="bp">∨</span>
 <span class="o">(</span><span class="n">s₁</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">∧</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">=</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">∧</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">∧</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">cabbage</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">cabbage</span><span class="o">)</span> <span class="bp">∨</span>
 <span class="o">(</span><span class="n">s₁</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">=</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">∧</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">∧</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">cabbage</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">cabbage</span> <span class="bp">∧</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">goat</span><span class="o">))</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">decidable_rel</span> <span class="n">step</span> <span class="bp">|</span> <span class="n">s₁</span> <span class="n">s₂</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">unfold</span> <span class="n">step</span><span class="bp">;</span> <span class="n">apply_instance</span>

<span class="n">def</span> <span class="n">path</span> <span class="o">:</span> <span class="n">list</span> <span class="n">state</span> <span class="o">:=</span>
<span class="o">[</span><span class="bp">⟨</span><span class="n">ff</span><span class="o">,</span> <span class="n">ff</span><span class="o">,</span> <span class="n">ff</span><span class="o">,</span> <span class="n">ff</span><span class="bp">⟩</span><span class="o">,</span>
 <span class="bp">⟨</span><span class="n">ff</span><span class="o">,</span> <span class="n">tt</span><span class="o">,</span> <span class="n">ff</span><span class="o">,</span> <span class="n">tt</span><span class="bp">⟩</span><span class="o">,</span>
 <span class="bp">⟨</span><span class="n">ff</span><span class="o">,</span> <span class="n">tt</span><span class="o">,</span> <span class="n">ff</span><span class="o">,</span> <span class="n">ff</span><span class="bp">⟩</span><span class="o">,</span>
 <span class="bp">⟨</span><span class="n">ff</span><span class="o">,</span> <span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="bp">⟩</span><span class="o">,</span>
 <span class="bp">⟨</span><span class="n">ff</span><span class="o">,</span> <span class="n">ff</span><span class="o">,</span> <span class="n">tt</span><span class="o">,</span> <span class="n">ff</span><span class="bp">⟩</span><span class="o">,</span>
 <span class="bp">⟨</span><span class="n">tt</span><span class="o">,</span> <span class="n">ff</span><span class="o">,</span> <span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="bp">⟩</span><span class="o">,</span>
 <span class="bp">⟨</span><span class="n">tt</span><span class="o">,</span> <span class="n">ff</span><span class="o">,</span> <span class="n">tt</span><span class="o">,</span> <span class="n">ff</span><span class="bp">⟩</span><span class="o">,</span>
 <span class="bp">⟨</span><span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="bp">⟩</span><span class="o">]</span>

<span class="kn">theorem</span> <span class="n">path_start</span> <span class="o">:</span> <span class="n">path</span><span class="bp">.</span><span class="n">head&#39;</span> <span class="bp">=</span> <span class="n">some</span> <span class="bp">⟨</span><span class="n">ff</span><span class="o">,</span> <span class="n">ff</span><span class="o">,</span> <span class="n">ff</span><span class="o">,</span> <span class="n">ff</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="kn">theorem</span> <span class="n">path_end</span> <span class="o">:</span> <span class="n">path</span><span class="bp">.</span><span class="n">last&#39;</span> <span class="bp">=</span> <span class="n">some</span> <span class="bp">⟨</span><span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="kn">theorem</span> <span class="n">path_step</span> <span class="o">:</span> <span class="n">list</span><span class="bp">.</span><span class="n">chain&#39;</span> <span class="n">step</span> <span class="n">path</span> <span class="o">:=</span> <span class="n">dec_trivial</span>
<span class="kn">theorem</span> <span class="n">path_valid</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">s</span> <span class="err">∈</span> <span class="n">path</span><span class="o">,</span> <span class="n">valid</span> <span class="n">s</span> <span class="o">:=</span> <span class="n">dec_trivial</span>

<span class="kn">end</span> <span class="n">WGC</span>
</pre></div>

<a name="174608891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174608891" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174608891">Mario Carneiro (Aug 31 2019 at 08:40)</a>:</h4>
<p>Ah, I guess I'm not meeting your secondary objectives...</p>

<a name="174608901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174608901" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174608901">Mario Carneiro (Aug 31 2019 at 08:41)</a>:</h4>
<p>(PS: I had to fix some broken definitions of the decidable instances for <code>chain</code> and <code>chain'</code> here, caused by improper use of <code>simp</code> in a decidability proof.)</p>

<a name="174610029"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174610029" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174610029">Mario Carneiro (Aug 31 2019 at 09:23)</a>:</h4>
<p>Here's a more gamey version:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">list</span><span class="bp">.</span><span class="n">basic</span>

<span class="kn">namespace</span> <span class="n">list</span>

<span class="kn">instance</span> <span class="n">decidable_chain₂</span> <span class="o">{</span><span class="n">α</span> <span class="n">R</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_rel</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">decidable</span> <span class="o">(</span><span class="n">chain</span> <span class="n">R</span> <span class="n">a</span> <span class="n">l</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">induction</span> <span class="n">l</span> <span class="n">generalizing</span> <span class="n">a</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">is_true</span> <span class="n">chain</span><span class="bp">.</span><span class="n">nil</span><span class="o">,</span>
  <span class="n">exactI</span> <span class="n">decidable_of_iff&#39;</span> <span class="bp">_</span> <span class="n">chain_cons</span>
<span class="kn">end</span>

<span class="kn">instance</span> <span class="n">decidable_chain&#39;₂</span> <span class="o">{</span><span class="n">α</span> <span class="n">R</span><span class="o">}</span> <span class="o">[</span><span class="n">decidable_rel</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">decidable</span> <span class="o">(</span><span class="n">chain&#39;</span> <span class="n">R</span> <span class="n">l</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">cases</span> <span class="n">l</span><span class="bp">;</span> <span class="n">dunfold</span> <span class="n">chain&#39;</span><span class="bp">;</span> <span class="n">apply_instance</span>

<span class="kn">end</span> <span class="n">list</span>

<span class="kn">namespace</span> <span class="n">WGC</span>

<span class="kn">structure</span> <span class="n">state</span> <span class="o">:=</span> <span class="o">(</span><span class="n">wolf</span> <span class="n">goat</span> <span class="n">cabbage</span> <span class="n">farmer</span> <span class="o">:</span> <span class="n">bool</span><span class="o">)</span>

<span class="n">def</span> <span class="n">valid</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">state</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">¬</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">=</span> <span class="n">s</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">∧</span> <span class="n">s</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">≠</span> <span class="n">s</span><span class="bp">.</span><span class="n">wolf</span><span class="o">)</span> <span class="bp">∧</span>
<span class="bp">¬</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">=</span> <span class="n">s</span><span class="bp">.</span><span class="n">cabbage</span> <span class="bp">∧</span> <span class="n">s</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">≠</span> <span class="n">s</span><span class="bp">.</span><span class="n">goat</span><span class="o">)</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">decidable_pred</span> <span class="n">valid</span> <span class="bp">|</span> <span class="n">s</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">unfold</span> <span class="n">valid</span><span class="bp">;</span> <span class="n">apply_instance</span>

<span class="n">def</span> <span class="n">step</span> <span class="o">(</span><span class="n">s₁</span> <span class="n">s₂</span> <span class="o">:</span> <span class="n">state</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">s₁</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">≠</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">∧</span>
<span class="o">((</span><span class="n">s₁</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">∧</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">∧</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">cabbage</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">cabbage</span><span class="o">)</span> <span class="bp">∨</span>
 <span class="o">(</span><span class="n">s₁</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">∧</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">∧</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">cabbage</span> <span class="bp">=</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">∧</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">cabbage</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">farmer</span><span class="o">)</span> <span class="bp">∨</span>
 <span class="o">(</span><span class="n">s₁</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">∧</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">=</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">∧</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">∧</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">cabbage</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">cabbage</span><span class="o">)</span> <span class="bp">∨</span>
 <span class="o">(</span><span class="n">s₁</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">=</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">∧</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">wolf</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">farmer</span> <span class="bp">∧</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">cabbage</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">cabbage</span> <span class="bp">∧</span> <span class="n">s₁</span><span class="bp">.</span><span class="n">goat</span> <span class="bp">=</span> <span class="n">s₂</span><span class="bp">.</span><span class="n">goat</span><span class="o">))</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">decidable_rel</span> <span class="n">step</span> <span class="bp">|</span> <span class="n">s₁</span> <span class="n">s₂</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">unfold</span> <span class="n">step</span><span class="bp">;</span> <span class="n">apply_instance</span>

<span class="n">def</span> <span class="n">solution_from</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">state</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">list</span> <span class="n">state</span> <span class="bp">//</span> <span class="n">p</span><span class="bp">.</span><span class="n">head&#39;</span> <span class="bp">=</span> <span class="n">some</span> <span class="n">s</span> <span class="bp">∧</span>
  <span class="n">p</span><span class="bp">.</span><span class="n">last&#39;</span> <span class="bp">=</span> <span class="n">some</span> <span class="bp">⟨</span><span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="bp">⟩</span> <span class="bp">∧</span>
  <span class="n">list</span><span class="bp">.</span><span class="n">chain&#39;</span> <span class="n">step</span> <span class="n">p</span> <span class="bp">∧</span>
  <span class="bp">∀</span> <span class="n">s&#39;</span> <span class="err">∈</span> <span class="n">p</span><span class="o">,</span> <span class="n">valid</span> <span class="n">s&#39;</span><span class="o">}</span>

<span class="n">def</span> <span class="n">finish</span> <span class="o">:</span> <span class="n">solution_from</span> <span class="bp">⟨</span><span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="bp">⟩</span> <span class="o">:=</span>
<span class="bp">⟨</span><span class="o">[</span><span class="bp">⟨</span><span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="bp">⟩</span><span class="o">],</span> <span class="n">dec_trivial</span><span class="bp">⟩</span>

<span class="n">def</span> <span class="n">solution_from</span><span class="bp">.</span><span class="n">step</span> <span class="o">{</span><span class="n">s₁</span><span class="o">}</span> <span class="o">(</span><span class="n">s₂</span><span class="o">)</span>
  <span class="o">(</span><span class="n">H₁</span> <span class="o">:</span> <span class="n">valid</span> <span class="n">s₁</span><span class="o">)</span> <span class="o">(</span><span class="n">H₂</span> <span class="o">:</span> <span class="n">step</span> <span class="n">s₁</span> <span class="n">s₂</span><span class="o">)</span>
  <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">solution_from</span> <span class="n">s₂</span><span class="o">)</span> <span class="o">:</span> <span class="n">solution_from</span> <span class="n">s₁</span> <span class="o">:=</span>
<span class="bp">⟨</span><span class="n">s₁</span> <span class="bp">::</span> <span class="n">p</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span> <span class="k">begin</span>
  <span class="n">rcases</span> <span class="n">p</span><span class="bp">.</span><span class="mi">2</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">h₁</span><span class="o">,</span> <span class="n">h₂</span><span class="o">,</span> <span class="n">h₃</span><span class="o">,</span> <span class="n">h₄</span><span class="bp">⟩</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">p</span><span class="bp">.</span><span class="mi">1</span> <span class="k">with</span> <span class="n">a</span> <span class="n">l</span><span class="bp">;</span> <span class="n">cases</span> <span class="n">h₁</span><span class="o">,</span>
  <span class="n">exact</span> <span class="bp">⟨</span><span class="n">rfl</span><span class="o">,</span> <span class="n">h₂</span><span class="o">,</span> <span class="n">list</span><span class="bp">.</span><span class="n">chain</span><span class="bp">.</span><span class="n">cons</span> <span class="n">H₂</span> <span class="n">h₃</span><span class="o">,</span>
    <span class="n">list</span><span class="bp">.</span><span class="n">forall_mem_cons</span><span class="bp">.</span><span class="mi">2</span> <span class="bp">⟨</span><span class="n">H₁</span><span class="o">,</span> <span class="n">h₄</span><span class="bp">⟩⟩</span>
<span class="kn">end</span><span class="bp">⟩</span>

<span class="kn">section</span>
<span class="kn">open</span> <span class="n">tactic</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">interactive</span> <span class="n">interactive</span> <span class="n">lean</span><span class="bp">.</span><span class="n">parser</span>

<span class="n">meta</span> <span class="n">def</span> <span class="n">negate</span> <span class="o">:</span> <span class="n">expr</span> <span class="bp">→</span> <span class="n">tactic</span> <span class="n">expr</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">(</span><span class="n">tt</span><span class="o">)</span> <span class="o">:=</span> <span class="n">return</span> <span class="bp">`</span><span class="o">(</span><span class="n">ff</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">(</span><span class="n">ff</span><span class="o">)</span> <span class="o">:=</span> <span class="n">return</span> <span class="bp">`</span><span class="o">(</span><span class="n">tt</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">_</span> <span class="o">:=</span> <span class="n">fail</span> <span class="s2">&quot;invalid goal&quot;</span>

<span class="n">meta</span> <span class="n">def</span> <span class="n">carry_in_boat</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">parse</span> <span class="n">ident</span><span class="o">)</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span> <span class="n">do</span>
  <span class="bp">`</span><span class="o">(</span><span class="n">solution_from</span> <span class="bp">⟨</span><span class="err">%%</span><span class="n">w</span><span class="o">,</span> <span class="err">%%</span><span class="n">g</span><span class="o">,</span> <span class="err">%%</span><span class="n">c</span><span class="o">,</span> <span class="err">%%</span><span class="n">f</span><span class="bp">⟩</span><span class="o">)</span> <span class="err">←</span> <span class="n">target</span> <span class="bp">|</span> <span class="n">fail</span> <span class="s2">&quot;invalid goal&quot;</span><span class="o">,</span>
  <span class="n">f&#39;</span> <span class="err">←</span> <span class="n">negate</span> <span class="n">f</span><span class="o">,</span>
  <span class="o">(</span><span class="n">w&#39;</span><span class="o">,</span> <span class="n">g&#39;</span><span class="o">,</span> <span class="n">c&#39;</span><span class="o">)</span> <span class="err">←</span> <span class="k">match</span> <span class="n">n</span> <span class="k">with</span>
  <span class="bp">|</span> <span class="bp">`</span><span class="n">wolf</span> <span class="o">:=</span> <span class="n">do</span>
    <span class="n">when</span> <span class="o">(</span><span class="bp">¬</span> <span class="n">w</span> <span class="bp">=</span><span class="err">ₐ</span> <span class="n">f</span><span class="o">)</span> <span class="err">$</span> <span class="n">fail</span> <span class="s2">&quot;Can&#39;t do that, the wolf is on the other side.&quot;</span><span class="o">,</span>
    <span class="n">w&#39;</span> <span class="err">←</span> <span class="n">negate</span> <span class="n">w</span><span class="o">,</span>
    <span class="n">when</span> <span class="o">(</span><span class="n">g</span> <span class="bp">=</span><span class="err">ₐ</span> <span class="n">c</span> <span class="bp">∧</span> <span class="bp">¬</span> <span class="n">g</span> <span class="bp">=</span><span class="err">ₐ</span> <span class="n">f&#39;</span><span class="o">)</span> <span class="err">$</span> <span class="n">fail</span> <span class="s2">&quot;Can&#39;t do that, the goat would eat the cabbage.&quot;</span><span class="o">,</span>
    <span class="n">return</span> <span class="o">(</span><span class="n">w&#39;</span><span class="o">,</span> <span class="n">g</span><span class="o">,</span> <span class="n">c</span><span class="o">)</span>
  <span class="bp">|</span> <span class="bp">`</span><span class="n">goat</span> <span class="o">:=</span> <span class="n">do</span>
    <span class="n">when</span> <span class="o">(</span><span class="bp">¬</span> <span class="n">g</span> <span class="bp">=</span><span class="err">ₐ</span> <span class="n">f</span><span class="o">)</span> <span class="err">$</span> <span class="n">fail</span> <span class="s2">&quot;Can&#39;t do that, the goat is on the other side.&quot;</span><span class="o">,</span>
    <span class="n">g&#39;</span> <span class="err">←</span> <span class="n">negate</span> <span class="n">g</span><span class="o">,</span>
    <span class="n">return</span> <span class="o">(</span><span class="n">w</span><span class="o">,</span> <span class="n">g&#39;</span><span class="o">,</span> <span class="n">c</span><span class="o">)</span>
  <span class="bp">|</span> <span class="bp">`</span><span class="n">cabbage</span> <span class="o">:=</span> <span class="n">do</span>
    <span class="n">when</span> <span class="o">(</span><span class="bp">¬</span> <span class="n">c</span> <span class="bp">=</span><span class="err">ₐ</span> <span class="n">f</span><span class="o">)</span> <span class="err">$</span> <span class="n">fail</span> <span class="s2">&quot;Can&#39;t do that, the cabbage is on the other side.&quot;</span><span class="o">,</span>
    <span class="n">c&#39;</span> <span class="err">←</span> <span class="n">negate</span> <span class="n">c</span><span class="o">,</span>
    <span class="n">when</span> <span class="o">(</span><span class="n">w</span> <span class="bp">=</span><span class="err">ₐ</span> <span class="n">g</span> <span class="bp">∧</span> <span class="bp">¬</span> <span class="n">g</span> <span class="bp">=</span><span class="err">ₐ</span> <span class="n">f&#39;</span><span class="o">)</span> <span class="err">$</span> <span class="n">fail</span> <span class="s2">&quot;Can&#39;t do that, the wolf would eat the goat.&quot;</span><span class="o">,</span>
    <span class="n">return</span> <span class="o">(</span><span class="n">w</span><span class="o">,</span> <span class="n">g</span><span class="o">,</span> <span class="n">c&#39;</span><span class="o">)</span>
  <span class="bp">|</span> <span class="bp">`</span><span class="n">nothing</span> <span class="o">:=</span> <span class="n">do</span>
    <span class="n">when</span> <span class="o">(</span><span class="n">g</span> <span class="bp">=</span><span class="err">ₐ</span> <span class="n">c</span> <span class="bp">∧</span> <span class="bp">¬</span> <span class="n">g</span> <span class="bp">=</span><span class="err">ₐ</span> <span class="n">f&#39;</span><span class="o">)</span> <span class="err">$</span> <span class="n">fail</span> <span class="s2">&quot;Can&#39;t do that, the goat would eat the cabbage.&quot;</span><span class="o">,</span>
    <span class="n">when</span> <span class="o">(</span><span class="n">w</span> <span class="bp">=</span><span class="err">ₐ</span> <span class="n">g</span> <span class="bp">∧</span> <span class="bp">¬</span> <span class="n">g</span> <span class="bp">=</span><span class="err">ₐ</span> <span class="n">f&#39;</span><span class="o">)</span> <span class="err">$</span> <span class="n">fail</span> <span class="s2">&quot;Can&#39;t do that, the wolf would eat the goat.&quot;</span><span class="o">,</span>
    <span class="n">return</span> <span class="o">(</span><span class="n">w</span><span class="o">,</span> <span class="n">g</span><span class="o">,</span> <span class="n">c</span><span class="o">)</span>
  <span class="bp">|</span> <span class="bp">_</span> <span class="o">:=</span> <span class="n">fail</span> <span class="s2">&quot;invalid choice&quot;</span>
  <span class="kn">end</span><span class="o">,</span>
  <span class="n">tactic</span><span class="bp">.</span><span class="n">refine</span> <span class="bp">``</span><span class="o">(</span><span class="n">solution_from</span><span class="bp">.</span><span class="n">step</span>
    <span class="bp">⟨</span><span class="err">%%</span><span class="n">w&#39;</span><span class="o">,</span> <span class="err">%%</span><span class="n">g&#39;</span><span class="o">,</span> <span class="err">%%</span><span class="n">c&#39;</span><span class="o">,</span> <span class="err">%%</span><span class="n">f&#39;</span><span class="bp">⟩</span> <span class="n">dec_trivial</span> <span class="n">dec_trivial</span> <span class="bp">_</span><span class="o">),</span>
  <span class="n">tactic</span><span class="bp">.</span><span class="n">try</span> <span class="o">(</span><span class="n">exact</span> <span class="bp">`</span><span class="o">(</span><span class="n">finish</span><span class="o">))</span>

<span class="n">run_cmd</span> <span class="n">add_interactive</span> <span class="o">[</span><span class="bp">``</span><span class="n">carry_in_boat</span><span class="o">]</span>
<span class="kn">end</span>

<span class="kn">theorem</span> <span class="n">solution</span> <span class="o">:</span> <span class="n">solution_from</span> <span class="bp">⟨</span><span class="n">ff</span><span class="o">,</span> <span class="n">ff</span><span class="o">,</span> <span class="n">ff</span><span class="o">,</span> <span class="n">ff</span><span class="bp">⟩</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">carry_in_boat</span> <span class="n">goat</span><span class="o">,</span>
  <span class="n">carry_in_boat</span> <span class="n">nothing</span><span class="o">,</span>
  <span class="n">carry_in_boat</span> <span class="n">cabbage</span><span class="o">,</span>
  <span class="n">carry_in_boat</span> <span class="n">goat</span><span class="o">,</span>
  <span class="n">carry_in_boat</span> <span class="n">wolf</span><span class="o">,</span>
  <span class="n">carry_in_boat</span> <span class="n">nothing</span><span class="o">,</span>
  <span class="n">carry_in_boat</span> <span class="n">goat</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">end</span> <span class="n">WGC</span>
</pre></div>

<a name="174610187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174610187" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174610187">Mario Carneiro (Aug 31 2019 at 09:28)</a>:</h4>
<p>Manipulating the tactic state for a better display of the protagonists is more difficult though</p>

<a name="174610462"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174610462" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174610462">Mario Carneiro (Aug 31 2019 at 09:39)</a>:</h4>
<p>I don't think the game theory stuff would help, as it's primarily for two-player games and this is a one-player game</p>

<a name="174610507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174610507" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174610507">Mario Carneiro (Aug 31 2019 at 09:40)</a>:</h4>
<p>unless you model the actions of the wolf and goat as an adversarial player rather than a constraint</p>

<a name="174617874"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174617874" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174617874">Johan Commelin (Aug 31 2019 at 13:25)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Wow, thanks a lot!</p>

<a name="174617883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174617883" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174617883">Johan Commelin (Aug 31 2019 at 13:25)</a>:</h4>
<p>I'm only seeing it now, because we had an "emergency" swimming pool party, to keep the kids busy.</p>

<a name="174618509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174618509" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174618509">Johan Commelin (Aug 31 2019 at 13:44)</a>:</h4>
<blockquote>
<p>(PS: I had to fix some broken definitions of the decidable instances for <code>chain</code> and <code>chain'</code> here, caused by improper use of <code>simp</code> in a decidability proof.)</p>
</blockquote>
<p>Do you mean "fix" in mathlib? Currently the <code>dec_trivial</code> in the proof of finish gives an error on my side. Are those fixes meant to fix that?</p>

<a name="174618845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174618845" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174618845">Johan Commelin (Aug 31 2019 at 13:55)</a>:</h4>
<p><code>s/solution_from/position/g</code></p>

<a name="174618851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174618851" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174618851">Johan Commelin (Aug 31 2019 at 13:55)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">notation</span> <span class="bp">`</span><span class="n">left_shore</span><span class="bp">`</span> <span class="o">:=</span>  <span class="n">tt</span>
<span class="kn">notation</span> <span class="bp">`</span><span class="n">right_shore</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">ff</span>
</pre></div>

<a name="174618856"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174618856" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174618856">Johan Commelin (Aug 31 2019 at 13:55)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">solution</span> <span class="o">:</span> <span class="n">position</span> <span class="bp">⟨</span><span class="n">ff</span><span class="o">,</span> <span class="n">ff</span><span class="o">,</span> <span class="n">ff</span><span class="o">,</span> <span class="n">ff</span><span class="bp">⟩</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">carry_in_boat</span> <span class="n">goat</span><span class="o">,</span>
  <span class="n">carry_in_boat</span> <span class="n">nothing</span><span class="o">,</span>
  <span class="n">carry_in_boat</span> <span class="n">cabbage</span><span class="o">,</span>
  <span class="n">carry_in_boat</span> <span class="n">goat</span><span class="o">,</span>
  <span class="n">carry_in_boat</span> <span class="n">wolf</span><span class="o">,</span>
  <span class="n">carry_in_boat</span> <span class="n">nothing</span><span class="o">,</span>
  <span class="n">carry_in_boat</span> <span class="n">goat</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>

<a name="174618899"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174618899" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174618899">Johan Commelin (Aug 31 2019 at 13:56)</a>:</h4>
<p>With tactic states like:</p>
<div class="codehilite"><pre><span></span><span class="mi">1</span> <span class="n">goal</span>
<span class="err">⊢</span> <span class="n">position</span> <span class="o">{</span><span class="n">wolf</span> <span class="o">:=</span> <span class="n">right_shore</span><span class="o">,</span> <span class="n">goat</span> <span class="o">:=</span> <span class="n">left_shore</span><span class="o">,</span> <span class="n">cabbage</span> <span class="o">:=</span> <span class="n">left_shore</span><span class="o">,</span> <span class="n">farmer</span> <span class="o">:=</span> <span class="n">left_shore</span><span class="o">}</span>
</pre></div>

<a name="174620538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174620538" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174620538">Keeley Hoek (Aug 31 2019 at 14:43)</a>:</h4>
<p>I think we need a whole bunch of <code>xyz := dec_trivial</code> tests</p>

<a name="174625294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174625294" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174625294">Jeremy Avigad (Aug 31 2019 at 16:55)</a>:</h4>
<p>This is a nice example. I think it should be in the <code>archive</code> folder. Even better: design a custom interactive tactic state that shows the state with little ASCII-art or unicode representations. That would be a great advertisement for kids.<br>
We could have a whole library of Lean puzzles, like the 15 puzzle, or this one: <a href="https://www.cs.brandeis.edu/~storer/JimPuzzles/ZPAGES/zzzTrafficJam.html" target="_blank" title="https://www.cs.brandeis.edu/~storer/JimPuzzles/ZPAGES/zzzTrafficJam.html">https://www.cs.brandeis.edu/~storer/JimPuzzles/ZPAGES/zzzTrafficJam.html</a>.</p>

<a name="174626346"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174626346" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174626346">Johan Commelin (Aug 31 2019 at 17:27)</a>:</h4>
<p>Is the tactic state customisable? <span aria-label="interrobang" class="emoji emoji-2049" role="img" title="interrobang">:interrobang:</span> <span aria-label="hushed" class="emoji emoji-1f62f" role="img" title="hushed">:hushed:</span> That sounds really cool!</p>

<a name="174626443"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174626443" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174626443">Patrick Massot (Aug 31 2019 at 17:30)</a>:</h4>
<p>Of course it is. Don't you use the Kevin tactic monad?</p>

<a name="174626456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174626456" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174626456">Johan Commelin (Aug 31 2019 at 17:31)</a>:</h4>
<p>Aaah, I forgot about that one...</p>

<a name="174626685"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174626685" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174626685">Jeremy Avigad (Aug 31 2019 at 17:38)</a>:</h4>
<p>Yes, it is cool. You can change the way the state is displayed, add extra state, add instructions to be carried out after every command, etc. It is not well documented, but Leo put an example here: tests/interactive/my_tactic_class.lean. I used it here: <a href="https://github.com/avigad/embed/blob/master/src/interactive.lean" target="_blank" title="https://github.com/avigad/embed/blob/master/src/interactive.lean">https://github.com/avigad/embed/blob/master/src/interactive.lean</a>. Seul Baek and Simon Hudon have also used it.<br>
When even these little bits of customization are so much fun, can you imagine what things will be like with Lean 4?</p>

<a name="174626745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174626745" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174626745">Reid Barton (Aug 31 2019 at 17:40)</a>:</h4>
<p>Sort of related is <a href="https://github.com/A1kmm/proofsweeper" target="_blank" title="https://github.com/A1kmm/proofsweeper">https://github.com/A1kmm/proofsweeper</a></p>

<a name="174626747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174626747" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174626747">Jeremy Avigad (Aug 31 2019 at 17:40)</a>:</h4>
<p>(Seul, Simon, and I all used to it implement a "proof system with a proof system", e.g. <a href="https://github.com/avigad/embed/blob/master/src/examples.lean" target="_blank" title="https://github.com/avigad/embed/blob/master/src/examples.lean">https://github.com/avigad/embed/blob/master/src/examples.lean</a>.)</p>

<a name="174626807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174626807" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174626807">Jeremy Avigad (Aug 31 2019 at 17:42)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span> Cool. I have been told that the video game industry is much bigger than the film industry. We need to make ITP even more like playing video games.</p>

<a name="174627345"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174627345" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174627345">Kevin Buzzard (Aug 31 2019 at 18:00)</a>:</h4>
<p>I keep meaning to finish my blog post explaining how my favourite computer game used to be the Zelda series but now it's the Lean series.</p>

<a name="174627363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174627363" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174627363">Kevin Buzzard (Aug 31 2019 at 18:01)</a>:</h4>
<p>OTOH it took me a year to understand how to play Lean; ideally it should take rather less long than that. I think it's striking that I haven't played any Zelda for well over a year now though.</p>

<a name="174627506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174627506" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174627506">Jeremy Avigad (Aug 31 2019 at 18:06)</a>:</h4>
<p>We need avatars that can traverse fiber bundles and do battle with singular measures.</p>

<a name="174627857"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174627857" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174627857">Kevin Buzzard (Aug 31 2019 at 18:17)</a>:</h4>
<p>I definitely think about maths in a much more geometric way then lean and I'm sure that this is even more true for the geometers</p>

<a name="174632489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174632489" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174632489">Bryan Gin-ge Chen (Aug 31 2019 at 20:44)</a>:</h4>
<p>This seemed like a good use-case for the Observable editor:</p>
<p><a href="https://observablehq.com/d/5d494b42d8ce39e8" target="_blank" title="https://observablehq.com/d/5d494b42d8ce39e8">https://observablehq.com/d/5d494b42d8ce39e8</a></p>
<p>It should be possible to create some buttons (in a "custom footer") that allow users to click to insert / edit <code>carry_in_boat XX</code> lines and also to create graphics for the errors as well. I'll hold off on more changes for now in case the Lean code is updated (and also since it's dinnertime). Feel free to suggest ideas!</p>

<a name="174632622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174632622" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174632622">Johan Commelin (Aug 31 2019 at 20:49)</a>:</h4>
<p>Wow! Just wow!</p>

<a name="174632668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174632668" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174632668">Johan Commelin (Aug 31 2019 at 20:50)</a>:</h4>
<p>This makes "no goals" so depressing...</p>

<a name="174632719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174632719" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174632719">Johan Commelin (Aug 31 2019 at 20:52)</a>:</h4>
<p>Maybe you should compensate for it by having confetti all over the screen, and playing some victory tune.</p>

<a name="174632751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174632751" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174632751">Johan Commelin (Aug 31 2019 at 20:53)</a>:</h4>
<p>This is the solution that I created with my kids this morning: <a href="https://weblog.commelin.net/wp-content/uploads/2019/08/wgc_80.gif" target="_blank" title="https://weblog.commelin.net/wp-content/uploads/2019/08/wgc_80.gif">https://weblog.commelin.net/wp-content/uploads/2019/08/wgc_80.gif</a></p>
<div class="message_inline_image"><a href="https://weblog.commelin.net/wp-content/uploads/2019/08/wgc_80.gif" target="_blank" title="https://weblog.commelin.net/wp-content/uploads/2019/08/wgc_80.gif"><img src="https://weblog.commelin.net/wp-content/uploads/2019/08/wgc_80.gif"></a></div>

<a name="174633543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174633543" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174633543">Kevin Buzzard (Aug 31 2019 at 21:18)</a>:</h4>
<p>That's great Bryan! But the solution at <a href="https://xkcd.com/1134/" target="_blank" title="https://xkcd.com/1134/">https://xkcd.com/1134/</a> doesn't work :-/</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">solution</span> <span class="o">:</span> <span class="n">solution_from</span> <span class="bp">⟨</span><span class="n">ff</span><span class="o">,</span> <span class="n">ff</span><span class="o">,</span> <span class="n">ff</span><span class="o">,</span> <span class="n">ff</span><span class="bp">⟩</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">carry_in_boat</span> <span class="n">goat</span><span class="o">,</span>
  <span class="n">carry_in_boat</span> <span class="n">nothing</span><span class="o">,</span>
  <span class="n">carry_in_boat</span> <span class="n">cabbage</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>

<a name="174642736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/174642736" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#174642736">Bryan Gin-ge Chen (Sep 01 2019 at 02:26)</a>:</h4>
<blockquote>
<p>This makes "no goals" so depressing...</p>
</blockquote>
<p>I updated the notebook so now it shows the end state as well as a <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span> emoji.</p>

<a name="177899399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/wolf%20goat%20cabbage/near/177899399" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/116395maths/44057wolfgoatcabbage.html#177899399">Wojciech Nawrocki (Oct 11 2019 at 11:45)</a>:</h4>
<p>I recall that at Big Proof 2019 a few people were playing this online drag-n-drop proof game, where graph nodes are more or less inference rules. I was looking for it and for the life of me can't find it - does anyone remember the website name?</p>


{% endraw %}

{% include archive_update.html %}