---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113489newmembers/04165squares.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113489newmembers/index.html">new members</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html">squares</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="187825068"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187825068" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187825068">Alex Kontorovich (Feb 10 2020 at 15:23)</a>:</h4>
<p>Here's something trivial that I'm trying to formalize: If a and b are coprime and a*b is a perfect square, then a and b are squares. </p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">divides</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span><span class="bp">ℤ</span> <span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">d</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">,</span> <span class="n">y</span><span class="bp">=</span><span class="n">x</span><span class="bp">*</span><span class="n">d</span>

<span class="n">def</span> <span class="n">coprime</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span><span class="bp">ℤ</span>  <span class="o">)</span> <span class="o">:=</span> <span class="bp">∀</span> <span class="n">d</span><span class="o">:</span><span class="bp">ℕ</span> <span class="o">,</span> <span class="o">(</span><span class="n">divides</span> <span class="n">d</span> <span class="n">x</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">divides</span> <span class="n">d</span> <span class="n">y</span><span class="o">)</span> <span class="bp">-&gt;</span> <span class="n">d</span><span class="bp">=</span><span class="mi">1</span>

<span class="n">def</span> <span class="n">is_square</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℤ</span> <span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">r</span><span class="o">:</span><span class="bp">ℤ</span><span class="o">,</span> <span class="n">x</span><span class="bp">=</span><span class="n">r</span><span class="bp">*</span><span class="n">r</span>

<span class="kn">lemma</span> <span class="n">product_coprimes_square</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span><span class="bp">ℤ</span> <span class="o">)</span> <span class="o">(</span><span class="n">p</span><span class="o">:</span> <span class="n">coprime</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">p1</span> <span class="o">:</span> <span class="n">a</span><span class="bp">*</span><span class="n">b</span><span class="bp">=</span><span class="n">c</span><span class="bp">*</span><span class="n">c</span><span class="o">):</span>
<span class="o">((</span><span class="n">is_square</span> <span class="n">a</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">is_square</span> <span class="n">b</span><span class="o">))</span>
<span class="o">:=</span> <span class="k">begin</span>

<span class="kn">end</span>
</pre></div>


<p>The argument could go something like: a is a square &lt;-&gt; every prime in its factorization appears with even multiplicity. How does unique factorization work in Lean? Help please? Thanks!</p>

<a name="187825273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187825273" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187825273">Alex Kontorovich (Feb 10 2020 at 15:25)</a>:</h4>
<p>Ooh stupid subtlety: a and b need to be positive, or else it's false!... (Originally I was doing this all in naturals, but elsewhere I need to subtract ... which doesn't exist for naturals!...)</p>

<a name="187825422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187825422" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187825422">Mario Carneiro (Feb 10 2020 at 15:27)</a>:</h4>
<p>This is fine for an example, but if you want "real" theorems about primes and stuff then use the library definitions of <code>divides</code> and <code>coprime</code> (<code>is_square</code> doesn't have a definition)</p>

<a name="187825586"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187825586" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187825586">Mario Carneiro (Feb 10 2020 at 15:28)</a>:</h4>
<p>You can certainly subtract on naturals, but you have to do the subtraction in <code>int</code> if you want it to mean the expected thing</p>

<a name="187825701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187825701" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187825701">Mario Carneiro (Feb 10 2020 at 15:29)</a>:</h4>
<p>Also your definition of <code>divides</code> isn't right for <code>int</code>, as it implies <code>x</code> and <code>y</code> have the same sign</p>

<a name="187825794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187825794" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187825794">Mario Carneiro (Feb 10 2020 at 15:30)</a>:</h4>
<p>do you have mathlib?</p>

<a name="187827246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187827246" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187827246">Alex Kontorovich (Feb 10 2020 at 15:45)</a>:</h4>
<p>yes I have mathlib. (How do I use it?...)</p>

<a name="187827566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187827566" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187827566">Alex Kontorovich (Feb 10 2020 at 15:48)</a>:</h4>
<p>How do I fix this with "int" so that it works? (I can "cheat" and change \N to \Z...)</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">converse</span> <span class="o">(</span><span class="n">r</span> <span class="n">s</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">px</span><span class="o">:</span> <span class="n">x</span><span class="bp">=</span> <span class="n">r</span><span class="bp">*</span><span class="n">r</span><span class="bp">-</span><span class="n">s</span><span class="bp">*</span><span class="n">s</span><span class="o">)</span> <span class="o">(</span><span class="n">py</span><span class="o">:</span> <span class="n">y</span><span class="bp">=</span><span class="mi">2</span><span class="bp">*</span><span class="n">r</span><span class="bp">*</span><span class="n">s</span><span class="o">)</span> <span class="o">(</span><span class="n">pz</span><span class="o">:</span><span class="n">z</span><span class="bp">=</span><span class="n">r</span><span class="bp">*</span><span class="n">r</span><span class="bp">+</span><span class="n">s</span><span class="bp">*</span><span class="n">s</span><span class="o">)</span>
<span class="o">:</span>
 <span class="n">x</span><span class="bp">*</span><span class="n">x</span><span class="bp">+</span><span class="n">y</span><span class="bp">*</span><span class="n">y</span><span class="bp">=</span><span class="n">z</span><span class="bp">*</span><span class="n">z</span> <span class="o">:=</span>
<span class="k">begin</span>
 <span class="n">rw</span> <span class="n">px</span><span class="o">,</span>
 <span class="n">rw</span> <span class="n">py</span><span class="o">,</span>
 <span class="n">rw</span> <span class="n">pz</span><span class="o">,</span>
 <span class="n">ring</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>

<a name="187827672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187827672" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187827672">Alex Kontorovich (Feb 10 2020 at 15:49)</a>:</h4>
<p>(the goal, if it isn't clear, is to show that, if x=r^2-s^2, y=2rs, and z=r^2+s^2, then x^2+y^2=z^2...)</p>

<a name="187828549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187828549" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187828549">Mario Carneiro (Feb 10 2020 at 15:57)</a>:</h4>
<p>One option:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span>
<span class="kn">lemma</span> <span class="n">converse</span> <span class="o">(</span><span class="n">r</span> <span class="n">s</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">px</span><span class="o">:</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℤ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">r</span><span class="bp">*</span><span class="n">r</span><span class="bp">-</span><span class="n">s</span><span class="bp">*</span><span class="n">s</span><span class="o">)</span> <span class="o">(</span><span class="n">py</span><span class="o">:</span> <span class="n">y</span><span class="bp">=</span><span class="mi">2</span><span class="bp">*</span><span class="n">r</span><span class="bp">*</span><span class="n">s</span><span class="o">)</span> <span class="o">(</span><span class="n">pz</span><span class="o">:</span><span class="n">z</span><span class="bp">=</span><span class="n">r</span><span class="bp">*</span><span class="n">r</span><span class="bp">+</span><span class="n">s</span><span class="bp">*</span><span class="n">s</span><span class="o">)</span> <span class="o">:</span>
 <span class="n">x</span><span class="bp">*</span><span class="n">x</span><span class="bp">+</span><span class="n">y</span><span class="bp">*</span><span class="n">y</span><span class="bp">=</span><span class="n">z</span><span class="bp">*</span><span class="n">z</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">int</span><span class="bp">.</span><span class="n">coe_nat_inj</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">px</span><span class="o">,</span> <span class="n">py</span><span class="o">,</span> <span class="n">pz</span><span class="o">],</span>
  <span class="n">ring</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>

<a name="187829171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187829171" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187829171">Reid Barton (Feb 10 2020 at 16:02)</a>:</h4>
<p>There's a tricky way to prove your original statement avoiding prime factorization using <code>prod_dvd_and_dvd_of_dvd_prod</code>, which states (in particular) that if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span> divides <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>∗</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">c*c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span></span></span></span>, then <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mi>d</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">a = de</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span></span></span></span> with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span> dividing <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span> dividing <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span></span></span></span>.</p>

<a name="187829212"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187829212" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187829212">Reid Barton (Feb 10 2020 at 16:03)</a>:</h4>
<p>You might have fun working out the rest of the proof.</p>

<a name="187829427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187829427" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187829427">Reid Barton (Feb 10 2020 at 16:05)</a>:</h4>
<p>(It's still kind of tricky after this step.)</p>

<a name="187829475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187829475" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187829475">Reid Barton (Feb 10 2020 at 16:06)</a>:</h4>
<p>I have FLT for n=4 lying around on my old laptop, but it is for a 2 year old version of mathlib so it probably doesn't work any more.</p>

<a name="187830198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187830198" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187830198">Alex Kontorovich (Feb 10 2020 at 16:14)</a>:</h4>
<p>Right, that's exactly where I'm going with this, FLT for n=4 (of course). Just to learn Lean. Thanks for the hint. </p>
<p>Related/complaint: I wish the file "prime.lean" used fever fancy tactics so mathematicians like me had less start-up cost...</p>

<a name="187830270"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187830270" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187830270">Mario Carneiro (Feb 10 2020 at 16:14)</a>:</h4>
<p>prime.lean uses very few fancy tactics last time I checked. In fact, that might be why it's not so readable</p>

<a name="187831558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187831558" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187831558">Alex Kontorovich (Feb 10 2020 at 16:27)</a>:</h4>
<p>Heh :) As a mathematician who came here because Kevin made his "game" look very much like "regular math", the fewer tactics (besides, say, "ring", which for me means, leave the algebra as an exercise) the better (at least for me, for now).</p>

<a name="187831702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187831702" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187831702">Reid Barton (Feb 10 2020 at 16:28)</a>:</h4>
<p>When I did this there was nothing in mathlib yet about prime factorization or multiplicity of primes so the easiest way was to use this little trick. But now we should be close to stating and proving things like if every exponent in the prime factorization of n is even, then n is a square, and of course these facts are more generally useful (or at least easiier to think of!)</p>

<a name="187831973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187831973" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187831973">Alex Kontorovich (Feb 10 2020 at 16:31)</a>:</h4>
<p>Agreed! Is there a place where ord_p(n) is defined? (Exponent of p in the prime factorization of n)</p>

<a name="187832116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187832116" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187832116">Alex Kontorovich (Feb 10 2020 at 16:32)</a>:</h4>
<p>I'm actually really curious in how the "descent" part of FLTn=4 will go. (Don't tell me yet... Still trying to get Pythagorean parametrization up and running)</p>

<a name="187832305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187832305" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187832305">Reid Barton (Feb 10 2020 at 16:35)</a>:</h4>
<p>See <code>multiplicity</code>, in <code>ring_theory.multiplicity</code></p>

<a name="187832422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/squares/near/187832422" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/04165squares.html#187832422">Alex Kontorovich (Feb 10 2020 at 16:36)</a>:</h4>
<p>Thanks!</p>


{% endraw %}

{% include archive_update.html %}