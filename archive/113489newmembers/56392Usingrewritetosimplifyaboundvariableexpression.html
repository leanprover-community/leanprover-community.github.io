---
layout: page
title: Lean Prover Zulip Chat Archive 
permalink: archive/113489newmembers/56392Usingrewritetosimplifyaboundvariableexpression.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113489newmembers/index.html">new members</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113489newmembers/56392Usingrewritetosimplifyaboundvariableexpression.html">Using rewrite to simplify a bound variable expression</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="130950190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20rewrite%20to%20simplify%20a%20bound%20variable%20expression/near/130950190" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/56392Usingrewritetosimplifyaboundvariableexpression.html#130950190">Ken Roe (Aug 06 2018 at 10:36)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">fsimp3</span> <span class="o">{</span> <span class="n">x</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="o">}</span> <span class="o">:</span> <span class="n">x</span><span class="bp">=</span><span class="mi">0</span> <span class="bp">→</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">intro</span><span class="o">,</span> <span class="n">unfold</span> <span class="n">f</span><span class="o">,</span> <span class="n">rw</span> <span class="n">a</span>
<span class="kn">end</span>

<span class="kn">theorem</span> <span class="n">fsimp4</span> <span class="o">{</span><span class="n">e</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="o">}</span> <span class="o">:</span> <span class="n">e</span><span class="bp">=</span><span class="mi">0</span> <span class="bp">→</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">,</span> <span class="n">x</span><span class="bp">+</span><span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span><span class="bp">=</span><span class="mi">1</span><span class="bp">+</span><span class="n">x</span><span class="o">)</span><span class="bp">=</span><span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">,</span> <span class="mi">1</span><span class="bp">=</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">intro</span><span class="o">,</span>
    <span class="n">rewrite</span> <span class="n">fsimp3</span><span class="o">,</span> <span class="n">simp</span>
<span class="kn">end</span>
</pre></div>


<p>How do I get the "rewrite fsimp3" tactic to work in the "fsimp4" proof?</p>

<a name="130950208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20rewrite%20to%20simplify%20a%20bound%20variable%20expression/near/130950208" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/56392Usingrewritetosimplifyaboundvariableexpression.html#130950208">Scott Morrison (Aug 06 2018 at 10:37)</a>:</h4>
<p>Probably use <code>conv</code>. Do you want to post an MWE?</p>

<a name="130950318"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20rewrite%20to%20simplify%20a%20bound%20variable%20expression/near/130950318" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/56392Usingrewritetosimplifyaboundvariableexpression.html#130950318">Ken Roe (Aug 06 2018 at 10:40)</a>:</h4>
<p>Go ahead and post</p>

<a name="130950372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20rewrite%20to%20simplify%20a%20bound%20variable%20expression/near/130950372" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/56392Usingrewritetosimplifyaboundvariableexpression.html#130950372">Scott Morrison (Aug 06 2018 at 10:42)</a>:</h4>
<p>No, I was suggesting that _you_ post a minimal example that shows the problem --- in particular you haven't included the definition of <code>f</code>!</p>

<a name="130950374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20rewrite%20to%20simplify%20a%20bound%20variable%20expression/near/130950374" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/56392Usingrewritetosimplifyaboundvariableexpression.html#130950374">Scott Morrison (Aug 06 2018 at 10:42)</a>:</h4>
<p>I think <code>def f (x : ℕ) := x + 1</code> probably serves your purpose.</p>

<a name="130950425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20rewrite%20to%20simplify%20a%20bound%20variable%20expression/near/130950425" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/56392Usingrewritetosimplifyaboundvariableexpression.html#130950425">Mario Carneiro (Aug 06 2018 at 10:44)</a>:</h4>
<p><code>rw</code> does not work under a binder. You can either use <code>simp</code> instead, or use <code>conv</code> or <code>funext</code> to enter the binder</p>

<a name="130950432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20rewrite%20to%20simplify%20a%20bound%20variable%20expression/near/130950432" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/56392Usingrewritetosimplifyaboundvariableexpression.html#130950432">Reid Barton (Aug 06 2018 at 10:45)</a>:</h4>
<p>For conv, see <a href="https://github.com/leanprover/mathlib/blob/master/docs/extras/conv.md" target="_blank" title="https://github.com/leanprover/mathlib/blob/master/docs/extras/conv.md">https://github.com/leanprover/mathlib/blob/master/docs/extras/conv.md</a></p>

<a name="130950433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20rewrite%20to%20simplify%20a%20bound%20variable%20expression/near/130950433" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/56392Usingrewritetosimplifyaboundvariableexpression.html#130950433">Ken Roe (Aug 06 2018 at 10:45)</a>:</h4>
<p>Oops--Missed that def</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:=</span> <span class="n">x</span><span class="bp">+</span><span class="mi">1</span>

<span class="kn">theorem</span> <span class="n">fsimp3</span> <span class="o">{</span> <span class="n">x</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="o">}</span> <span class="o">:</span> <span class="n">x</span><span class="bp">=</span><span class="mi">0</span> <span class="bp">→</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">intro</span><span class="o">,</span> <span class="n">unfold</span> <span class="n">f</span><span class="o">,</span> <span class="n">rw</span> <span class="n">a</span>
<span class="kn">end</span>

<span class="kn">theorem</span> <span class="n">fsimp4</span> <span class="o">{</span><span class="n">e</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="o">}</span> <span class="o">:</span> <span class="n">e</span><span class="bp">=</span><span class="mi">0</span> <span class="bp">→</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">,</span> <span class="n">x</span><span class="bp">+</span><span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span><span class="bp">=</span><span class="mi">1</span><span class="bp">+</span><span class="n">x</span><span class="o">)</span><span class="bp">=</span><span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">,</span> <span class="mi">1</span><span class="bp">=</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">intro</span><span class="o">,</span>
    <span class="n">rewrite</span> <span class="n">fsimp3</span><span class="o">,</span> <span class="n">simp</span>
<span class="kn">end</span>
</pre></div>

<a name="130950482"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20rewrite%20to%20simplify%20a%20bound%20variable%20expression/near/130950482" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/56392Usingrewritetosimplifyaboundvariableexpression.html#130950482">Scott Morrison (Aug 06 2018 at 10:46)</a>:</h4>
<p>I'm pretty confused how you intend to do anything using <code>rw fsimp3</code>, even under the binder.</p>

<a name="130950491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20rewrite%20to%20simplify%20a%20bound%20variable%20expression/near/130950491" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/56392Usingrewritetosimplifyaboundvariableexpression.html#130950491">Scott Morrison (Aug 06 2018 at 10:47)</a>:</h4>
<p>You've only got <code>e=0</code>, but now want to say something about all <code>x</code>?</p>

<a name="130950780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20rewrite%20to%20simplify%20a%20bound%20variable%20expression/near/130950780" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/56392Usingrewritetosimplifyaboundvariableexpression.html#130950780">Ken Roe (Aug 06 2018 at 10:56)</a>:</h4>
<p>It looks like conv fails:</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">fsimp4</span> <span class="o">{</span><span class="n">e</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="o">}</span> <span class="o">:</span> <span class="n">e</span><span class="bp">=</span><span class="mi">0</span> <span class="bp">→</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">,</span> <span class="n">x</span><span class="bp">+</span><span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span><span class="bp">=</span><span class="mi">1</span><span class="bp">+</span><span class="n">x</span><span class="o">)</span><span class="bp">=</span><span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">,</span> <span class="mi">1</span><span class="bp">=</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">intro</span><span class="o">,</span> <span class="n">simp</span><span class="o">,</span> <span class="n">conv</span>
    <span class="k">begin</span>
        <span class="n">to_lhs</span><span class="o">,</span>
        <span class="n">funext</span><span class="o">,</span>
        <span class="n">rw</span> <span class="n">fsimp3</span><span class="o">,</span> <span class="n">reflexivity</span><span class="o">,</span>
    <span class="kn">end</span>
<span class="kn">end</span>
</pre></div>


<p>I get the error:</p>
<div class="codehilite"><pre><span></span><span class="n">convert</span> <span class="n">tactic</span> <span class="n">failed</span><span class="o">,</span> <span class="n">there</span> <span class="n">are</span> <span class="n">unsolved</span> <span class="n">goals</span>
<span class="n">state</span><span class="o">:</span>
<span class="n">e</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">,</span>
<span class="n">a</span> <span class="o">:</span> <span class="n">e</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
<span class="n">x</span> <span class="o">:</span> <span class="bp">ℕ</span>
<span class="err">⊢</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">0</span>
</pre></div>

<a name="130950786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20rewrite%20to%20simplify%20a%20bound%20variable%20expression/near/130950786" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/56392Usingrewritetosimplifyaboundvariableexpression.html#130950786">Reid Barton (Aug 06 2018 at 10:57)</a>:</h4>
<p>That's because, as Scott pointed out, what you're trying to prove is not true</p>

<a name="130950908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20rewrite%20to%20simplify%20a%20bound%20variable%20expression/near/130950908" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/56392Usingrewritetosimplifyaboundvariableexpression.html#130950908">Ken Roe (Aug 06 2018 at 11:01)</a>:</h4>
<p>Actually, I found the error:</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">fsimp4</span> <span class="o">{</span><span class="n">e</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="o">}</span> <span class="o">:</span> <span class="n">e</span><span class="bp">=</span><span class="mi">0</span> <span class="bp">→</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">,</span> <span class="n">x</span><span class="bp">+</span><span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span><span class="bp">=</span><span class="mi">1</span><span class="bp">+</span><span class="n">x</span><span class="o">)</span> <span class="n">e</span><span class="bp">=</span><span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">,</span> <span class="mi">1</span><span class="bp">=</span><span class="mi">1</span><span class="o">)</span> <span class="n">e</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">intro</span><span class="o">,</span> <span class="n">conv</span>
    <span class="k">begin</span>
        <span class="n">to_lhs</span><span class="o">,</span>
        <span class="n">simp</span><span class="o">,</span> <span class="n">rw</span> <span class="n">a</span><span class="o">,</span>
        <span class="n">funext</span><span class="o">,</span>
        <span class="n">rw</span> <span class="n">fsimp3</span><span class="o">,</span> <span class="n">skip</span><span class="o">,</span> <span class="n">reflexivity</span>
    <span class="kn">end</span>
<span class="kn">end</span>
</pre></div>


<p>However, the error I got is confusing.  The "x=0" got changed to "x" on the screen in the message.</p>

<a name="130951440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20rewrite%20to%20simplify%20a%20bound%20variable%20expression/near/130951440" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/56392Usingrewritetosimplifyaboundvariableexpression.html#130951440">Mario Carneiro (Aug 06 2018 at 11:18)</a>:</h4>
<p>this proof attempt is not valid for the same reason as before. You can't try to prove the functions are equal because they aren't. You can only prove that the functions <em>evaluated at <code>e</code></em> are equal, so you need to do beta reduction first (using <code>dsimp</code>) and then try to prove it</p>


{% endraw %}
