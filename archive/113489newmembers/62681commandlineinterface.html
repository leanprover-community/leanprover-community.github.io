---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113489newmembers/62681commandlineinterface.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113489newmembers/index.html">new members</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html">command line interface</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="192006856"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192006856" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192006856">Jiekai (Mar 27 2020 at 11:54)</a>:</h4>
<p>My vscode lean environment constantly run out of memory.   I'm wondering if there is a command line interface?<br>
Here is the my lean file.  What command should I use to output the <code>#check</code> result?</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">complex</span><span class="bp">.</span><span class="n">exponential</span>

<span class="kn">open</span> <span class="n">real</span>

<span class="bp">#</span><span class="kn">check</span> <span class="n">pi</span>
</pre></div>

<a name="192006896"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192006896" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192006896">Jiekai (Mar 27 2020 at 11:55)</a>:</h4>
<p>Trying to go through &lt;<a href="https://github.com/kbuzzard/xena/blob/master/lean_together/5_minutes_on_type_theory/2_more_type_examples.lean" title="https://github.com/kbuzzard/xena/blob/master/lean_together/5_minutes_on_type_theory/2_more_type_examples.lean">https://github.com/kbuzzard/xena/blob/master/lean_together/5_minutes_on_type_theory/2_more_type_examples.lean</a>&gt;</p>

<a name="192009771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192009771" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192009771">Kevin Buzzard (Mar 27 2020 at 12:30)</a>:</h4>
<p>Oh my goodness how do people find these random things</p>

<a name="192009843"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192009843" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192009843">Kevin Buzzard (Mar 27 2020 at 12:31)</a>:</h4>
<p>Why don't you just fix your VS Code lean environment?</p>

<a name="192009844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192009844" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192009844">Kevin Buzzard (Mar 27 2020 at 12:31)</a>:</h4>
<p>There are commend line options to limit the amount of memory lean uses</p>

<a name="192009872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192009872" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192009872">Kevin Buzzard (Mar 27 2020 at 12:31)</a>:</h4>
<p>And you can tell VS Code to use these options when it invokes Lean</p>

<a name="192009987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192009987" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192009987">Marc Huisinga (Mar 27 2020 at 12:32)</a>:</h4>
<p>if you publish anything on the web, someone's gonna find it ;)</p>

<a name="192010003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192010003" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192010003">Kevin Buzzard (Mar 27 2020 at 12:32)</a>:</h4>
<p>That stuff you stumbled upon is some ideas for scripts for five minute lean videos</p>

<a name="192010013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192010013" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192010013">Kevin Buzzard (Mar 27 2020 at 12:32)</a>:</h4>
<p>I have more not online</p>

<a name="192010035"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192010035" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192010035">Jiekai (Mar 27 2020 at 12:33)</a>:</h4>
<p><a href="https://av-media.vu.nl/mediasite/Play/27894c3a8a4d4768a0421f62e5345a6c1d" title="https://av-media.vu.nl/mediasite/Play/27894c3a8a4d4768a0421f62e5345a6c1d">https://av-media.vu.nl/mediasite/Play/27894c3a8a4d4768a0421f62e5345a6c1d</a></p>
<p>I'm watching the video <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>

<a name="192010067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192010067" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192010067">Kevin Buzzard (Mar 27 2020 at 12:33)</a>:</h4>
<p>Maybe it's time some of those videos got made. The big issue I had with making them is that I want wacky graphics and don't know how to make them</p>

<a name="192010167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192010167" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192010167">Kevin Buzzard (Mar 27 2020 at 12:34)</a>:</h4>
<p>I mean I want something which could easily be knocked up in 5 minutes by someone who knows how to use PowerPoint</p>

<a name="192099726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192099726" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192099726">Jiekai (Mar 28 2020 at 02:00)</a>:</h4>
<p>Looking into the vscode lean server situation, there seems to be some sort of memory leak.  The memory lean process uses increases at 100MiB / sec.<br>
The process command:<br>
<code>/home/zjk/.elan/toolchains/leanprover-community-lean-3.5.1/bin/lean --server -M 4096 -T 100000 */home/zjk/github/M4P33*</code></p>

<a name="192102417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192102417" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192102417">Scott Morrison (Mar 28 2020 at 03:11)</a>:</h4>
<p>Can you provide us a reproducible case to run it on?</p>

<a name="192112708"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192112708" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192112708">Jiekai (Mar 28 2020 at 08:37)</a>:</h4>
<p>I think all I did is typing this line then after several seconds commenting it out.</p>
<div class="codehilite"><pre><span></span><span class="c1">-- import analysis.complex.basic</span>
</pre></div>

<a name="192112797"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192112797" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192112797">Jiekai (Mar 28 2020 at 08:39)</a>:</h4>
<div class="codehilite"><pre><span></span>_target/deps/mathlib$ git status
HEAD detached at 8700aa7d
nothing to commit, working tree clean
</pre></div>


<p>Not sure if this is relevant.</p>

<a name="192113419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192113419" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192113419">Jiekai (Mar 28 2020 at 08:59)</a>:</h4>
<p>Seems quite reproducible.  I change this &lt;<a href="https://github.com/leanprover/lean-client-js/blob/master/lean-client-js-node/demo.ts" title="https://github.com/leanprover/lean-client-js/blob/master/lean-client-js-node/demo.ts">https://github.com/leanprover/lean-client-js/blob/master/lean-client-js-node/demo.ts</a>&gt; to </p>
<div class="codehilite"><pre><span></span>diff --git a/lean-client-js-node/demo.ts b/lean-client-js-node/demo.ts
index 895d0da..1b0071c 100644
--- a/lean-client-js-node/demo.ts
+++ b/lean-client-js-node/demo.ts
@@ -1,6 +1,8 @@
 import * as lean from &#39;./src&#39;;

-const transport = new lean.ProcessTransport(&#39;lean&#39;, &#39;.&#39;, []);
+const transport = new lean.ProcessTransport(
+  &#39;/home/zjk/.elan/toolchains/leanprover-community-lean-3.5.1/bin/lean&#39;,
+  &#39;/home/zjk/github/M4P33&#39;, [&#39;-M 4096&#39;, &#39;-T 100000&#39;]);
 const server = new lean.Server(transport);
 server.error.on((err) =&gt; console.log(&#39;error:&#39;, err));
 server.allMessages.on((allMessages) =&gt; console.log(&#39;messages&#39;, allMessages.msgs));
@@ -8,16 +10,10 @@ server.tasks.on((currentTasks) =&gt; console.log(&#39;tasks:&#39;, currentTasks.tasks));

 server.connect();

-const testfile = &#39;&#39;
-    + &#39;variables p q r s : Prop\n&#39;
-    + &#39;theorem my_and_comm : p /\\ q &lt;-&gt; q /\\ p :=\n&#39;
-    + &#39;iff.intro\n&#39;
-    + &#39;  (assume Hpq : p /\\ q,\n&#39;
-    + &#39;    and.intro (and.elim_right Hpq) (and.elim_left Hpq))\n&#39;
-    + &#39;  (assume Hqp : q /\\ p,\n&#39;
-    + &#39;    and.intro (and.elim_right Hqp) {!!})\n&#39;
-    + &#39;#check @nat.rec_on\n&#39;
-    + &#39;#print &quot;end of file!&quot;\n&#39;;
+const testfile = `
+import analysis.complex.basic
+
+`;

 async function demo(): Promise&lt;any&gt; {
     await server.sync(&#39;test.lean&#39;, testfile);
@@ -34,14 +30,14 @@ async function demo(): Promise&lt;any&gt; {
     }

     const info = await server.info(&#39;test.lean&#39;, 3, 0);
-    console.log(`got info: ${JSON.stringify(info)}`);
+    // console.log(`got info: ${JSON.stringify(info)}`);
 }

 async function main(): Promise&lt;any&gt; {
     await demo();
-    server.restart();
-    await demo();
-    process.exit(0);
+    // server.restart();
+    // await demo();
+    // process.exit(0);
 }

 main().catch((err) =&gt; console.log(&#39;error:&#39;, err));
</pre></div>


<p>Then I have until the process is killed</p>
<div class="codehilite"><pre><span></span>  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
 1454 zjk       20   0 10.706g 9.749g   9368 S 507.3 62.9  20:52.73 lean
21454 zjk       20   0 11.190g 1.571g  35832 S   1.3 10.1  25:29.84 java
</pre></div>

<a name="192116414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192116414" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192116414">Scott Morrison (Mar 28 2020 at 10:23)</a>:</h4>
<p>Can you make sure <code>leanpkg build</code> returns in &lt;30 secs, and post your <code>leanpkg.toml</code> file and the output of <code>ls</code> in your project directory?</p>

<a name="192116753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192116753" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192116753">Jiekai (Mar 28 2020 at 10:32)</a>:</h4>
<p><code>leanpkg build</code> never returns correctly and uses all memory eventually.</p>

<a name="192116762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192116762" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192116762">Jiekai (Mar 28 2020 at 10:33)</a>:</h4>
<p>My project directory is a cloned <code>https://github.com/ImperialCollegeLondon/M4P33</code>.</p>

<a name="192116766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192116766" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192116766">Jiekai (Mar 28 2020 at 10:33)</a>:</h4>
<div class="codehilite"><pre><span></span>[package]
name = &quot;M4P33&quot;
version = &quot;0.1&quot;
lean_version = &quot;leanprover-community/lean:3.5.1&quot;
path = &quot;src&quot;

[dependencies]
mathlib = {git = &quot;https://github.com/leanprover-community/mathlib&quot;, rev = &quot;8700aa7d78b10b65cf8db1d9e320872ae313517a&quot;}
</pre></div>

<a name="192117260"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192117260" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192117260">Jiekai (Mar 28 2020 at 10:47)</a>:</h4>
<div class="codehilite"><pre><span></span>$ ls -l
total 44
drwxr-xr-x 2 zjk zjk  4096 3月  26 10:43 doc
-rw-r--r-- 1 zjk zjk    54 3月  28 18:40 leanpkg.path
-rw-r--r-- 1 zjk zjk   237 3月  28 10:33 leanpkg.toml
-rw-r--r-- 1 zjk zjk 11357 3月  26 10:43 LICENSE
drwxr-xr-x 3 zjk zjk  4096 3月  26 10:43 problem_sheets
-rw-r--r-- 1 zjk zjk  1816 3月  26 10:43 README.md
drwxr-xr-x 6 zjk zjk  4096 3月  28 18:40 src
drwxr-xr-x 3 zjk zjk  4096 3月  27 17:04 _target
-rw-r--r-- 1 zjk zjk   266 3月  26 10:43 TODO.txt
</pre></div>

<a name="192117472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192117472" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192117472">Jiekai (Mar 28 2020 at 10:53)</a>:</h4>
<p>Oh. <code>leanpkg build</code> finished.  Seems that in the previous run I just give up when memory usage hit 4Gib and killed <code>leanpkg build</code>.</p>

<a name="192117514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192117514" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192117514">Jiekai (Mar 28 2020 at 10:54)</a>:</h4>
<p>Now it all seems working.  Thank you!  So <code>leanpkg build</code> is crucial.</p>

<a name="192117542"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192117542" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192117542">Kevin Buzzard (Mar 28 2020 at 10:55)</a>:</h4>
<p>Nobody should be using leanpkg any more</p>

<a name="192117590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192117590" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192117590">Kevin Buzzard (Mar 28 2020 at 10:56)</a>:</h4>
<p>If you install the project with <code>leanproject</code> do you get the same problems? This should download a compiled mathlib</p>

<a name="192117591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192117591" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192117591">Jiekai (Mar 28 2020 at 10:56)</a>:</h4>
<p>Anywhere I can learn about difference between<code>leanpkg</code> and <code>leanproject</code>?</p>

<a name="192117600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192117600" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192117600">Kevin Buzzard (Mar 28 2020 at 10:57)</a>:</h4>
<p>Leanproject handles projects which aren't on 3.4.2 like the M4P33 one</p>

<a name="192119084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192119084" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192119084">Patrick Massot (Mar 28 2020 at 11:41)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> this project is not so old, it actually has available mathlib olean (although they are still on GitHub, so API limiting rate may strike). Could you change the README to tell people to <code>leanproject get ImperialCollegeLondon/M4P33</code>?</p>

<a name="192119952"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192119952" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192119952">Kevin Buzzard (Mar 28 2020 at 12:05)</a>:</h4>
<p>Oh sure! I hadn't realised it was my fault</p>

<a name="192119956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192119956" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192119956">Kevin Buzzard (Mar 28 2020 at 12:05)</a>:</h4>
<p>I should do this for all my repos</p>

<a name="192120143"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/command%20line%20interface/near/192120143" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/62681commandlineinterface.html#192120143">Patrick Massot (Mar 28 2020 at 12:10)</a>:</h4>
<p>By the way, I'm working on the weird message about not being in a Git repository. I totally understand where it comes from. The problem is that fetching oleans from GitHub instead of Azure is half deprecated, still supported by mathlibtools but not well tested.</p>


{% endraw %}

{% include archive_update.html %}