---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113489newmembers/45971Uniquenessofbinaryexpansions.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113489newmembers/index.html">new members</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html">Uniqueness of binary expansions</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="183499723"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183499723" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183499723">Bhavik Mehta (Dec 15 2019 at 18:58)</a>:</h4>
<p>Any suggestions on how to prove this function is injective?</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">binary</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">finset</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">))</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="o">:=</span> <span class="n">A</span><span class="bp">.</span><span class="n">sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">pow</span> <span class="mi">2</span> <span class="n">x</span><span class="bp">.</span><span class="n">val</span><span class="o">)</span>
</pre></div>

<a name="183502459"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183502459" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183502459">Kevin Buzzard (Dec 15 2019 at 20:12)</a>:</h4>
<p>My instinct would be to do the proofs with a function taking values in int not nat, because subtraction will be involved, and then deduce the nat version from the int version.</p>

<a name="183502530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183502530" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183502530">Kevin Buzzard (Dec 15 2019 at 20:14)</a>:</h4>
<p>As for proving it, the 2-adic method would be to find the smallest index i where two different finsets differ and then show that the difference was not a multiple of 2^i and hence can't be zero. The real method would be to find the largest index where they differ and then show that the difference has to be positive and hence non-zero.</p>

<a name="183502582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183502582" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183502582">Kevin Buzzard (Dec 15 2019 at 20:15)</a>:</h4>
<p>Maybe another idea would be to define binary expansions of a nat (which might be there already) and prove that i is in A iff the i'th digit is 1.</p>

<a name="183502627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183502627" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183502627">Kevin Buzzard (Dec 15 2019 at 20:16)</a>:</h4>
<p>i.e. write a one-sided inverse</p>

<a name="183502629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183502629" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183502629">Chris Hughes (Dec 15 2019 at 20:16)</a>:</h4>
<p>I don't think this will ever be a short proof. Probably there should be some theory of base-n expansions. You'll probably have to write the left inverse to this function and prove it's a left inverse.</p>

<a name="183502636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183502636" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183502636">Chris Hughes (Dec 15 2019 at 20:16)</a>:</h4>
<p>Also, I would use <code>finset nat</code> not <code>finset (fin n)</code></p>

<a name="183502983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183502983" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183502983">YH (Dec 15 2019 at 20:27)</a>:</h4>
<p>Where is <code>finset.sum</code> defined?</p>

<a name="183503060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183503060" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183503060">Chris Hughes (Dec 15 2019 at 20:29)</a>:</h4>
<p><code>algebra.big_operators</code></p>

<a name="183503109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183503109" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183503109">YH (Dec 15 2019 at 20:30)</a>:</h4>
<p>Oh found it in <code>data.finsupp</code></p>

<a name="183503248"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183503248" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183503248">Kevin Buzzard (Dec 15 2019 at 20:34)</a>:</h4>
<p>If you use finset nat you can prove an explicit equiv between that and nat</p>

<a name="183503729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183503729" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183503729">YH (Dec 15 2019 at 20:46)</a>:</h4>
<p>I guess we can just write an inverse like</p>
<div class="codehilite"><pre><span></span>import data.finset data.finsupp
open finset set
def binary (A : finset ℕ) : ℕ := A.sum (λ x, pow 2 x)

def binary_reverse : ℕ → finset ℕ
| 0 := ∅
| (n+1) :=
  let A := binary_reverse n in
</pre></div>


<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∪</mo><mi>k</mi><mi mathvariant="normal">\</mi><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">A ∪ {k} \backslash \{0,1,..., k-1\}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span><span class="mord">\</span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span> where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> is the smallest natural number not in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">N</mi></mrow><annotation encoding="application/x-tex">ℕ</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord amsrm">N</span></span></span></span> (now I need to learn how to write this in Lean...)</p>

<a name="183504130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183504130" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183504130">Kevin Buzzard (Dec 15 2019 at 20:57)</a>:</h4>
<p>I think I'd be tempted to do this with <code>num</code> not nat</p>

<a name="183504182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183504182" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183504182">Kevin Buzzard (Dec 15 2019 at 20:58)</a>:</h4>
<p>This work must have been done already in essence, when proving nat and num are the same</p>

<a name="183504189"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183504189" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183504189">YH (Dec 15 2019 at 20:58)</a>:</h4>
<p>What is <code>num</code>?</p>

<a name="183504192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183504192" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183504192">Kevin Buzzard (Dec 15 2019 at 20:58)</a>:</h4>
<p>It's in core I think</p>

<a name="183504203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183504203" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183504203">Kevin Buzzard (Dec 15 2019 at 20:59)</a>:</h4>
<p>It's nats but defined as binary sequences</p>

<a name="183504282"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183504282" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183504282">Kevin Buzzard (Dec 15 2019 at 21:00)</a>:</h4>
<p>I'm on phone right now, but try importing data.num.basic of it exists, and then #check num and right click</p>

<a name="183504301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183504301" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183504301">Chris Hughes (Dec 15 2019 at 21:00)</a>:</h4>
<p>Here's a start. There's a bunch of sorries, and I do have a habit of leaving false sorries.</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">nat</span><span class="bp">.</span><span class="n">modeq</span> <span class="n">data</span><span class="bp">.</span><span class="n">fin</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">big_operators</span> <span class="n">data</span><span class="bp">.</span><span class="n">nat</span><span class="bp">.</span><span class="n">parity</span>

<span class="kn">variable</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span>
<span class="kn">open</span> <span class="n">function</span> <span class="n">nat</span> <span class="n">finset</span>

<span class="n">def</span> <span class="n">binary</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">finset</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="o">:=</span> <span class="n">A</span><span class="bp">.</span><span class="n">sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">pow</span> <span class="mi">2</span> <span class="n">x</span><span class="o">)</span>

<span class="n">def</span> <span class="n">ith_bit</span> <span class="o">(</span><span class="n">n</span> <span class="n">i</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:=</span> <span class="n">n</span> <span class="bp">/</span> <span class="mi">2</span> <span class="err">^</span> <span class="n">i</span> <span class="err">%</span> <span class="mi">2</span>

<span class="kn">lemma</span> <span class="n">ith_bit_binary</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">finset</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">i</span> <span class="err">∈</span> <span class="n">A</span> <span class="bp">↔</span> <span class="bp">¬</span> <span class="n">even</span> <span class="o">(</span><span class="n">binary</span> <span class="n">A</span> <span class="bp">/</span> <span class="mi">2</span> <span class="err">^</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">finset</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">A</span>
  <span class="o">(</span><span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">binary</span><span class="o">,</span> <span class="n">ith_bit</span><span class="o">])</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span> <span class="n">s</span> <span class="n">has</span> <span class="n">ih</span> <span class="n">i</span><span class="o">,</span> <span class="k">begin</span>
    <span class="n">dsimp</span> <span class="o">[</span><span class="n">binary</span><span class="o">,</span> <span class="n">ith_bit</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">sum_insert</span> <span class="n">has</span><span class="o">,</span> <span class="n">mem_insert</span><span class="o">,</span> <span class="n">nat</span><span class="bp">.</span><span class="n">add_div</span><span class="o">,</span> <span class="n">if_neg</span><span class="o">],</span>
    <span class="n">rcases</span> <span class="n">lt_trichotomy</span> <span class="n">i</span> <span class="n">a</span> <span class="k">with</span> <span class="n">hia</span><span class="bp">|</span><span class="n">rfl</span><span class="bp">|</span><span class="n">hai</span><span class="o">,</span>
    <span class="o">{</span> <span class="k">have</span> <span class="o">:</span> <span class="n">even</span> <span class="o">(</span><span class="mi">2</span><span class="err">^</span><span class="n">a</span> <span class="bp">/</span> <span class="mi">2</span><span class="err">^</span><span class="n">i</span><span class="o">),</span> <span class="k">from</span> <span class="n">sorry</span><span class="o">,</span>
      <span class="n">simp</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span> <span class="n">ne_of_lt</span> <span class="n">hia</span><span class="o">,</span> <span class="n">ih</span><span class="o">]</span> <span class="k">with</span> <span class="n">parity_simps</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">nat</span><span class="bp">.</span><span class="n">div_self</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">pow_pos</span> <span class="o">(</span><span class="k">show</span> <span class="mi">2</span> <span class="bp">&gt;</span> <span class="mi">0</span><span class="o">,</span> <span class="k">from</span> <span class="n">dec_trivial</span><span class="o">)</span> <span class="bp">_</span><span class="o">),</span>
        <span class="n">nat</span><span class="bp">.</span><span class="n">mod_self</span><span class="o">]</span> <span class="k">with</span> <span class="n">parity_simps</span><span class="o">,</span>
      <span class="n">finish</span> <span class="o">},</span>
    <span class="o">{</span> <span class="k">have</span> <span class="o">:</span> <span class="mi">2</span><span class="err">^</span><span class="n">a</span> <span class="bp">/</span> <span class="mi">2</span><span class="err">^</span><span class="n">i</span> <span class="bp">=</span> <span class="mi">2</span><span class="err">^</span><span class="n">a</span><span class="o">,</span> <span class="k">from</span> <span class="n">sorry</span><span class="o">,</span>
      <span class="n">simp</span> <span class="o">[</span><span class="n">ne_of_gt</span> <span class="n">hai</span><span class="o">,</span> <span class="n">this</span><span class="o">,</span> <span class="n">ih</span><span class="o">]</span> <span class="k">with</span> <span class="n">parity_simps</span><span class="o">,</span>
      <span class="n">by_cases</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
      <span class="n">simp</span> <span class="bp">*</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span> <span class="n">sorry</span><span class="o">,</span>
      <span class="n">simp</span> <span class="bp">*</span> <span class="o">},</span>
    <span class="n">sorry</span><span class="o">,</span>
    <span class="n">sorry</span><span class="o">,</span>
  <span class="kn">end</span><span class="o">)</span>
</pre></div>

<a name="183504412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183504412" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183504412">YH (Dec 15 2019 at 21:03)</a>:</h4>
<blockquote>
<p>I'm on phone right now, but try importing data.num.basic of it exists, and then #check num and right click</p>
</blockquote>
<p>I see. I think this problem is essentially the same as proving <code>nat</code> and <code>num</code> are the same?</p>

<a name="183505570"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183505570" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183505570">Bhavik Mehta (Dec 15 2019 at 21:34)</a>:</h4>
<blockquote>
<p>Also, I would use <code>finset nat</code> not <code>finset (fin n)</code></p>
</blockquote>
<p>I usually would, but this is in the context of a lot of other stuff, where I need <code>finset (fin n)</code>. I'd be happy to prove it for <code>finset nat</code> instead and convert from that to this result</p>

<a name="183505625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183505625" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183505625">Bhavik Mehta (Dec 15 2019 at 21:36)</a>:</h4>
<blockquote>
<p>Here's a start. There's a bunch of sorries, and I do have a habit of leaving false sorries.</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">ith_bit</span> <span class="o">(</span><span class="n">n</span> <span class="n">i</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:=</span> <span class="n">n</span> <span class="bp">/</span> <span class="mi">2</span> <span class="err">^</span> <span class="n">i</span> <span class="err">%</span> <span class="mi">2</span>
</pre></div>


</blockquote>
<p>There's <code>test_bit</code>, by the way - perhaps that would be nicer</p>

<a name="183506073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183506073" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183506073">Chris Hughes (Dec 15 2019 at 21:51)</a>:</h4>
<p>Almost certainly better. It shouldn't be too hard to prove given the lemmas in the file.</p>

<a name="183509247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183509247" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183509247">Bhavik Mehta (Dec 15 2019 at 23:27)</a>:</h4>
<blockquote>
<p>Here's a start. There's a bunch of sorries, and I do have a habit of leaving false sorries.</p>
<div class="codehilite"><pre><span></span><span class="k">have</span> <span class="o">:</span> <span class="mi">2</span><span class="err">^</span><span class="n">a</span> <span class="bp">/</span> <span class="mi">2</span><span class="err">^</span><span class="n">i</span> <span class="bp">=</span> <span class="mi">2</span><span class="err">^</span><span class="n">a</span><span class="o">,</span> <span class="k">from</span> <span class="n">sorry</span><span class="o">,</span>
</pre></div>


</blockquote>
<p>I'm fairly sure this sorry is false - the only assumption on <code>i</code> here is that <code>a &lt; i</code>, so <code>2^a / 2^i</code> is zero</p>

<a name="183509908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183509908" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183509908">Mario Carneiro (Dec 15 2019 at 23:47)</a>:</h4>
<p>I think the easiest way to prove this one is as follows: Suppose <code>binary A = binary B</code>, and <code>A != B</code>. Then there exists a largest <code>k</code> where they differ; suppose that it is in <code>A</code>. Then <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>A</mi></mrow></msub><msup><mn>2</mn><mi>i</mi></msup><mo>≥</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>A</mi><mo separator="true">,</mo><mi>i</mi><mo>&gt;</mo><mi>k</mi></mrow></msub><msup><mn>2</mn><mi>i</mi></msup><mo>+</mo><msup><mn>2</mn><mi>k</mi></msup><mo>=</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>B</mi><mo separator="true">,</mo><mi>i</mi><mo>&gt;</mo><mi>k</mi></mrow></msub><msup><mn>2</mn><mi>i</mi></msup><mo>+</mo><msup><mn>2</mn><mi>k</mi></msup><mo>&gt;</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>B</mi><mo separator="true">,</mo><mi>i</mi><mo>&gt;</mo><mi>k</mi></mrow></msub><msup><mn>2</mn><mi>i</mi></msup><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msup><mn>2</mn><mi>i</mi></msup><mo>≥</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>B</mi><mo separator="true">,</mo><mi>i</mi><mo>&gt;</mo><mi>k</mi></mrow></msub><msup><mn>2</mn><mi>i</mi></msup><mo>+</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>B</mi><mo separator="true">,</mo><mi>i</mi><mo>&lt;</mo><mi>k</mi></mrow></msub><msup><mn>2</mn><mi>i</mi></msup><mo>=</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>B</mi></mrow></msub><msup><mn>2</mn><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">\sum_{i\in A} 2^i\ge \sum_{i\in A,i&gt;k} 2^i+2^k = \sum_{i\in B,i&gt;k} 2^i+2^k &gt;\sum_{i\in B,i&gt;k} 2^i+\sum_{i=0}^{k-1}2^i\ge \sum_{i\in B,i&gt;k} 2^i+\sum_{i\in B, i&lt;k}2^i=\sum_{i\in B} 2^i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.1517439999999999em;vertical-align:-0.32708000000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.17862099999999992em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.260482em;vertical-align:-0.43581800000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.18639799999999984em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight">A</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span><span class="mrel mtight">&gt;</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.260482em;vertical-align:-0.43581800000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.18639799999999984em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span><span class="mrel mtight">&gt;</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.888208em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.260482em;vertical-align:-0.43581800000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.18639799999999984em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span><span class="mrel mtight">&gt;</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.2887179999999998em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9890079999999999em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.260482em;vertical-align:-0.43581800000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.18639799999999984em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span><span class="mrel mtight">&gt;</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.260482em;vertical-align:-0.43581800000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.18639799999999984em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span><span class="mrel mtight">&lt;</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1517439999999999em;vertical-align:-0.32708000000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.17862099999999992em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span></p>

<a name="183509955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183509955" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183509955">Bhavik Mehta (Dec 15 2019 at 23:48)</a>:</h4>
<p>This looks great, thanks!</p>

<a name="183515737"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Uniqueness%20of%20binary%20expansions/near/183515737" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/45971Uniquenessofbinaryexpansions.html#183515737">Chris Hughes (Dec 16 2019 at 02:51)</a>:</h4>
<blockquote>
<blockquote>
<p>Here's a start. There's a bunch of sorries, and I do have a habit of leaving false sorries.</p>
<div class="codehilite"><pre><span></span><span class="k">have</span> <span class="o">:</span> <span class="mi">2</span><span class="err">^</span><span class="n">a</span> <span class="bp">/</span> <span class="mi">2</span><span class="err">^</span><span class="n">i</span> <span class="bp">=</span> <span class="mi">2</span><span class="err">^</span><span class="n">a</span><span class="o">,</span> <span class="k">from</span> <span class="n">sorry</span><span class="o">,</span>
</pre></div>


</blockquote>
<p>I'm fairly sure this sorry is false - the only assumption on <code>i</code> here is that <code>a &lt; i</code>, so <code>2^a / 2^i</code> is zero</p>
</blockquote>
<p>Yes it's false, I got <code>mod</code> and <code>div</code> confused. It should be equal to zero, in which case the proof is a little easier.</p>


{% endraw %}

{% include archive_update.html %}