---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113489newmembers/16588Firstproblemsingrouptheory.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113489newmembers/index.html">new members</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html">First problems in group theory</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="187916327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187916327" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187916327">Laurent Bartholdi (Feb 11 2020 at 14:30)</a>:</h4>
<p>Hello world!<br>
I played enough of the "number game" that I thought I should try something a bit different -- more in my area, and more advanced.</p>
<p>I checked that Lean has the concepts of group, and in particular finite groups, built-in. I was thinking about proving the following theorems, in order of difficulty:<br>
-- The group generated by x-&gt;x+1 acting on the reals is the free group &lt;a|&gt;<br>
-- The group generated by x-&gt;x+1 and x-&gt;2x has as presentation &lt;a,b|ab=ba^2&gt;<br>
-- The group generated by x-&gt;x+1 and x-&gt;x^3 is the free group &lt;a,b|&gt;</p>
<p>Any opinions on whether this is a sensible task for a newbie?</p>
<p>TIA, Laurent</p>

<a name="187917115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187917115" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187917115">Johan Commelin (Feb 11 2020 at 14:36)</a>:</h4>
<p><span class="user-mention" data-user-id="263407">@Laurent Bartholdi</span> What exactly do you mean with "the group generated by x -&gt; x+1 and x -&gt; x^3"?</p>

<a name="187917152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187917152" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187917152">Johan Commelin (Feb 11 2020 at 14:37)</a>:</h4>
<p>Are you fixing a real number, and then taking the closure under those functions?</p>

<a name="187917287"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187917287" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187917287">Johan Commelin (Feb 11 2020 at 14:38)</a>:</h4>
<p>Anyway, I think such statements can be done in Lean, although there might be some annoying technicalities.</p>

<a name="187917849"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187917849" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187917849">Laurent Bartholdi (Feb 11 2020 at 14:45)</a>:</h4>
<blockquote>
<p>Are you fixing a real number, and then taking the closure under those functions?</p>
</blockquote>
<p>There are two options. I could think about maps on the reals, and this is my preferred choice. I could also think of the orbit of \pi under these operations (assuming lean knows that \pi is transcendental, of course).</p>

<a name="187921238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187921238" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187921238">Johan Commelin (Feb 11 2020 at 15:23)</a>:</h4>
<p>It doesn't know that <code>pi</code> is transcendental</p>

<a name="187921317"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187921317" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187921317">Johan Commelin (Feb 11 2020 at 15:24)</a>:</h4>
<p>Aha, so you want to look at subgroups of <code>Aut(R)</code>, sorry, I was being dense.</p>

<a name="187921391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187921391" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187921391">Johan Commelin (Feb 11 2020 at 15:25)</a>:</h4>
<p>There is something called <code>\R \equiv \R</code>, which is all bijections from R to itself.</p>

<a name="187921399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187921399" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187921399">Johan Commelin (Feb 11 2020 at 15:25)</a>:</h4>
<p>Lean knows that it is a group.</p>

<a name="187921406"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187921406" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187921406">Johan Commelin (Feb 11 2020 at 15:25)</a>:</h4>
<p>Lean also knows how to generate a subgroup from a set.</p>

<a name="187921462"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187921462" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187921462">Johan Commelin (Feb 11 2020 at 15:26)</a>:</h4>
<p>So you could start by building the bijections that you stated in your post. That would be task 0.1 I guess</p>

<a name="187921534"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187921534" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187921534">Johan Commelin (Feb 11 2020 at 15:27)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">add_one</span> <span class="o">:</span> <span class="err">\</span><span class="n">R</span> <span class="err">\</span><span class="n">equiv</span> <span class="err">\</span><span class="n">R</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">to_fun</span> <span class="o">:=</span> <span class="n">sorry</span><span class="o">,</span>
  <span class="n">inv_fun</span> <span class="o">:=</span> <span class="n">sorry</span><span class="o">,</span>
  <span class="n">left_inv</span> <span class="o">:=</span> <span class="n">sorry</span><span class="o">,</span>
  <span class="n">right_inv</span> <span class="o">:=</span> <span class="n">sorry</span> <span class="o">}</span>

<span class="n">def</span> <span class="n">double</span> <span class="o">:</span> <span class="err">\</span><span class="n">R</span> <span class="err">\</span><span class="n">equiv</span> <span class="err">\</span><span class="n">R</span> <span class="o">:=</span> <span class="n">sorry</span>

<span class="n">def</span> <span class="n">pow_three</span> <span class="o">:</span> <span class="err">\</span><span class="n">R</span> <span class="err">\</span><span class="n">equiv</span> <span class="err">\</span><span class="n">R</span> <span class="o">:=</span> <span class="n">sorry</span>
</pre></div>

<a name="187921548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187921548" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187921548">Johan Commelin (Feb 11 2020 at 15:27)</a>:</h4>
<p>(Sorry, no unicode nearby...)</p>

<a name="187929480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187929480" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187929480">Kevin Buzzard (Feb 11 2020 at 16:48)</a>:</h4>
<p>It will be no problem proving that the group generated by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>↦</mo><mi>x</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x\mapsto x+1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.522em;vertical-align:-0.011em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">↦</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> is isomorphic to the free group.</p>

<a name="187930395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187930395" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187930395">Kevin Buzzard (Feb 11 2020 at 16:58)</a>:</h4>
<p>For the others, I don't know a formal maths proof but it wouldn't surprise me if it were straightforward for an expert to formalise, although it might be long for a beginner.</p>

<a name="187934442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187934442" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187934442">Patrick Massot (Feb 11 2020 at 17:40)</a>:</h4>
<p>Laurent, the honest answer is: everything is hard, but it's a lot of fun.</p>

<a name="187934728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187934728" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187934728">Patrick Massot (Feb 11 2020 at 17:44)</a>:</h4>
<p>What Johan wrote is probably not enough to get you started. The first point is that, for computer science related reasons, a lot of things in mathlib are setup in terms of this <code>equiv</code> structure which packages a map, its inverse and proofs that the inverse is indeed a left and right inverse. Of course from a mathematics perspective, it has no additional content compared to a map and a proof of bijectivity, but from a computational perspective it's different. This is slightly painful but it would be much worse if you wanted to use Coq whose community is full of people who care about computations.</p>

<a name="187934804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187934804" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187934804">Patrick Massot (Feb 11 2020 at 17:45)</a>:</h4>
<p>We also have an abbreviation for self-equiv called <code>perm</code>. So the map <code>x+1</code> seen as a permutation of reals is defined as:</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">T</span> <span class="o">:</span> <span class="n">perm</span> <span class="n">ℝ</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span>
  <span class="n">inv_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span><span class="bp">-</span><span class="mi">1</span><span class="o">,</span>
  <span class="n">left_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">right_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">}</span>
</pre></div>


<p>The last two lines are the proofs, they are crushed by the simplifier.</p>

<a name="187935099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187935099" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187935099">Patrick Massot (Feb 11 2020 at 17:48)</a>:</h4>
<p>Then the subgroup spanned by <code>T</code> is: <code>group.closure ({T} : set (perm ℝ))</code>. Note that it should be enough to write <code>group.closure {T}</code> but Lean3's elaborator is failing badly here (this is a known bug) so we need to tell it explicitly that this singleton <code>{T}</code> is a set of permutations of ℝ.</p>

<a name="187935281"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187935281" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187935281">Patrick Massot (Feb 11 2020 at 17:49)</a>:</h4>
<p>Question <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> and <span class="user-mention" data-user-id="110596">@Rob Lewis</span>  who seem to be around. Do you have any idea why Lean doesn't immediately get a subgroup instance on that group closure?</p>

<a name="187935370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187935370" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187935370">Patrick Massot (Feb 11 2020 at 17:50)</a>:</h4>
<p>Minimal example here:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">group_theory</span><span class="bp">.</span><span class="n">free_group</span>
<span class="kn">open</span> <span class="n">equiv</span> <span class="n">function</span>
<span class="n">open_locale</span> <span class="n">classical</span>
<span class="n">noncomputable</span> <span class="n">theory</span>

<span class="n">def</span> <span class="n">T</span> <span class="o">:</span> <span class="n">perm</span> <span class="n">ℝ</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span>
  <span class="n">inv_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span><span class="bp">-</span><span class="mi">1</span><span class="o">,</span>
  <span class="n">left_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">right_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">}</span>

<span class="kn">namespace</span> <span class="n">LB1</span>
<span class="c1">-- The subgroup generated by T</span>
<span class="n">def</span> <span class="n">LB1</span> <span class="o">:=</span> <span class="n">group</span><span class="bp">.</span><span class="n">closure</span> <span class="o">({</span><span class="n">T</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">perm</span> <span class="n">ℝ</span><span class="o">))</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">is_subgroup</span> <span class="n">LB1</span> <span class="o">:=</span> <span class="n">group</span><span class="bp">.</span><span class="n">closure</span><span class="bp">.</span><span class="n">is_subgroup</span> <span class="bp">_</span>  <span class="c1">-- by apply_instance fails</span>
</pre></div>

<a name="187935557"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187935557" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187935557">Patrick Massot (Feb 11 2020 at 17:52)</a>:</h4>
<p>Next trap for Laurent. You may think that <code>T</code> belongs to <code>LB1</code>. But elements of <code>LB1</code> are packages containing a permutation <em>and</em> a proof that it belongs to the subgroup spanned by <code>T</code>. So you need something like <code>def t : LB1 := ⟨T, group.in_closure.basic (by simp)</code> to define <code>t</code> which is <code>T</code> seen as an element of <code>LB1</code> (we could probably write a nice helper function here).</p>

<a name="187935794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187935794" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187935794">Patrick Massot (Feb 11 2020 at 17:54)</a>:</h4>
<p>Then you need to start reading <a href="https://leanprover-community.github.io/mathlib_docs/group_theory/free_group.html" target="_blank" title="https://leanprover-community.github.io/mathlib_docs/group_theory/free_group.html">https://leanprover-community.github.io/mathlib_docs/group_theory/free_group.html</a> or the corresponding Lean file. Unfortunately this was written before we enforced nice documentation requirements. I you like documenting what you understand, you could take this as a challenge to contribute documentation to mathlib.</p>

<a name="187935825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187935825" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187935825">Patrick Massot (Feb 11 2020 at 17:55)</a>:</h4>
<p>Same applies to <a href="https://leanprover-community.github.io/mathlib_docs/group_theory/presented_group.html" target="_blank" title="https://leanprover-community.github.io/mathlib_docs/group_theory/presented_group.html">https://leanprover-community.github.io/mathlib_docs/group_theory/presented_group.html</a></p>

<a name="187935994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187935994" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187935994">Patrick Massot (Feb 11 2020 at 17:56)</a>:</h4>
<p>One possible way to state your first two challenges would then be:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">group_theory</span><span class="bp">.</span><span class="n">free_group</span>
<span class="kn">open</span> <span class="n">equiv</span> <span class="n">function</span>
<span class="n">open_locale</span> <span class="n">classical</span>
<span class="n">noncomputable</span> <span class="n">theory</span>

<span class="n">def</span> <span class="n">T</span> <span class="o">:</span> <span class="n">perm</span> <span class="n">ℝ</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span>
  <span class="n">inv_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span><span class="bp">-</span><span class="mi">1</span><span class="o">,</span>
  <span class="n">left_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">right_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">}</span>

<span class="kn">namespace</span> <span class="n">LB1</span>
<span class="c1">-- The subgroup generated by T</span>
<span class="bp">@</span><span class="o">[</span><span class="n">derive</span> <span class="n">is_subgroup</span><span class="o">]</span>
<span class="n">def</span> <span class="n">LB1</span> <span class="o">:=</span> <span class="n">group</span><span class="bp">.</span><span class="n">closure</span> <span class="o">({</span><span class="n">T</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">perm</span> <span class="n">ℝ</span><span class="o">))</span>

<span class="c1">-- The transformation T seen as an element of the subgroup it generates.</span>
<span class="n">def</span> <span class="n">t</span> <span class="o">:</span> <span class="n">LB1</span> <span class="o">:=</span> <span class="bp">⟨</span><span class="n">T</span><span class="o">,</span> <span class="n">group</span><span class="bp">.</span><span class="n">in_closure</span><span class="bp">.</span><span class="n">basic</span> <span class="o">(</span><span class="k">by</span> <span class="n">simp</span><span class="o">)</span><span class="bp">⟩</span>


<span class="c1">-- Free group on one generator denoted by ()</span>
<span class="bp">@</span><span class="o">[</span><span class="n">derive</span> <span class="n">group</span><span class="o">]</span>
<span class="n">def</span> <span class="n">F₁</span> <span class="o">:=</span> <span class="n">free_group</span> <span class="n">unit</span>

<span class="c1">-- Laurent&#39;s first map</span>
<span class="n">def</span> <span class="n">LB1_map</span> <span class="o">:</span> <span class="n">F₁</span> <span class="bp">→</span> <span class="n">LB1</span> <span class="o">:=</span> <span class="n">free_group</span><span class="bp">.</span><span class="n">to_group</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">u</span> <span class="o">:</span> <span class="n">unit</span><span class="o">,</span> <span class="n">t</span><span class="o">)</span>

<span class="kn">lemma</span> <span class="n">LB1_iso</span> <span class="o">:</span> <span class="n">bijective</span> <span class="n">LB1_map</span> <span class="o">:=</span>
<span class="n">sorry</span>

<span class="kn">end</span> <span class="n">LB1</span>

<span class="n">def</span> <span class="n">S</span> <span class="o">:</span> <span class="n">perm</span> <span class="n">ℝ</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="mi">2</span><span class="bp">*</span><span class="n">x</span><span class="o">,</span>
  <span class="n">inv_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span><span class="bp">/</span><span class="mi">2</span><span class="o">,</span>
  <span class="n">left_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span> <span class="bp">;</span> <span class="n">ring</span><span class="o">,</span>
  <span class="n">right_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span> <span class="bp">;</span> <span class="n">ring</span> <span class="o">}</span>

<span class="kn">namespace</span> <span class="n">LB2</span>
<span class="bp">@</span><span class="o">[</span><span class="n">derive</span> <span class="n">is_subgroup</span><span class="o">]</span>
<span class="n">def</span> <span class="n">LB2</span> <span class="o">:=</span> <span class="n">group</span><span class="bp">.</span><span class="n">closure</span> <span class="o">({</span><span class="n">T</span><span class="o">,</span> <span class="n">S</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">perm</span> <span class="n">ℝ</span><span class="o">))</span>

<span class="n">def</span> <span class="n">t</span> <span class="o">:</span> <span class="n">LB2</span> <span class="o">:=</span> <span class="bp">⟨</span><span class="n">T</span><span class="o">,</span> <span class="n">group</span><span class="bp">.</span><span class="n">in_closure</span><span class="bp">.</span><span class="n">basic</span> <span class="o">(</span><span class="k">by</span> <span class="n">simp</span><span class="o">)</span><span class="bp">⟩</span>
<span class="n">def</span> <span class="n">s</span> <span class="o">:</span> <span class="n">LB2</span> <span class="o">:=</span> <span class="bp">⟨</span><span class="n">S</span><span class="o">,</span> <span class="n">group</span><span class="bp">.</span><span class="n">in_closure</span><span class="bp">.</span><span class="n">basic</span> <span class="o">(</span><span class="k">by</span> <span class="n">simp</span><span class="o">)</span><span class="bp">⟩</span>

<span class="c1">-- The free group generated by booleans tt and ff</span>
<span class="bp">@</span><span class="o">[</span><span class="n">derive</span> <span class="n">group</span><span class="o">]</span>
<span class="n">def</span> <span class="n">F₂</span> <span class="o">:=</span> <span class="n">free_group</span> <span class="n">bool</span>

<span class="c1">-- First generator of F</span>
<span class="n">def</span> <span class="n">a</span> <span class="o">:</span> <span class="n">F₂</span> <span class="o">:=</span> <span class="n">free_group</span><span class="bp">.</span><span class="n">mk</span> <span class="o">[(</span><span class="n">tt</span><span class="o">,</span> <span class="n">tt</span><span class="o">)]</span>
<span class="n">def</span> <span class="n">b</span> <span class="o">:</span> <span class="n">F₂</span> <span class="o">:=</span> <span class="n">free_group</span><span class="bp">.</span><span class="n">mk</span> <span class="o">[(</span><span class="n">ff</span><span class="o">,</span> <span class="n">tt</span><span class="o">)]</span>

<span class="c1">-- Laurent&#39;s second map</span>
<span class="n">def</span> <span class="n">LB2_map</span> <span class="o">:</span> <span class="n">F₂</span> <span class="bp">→</span> <span class="n">LB2</span> <span class="o">:=</span> <span class="n">free_group</span><span class="bp">.</span><span class="n">to_group</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">b</span><span class="o">,</span> <span class="k">if</span> <span class="n">b</span> <span class="k">then</span> <span class="n">t</span> <span class="k">else</span> <span class="n">s</span><span class="o">)</span>

<span class="kn">instance</span> <span class="o">:</span> <span class="n">is_group_hom</span> <span class="n">LB2_map</span> <span class="o">:=</span> <span class="n">free_group</span><span class="bp">.</span><span class="n">to_group</span><span class="bp">.</span><span class="n">is_group_hom</span>

<span class="kn">lemma</span> <span class="n">surj</span> <span class="o">:</span> <span class="n">surjective</span> <span class="n">LB2_map</span> <span class="o">:=</span>
<span class="n">sorry</span>

<span class="kn">lemma</span> <span class="n">ker</span> <span class="o">:</span> <span class="n">is_group_hom</span><span class="bp">.</span><span class="n">ker</span> <span class="n">LB2_map</span> <span class="bp">=</span> <span class="n">group</span><span class="bp">.</span><span class="n">normal_closure</span> <span class="o">{</span><span class="n">a</span><span class="bp">*</span><span class="n">b</span><span class="bp">*</span><span class="o">(</span><span class="n">b</span><span class="bp">*</span><span class="n">a</span><span class="err">^</span><span class="mi">2</span><span class="o">)</span><span class="bp">⁻¹</span><span class="o">}</span> <span class="o">:=</span>
<span class="n">sorry</span>
<span class="kn">end</span> <span class="n">LB2</span>
</pre></div>

<a name="187936064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187936064" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187936064">Patrick Massot (Feb 11 2020 at 17:57)</a>:</h4>
<p>Understanding that piece should already give you plenty of questions to ask here. For everybody else: note there is another mysterious instance that type class instance resolution is not finding.</p>

<a name="187936103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187936103" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187936103">Rob Lewis (Feb 11 2020 at 17:58)</a>:</h4>
<blockquote>
<p>Question <span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> and <span class="user-mention silent" data-user-id="110596">Rob Lewis</span>  who seem to be around. Do you have any idea why Lean doesn't immediately get a subgroup instance on that group closure?</p>
</blockquote>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">group_theory</span><span class="bp">.</span><span class="n">perm</span><span class="bp">.</span><span class="n">all</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">open</span> <span class="n">tactic</span> <span class="n">equiv</span>

<span class="n">def</span> <span class="n">T</span> <span class="o">:</span> <span class="n">perm</span> <span class="n">ℝ</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span>
  <span class="n">inv_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span><span class="bp">-</span><span class="mi">1</span><span class="o">,</span>
  <span class="n">left_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">right_inv</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">}</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">is_subgroup</span> <span class="o">(</span><span class="n">group</span><span class="bp">.</span><span class="n">closure</span> <span class="o">({</span><span class="n">T</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">perm</span> <span class="n">ℝ</span><span class="o">)))</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">apply_instance</span>
</pre></div>


<p>seems fine?</p>

<a name="187936417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187936417" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187936417">Patrick Massot (Feb 11 2020 at 18:00)</a>:</h4>
<p>Oh sorry. It's unfolding again.</p>

<a name="187936511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187936511" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187936511">Patrick Massot (Feb 11 2020 at 18:01)</a>:</h4>
<p>So I could have written</p>
<div class="codehilite"><pre><span></span><span class="bp">@</span><span class="o">[</span><span class="n">derive</span> <span class="n">is_subgroup</span><span class="o">]</span>
<span class="n">def</span> <span class="n">LB1</span> <span class="o">:=</span> <span class="n">group</span><span class="bp">.</span><span class="n">closure</span> <span class="o">({</span><span class="n">T</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">perm</span> <span class="n">ℝ</span><span class="o">))</span>
</pre></div>

<a name="187936544"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187936544" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187936544">Patrick Massot (Feb 11 2020 at 18:01)</a>:</h4>
<p>This doesn't work for the second failing instance. <code>derive</code> complains it want a <code>group real</code> instance.</p>

<a name="187936802"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187936802" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187936802">Yury G. Kudryashov (Feb 11 2020 at 18:04)</a>:</h4>
<p>For <code>+1</code> we have <code>equiv.add_right</code>.</p>

<a name="187936812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187936812" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187936812">Yury G. Kudryashov (Feb 11 2020 at 18:04)</a>:</h4>
<p>I'd define all these subgroups as images of the free group under a <code>lift</code> homomorphism, then study the kernels of these homomorphisms.</p>

<a name="187936836"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187936836" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187936836">Rob Lewis (Feb 11 2020 at 18:04)</a>:</h4>
<blockquote>
<p>This doesn't work for the second failing instance. <code>derive</code> complains it want a <code>group real</code> instance.</p>
</blockquote>
<p>What's the second failing instance?</p>

<a name="187936870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187936870" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187936870">Patrick Massot (Feb 11 2020 at 18:04)</a>:</h4>
<p><code>is_group_hom LB2_map</code></p>

<a name="187936948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187936948" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187936948">Patrick Massot (Feb 11 2020 at 18:05)</a>:</h4>
<p>It needs the big message with 67 lines of code.</p>

<a name="187937026"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187937026" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187937026">Patrick Massot (Feb 11 2020 at 18:06)</a>:</h4>
<p>And maybe it's not the right starting point. I only tried to get one, but maybe Yury has a better way. I don't know group theory in mathlib.</p>

<a name="187937116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187937116" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187937116">Patrick Massot (Feb 11 2020 at 18:07)</a>:</h4>
<p>There should be a nice documented way of formalizing those kind of questions, but I don't think anyone did this yet (at least it doesn't seem documented).</p>

<a name="187937246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187937246" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187937246">Rob Lewis (Feb 11 2020 at 18:09)</a>:</h4>
<p>Oh, I think the derive handler is struggling with the function type there like in <a href="https://github.com/leanprover-community/mathlib/issues/1951" target="_blank" title="https://github.com/leanprover-community/mathlib/issues/1951">#1951</a>. I'll look into it eventually.</p>

<a name="187937372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187937372" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187937372">Yury G. Kudryashov (Feb 11 2020 at 18:10)</a>:</h4>
<p>BTW, it would be nice to turn <code>equiv.mul_left</code> (or <code>_right</code>?) into a group homomorphism <code>G →* (mul_equiv G G)</code></p>

<a name="187950685"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187950685" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187950685">Laurent Bartholdi (Feb 11 2020 at 20:21)</a>:</h4>
<p>Thanks to all, esp. <span class="user-mention" data-user-id="110031">@Patrick Massot</span> for getting me on the horse.</p>
<p>Indeed I do have some questions, that I can't answer myself.<br>
1) why the "instance : is_group_hom LB2_map := free_group.to_group.is_group_hom"? I understand "instance" as forcing is_group_hom(LB2_map) to be non-empty by supplying an instance; but why isn't it automatic? Maybe I'm missing the point of the discussion in the following messages</p>
<p>2) what are the angles in "⟨T, group.in_closure.basic (by simp)⟩"? Is it that we would like to write "def t : LB2 := T" but need to help lean perform the type conversion? Are the angles equivalent to "begin... end"?</p>
<p>3) I tried, of course, LB3 :). However,<br>
def R : perm ℝ :=<br>
{ to_fun := λ x, x^3,<br>
  inv_fun := λ x, x^(1/3),<br>
  left_inv := λ x, by simp ; ring,<br>
  right_inv := λ x, by simp ; ring }</p>
<p>and lean complains that (x^3)^(1/3) cannot be simplified. I grep'ed through deps/mathlib/src hoping to find something on real numbers, but failed.</p>

<a name="187952452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187952452" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187952452">Floris van Doorn (Feb 11 2020 at 20:41)</a>:</h4>
<p>You can put code between triple backticks (```) to format it nicely.</p>

<a name="187952636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187952636" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187952636">Floris van Doorn (Feb 11 2020 at 20:43)</a>:</h4>
<p>(1) Lean doesn't unfold definitions when checking whether <code>is_group_hom(LB2_map)</code> is non-empty, so we have to tell it explicitly.  Alternatively you can mark <code>LB2_map</code> as reducible (with <code>@[reducible] def LB2_map ...</code>) and then it will be unfolded.</p>

<a name="187952747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187952747" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187952747">Floris van Doorn (Feb 11 2020 at 20:44)</a>:</h4>
<p>(2) These are "anonymous constructors". When providing any kind of tuple (for example an inhabitant of a <code>structure</code>) you can use it to provide the fields.</p>

<a name="187953460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187953460" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187953460">Patrick Massot (Feb 11 2020 at 20:52)</a>:</h4>
<p>I don't think Lean reads that <code>x^(1/3)</code> the way you would expect it.</p>

<a name="187953516"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187953516" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187953516">Patrick Massot (Feb 11 2020 at 20:52)</a>:</h4>
<p>I guess it uses division on natural number and makes it <code>x^0</code>. <span class="user-mention" data-user-id="110044">@Chris Hughes</span> can you help here?</p>

<a name="187954105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187954105" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187954105">Yury G. Kudryashov (Feb 11 2020 at 20:58)</a>:</h4>
<p>I guess you need to tell lean that this one is a real number</p>

<a name="187954126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187954126" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187954126">Patrick Massot (Feb 11 2020 at 20:58)</a>:</h4>
<p>Laurent, you need to read a bit more if you only played the natural number game and want to do more. Did  you get <a href="https://github.com/leanprover-community/tutorials/" target="_blank" title="https://github.com/leanprover-community/tutorials/">https://github.com/leanprover-community/tutorials/</a> and played a bit with the unique lean file it contains? You should also read <a href="https://leanprover.github.io/theorem_proving_in_lean/index.html" target="_blank" title="https://leanprover.github.io/theorem_proving_in_lean/index.html">Theorem Proving in Lean</a>. If you use VScode you can type Ctrl-Shift-p and then type doc (you should see in the menu Lean: Open documentation view) and then Enter. This will open the book webpage and allow you to try the examples right in VScode.</p>

<a name="187954146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187954146" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187954146">Rob Lewis (Feb 11 2020 at 20:58)</a>:</h4>
<p>It doesn't. You probably want</p>
<div class="codehilite"><pre><span></span><span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span><span class="err">^</span><span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">),</span>
<span class="n">inv_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span><span class="err">^</span><span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">),</span>
</pre></div>


<p>but then the proofs of <code>left_inv</code> and <code>right_inv</code> are harder.</p>

<a name="187954156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187954156" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187954156">Chris Hughes (Feb 11 2020 at 20:58)</a>:</h4>
<p>I just checked, and there isn't actually a nice way to take cube roots in the reals right now. <code>rpow</code> is the function for reals to the power of reals, but it returns junk when the first real is negative (I think it will return the real part of one of the complex cube roots, but not the real cube root). There should probably be a theorem saying there are real nth roots of negative numbers when <code>n</code> is odd</p>

<a name="187954315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187954315" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187954315">Patrick Massot (Feb 11 2020 at 21:00)</a>:</h4>
<p>This is what I feared. Cube roots of real numbers are not used to solve the cap set problem or define perfectoid spaces.</p>

<a name="187954394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187954394" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187954394">Patrick Massot (Feb 11 2020 at 21:00)</a>:</h4>
<p>mathlib is still very young and such embarrassing holes are not uncommon.</p>

<a name="187956947"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187956947" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187956947">Daniel Keys (Feb 11 2020 at 21:22)</a>:</h4>
<p>Is there a way to take derivatives, even only point-wise, for simple functions like polynomials? I just tried to, but couldn't get more than a <code>Prop</code> so far.</p>

<a name="187962753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187962753" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187962753">Sebastien Gouezel (Feb 11 2020 at 22:24)</a>:</h4>
<p>If <code>f</code> is a real function, <code>deriv f x</code> is the derivative of <code>f</code> at the point <code>x</code>.</p>

<a name="187963189"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187963189" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187963189">Daniel Keys (Feb 11 2020 at 22:32)</a>:</h4>
<p><span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span>   Right, that is what I did. What I mean is that I don't seem to be able to get a value, evaluation/reduction fails:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">calculus</span><span class="bp">.</span><span class="n">deriv</span>

<span class="n">def</span> <span class="n">twoX</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">x</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">twoX</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">has_deriv_at</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">has_deriv_at</span> <span class="n">twoX</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="mi">5</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="c1">-- type Prop</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">deriv</span> <span class="n">twoX</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span>  <span class="c1">-- type real</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="n">deriv</span> <span class="n">twoX</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="c1">-- this fails</span>
</pre></div>


<p>Is there something I'm doing wrong?</p>

<a name="187964193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187964193" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187964193">Floris van Doorn (Feb 11 2020 at 22:46)</a>:</h4>
<p>You cannot use Lean to <code>#eval</code> or <code>#reduce</code> anything on the real numbers: they are not computable. You have to prove that it equals a value:</p>
<div class="codehilite"><pre><span></span>example : deriv twoX (2:ℝ) = 2 :=
[...]
</pre></div>

<a name="187964339"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187964339" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187964339">Floris van Doorn (Feb 11 2020 at 22:49)</a>:</h4>
<p>In proofs, you can use <code>norm_num</code> to compute with specific real numbers, like <code>example : (2:ℝ) + 3 = 5 := by norm_num</code>.<br>
It is imaginable that at some point we will have a similar tactic for computing derivatives, but that time is not now.</p>

<a name="187964481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187964481" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187964481">Daniel Keys (Feb 11 2020 at 22:50)</a>:</h4>
<p>OK, now it all makes sense!</p>

<a name="187964541"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187964541" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187964541">Floris van Doorn (Feb 11 2020 at 22:51)</a>:</h4>
<p>In your manual proof, try using <code>deriv_add</code> and <code>deriv_id</code>.</p>

<a name="187964654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187964654" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187964654">Daniel Keys (Feb 11 2020 at 22:51)</a>:</h4>
<p>So do I need to prove for every point I am interested in?</p>

<a name="187964981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187964981" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187964981">Floris van Doorn (Feb 11 2020 at 22:57)</a>:</h4>
<p>You can do it for all real numbers at the same time:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">calculus</span><span class="bp">.</span><span class="n">deriv</span>

<span class="n">def</span> <span class="n">twoX</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">x</span>
<span class="kn">example</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="n">deriv</span> <span class="n">twoX</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">has_deriv_at</span><span class="bp">.</span><span class="n">deriv</span><span class="o">,</span> <span class="n">apply</span> <span class="n">has_deriv_at</span><span class="bp">.</span><span class="n">add</span><span class="bp">;</span> <span class="n">apply</span> <span class="n">has_deriv_at_id</span>
<span class="kn">end</span>
</pre></div>

<a name="187965071"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187965071" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187965071">Daniel Keys (Feb 11 2020 at 22:58)</a>:</h4>
<p>This is very helpful, very glad I asked! Thanks <span class="user-mention" data-user-id="111080">@Floris van Doorn</span></p>

<a name="187965283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187965283" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187965283">Rob Lewis (Feb 11 2020 at 23:01)</a>:</h4>
<p>I haven't really worked at all with <code>deriv</code> yet, but should we have (or is there?) a deriv rule simp set? Something like</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">calculus</span><span class="bp">.</span><span class="n">deriv</span>

<span class="bp">#</span><span class="kn">check</span> <span class="n">deriv</span>

<span class="n">mk_simp_attribute</span> <span class="n">deriv_simp</span> <span class="s2">&quot;simp rules for deriv&quot;</span>

<span class="n">attribute</span> <span class="o">[</span><span class="n">deriv_simp</span><span class="o">]</span> <span class="n">differentiable_at_pow</span> <span class="n">differentiable_at_const</span>
  <span class="n">deriv_add</span> <span class="n">deriv_const</span> <span class="n">deriv_pow</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="n">deriv</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">,</span> <span class="n">x</span><span class="err">^</span><span class="mi">2</span> <span class="bp">+</span> <span class="mi">2</span><span class="o">)</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">x</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">simp</span> <span class="k">with</span> <span class="n">deriv_simp</span>
</pre></div>

<a name="187965319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187965319" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187965319">Rob Lewis (Feb 11 2020 at 23:02)</a>:</h4>
<p><span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span> were we talking about something like this in Pittsburgh?</p>

<a name="187986786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187986786" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187986786">Sebastien Gouezel (Feb 12 2020 at 07:14)</a>:</h4>
<p>Yes, we talked about this in relationship with the continuity tactic. I was afraid that, on more complicated examples with composition, the apply bug would show up and make a simpset not powerful enough and that one would need a dedicated tactic, but on this example the naive simpset idea works pretty well.</p>

<a name="187987683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/First%20problems%20in%20group%20theory/near/187987683" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/16588Firstproblemsingrouptheory.html#187987683">Johan Commelin (Feb 12 2020 at 07:37)</a>:</h4>
<p>The apply bug can now be fixed in lean 3.5.1, right?</p>


{% endraw %}

{% include archive_update.html %}