---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113489newmembers/14789Decomposinghypotheses.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113489newmembers/index.html">new members</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html">Decomposing hypotheses</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="130287397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130287397" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130287397">Ken Roe (Jul 25 2018 at 16:46)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">test_split</span> <span class="o">{</span> <span class="n">P</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">}</span> <span class="o">{</span> <span class="n">Q</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">}</span> <span class="o">{</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">}</span> <span class="o">{</span> <span class="n">S</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">}</span> <span class="o">:</span>
    <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">∨</span> <span class="n">R</span><span class="o">))</span> <span class="bp">→</span> <span class="o">(</span><span class="n">Q</span> <span class="bp">→</span> <span class="n">S</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">R</span> <span class="bp">→</span> <span class="n">S</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">P</span> <span class="bp">∧</span> <span class="n">S</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">intros</span><span class="o">,</span> <span class="n">sorry</span>
<span class="kn">end</span>
</pre></div>


<p>Is there a nice way to decompose the hypotheses to prove the above theorem?  What should "sorry" be replaced with?</p>

<a name="130287654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130287654" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130287654">Reid Barton (Jul 25 2018 at 16:51)</a>:</h4>
<p><code>tauto</code> gets the job done in this case</p>

<a name="130287735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130287735" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130287735">Reid Barton (Jul 25 2018 at 16:52)</a>:</h4>
<p>Manually, you could use <code>cases</code>, for example</p>
<div class="codehilite"><pre><span></span>    <span class="n">cases</span> <span class="n">pqr</span> <span class="k">with</span> <span class="n">p</span> <span class="n">qr</span><span class="o">,</span>
    <span class="n">refine</span> <span class="bp">⟨</span><span class="n">p</span><span class="o">,</span> <span class="bp">_⟩</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">qr</span> <span class="k">with</span> <span class="n">q</span> <span class="n">r</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="n">qs</span> <span class="n">q</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="n">rs</span> <span class="n">r</span> <span class="o">}</span>
</pre></div>

<a name="130288011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130288011" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130288011">Ken Roe (Jul 25 2018 at 16:58)</a>:</h4>
<p>Where can I find tauto?  It is not in the standard libraries.</p>

<a name="130288034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130288034" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130288034">Reid Barton (Jul 25 2018 at 16:59)</a>:</h4>
<p>It's in mathlib</p>

<a name="130292466"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130292466" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130292466">Ken Roe (Jul 25 2018 at 18:10)</a>:</h4>
<p>Now for a more complex example,</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">test_split</span> <span class="o">{</span> <span class="n">P</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="o">}</span> <span class="o">{</span> <span class="n">Q</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="o">}</span> <span class="o">{</span> <span class="n">R</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="o">}</span> <span class="o">{</span> <span class="n">S</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="o">}</span> <span class="o">:</span>
    <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">P</span> <span class="n">x</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="n">x</span> <span class="bp">∨</span> <span class="n">R</span> <span class="n">x</span><span class="o">))</span> <span class="bp">→</span> <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">Q</span> <span class="n">x</span> <span class="bp">→</span> <span class="n">S</span> <span class="n">x</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">R</span> <span class="n">x</span> <span class="bp">→</span> <span class="n">S</span> <span class="n">x</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">P</span> <span class="n">x</span> <span class="bp">∧</span> <span class="n">S</span> <span class="n">x</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">intros</span><span class="o">,</span> <span class="n">sorry</span>
<span class="kn">end</span>
</pre></div>


<p>After the intros, is there a nice way to decompose these hypotheses?</p>

<a name="130292689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130292689" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130292689">Patrick Massot (Jul 25 2018 at 18:14)</a>:</h4>
<p>I'm not sure what you are looking for, but here is a short proof using <code>tauto</code>:</p>

<a name="130292693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130292693" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130292693">Patrick Massot (Jul 25 2018 at 18:14)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">test_split</span> <span class="o">{</span> <span class="n">P</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="o">}</span> <span class="o">{</span> <span class="n">Q</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="o">}</span> <span class="o">{</span> <span class="n">R</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="o">}</span> <span class="o">{</span> <span class="n">S</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="o">}</span> <span class="o">:</span>
    <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">P</span> <span class="n">x</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="n">x</span> <span class="bp">∨</span> <span class="n">R</span> <span class="n">x</span><span class="o">))</span> <span class="bp">→</span> <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">Q</span> <span class="n">x</span> <span class="bp">→</span> <span class="n">S</span> <span class="n">x</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">R</span> <span class="n">x</span> <span class="bp">→</span> <span class="n">S</span> <span class="n">x</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">P</span> <span class="n">x</span> <span class="bp">∧</span> <span class="n">S</span> <span class="n">x</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">intros</span> <span class="n">h</span> <span class="n">h&#39;</span> <span class="n">h&#39;&#39;</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">specialize</span> <span class="n">h</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">specialize</span> <span class="n">h&#39;</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">specialize</span> <span class="n">h&#39;&#39;</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">tauto</span>
<span class="kn">end</span>
</pre></div>

<a name="130292772"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130292772" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130292772">Patrick Massot (Jul 25 2018 at 18:16)</a>:</h4>
<p>I'm not sure we currently have any tactic that can guess the <code>specialize</code> steps.</p>

<a name="130292790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130292790" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130292790">Patrick Massot (Jul 25 2018 at 18:16)</a>:</h4>
<p>If you really really want one, then the standard procedure is to hope Simon will pity you.</p>

<a name="130293761"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130293761" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130293761">Simon Hudon (Jul 25 2018 at 18:36)</a>:</h4>
<p>Haha! I'm pretty merciful though</p>

<a name="130293765"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130293765" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130293765">Simon Hudon (Jul 25 2018 at 18:37)</a>:</h4>
<p>Have you tried <code>solve_by_elim</code>?</p>

<a name="130293837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130293837" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130293837">Patrick Massot (Jul 25 2018 at 18:38)</a>:</h4>
<p>It doesn't work</p>

<a name="130294047"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130294047" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130294047">Patrick Massot (Jul 25 2018 at 18:42)</a>:</h4>
<p>Btw Simon, how was your tauto lecture?</p>

<a name="130294182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130294182" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130294182">Simon Hudon (Jul 25 2018 at 18:45)</a>:</h4>
<p>You can shrink the proof down to:</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">test_split</span> <span class="o">{</span> <span class="n">P</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="o">}</span> <span class="o">{</span> <span class="n">Q</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="o">}</span> <span class="o">{</span> <span class="n">R</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="o">}</span> <span class="o">{</span> <span class="n">S</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="o">}</span> <span class="o">:</span>
    <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">P</span> <span class="n">x</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">Q</span> <span class="n">x</span> <span class="bp">∨</span> <span class="n">R</span> <span class="n">x</span><span class="o">))</span> <span class="bp">→</span> <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">Q</span> <span class="n">x</span> <span class="bp">→</span> <span class="n">S</span> <span class="n">x</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">R</span> <span class="n">x</span> <span class="bp">→</span> <span class="n">S</span> <span class="n">x</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">P</span> <span class="n">x</span> <span class="bp">∧</span> <span class="n">S</span> <span class="n">x</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">intros</span> <span class="n">h</span> <span class="n">h&#39;</span> <span class="n">h&#39;&#39;</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">specialize</span> <span class="n">h</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">split</span><span class="bp">;</span> <span class="n">tauto</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>

<a name="130294259"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130294259" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130294259">Simon Hudon (Jul 25 2018 at 18:46)</a>:</h4>
<p>I'm giving it tonight and I decided to talk about <code>pi_instances</code> after all. 5 minutes is so incredibly short :D</p>

<a name="130294306"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130294306" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130294306">Patrick Massot (Jul 25 2018 at 18:47)</a>:</h4>
<p>Did you prepare a heavily commented version of the source?</p>

<a name="130294601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130294601" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130294601">Simon Hudon (Jul 25 2018 at 18:53)</a>:</h4>
<p>What I decided to do is write an instance for <code>group</code> and show how automation shrinks it. And then I mention that <code>refine_struct</code> is written in Lean</p>

<a name="130314506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Decomposing%20hypotheses/near/130314506" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/14789Decomposinghypotheses.html#130314506">Mario Carneiro (Jul 26 2018 at 01:19)</a>:</h4>
<p><code>rintro</code> is a really nice way of doing all that</p>
<div class="codehilite"><pre><span></span>theorem test_split {P Q R S : Prop} :
  P ∧ (Q ∨ R) → (Q → S) → (R → S) → P ∧ S :=
begin
  rintro ⟨hp, hq | hr⟩ qs rs,
  { exact ⟨hp, qs hq⟩ },
  { exact ⟨hp, rs hr⟩ }
end
</pre></div>


{% endraw %}
