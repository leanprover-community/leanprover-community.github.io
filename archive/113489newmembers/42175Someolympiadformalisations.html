---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113489newmembers/42175Someolympiadformalisations.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113489newmembers/index.html">new members</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113489newmembers/42175Someolympiadformalisations.html">Some olympiad formalisations</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="194557725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Some%20olympiad%20formalisations/near/194557725" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/42175Someolympiadformalisations.html#194557725">Joseph Myers (Apr 18 2020 at 18:30)</a>:</h4>
<p>As a first exercise in formalisation after Kevin's natural number game and Lean maths challenges, I tried <a href="https://github.com/jsm28/bmo2-2020-lean" title="https://github.com/jsm28/bmo2-2020-lean">formalising solutions</a> to some problems from this year's <a href="https://bmos.ukmt.org.uk/home/bmo2-2020.pdf" title="https://bmos.ukmt.org.uk/home/bmo2-2020.pdf">British Mathematical Olympiad round 2</a>. A couple of questions that arose from this. (a) In the course of those formalisations I found I wanted various trivial lemmas that I couldn't locate in mathlib, but that seemed of more general relevance than just those particular olympiad problems; see p1_lemmas.lean, p3_lemmas.lean and p4_lemmas.lean at the link. Are some of those actually in mathlib in a different form, or do any of them belong there? (b) The proof of problem 3 (p3.lean) got very bogged down proving trivialities. Are there key Lean tricks I'm missing that could make it, say, five times shorter (which would still be longer than either of the other proofs there)?</p>

<a name="194559223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Some%20olympiad%20formalisations/near/194559223" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/42175Someolympiadformalisations.html#194559223">Kevin Buzzard (Apr 18 2020 at 19:08)</a>:</h4>
<p>Thanks for mentioning this stuff here Joseph, I know you told me about it weeks ago but I've been focusing on other things.</p>

<a name="194568695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Some%20olympiad%20formalisations/near/194568695" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/42175Someolympiadformalisations.html#194568695">Scott Morrison (Apr 18 2020 at 23:20)</a>:</h4>
<p>I only briefly skimmed your lemmas, but mostly these look useful and appropriate for mathlib.</p>

<a name="194568698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Some%20olympiad%20formalisations/near/194568698" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/42175Someolympiadformalisations.html#194568698">Scott Morrison (Apr 18 2020 at 23:20)</a>:</h4>
<p>I'd double check on some of the simpler ones that <code>library_search</code> doesn't find any matches.</p>

<a name="194568704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Some%20olympiad%20formalisations/near/194568704" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/42175Someolympiadformalisations.html#194568704">Scott Morrison (Apr 18 2020 at 23:21)</a>:</h4>
<p>and then start PR'ing them. It's probably best to do them in small chunks, as it makes it more likely that the relevant reviewer who knows the file the lemmas belong in will have time to check them.</p>

<a name="194568708"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Some%20olympiad%20formalisations/near/194568708" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/42175Someolympiadformalisations.html#194568708">Scott Morrison (Apr 18 2020 at 23:22)</a>:</h4>
<p>(But my first impression is that everything was written nicely, and had good mathlib-style names, so PRing should be pretty straightforward, beyond looking for existing matches.)</p>

<a name="194603866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Some%20olympiad%20formalisations/near/194603866" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/42175Someolympiadformalisations.html#194603866">Joseph Myers (Apr 19 2020 at 15:47)</a>:</h4>
<p>OK, I've filed PR  <a href="https://github.com/leanprover-community/mathlib/issues/2460" title="https://github.com/leanprover-community/mathlib/issues/2460">#2460</a> for some of the modular arithmetic lemmas after checking with <code>library_search</code>. Though as <code>library_search</code> is very sensitive to the exact form in which a lemma is stated, it's quite possible something very similar is already present. (E.g. at one point in doing these formalisations I wanted the name of the lemma that turns out to be <code>nat.add_mul_div_right</code>, but because I had the additions the other way round, <code>library_search</code> didn't find it.) I left out one of the modular arithmetic lemmas from this PR, both because it's more complicated and because I got a mysterious timeout after updating to the latest Lean and mathlib. Why does this code timeout on <code>use</code> (but not if <code>existsi</code> is used instead, or with different imports)? This is with Lean 3.9.0, mathlib commit 99245b33741b6b3adc6832858c88e7b0ce2de519, and didn't appear with Lean 3.8.0, mathlib commit d2db3e831a8f8e20564e7c702409bd3bdda691f5.</p>
<div class="codehilite"><pre><span></span><span class="c1">-- This import is needed; the timeout does not appear with &quot;import tactic&quot; instead.</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">int</span><span class="bp">.</span><span class="n">basic</span>

<span class="kn">lemma</span> <span class="n">mod_mul_eq_cases</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">hbpos</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">hcpos</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">c</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hmod</span> <span class="o">:</span> <span class="n">n</span> <span class="err">%</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">d</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">,</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">d</span> <span class="bp">∧</span> <span class="n">d</span> <span class="bp">&lt;</span> <span class="n">c</span> <span class="bp">∧</span> <span class="n">n</span> <span class="err">%</span> <span class="o">(</span><span class="n">c</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">d</span> <span class="bp">*</span> <span class="n">b</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">use</span> <span class="o">((</span><span class="n">n</span> <span class="err">%</span> <span class="o">(</span><span class="n">c</span> <span class="bp">*</span> <span class="n">b</span><span class="o">))</span> <span class="bp">/</span> <span class="n">b</span><span class="o">),</span> <span class="c1">-- Times out (works with &quot;existsi&quot;)</span>
  <span class="n">sorry</span>
<span class="kn">end</span>
</pre></div>


{% endraw %}

{% include archive_update.html %}