---
layout: page
title: Lean Prover Zulip Chat Archive 
permalink: archive/113489newmembers/28310dectrivialfails.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113489newmembers/index.html">new members</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html">dec_trivial fails</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="136806175"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136806175" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136806175">Kenny Lau (Oct 30 2018 at 21:52)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">rat</span>

<span class="n">def</span> <span class="n">rat</span><span class="bp">.</span><span class="n">sqrt</span> <span class="o">(</span><span class="n">q</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℚ</span> <span class="o">:=</span>
<span class="n">rat</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">sqrt</span> <span class="err">$</span> <span class="n">int</span><span class="bp">.</span><span class="n">to_nat</span> <span class="n">q</span><span class="bp">.</span><span class="n">num</span><span class="o">)</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">sqrt</span> <span class="n">q</span><span class="bp">.</span><span class="n">denom</span><span class="o">)</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">rat</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">dec_trivial</span> <span class="c1">-- fails</span>

<span class="bp">#</span><span class="kn">eval</span> <span class="n">rat</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">2</span> <span class="c1">-- 1</span>
</pre></div>

<a name="136806191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136806191" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136806191">Kenny Lau (Oct 30 2018 at 21:52)</a>:</h4>
<p>Why does <code>dec_trivial</code> fail?</p>

<a name="136806337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136806337" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136806337">Kenny Lau (Oct 30 2018 at 21:55)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span></p>

<a name="136807285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136807285" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136807285">Kenny Lau (Oct 30 2018 at 22:09)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">:</span> <span class="n">nat</span><span class="bp">.</span><span class="n">sqrt</span> <span class="o">(</span><span class="n">int</span><span class="bp">.</span><span class="n">to_nat</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">dec_trivial</span> <span class="c1">-- fails</span>
<span class="kn">example</span> <span class="o">:</span> <span class="n">nat</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">dec_trivial</span> <span class="c1">-- fails</span>
<span class="kn">example</span> <span class="o">:</span> <span class="n">rat</span><span class="bp">.</span><span class="n">mk</span> <span class="mi">1</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">dec_trivial</span> <span class="c1">-- succeeds</span>
</pre></div>

<a name="136807385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136807385" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136807385">Kenny Lau (Oct 30 2018 at 22:10)</a>:</h4>
<p>ok so the problem boils down to this</p>

<a name="136807389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136807389" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136807389">Kenny Lau (Oct 30 2018 at 22:10)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">nat</span><span class="bp">.</span><span class="n">sqrt</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">nat</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">dec_trivial</span> <span class="c1">-- fails</span>
</pre></div>

<a name="136807651"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136807651" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136807651">Scott Olson (Oct 30 2018 at 22:15)</a>:</h4>
<p>Looks like it goes <code>nat.sqrt -&gt; nat.size -&gt; nat.binary_rec</code> and <code>binary_rec</code> reduces very slowly, so <code>dec_trivial</code> gives up</p>

<a name="136807739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136807739" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136807739">Kevin Buzzard (Oct 30 2018 at 22:16)</a>:</h4>
<p>From <code>data.nat.sqrt</code>:</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">sqrt</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="o">:=</span>
<span class="k">match</span> <span class="n">size</span> <span class="n">n</span> <span class="k">with</span>
<span class="bp">|</span> <span class="mi">0</span>      <span class="o">:=</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="n">succ</span> <span class="n">s</span> <span class="o">:=</span> <span class="n">sqrt_aux</span> <span class="o">(</span><span class="n">shiftl</span> <span class="mi">1</span> <span class="o">(</span><span class="n">bit0</span> <span class="o">(</span><span class="n">div2</span> <span class="n">s</span><span class="o">)))</span> <span class="mi">0</span> <span class="n">n</span>
<span class="kn">end</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">nat</span><span class="bp">.</span><span class="n">sqrt</span>

<span class="kn">open</span> <span class="n">nat</span>

<span class="bp">#</span><span class="kn">eval</span> <span class="n">size</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="c1">-- 1</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">size</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="c1">-- ℕ</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">nat</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">dec_trivial</span> <span class="c1">-- fails</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">sqrt_aux</span> <span class="o">(</span><span class="n">shiftl</span> <span class="mi">1</span> <span class="o">(</span><span class="n">bit0</span> <span class="o">(</span><span class="n">div2</span> <span class="mi">0</span><span class="o">)))</span> <span class="mi">0</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">dec_trivial</span> <span class="c1">-- works?</span>
</pre></div>

<a name="136807780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136807780" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136807780">Kevin Buzzard (Oct 30 2018 at 22:17)</a>:</h4>
<p>Yes Scott has seen the right path -- <code>example : size 1 = 1 := dec_trivial</code> fails</p>

<a name="136807877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136807877" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136807877">Scott Olson (Oct 30 2018 at 22:19)</a>:</h4>
<p>I get failure for the <code>sqrt_aux</code> line</p>

<a name="136807887"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136807887" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136807887">Kevin Buzzard (Oct 30 2018 at 22:19)</a>:</h4>
<p>Did you open nat?</p>

<a name="136807888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136807888" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136807888">Scott Olson (Oct 30 2018 at 22:19)</a>:</h4>
<p>Yes</p>

<a name="136808002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808002" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808002">Kenny Lau (Oct 30 2018 at 22:21)</a>:</h4>
<p>hmm</p>

<a name="136808015"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808015" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808015">Kenny Lau (Oct 30 2018 at 22:21)</a>:</h4>
<p>this is troublesome</p>

<a name="136808032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808032" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808032">Kenny Lau (Oct 30 2018 at 22:21)</a>:</h4>
<p>because we can't change <code>nat.binary_rec</code></p>

<a name="136808036"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808036" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808036">Kenny Lau (Oct 30 2018 at 22:21)</a>:</h4>
<p>well maybe we can write <code>nat.binary_rec'</code> just like we do other functions</p>

<a name="136808291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808291" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808291">Kevin Buzzard (Oct 30 2018 at 22:25)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">:</span> <span class="n">binary_rec</span> <span class="mi">0</span> <span class="o">(</span><span class="bp">λ_</span> <span class="bp">_</span><span class="o">,</span> <span class="n">succ</span><span class="o">)</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="k">begin</span>
  <span class="n">unfold</span> <span class="n">binary_rec</span><span class="o">,</span>
  <span class="n">split_ifs</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">refl</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>


<p>Maybe you can add some sort of decidability instance for <code>size</code>?</p>

<a name="136808370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808370" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808370">Kevin Buzzard (Oct 30 2018 at 22:27)</a>:</h4>
<p>I don't think you need to go down as far as <code>binary_rec</code>.</p>

<a name="136808446"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808446" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808446">Kenny Lau (Oct 30 2018 at 22:28)</a>:</h4>
<p>I don't see how we can just add decidability instance.</p>

<a name="136808451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808451" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808451">Kevin Buzzard (Oct 30 2018 at 22:28)</a>:</h4>
<p>You know more about decidability than me.</p>

<a name="136808459"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808459" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808459">Kevin Buzzard (Oct 30 2018 at 22:28)</a>:</h4>
<p><code>decidable (size a = b)</code>?</p>

<a name="136808465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808465" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808465">Kenny Lau (Oct 30 2018 at 22:28)</a>:</h4>
<p>that wouldn't be useful</p>

<a name="136808470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808470" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808470">Kenny Lau (Oct 30 2018 at 22:29)</a>:</h4>
<p>because I can have another function that calls <code>size</code></p>

<a name="136808471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808471" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808471">Kevin Buzzard (Oct 30 2018 at 22:29)</a>:</h4>
<p>Or "computability" or something? I have no idea how these things work.</p>

<a name="136808498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808498" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808498">Kenny Lau (Oct 30 2018 at 22:29)</a>:</h4>
<p>I don't see any other solution than rewriting some functions in the chain, but maybe <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> would have some idea</p>

<a name="136808581"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808581" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808581">Kevin Buzzard (Oct 30 2018 at 22:30)</a>:</h4>
<p>So what's going on here? You need to make sure that the...kernel? VM? can compute <code>size a</code>?</p>

<a name="136808629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808629" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808629">Kevin Buzzard (Oct 30 2018 at 22:31)</a>:</h4>
<p>I don't really understand how <code>a = b</code> can fail to be proved by <code>dec_trivial</code> (if a and b are explicit computable nats). Equality on nat is decidable, so whatever runs <code>dec_trivial</code> just has to work out what <code>a</code> and <code>b</code> are and then check that they're equal.</p>

<a name="136808676"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808676" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808676">Kevin Buzzard (Oct 30 2018 at 22:32)</a>:</h4>
<p>and any nat in Lean is reducible to succ succ ... succ zero</p>

<a name="136808918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808918" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808918">Kevin Buzzard (Oct 30 2018 at 22:37)</a>:</h4>
<p>Aah I understand more about the problem now. <code>#reduce size 1</code> is a deterministic timeout.</p>

<a name="136808927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136808927" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136808927">Kevin Buzzard (Oct 30 2018 at 22:37)</a>:</h4>
<p>and then a segfault ;-)</p>

<a name="136809025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136809025" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136809025">Kevin Buzzard (Oct 30 2018 at 22:39)</a>:</h4>
<p>[ten seconds later]</p>

<a name="136809162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136809162" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136809162">Scott Olson (Oct 30 2018 at 22:41)</a>:</h4>
<p>Yeah, my understanding is <code>dec_trivial</code> should never fail on closed terms, but it gives up when reduction takes too long</p>

<a name="136809269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136809269" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136809269">Kevin Buzzard (Oct 30 2018 at 22:43)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">open</span> <span class="n">nat</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">binary_rec</span> <span class="mi">0</span> <span class="o">(</span><span class="bp">λ_</span> <span class="bp">_</span><span class="o">,</span> <span class="n">succ</span><span class="o">)</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">unfold</span> <span class="n">binary_rec</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">dec_trivial</span>
<span class="kn">end</span> <span class="c1">-- works</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">binary_rec</span> <span class="mi">0</span> <span class="o">(</span><span class="bp">λ_</span> <span class="bp">_</span><span class="o">,</span> <span class="n">succ</span><span class="o">)</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">exact</span> <span class="n">dec_trivial</span>
<span class="kn">end</span> <span class="c1">-- fails</span>
</pre></div>

<a name="136809462"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136809462" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136809462">Scott Olson (Oct 30 2018 at 22:47)</a>:</h4>
<p>That does seem a bit... artificial. I wish I knew more about how the reductions worked</p>

<a name="136809536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136809536" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136809536">Scott Olson (Oct 30 2018 at 22:48)</a>:</h4>
<p>But I can confirm <code>#reduce binary_rec 0 (λ_ _, succ) 1</code> times out but <code>#reduce</code> on the goal after <code>unfold binary_rec</code> (copy/pasted out with <code>set_option pp.proofs true</code> and <code>set_option pp.implicit true</code>) does give you <code>1</code></p>

<a name="136814397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136814397" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136814397">Mario Carneiro (Oct 31 2018 at 00:20)</a>:</h4>
<p>This is because proofs are irreducible by default. I think there is an option for this, I forget the name</p>

<a name="136814432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136814432" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136814432">Mario Carneiro (Oct 31 2018 at 00:21)</a>:</h4>
<p>It is almost never necessary to reduce a proof during evaluation, but well founded definitions require recursion on proofs of wellfoundedness</p>

<a name="136814666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136814666" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136814666">Kenny Lau (Oct 31 2018 at 00:26)</a>:</h4>
<p>then what should we do?</p>

<a name="136815767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136815767" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136815767">Mario Carneiro (Oct 31 2018 at 00:54)</a>:</h4>
<p>give up? This definition is not intended for kernel reduction</p>

<a name="136815862"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/dec_trivial%20fails/near/136815862" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/28310dectrivialfails.html#136815862">Mario Carneiro (Oct 31 2018 at 00:56)</a>:</h4>
<p>If you need to calculate these things, you can either use the definition, or if we need larger scale computation we can add another <code>norm_num</code> add-on for this (I really need to make it extensible via annotation...)</p>


{% endraw %}
