---
layout: archive
title: Lean Prover Zulip Chat Archive 
permalink: archive/113489newmembers/01890Higherorderchaos.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113489newmembers/index.html">new members</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html">Higher order chaos</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="129679786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129679786" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129679786">Ken Roe (Jul 14 2018 at 23:25)</a>:</h4>
<p>I was experimenting with lambda reductions.  Can someone help me complete the following theorem:</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">testit</span><span class="o">:</span> <span class="o">(</span><span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="o">((</span><span class="bp">λ</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="o">(</span><span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span><span class="o">)),</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span><span class="bp">+</span><span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)))</span>
                         <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="mi">3</span><span class="bp">=</span><span class="mi">4</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">intro</span><span class="o">,</span> <span class="n">cases</span> <span class="n">a</span><span class="o">,</span><span class="n">sorry</span>
<span class="kn">end</span>
</pre></div>


<p>What should replace the "sorry"?</p>

<a name="129680026"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129680026" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129680026">Mario Carneiro (Jul 14 2018 at 23:35)</a>:</h4>
<p>here's a proof:</p>
<div class="codehilite"><pre><span></span>theorem testit: (∃ x, ((λ (f : (ℕ → ℕ)), (λ (x:ℕ), (f x)+(f x)))
                         (λ (x:ℕ), x+1)) x = 1) → 3=4 :=
begin
    intro, cases a,
    dsimp at a_h,
    rw [add_assoc, add_left_comm 1] at a_h,
    cases a_h
end
</pre></div>

<a name="129696201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696201" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696201">Kevin Buzzard (Jul 15 2018 at 10:01)</a>:</h4>
<p>Here's a more fleshed-out argument:</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">testit</span><span class="o">:</span> <span class="o">(</span><span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="o">((</span><span class="bp">λ</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="o">(</span><span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span><span class="o">)),</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span><span class="bp">+</span><span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)))</span>
                         <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="mi">3</span><span class="bp">=</span><span class="mi">4</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">intro</span><span class="o">,</span> <span class="n">cases</span> <span class="n">a</span> <span class="k">with</span> <span class="n">n</span> <span class="n">Hn</span><span class="o">,</span> <span class="c1">-- name the hypotheses</span>
    <span class="n">exfalso</span><span class="o">,</span> <span class="c1">-- we&#39;re going to prove by contradiction</span>
    <span class="n">change</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="n">at</span> <span class="n">Hn</span><span class="o">,</span> <span class="c1">-- instead of dsimp do the definitional rewrite yourself</span>
    <span class="n">rw</span> <span class="err">←</span><span class="n">add_assoc</span> <span class="n">at</span> <span class="n">Hn</span><span class="o">,</span> <span class="c1">-- Hn now n + 1 + n + 1 = 1</span>
    <span class="n">rw</span> <span class="err">←</span><span class="n">add_right_comm</span> <span class="n">n</span> <span class="n">at</span> <span class="n">Hn</span><span class="o">,</span> <span class="c1">-- Hn now (n + n) + 1 + 1 = 1</span>
    <span class="k">have</span> <span class="n">H₂</span> <span class="o">:=</span> <span class="n">nat</span><span class="bp">.</span><span class="n">succ</span><span class="bp">.</span><span class="n">inj</span> <span class="n">Hn</span><span class="o">,</span> <span class="c1">-- H₂ now (n+n)+1=0</span>
    <span class="n">exact</span> <span class="n">nat</span><span class="bp">.</span><span class="n">succ_ne_zero</span> <span class="bp">_</span> <span class="n">H₂</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>

<a name="129696426"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696426" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696426">Kenny Lau (Jul 15 2018 at 10:11)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">testit</span><span class="o">:</span> <span class="o">(</span><span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="o">((</span><span class="bp">λ</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="o">(</span><span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span><span class="o">)),</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span><span class="bp">+</span><span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)))</span>
                         <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="mi">3</span><span class="bp">=</span><span class="mi">4</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">h</span><span class="bp">⟩</span><span class="o">,</span> <span class="n">nat</span><span class="bp">.</span><span class="n">cases_on</span> <span class="n">x</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="n">H</span><span class="o">,</span> <span class="n">nat</span><span class="bp">.</span><span class="n">no_confusion</span> <span class="err">$</span> <span class="n">nat</span><span class="bp">.</span><span class="n">succ_inj</span> <span class="n">H</span><span class="o">)</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="n">n</span> <span class="n">H</span><span class="o">,</span> <span class="n">nat</span><span class="bp">.</span><span class="n">no_confusion</span> <span class="err">$</span> <span class="n">nat</span><span class="bp">.</span><span class="n">succ_inj</span> <span class="n">H</span><span class="o">)</span> <span class="n">h</span>

<span class="kn">theorem</span> <span class="n">testit&#39;</span><span class="o">:</span> <span class="o">(</span><span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="o">((</span><span class="bp">λ</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="o">(</span><span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span><span class="o">)),</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span><span class="bp">+</span><span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)))</span>
                         <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="mi">3</span><span class="bp">=</span><span class="mi">4</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">h</span><span class="bp">⟩</span><span class="o">,</span> <span class="k">by</span> <span class="n">cases</span> <span class="n">x</span><span class="bp">;</span> <span class="k">from</span> <span class="n">nat</span><span class="bp">.</span><span class="n">no_confusion</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">succ_inj</span> <span class="n">h</span><span class="o">)</span>

<span class="kn">theorem</span> <span class="n">testit&#39;&#39;</span><span class="o">:</span> <span class="o">(</span><span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="o">((</span><span class="bp">λ</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="o">(</span><span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span><span class="o">)),</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span><span class="bp">+</span><span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)))</span>
                         <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="mi">3</span><span class="bp">=</span><span class="mi">4</span>
<span class="bp">|</span> <span class="bp">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">h</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="n">nat</span><span class="bp">.</span><span class="n">no_confusion</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">succ_inj</span> <span class="n">h</span><span class="o">)</span>
</pre></div>

<a name="129696429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696429" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696429">Patrick Massot (Jul 15 2018 at 10:11)</a>:</h4>
<p>Now let's go for a more mathlib version:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span>

<span class="kn">theorem</span> <span class="n">testit</span><span class="o">:</span> <span class="o">(</span><span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="o">((</span><span class="bp">λ</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="o">(</span><span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span><span class="o">)),</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span><span class="bp">+</span><span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)))</span>
                         <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="mi">3</span><span class="bp">=</span><span class="mi">4</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">rintro</span> <span class="bp">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">Hn</span><span class="bp">⟩</span><span class="o">,</span> <span class="c1">-- name the hypotheses</span>
    <span class="n">by_contradiction</span><span class="o">,</span> <span class="c1">-- we&#39;re going to prove by contradiction</span>
    <span class="n">change</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="n">at</span> <span class="n">Hn</span><span class="o">,</span> <span class="c1">-- instead of dsimp do the definitional rewrite yourself</span>
    <span class="n">rw</span> <span class="o">(</span><span class="k">show</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">*</span><span class="n">n</span><span class="bp">+</span><span class="mi">2</span><span class="o">,</span> <span class="k">by</span> <span class="n">ring</span><span class="o">)</span> <span class="n">at</span> <span class="n">Hn</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">H₂</span> <span class="o">:=</span> <span class="n">nat</span><span class="bp">.</span><span class="n">succ</span><span class="bp">.</span><span class="n">inj</span> <span class="n">Hn</span><span class="o">,</span> <span class="c1">-- H₂ now 2*n+1=0</span>
    <span class="n">exact</span> <span class="n">nat</span><span class="bp">.</span><span class="n">succ_ne_zero</span> <span class="bp">_</span> <span class="n">H₂</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>

<a name="129696430"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696430" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696430">Kenny Lau (Jul 15 2018 at 10:11)</a>:</h4>
<p>I believe my last version would be the mathlib version :P</p>

<a name="129696469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696469" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696469">Patrick Massot (Jul 15 2018 at 10:12)</a>:</h4>
<p>I meant using mathlib tactics. Note the use of <code>rintro</code> to squash Kevin's first two lines into one, and the use of <code>ring</code> for the computation</p>

<a name="129696475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696475" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696475">Kenny Lau (Jul 15 2018 at 10:13)</a>:</h4>
<p>obfuscated version:</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">testit&#39;&#39;</span><span class="o">:</span> <span class="o">(</span><span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="o">((</span><span class="bp">λ</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="o">(</span><span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span><span class="o">)),</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span><span class="bp">+</span><span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)))</span>
                         <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="mi">3</span><span class="bp">=</span><span class="mi">4</span>
<span class="bp">|</span> <span class="bp">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">h</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="n">congr_arg</span> <span class="o">((</span><span class="bp">+</span><span class="o">)</span><span class="mi">2</span><span class="o">)</span> <span class="n">h</span><span class="bp">.</span><span class="n">symm</span>
</pre></div>

<a name="129696476"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696476" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696476">Patrick Massot (Jul 15 2018 at 10:13)</a>:</h4>
<p>I also replaced <code>exfalso</code> by <code>by_contradiction</code>. Here it buys you nothing but it's more powerful in general, so let's remember that one.</p>

<a name="129696584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696584" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696584">Mario Carneiro (Jul 15 2018 at 10:16)</a>:</h4>
<p>I prefer:</p>
<div class="codehilite"><pre><span></span>theorem testit&#39;&#39;: (∃ x, ((λ (f : (ℕ → ℕ)), (λ (x:ℕ), (f x)+(f x)))
                         (λ (x:ℕ), x+1)) x = 1) → 3=4
| ⟨0, h⟩ := by cases h
</pre></div>

<a name="129696589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696589" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696589">Kenny Lau (Jul 15 2018 at 10:17)</a>:</h4>
<p>nice</p>

<a name="129696590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696590" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696590">Mario Carneiro (Jul 15 2018 at 10:17)</a>:</h4>
<p>the match against <code>0</code> at the beginning is clever</p>

<a name="129696631"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696631" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696631">Mario Carneiro (Jul 15 2018 at 10:18)</a>:</h4>
<p>(but of course none of these is the mathlib version because the statement is ridiculous)</p>

<a name="129696640"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696640" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696640">Patrick Massot (Jul 15 2018 at 10:19)</a>:</h4>
<p>Again, my "mathlib version" story was only about rewriting Kevin's proof in the same spirit but using more mathlib power</p>

<a name="129696642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696642" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696642">Patrick Massot (Jul 15 2018 at 10:19)</a>:</h4>
<p>Anyway, hopefully Ken will be able to learn many things from this discussion</p>

<a name="129696702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696702" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696702">Mario Carneiro (Jul 15 2018 at 10:20)</a>:</h4>
<p>I think lean golf is a nice way to learn new tricks, although its actual applicability is debatable</p>

<a name="129696706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696706" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696706">Patrick Massot (Jul 15 2018 at 10:20)</a>:</h4>
<p>Actually I'd like to be sure I understand your trick. You let the equation compiler do the job of checking that 0 is the only possibility for x, right?</p>

<a name="129696717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696717" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696717">Kenny Lau (Jul 15 2018 at 10:22)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">logic</span><span class="bp">.</span><span class="n">basic</span>

<span class="kn">theorem</span> <span class="n">testit</span><span class="o">:</span> <span class="o">(</span><span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="o">((</span><span class="bp">λ</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="o">(</span><span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span><span class="o">)),</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span><span class="bp">+</span><span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)))</span>
                         <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="mi">3</span><span class="bp">=</span><span class="mi">4</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">simp</span><span class="bp">;</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">H</span><span class="bp">;</span> <span class="n">cases</span> <span class="n">H</span>
</pre></div>

<a name="129696756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696756" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696756">Mario Carneiro (Jul 15 2018 at 10:22)</a>:</h4>
<p>Right. The equation compiler figures out a sequence of case splits that produce the cases that I give. Since I wrote <code>0</code> instead of <code>n</code> for the first thing, it deduces that we have a case split on the nat, but that requires a second branch, for <code>&lt;succ n, h&gt;</code>. But here <code>h</code> has a type like <code>succ stuff = 0</code>, so it does a second case split on <code>h</code> and deduces that this case is impossible</p>

<a name="129696763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696763" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696763">Patrick Massot (Jul 15 2018 at 10:23)</a>:</h4>
<p>Ok, this is what I thought. Well done, equation compiler!</p>

<a name="129696803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696803" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696803">Mario Carneiro (Jul 15 2018 at 10:24)</a>:</h4>
<p>I like to take advantage of this for doing things like pattern matching on <code>l : list A</code> and <code>h : length l = 2</code> and only providing a case for <code>[a, b], _</code></p>

<a name="129696805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696805" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696805">Kenny Lau (Jul 15 2018 at 10:24)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">testit</span><span class="o">:</span> <span class="o">(</span><span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="o">((</span><span class="bp">λ</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="o">(</span><span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span><span class="o">)),</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span><span class="bp">+</span><span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)))</span>
                         <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="mi">3</span><span class="bp">=</span><span class="mi">4</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">H</span><span class="bp">⟩</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span> <span class="n">at</span> <span class="n">H</span><span class="bp">;</span> <span class="n">cases</span> <span class="n">H</span>
</pre></div>

<a name="129696815"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129696815" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129696815">Kevin Buzzard (Jul 15 2018 at 10:26)</a>:</h4>
<p>I like the way that the title of this thread was once a bit of an overstatement but has now become true. Something here for everyone now :-)</p>

<a name="129697094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129697094" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129697094">Kevin Buzzard (Jul 15 2018 at 10:37)</a>:</h4>
<blockquote>
<p>Actually I'd like to be sure I understand your trick. </p>
</blockquote>
<p>I'm still struggling with the <code>cases a_h</code> line in the very first proof <span class="emoji emoji-1f923" title="rolling on the floor laughing">:rolling_on_the_floor_laughing:</span></p>
<p><code>cases</code> seems to be much more powerful than I'd realised. Applied to <code>n + (n + (1 + 1)) = 1</code> it realises that both nats are <code>succ (something)</code> so reduces to <code>succ (n+n)=0</code> and then tries again, realises that the nats are made with different constructors this time, and solves the goal. At least that's my understanding of what's going on.</p>

<a name="129697236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129697236" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129697236">Kevin Buzzard (Jul 15 2018 at 10:42)</a>:</h4>
<blockquote>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">testit</span><span class="o">:</span> <span class="o">(</span><span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="o">((</span><span class="bp">λ</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="o">(</span><span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span><span class="o">)),</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span><span class="bp">+</span><span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)))</span>
                         <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="mi">3</span><span class="bp">=</span><span class="mi">4</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">H</span><span class="bp">⟩</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span> <span class="n">at</span> <span class="n">H</span><span class="bp">;</span> <span class="n">cases</span> <span class="n">H</span>
</pre></div>


</blockquote>
<p>You lose a point for proof instability</p>

<a name="129697237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129697237" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129697237">Kevin Buzzard (Jul 15 2018 at 10:42)</a>:</h4>
<p>When Leo removes <code>add_assoc</code> from simp you're in trouble</p>

<a name="129697238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129697238" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129697238">Kenny Lau (Jul 15 2018 at 10:42)</a>:</h4>
<p>you sound like Mario</p>

<a name="129697240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129697240" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129697240">Kevin Buzzard (Jul 15 2018 at 10:42)</a>:</h4>
<p>I'm practising.</p>

<a name="129697246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129697246" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129697246">Kenny Lau (Jul 15 2018 at 10:43)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">testit</span><span class="o">:</span> <span class="o">(</span><span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="o">((</span><span class="bp">λ</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="o">(</span><span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span><span class="o">)),</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span><span class="bp">+</span><span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)))</span>
                         <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="mi">3</span><span class="bp">=</span><span class="mi">4</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="bp">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">H</span><span class="bp">⟩</span><span class="o">,</span> <span class="k">by</span> <span class="n">cases</span> <span class="n">x</span><span class="bp">;</span> <span class="n">injections</span>
</pre></div>

<a name="129697293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129697293" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129697293">Kevin Buzzard (Jul 15 2018 at 10:45)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">testit4</span><span class="o">:</span> <span class="o">(</span><span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="o">((</span><span class="bp">λ</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="o">(</span><span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span><span class="o">)),</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span><span class="bp">+</span><span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)))</span>
                         <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="bp">ℕ</span><span class="o">),</span> <span class="n">x</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span> <span class="mi">3</span><span class="bp">=</span><span class="mi">4</span>
<span class="bp">|</span> <span class="bp">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">H</span><span class="bp">⟩</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">injections</span>
</pre></div>

<a name="129697294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129697294" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129697294">Mario Carneiro (Jul 15 2018 at 10:45)</a>:</h4>
<p>yes, <code>cases</code> basically has <code>injection</code> built in</p>

<a name="129697296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129697296" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129697296">Kevin Buzzard (Jul 15 2018 at 10:45)</a>:</h4>
<p>I don't think I'd internalised that before.</p>

<a name="129697336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129697336" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129697336">Mario Carneiro (Jul 15 2018 at 10:46)</a>:</h4>
<p>That's what makes doing cases on an inductive predicate so powerful (like Coq's <code>inversion</code> tactic)</p>

<a name="129697339"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129697339" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129697339">Mario Carneiro (Jul 15 2018 at 10:46)</a>:</h4>
<p>because it can skip all the cases where the indices don't match up</p>

<a name="129697344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129697344" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129697344">Kevin Buzzard (Jul 15 2018 at 10:47)</a>:</h4>
<p>That's funny, because last week my son discovered this. IIRC <code>inversion</code> is introduced in Software Foundations well after <code>cases</code> and in Lean you can just do cases anyway. I think that when I did those exercises in Lean myself I was still at the "let's try <code>cases;simp</code> and see if it works" stage.</p>

<a name="129697434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Higher%20order%20chaos/near/129697434" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/01890Higherorderchaos.html#129697434">Kevin Buzzard (Jul 15 2018 at 10:50)</a>:</h4>
<p>In my experiments trying to understand <code>cases</code> on <code>eq</code> I found that it could be used to do a rewrite for either the left or the right hand side (<code>cases a = blah</code> and <code>cases blah = a</code> both remove <code>a</code> and substitute <code>blah</code> everywhere). The only disconcerting thing is that the order of the hypotheses gets randomised a bit (presumably because they're reverted and then unreverted under the hood or something)</p>


{% endraw %}
