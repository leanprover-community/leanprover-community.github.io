---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113489newmembers/index.html">new members</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html">Lean act slowly when proof gets long</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="183415058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183415058" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183415058">YH (Dec 14 2019 at 00:35)</a>:</h4>
<p>Like when it's about 70 lines it starts to be slow. Is there anything to do?</p>

<a name="183416960"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183416960" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183416960">Alex J. Best (Dec 14 2019 at 01:19)</a>:</h4>
<p>Sure but it depends exactly what the problem is which is hard to diagnose without seeing the code. It could be any one of many problems so please post an example.</p>

<a name="183417189"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183417189" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183417189">YH (Dec 14 2019 at 01:25)</a>:</h4>
<p><a href="https://gist.github.com/3abc/5a1aa9aff302bfb6d2f1aab41c2b9e6e" target="_blank" title="https://gist.github.com/3abc/5a1aa9aff302bfb6d2f1aab41c2b9e6e">https://gist.github.com/3abc/5a1aa9aff302bfb6d2f1aab41c2b9e6e</a> <br>
OK here is what I had.</p>

<a name="183417266"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183417266" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183417266">YH (Dec 14 2019 at 01:27)</a>:</h4>
<p>it's just that at 60 lines whenever I add a new line it hangs like 10 - 15 seconds.</p>

<a name="183417280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183417280" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183417280">Simon Hudon (Dec 14 2019 at 01:27)</a>:</h4>
<p>Which line do you add?</p>

<a name="183417333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183417333" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183417333">Simon Hudon (Dec 14 2019 at 01:28)</a>:</h4>
<p>It's likely not a matter of length so much as what kind of work the proof requires from Lean</p>

<a name="183417334"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183417334" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183417334">YH (Dec 14 2019 at 01:28)</a>:</h4>
<p>Any newline, even if I add a random thing and remove it.</p>

<a name="183417667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183417667" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183417667">Simon Hudon (Dec 14 2019 at 01:36)</a>:</h4>
<p>What if you do <code>change _</code>?</p>

<a name="183421702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183421702" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183421702">Alex J. Best (Dec 14 2019 at 03:32)</a>:</h4>
<p>I have added a modified version of your proof on a gist: <a href="https://gist.github.com/alexjbest/5e21dea71b7ea3c4be346fd89c216951" target="_blank" title="https://gist.github.com/alexjbest/5e21dea71b7ea3c4be346fd89c216951">https://gist.github.com/alexjbest/5e21dea71b7ea3c4be346fd89c216951</a> . The short answer is that the proof is long and complicated and uses lots of tactics. Which is fine but its often better to break things up in some way or other. I'm definitely not an expert speeder-upper but here are some comments in no particular order, maybe not all of them are useful but I hope some of them are:</p>
<ul>
<li>Use separate lemmas for subproofs, these won't be re-checked each time you change the main proof, this is probably the most important thing</li>
<li>You use <code>let</code>  sometimes for Props instead of <code>have</code> which seems unnecessary.</li>
<li>When you have a lot of hypotheses in the context it can be hard for tactics like linarith to find a contradiction, so you can use <code>linarith only [blah]</code> to tell linarith which things will give a contradiction.</li>
<li>Alternatively to this (but it is also good in general) you can structure your proof in such a way that when you are done with a statement it drops out of context for instance your <code>h</code> was only used to prove <code>hhhh</code> but it was cluttering up the context after so I moved <code>h</code> into a proof block for <code>hhhh</code> same for <code>hh</code> <code>hhh</code> and <code>LHS_nonneg</code></li>
<li>After identifying that some <code>linarith</code> calls are just simple contradictions we can replace them e.g. <code>linarith only [hhhh, a]</code> can become</li>
</ul>
<div class="codehilite"><pre><span></span>      <span class="n">apply</span> <span class="n">lt_irrefl</span> <span class="o">((</span><span class="n">m</span> <span class="err">^</span> <span class="mi">4</span><span class="o">)</span> <span class="err">^</span> <span class="mi">3</span><span class="o">),</span>
      <span class="n">exact</span> <span class="n">lt_of_lt_of_le</span> <span class="n">a2</span> <span class="n">hhhh</span><span class="o">,</span>
</pre></div>


<p>or even <code>exact lt_irrefl ((m ^ 4) ^ 3) (lt_of_lt_of_le a2 hhhh),</code></p>
<ul>
<li>You can use <code>set_option profiler true</code> to see some profiling information about what is taking time</li>
<li>Instead of using <code>have blah : blaaaah, begin blah end</code> you can use <code>have  blah : blaaaah := begin  blah end</code>  this makes it easier to use the profiler for one.</li>
<li>simp is great but once you are happy with the way the proof is it is good to change it to <code>squeeze_simp</code> which will output a string <code>simp only [blah]</code> which should give a more minimal proof.</li>
</ul>

<a name="183427169"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183427169" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183427169">YH (Dec 14 2019 at 06:28)</a>:</h4>
<blockquote>
<ul>
<li>You use <code>let</code>  sometimes for Props instead of <code>have</code> which seems unnecessary.</li>
</ul>
</blockquote>
<p>This is something I wanted to ask, what is the difference between <code>have</code> and <code>let</code>? I felt <code>have</code> is only for one goal and <code>let</code> have a larger scope, but I am not sure.</p>

<a name="183427525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183427525" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183427525">Alex J. Best (Dec 14 2019 at 06:41)</a>:</h4>
<p>let remembers the definition of the term whereas have does not, for statements (Props) the definition / proof is not relevant once it is constructed, all that matters is that a term has been constructed. Most of the time if you are introducing terms of Types that are not Prop i.e. some natural or real number you want to remember its definition so that you can later substitute or otherwise work with it.</p>

<a name="183428825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183428825" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183428825">Kevin Buzzard (Dec 14 2019 at 07:24)</a>:</h4>
<p>So as Alex says, usually the problem when Lean gets sluggish like this is that you have used an expensive tactic like <code>simp</code> and the convoluted algorithm which it has discovered to prove your goal (which can involve trying literally thousands of stupid ideas before it finds the right one) gets repeated again and again. The fault is not some inbuilt lean issue, it's an argument which mathematicians would call logically fine and which computer scientists would call bad code. It's normally just one line which is causing the problem. Alex has listed several suggestions but the main idea to fix an issue like this is either to refactor (ie prove your lemmas before your theorems, not as sublemmas) or to replace an expensive tactic with the proof it found. Sometimes it can be the typeclass system though and this can be harder to work around</p>

<a name="183429745"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183429745" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183429745">Kevin Buzzard (Dec 14 2019 at 07:54)</a>:</h4>
<p>In particular your original claim "when it gets to 70 lines Lean gets slow" is not an accurate diagnosis of the situation. You can tell this can't be the case because some of the files in mathlib are 1000 lines long. What is happening in those files is that 98% of the proofs are two lines long. It's a bit of a pain to diagnose what's making a 70 line proof slow -- what happens with me in practice is that the moment the proof starts to become slow I stop and try to figure out what I did wrong.</p>

<a name="183429887"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183429887" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183429887">YH (Dec 14 2019 at 07:59)</a>:</h4>
<p>OK. I'm looking at Alex's modified version of my proof. <br>
Actually moving one thing out as a lemma reduces the whole elaboration by 2 seconds. (The one that gets from a ≥ 0 and  ¬(a &gt; 0) to a = 0.) I do believe many things can be improved in that proof.</p>

<a name="183430184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430184" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430184">Kevin Buzzard (Dec 14 2019 at 08:04)</a>:</h4>
<p>One thing you can do with your 70 line proof is this: Step 1: put <code>set_option profiler true</code> just before the statement of the lemma. Step 2: insert the line <code>repeat {sorry} end #exit</code> as the first line of the proof. Step 3: switch VS Code to "Info View: Display Messages (Ctrl+Shift+Alt+Enter)" (now the Lean Messages window prints debugging information about the entire file rather than just what's going on in the middle of one tactic mode proof). Step 4: move the <code>repeat {sorry} end #exit</code> line around until you spot a big jump in the time taken to elaborate <code>ag3</code>.</p>

<a name="183430244"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430244" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430244">YH (Dec 14 2019 at 08:06)</a>:</h4>
<p>Oh cool</p>

<a name="183430251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430251" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430251">YH (Dec 14 2019 at 08:06)</a>:</h4>
<p>Step 2: insert the line repeat {sorry} end #exit as the first line of the proof (or the lemma?).</p>

<a name="183430256"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430256" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430256">Kevin Buzzard (Dec 14 2019 at 08:07)</a>:</h4>
<p>This is just a random line which has a good chance of just dumping you out of the proof immediately.</p>

<a name="183430298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430298" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430298">YH (Dec 14 2019 at 08:08)</a>:</h4>
<p>How do I do step 3 on a Mac?</p>

<a name="183430299"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430299" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430299">Kevin Buzzard (Dec 14 2019 at 08:08)</a>:</h4>
<p>It doesn't always work, e.g. you have a begin/end block within another one and then you'll get syntax errors. This is why it's usually better to catch these things as they happen -- i.e. the <em>moment</em> things start getting slow, stop what you're doing and fix them.</p>

<a name="183430310"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430310" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430310">Kevin Buzzard (Dec 14 2019 at 08:09)</a>:</h4>
<p><a href="/user_uploads/3121/KS1bb5dkzJpFrOYjiWRrXS8b/view.png" target="_blank" title="view.png">view.png</a> Click the button that looks like that on VS Code</p>
<div class="message_inline_image"><a href="/user_uploads/3121/KS1bb5dkzJpFrOYjiWRrXS8b/view.png" target="_blank" title="view.png"><img src="/user_uploads/3121/KS1bb5dkzJpFrOYjiWRrXS8b/view.png"></a></div>

<a name="183430364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430364" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430364">YH (Dec 14 2019 at 08:10)</a>:</h4>
<p><a href="/user_uploads/3121/gf2BcagSHNtaNn8my6kOBtNl/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a> <br>
Cannot find any button like that...</p>
<div class="message_inline_image"><a href="/user_uploads/3121/gf2BcagSHNtaNn8my6kOBtNl/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/3121/gf2BcagSHNtaNn8my6kOBtNl/pasted_image.png"></a></div>

<a name="183430365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430365" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430365">Kevin Buzzard (Dec 14 2019 at 08:10)</a>:</h4>
<p>Try the three dots in the top right?</p>

<a name="183430371"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430371" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430371">YH (Dec 14 2019 at 08:10)</a>:</h4>
<p><a href="/user_uploads/3121/-gV233IPu-oDVTGB-3JroVzk/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/-gV233IPu-oDVTGB-3JroVzk/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/3121/-gV233IPu-oDVTGB-3JroVzk/pasted_image.png"></a></div>

<a name="183430377"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430377" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430377">Kevin Buzzard (Dec 14 2019 at 08:11)</a>:</h4>
<p>You have a tab which says "Lean Messages". If you close it, how can you open it again?</p>

<a name="183430380"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430380" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430380">Kevin Buzzard (Dec 14 2019 at 08:11)</a>:</h4>
<p>My guess is that on a mac it will be command+all those other keys I mentioned</p>

<a name="183430381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430381" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430381">YH (Dec 14 2019 at 08:11)</a>:</h4>
<p>Oh yeah close it the button appears</p>

<a name="183430425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430425" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430425">Kevin Buzzard (Dec 14 2019 at 08:12)</a>:</h4>
<p>There are two different windows displaying Lean messages, both helpfully with the title "Lean Messages" and explaining different things :-/</p>

<a name="183430427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430427" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430427">YH (Dec 14 2019 at 08:12)</a>:</h4>
<p><a href="/user_uploads/3121/wOAus7OsRfZr8qjFjC9xO10A/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a> <br>
Is this the info view?</p>
<div class="message_inline_image"><a href="/user_uploads/3121/wOAus7OsRfZr8qjFjC9xO10A/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/3121/wOAus7OsRfZr8qjFjC9xO10A/pasted_image.png"></a></div>

<a name="183430429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430429" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430429">Kevin Buzzard (Dec 14 2019 at 08:12)</a>:</h4>
<p>Yes!</p>

<a name="183430432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430432" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430432">YH (Dec 14 2019 at 08:12)</a>:</h4>
<p>Oh OK. It was always open here...</p>

<a name="183430442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430442" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430442">Kevin Buzzard (Dec 14 2019 at 08:13)</a>:</h4>
<p>Now compile your proof and see if you have something like "elaboration of ag3 took 10 seconds" somewhere</p>

<a name="183430489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430489" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430489">YH (Dec 14 2019 at 08:14)</a>:</h4>
<p><code>elaboration of ag3 took 4.99s</code></p>

<a name="183430500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430500" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430500">Kevin Buzzard (Dec 14 2019 at 08:15)</a>:</h4>
<p>so there's your problem, and there's just one or two bad lines of code in there where you use something like <code>simp</code> to go from a&lt;b to <code>not b&lt;=a</code> and it takes Lean about 2 seconds to do this, and you could cut this down to 0.002 seconds by changing that line to <code>rw lt_iff_not_le</code> or something.</p>

<a name="183430503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430503" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430503">Kevin Buzzard (Dec 14 2019 at 08:16)</a>:</h4>
<p>The problem is that it turns out that maths does not go at infinite speed.</p>

<a name="183430545"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430545" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430545">Kevin Buzzard (Dec 14 2019 at 08:16)</a>:</h4>
<p>That's why they have induction as an axiom ;-)</p>

<a name="183430549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430549" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430549">Kevin Buzzard (Dec 14 2019 at 08:16)</a>:</h4>
<p>If we know <code>P 0</code> is true and <code>P n -&gt; P (n + 1)</code> then we can instantly deduce <code>P 10^10^10^10</code></p>

<a name="183430552"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430552" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430552">YH (Dec 14 2019 at 08:16)</a>:</h4>
<p>There are some things which I repeated three times. <br>
Like proving some properties of 4th root of a number.<br>
I will see if I can write a function into subtypes of ℝ and get a 4th root map together with its properties.</p>

<a name="183430553"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430553" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430553">Kevin Buzzard (Dec 14 2019 at 08:16)</a>:</h4>
<p>because we won't ever bother writing the proof down</p>

<a name="183430562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430562" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430562">Kevin Buzzard (Dec 14 2019 at 08:17)</a>:</h4>
<p>These things are a pain to debug though. Sometimes it's just little things building up. There might be some killer line in there somewhere and rewriting it will save you 4 seconds. But it might just be a case of an annoying refactor.</p>

<a name="183430638"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183430638" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183430638">Alex J. Best (Dec 14 2019 at 08:20)</a>:</h4>
<p>Is the 4.99s the old one or the one I modified? I think I got it down to 1.2s on my computer (a laptop) so if it's the modified one it could just be that your computer can't run lean that fast.</p>

<a name="183438888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183438888" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183438888">YH (Dec 14 2019 at 12:32)</a>:</h4>
<p>The old one.</p>

<a name="183452487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183452487" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183452487">YH (Dec 14 2019 at 18:31)</a>:</h4>
<p>The new one actually took 3.17 on my computer. (If it is CPU that matters then it is a 2.3 GHz Intel Core i7)</p>

<a name="183454894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183454894" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183454894">Kevin Buzzard (Dec 14 2019 at 19:33)</a>:</h4>
<p><span class="user-mention" data-user-id="249123">@YH</span> </p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">nnreal</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">rat</span>
<span class="kn">open</span> <span class="n">real</span> <span class="n">nnreal</span>

<span class="kn">lemma</span> <span class="n">ag2</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">≤</span> <span class="n">a</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="n">b</span> <span class="err">^</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">le_of_sub_nonneg</span><span class="o">,</span>
  <span class="n">convert</span> <span class="n">mul_self_nonneg</span> <span class="o">(</span><span class="n">a</span> <span class="bp">-</span> <span class="n">b</span><span class="o">),</span>
  <span class="n">ring</span>
<span class="kn">end</span>
</pre></div>

<a name="183454990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183454990" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183454990">Reid Barton (Dec 14 2019 at 19:35)</a>:</h4>
<p>also, IIRC, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mn>3</mn></msup><mo>+</mo><msup><mi>b</mi><mn>3</mn></msup><mo>+</mo><msup><mi>c</mi><mn>3</mn></msup><mo>−</mo><mn>3</mn><mi>a</mi><mi>b</mi><mi>c</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo>+</mo><mi>c</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>a</mi><mo>−</mo><mi>b</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><mi>b</mi><mo>−</mo><mi>c</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><mi>c</mi><mo>−</mo><mi>a</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^3 + b^3 + c^3 - 3abc = \frac 12 (a + b + c) ((a - b)^2 + (b - c)^2 + (c - a)^2)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord mathdefault">a</span><span class="mord mathdefault">b</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">c</span><span class="mclose">)</span><span class="mopen">(</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">c</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>

<a name="183455000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183455000" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183455000">Kevin Buzzard (Dec 14 2019 at 19:36)</a>:</h4>
<p>spoken like a true IMOer.</p>

<a name="183455140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183455140" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183455140">Kevin Buzzard (Dec 14 2019 at 19:38)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">):</span> <span class="n">a</span> <span class="err">^</span> <span class="mi">3</span> <span class="bp">+</span> <span class="n">b</span> <span class="err">^</span> <span class="mi">3</span> <span class="bp">+</span> <span class="n">c</span> <span class="err">^</span> <span class="mi">3</span> <span class="bp">-</span> <span class="mi">3</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">=</span>
<span class="mi">1</span> <span class="bp">/</span> <span class="mi">2</span> <span class="bp">*</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">+</span> <span class="n">c</span><span class="o">)</span> <span class="bp">*</span> <span class="o">((</span><span class="n">a</span> <span class="bp">-</span> <span class="n">b</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">b</span> <span class="bp">-</span> <span class="n">c</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">c</span> <span class="bp">-</span> <span class="n">a</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">ring</span>
</pre></div>

<a name="183455713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183455713" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183455713">Kevin Buzzard (Dec 14 2019 at 19:52)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">ag4</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">d</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="mi">4</span> <span class="bp">*</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">d</span><span class="o">)</span> <span class="bp">≤</span> <span class="n">a</span> <span class="err">^</span> <span class="mi">4</span> <span class="bp">+</span> <span class="n">b</span> <span class="err">^</span> <span class="mi">4</span> <span class="bp">+</span> <span class="n">c</span> <span class="err">^</span> <span class="mi">4</span> <span class="bp">+</span> <span class="n">d</span> <span class="err">^</span> <span class="mi">4</span> <span class="o">:=</span>
<span class="k">calc</span> <span class="mi">4</span> <span class="bp">*</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">d</span><span class="o">)</span>
     <span class="bp">=</span> <span class="mi">2</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">*</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">c</span> <span class="bp">*</span> <span class="n">d</span><span class="o">))</span> <span class="o">:</span> <span class="k">by</span> <span class="n">ring</span>
<span class="bp">...</span>  <span class="bp">≤</span> <span class="mi">2</span> <span class="bp">*</span> <span class="o">((</span><span class="n">a</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">c</span> <span class="bp">*</span> <span class="n">d</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">mul_le_mul_left</span> <span class="err">$</span> <span class="k">by</span> <span class="n">norm_num</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span> <span class="err">$</span> <span class="n">ag2</span> <span class="bp">_</span> <span class="bp">_</span>
<span class="bp">...</span>  <span class="bp">=</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">a</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">b</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">c</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">d</span> <span class="err">^</span> <span class="mi">2</span> <span class="o">:</span> <span class="k">by</span> <span class="n">ring</span>
<span class="bp">...</span>  <span class="bp">≤</span> <span class="o">(</span><span class="n">a</span> <span class="err">^</span> <span class="mi">2</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">b</span> <span class="err">^</span> <span class="mi">2</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span>     <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">c</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">d</span> <span class="err">^</span> <span class="mi">2</span> <span class="o">:</span> <span class="n">add_le_add_right</span> <span class="o">(</span><span class="n">ag2</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span> <span class="bp">_</span>
<span class="bp">...</span>  <span class="bp">≤</span> <span class="o">(</span><span class="n">a</span> <span class="err">^</span> <span class="mi">2</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">b</span> <span class="err">^</span> <span class="mi">2</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span>  <span class="bp">+</span> <span class="o">((</span><span class="n">c</span> <span class="err">^</span> <span class="mi">2</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">d</span> <span class="err">^</span> <span class="mi">2</span><span class="o">)</span> <span class="err">^</span> <span class="mi">2</span><span class="o">)</span> <span class="o">:</span> <span class="n">add_le_add_left</span> <span class="o">(</span><span class="n">ag2</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span> <span class="bp">_</span>
<span class="bp">...</span>  <span class="bp">=</span> <span class="n">a</span> <span class="err">^</span> <span class="mi">4</span> <span class="bp">+</span> <span class="n">b</span> <span class="err">^</span> <span class="mi">4</span> <span class="bp">+</span> <span class="n">c</span> <span class="err">^</span> <span class="mi">4</span> <span class="bp">+</span> <span class="n">d</span> <span class="err">^</span> <span class="mi">4</span> <span class="o">:</span> <span class="k">by</span> <span class="n">ring</span>
</pre></div>


<p>You can get <code>ag4</code> from <code>ag2</code> purely in calc mode</p>

<a name="183455795"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183455795" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183455795">Kevin Buzzard (Dec 14 2019 at 19:54)</a>:</h4>
<p>The trick is to know exactly what the <code>ring</code> tactic can and can't do. I switch between term mode proofs like <code>add_le_add_right (ag2 _ _) _</code> which corresponds to what a mathematician means when they say "now apply AG2 and we deduce that..."</p>

<a name="183455799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183455799" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183455799">Kevin Buzzard (Dec 14 2019 at 19:54)</a>:</h4>
<p>All the equalities I did with <code>ring</code> and on the other steps I moved as little as possible.</p>

<a name="183455837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183455837" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183455837">Kevin Buzzard (Dec 14 2019 at 19:55)</a>:</h4>
<p>@YH your <code>ag3</code> code compiles with no warnings about sorrys now <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>

<a name="183456493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Lean%20act%20slowly%20when%20proof%20gets%20long/near/183456493" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/25534Leanactslowlywhenproofgetslong.html#183456493">YH (Dec 14 2019 at 20:10)</a>:</h4>
<blockquote>
<p>also, IIRC, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mn>3</mn></msup><mo>+</mo><msup><mi>b</mi><mn>3</mn></msup><mo>+</mo><msup><mi>c</mi><mn>3</mn></msup><mo>−</mo><mn>3</mn><mi>a</mi><mi>b</mi><mi>c</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo>+</mo><mi>c</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>a</mi><mo>−</mo><mi>b</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><mi>b</mi><mo>−</mo><mi>c</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><mi>c</mi><mo>−</mo><mi>a</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^3 + b^3 + c^3 - 3abc = \frac 12 (a + b + c) ((a - b)^2 + (b - c)^2 + (c - a)^2)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord mathdefault">a</span><span class="mord mathdefault">b</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">c</span><span class="mclose">)</span><span class="mopen">(</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">c</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
</blockquote>
<p>Yeah I know this one. I just want to write a proof that can be generalized.</p>


{% endraw %}

{% include archive_update.html %}