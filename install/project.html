<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="https://leanprover-community.github.io//css/lean.css" >
  <link rel="shortcut icon" href="https://leanprover-community.github.io//img/favicon.ico">
  <link rel="search" type="application/opensearchdescription+xml" title="mathlib docs" href="https://leanprover-community.github.io//opensearch.xml">
  <link href="https://fonts.googleapis.com/css2?family=Merriweather&family=Open+Sans&family=Source+Code+Pro:wght@400;600&display=swap" rel="stylesheet">
    

	<script>
                function buildShortcutsForStructures(names) {
                        const o = {}
                        names.forEach(name => o[name] = `\\mathbb\{${name}\}`)
                        return o
                }
		MathJax = {
			  tex: {
                                  macros: {
                                          ...buildShortcutsForStructures(["R", "Q", "Z", "N", "C"]),
                                  },
				      inlineMath: [['$', '$'], ['\\(', '\\)']]
				    },
		};
	</script>
	<script type="text/javascript" id="MathJax-script" async
		  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
	</script>

	<title>Lean projects</title>
  </head>
  <body>
  <nav class="navbar navbar-expand-lg navbar-light bg-gradient-light d-md-none">
    <div class="d-flex flex-grow-1">
		<a class="navbar-brand" href="https://leanprover-community.github.io/index.html">Lean Community
    </a>
    </div>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  </nav>

<div id="mainbox">

  <main>
    
<h1 id="lean-projects" class="markdown-heading">Lean projects <a class="hover-link" href="#lean-projects">#</a></h1>
<p>After you have installed Lean, to use it you <em>must</em> create or download a Lean project.
The recommended way to create or install a project is within Visual Studio Code (VS Code).
Within VS Code, click on the <code>∀</code> symbol in the top right (which should be visible if
Lean is installed) and either select &quot;New Project&quot; or &quot;Open Project&quot;.</p>
<p>If you have not yet installed Lean, then the recommended way is to follow the instructions in
<a href="https://docs.lean-lang.org/lean4/doc/quickstart.html">the official Lean documentation</a>.</p>
<h2 id="why-a-project" class="markdown-heading">Why a project? <a class="hover-link" href="#why-a-project">#</a></h2>
<p>In general, if you just open a single <code>.lean</code> file in your text editor
and try to compile it with Lean, you'll get a bunch of confusing errors.
Every non-trivial piece of Lean code needs to live inside a <em>Lean project</em>
(sometimes also called a Lean package).
A &quot;Lean project&quot; is more than just a folder that you've named &quot;My Lean stuff&quot;.
Rather, it's a folder containing some very specific things:
in particular, a <em>git repository</em> and a file
<code>lakefile.lean</code> or <code>lakefile.toml</code> that gathers information about dependencies of the
project, including for instance the version of Lean that should be used.</p>
<h2 id="legacy-instructions" class="markdown-heading">Legacy instructions <a class="hover-link" href="#legacy-instructions">#</a></h2>
<p>These legacy instructions give a command-line explanation of how to install a project
manually.</p>
<p>If you're interested in contributing to mathlib you only need to set up
a Lean project once, which you can use for all your contributions —
you don't need to set up a new Lean project for each new contribution.</p>
<p>Setting up and managing all this is done by a program called <code>lake</code> (this is
a portmanteau of <code>lean</code> and <code>make</code>).
This page describes the basic use of this tool, and should be sufficient
for everyday use.
If this is not enough for your purposes, you can read the
full <a href="https://github.com/leanprover/lean4/blob/master/src/lake/README.md">lake documentation</a>.</p>
<h2 id="working-on-an-existing-project" class="markdown-heading">Working on an existing project <a class="hover-link" href="#working-on-an-existing-project">#</a></h2>
<p>Suppose you want to work on an existing project. As example, we will take
<a href="https://github.com/leanprover-community/mathematics_in_lean">the Mathematics in Lean book</a>.
Open a terminal.</p>
<ul>
<li>
<p>If you have not logged in since you installed Lean and mathlib, then
you may need to first type <code>source ~/.profile</code> or
<code>source ~/.bash_profile</code> depending on your OS.
If you are on Windows, and don't know how to do this, another option is to restart your computer.</p>
</li>
<li>
<p>Go the the directory where you would like this package to live. You do not need to create a new folder yourself, the next command will create a <code>mathematics_in_lean</code> subfolder for you.</p>
</li>
<li>
<p>Run <code>git clone https://github.com/leanprover-community/mathematics_in_lean.git</code>.</p>
</li>
<li>
<p>Run <code>cd mathematics_in_lean</code></p>
</li>
<li>
<p>Run <code>lake exe cache get</code> (note: this command currently only works in projects which import <code>mathlib4</code> as a dependency)</p>
</li>
<li>
<p>Launch VS Code, either through your application menu or by typing
<code>code .</code>. (MacOS users need to take a one-off
<a href="https://code.visualstudio.com/docs/setup/mac#_launching-from-the-command-line">extra step</a>
to be able to launch VS Code from the command line.)</p>
</li>
<li>
<p>If you launched VS Code from a menu, on the main screen, or in the File menu,
click &quot;Open folder&quot; (just &quot;Open&quot; on a Mac), and choose the folder
<code>mathematics_in_lean</code> (<em>not</em> one of its subfolders).</p>
</li>
<li>
<p>Using the file explorer on the left-hand side, explore everything you
want in <code>MIL</code>.
See the <a href="https://github.com/leanprover-community/mathematics_in_lean/blob/master/README.md">MIL instructions</a>
for advice about how to do the exercises in this book.</p>
</li>
</ul>
<h2 id="creating-a-lean-project" class="markdown-heading">Creating a Lean project <a class="hover-link" href="#creating-a-lean-project">#</a></h2>
<p>We will now create a new project depending on mathlib. The following
commands should be typed in a terminal.</p>
<ul>
<li>
<p>Go to a folder where you want to create a project in a subfolder
<code>my_project</code>, and type <code>lake +leanprover/lean4:nightly-2024-04-24 new my_project math</code>. Do not worry about the date in the previous command, it ensures you will use a sufficiently recent version of <code>lake</code> but has no impact on the version of <code>lean</code> your project will use. If you get an
error message saying <code>lake</code> is an unknown command and
you have not logged in since you installed Lean, then
you may need to first type <code>source ~/.profile</code> or <code>source ~/.bash_profile</code>.
The keyword <code>math</code> at the end of this command adds <code>mathlib4</code> to the dependencies of your project, so that you can use <code>import Mathlib</code> in your project files.</p>
</li>
<li>
<p>Go inside the <code>my_project</code> folder and type <code>lake update</code>.</p>
<ul>
<li>Windows users seeing a <code>curl: (35) schannel: next InitializeSecurityContext failed</code> error should read <a href="#troubleshooting">this note</a>.</li>
</ul>
</li>
<li>
<p>Launch VS Code, either through your application menu or by typing
the <code>code .</code> command.</p>
</li>
<li>
<p>If you launched VS Code through a menu: on the main screen, or in the
File menu, click &quot;Open folder&quot; (on a Mac, just &quot;Open&quot;), and
choose the folder <code>my_project</code> (<em>not</em> one of its subfolders).</p>
</li>
<li>
<p>Your Lean code should now be put inside files with extension <code>.lean</code>
living in <code>my_project/MyProject/</code> or a subfolder thereof. In the file explorer
on the left-hand side of VS Code, you can right-click on <code>MyProject</code>, choose
<code>New file</code>, and type a filename to create a file there.</p>
</li>
</ul>
<p>If you want to make sure everything is working, you can start by
creating, say <code>my_project/MyProject/Test.lean</code> containing:</p>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="n">Mathlib.Topology.Basic</span>

<span class="k">#check</span><span class="w"> </span><span class="n">TopologicalSpace</span>
</code></pre></div>
</div>

<p>When the cursor is on the last line, the right hand part of VS Code
should display a &quot;Lean Infoview&quot; area saying:
<code>TopologicalSpace.{u} (α : Type u) : Type u</code>.</p>
<p>Note that you can import your own files in the project. For instance if you created a
file <code>my_project/MyProject/Definitions.lean</code>, you can start a new file
<code>my_project/MyProject/Lemmas.lean</code> with <code>import MyProject.Definitions</code>.</p>
<p>If, for some reason, you happen to lose the &quot;Lean Infoview&quot; area, you
can get it back with <kbd>Ctrl</kbd>-<kbd>Shift</kbd>-<kbd>Enter</kbd>
(<kbd>Cmd</kbd>-<kbd>Shift</kbd>-<kbd>Enter</kbd> on MacOS).
Also, you can get the Lean documentation inside VS Code using
<kbd>Ctrl</kbd>-<kbd>Shift</kbd>-<kbd>p</kbd>
(<kbd>Cmd</kbd>-<kbd>Shift</kbd>-<kbd>p</kbd> on MacOS) and then,
inside the text field that appears, type &quot;lean doc&quot; and hit <kbd>Enter</kbd>.
Then click &quot;Mathematics in Lean&quot; or &quot;Theorem Proving in Lean&quot; and enjoy.</p>
<h2 id="updating-mathlib-in-your-project" class="markdown-heading">Updating Mathlib in your project <a class="hover-link" href="#updating-mathlib-in-your-project">#</a></h2>
<p>If you have a project depending on Mathlib, and you want to update to the latest version of Lean and Mathlib, you have to do two steps:</p>
<ul>
<li>Update the <code>lean-toolchain</code> file in your repository to the latest version. You can do this automatically by running the following in the root directory of your repository.</li>
</ul>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="n">curl</span><span class="w"> </span><span class="bp">-</span><span class="n">L</span><span class="w"> </span><span class="n">https</span><span class="o">:</span><span class="bp">//</span><span class="n">raw.githubusercontent.com</span><span class="bp">/</span><span class="n">leanprover</span><span class="bp">-</span><span class="n">community</span><span class="bp">/</span><span class="n">mathlib4</span><span class="bp">/</span><span class="n">master</span><span class="bp">/</span><span class="n">lean</span><span class="bp">-</span><span class="n">toolchain</span><span class="w"> </span><span class="bp">-</span><span class="n">o</span><span class="w"> </span><span class="n">lean</span><span class="bp">-</span><span class="n">toolchain</span>
</code></pre></div>
</div>

<ul>
<li>run <code>lake update</code>. This will update Lean, Mathlib and download the new Mathlib cache for you. (Note: on project that use <code>leanblueprint</code>/<code>doc-gen</code>, you currently have to run <code>lake -R -Kenv=dev update</code>).</li>
</ul>
<p>You should then check whether all files in your repository still compile.
You can do this by running <code>lake exe mk_all &amp;&amp; lake build</code>.</p>
<p>More information about Lake can be found <a href="https://github.com/leanprover/lean4/tree/master/src/lake">here</a>.</p>
<h2 id="contributing-to-mathlib" class="markdown-heading">Contributing to mathlib <a class="hover-link" href="#contributing-to-mathlib">#</a></h2>
<p>See <a href="https://leanprover-community.github.io/contribute/index.html">How to contribute to mathlib</a>.</p>
<h2 id="troubleshooting" class="markdown-heading">Troubleshooting <a class="hover-link" href="#troubleshooting">#</a></h2>
<ul>
<li>Some Windows users have reported an error like this when running <code>lake exe cache get</code>:</li>
</ul>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="w">  </span><span class="n">curl</span><span class="o">:</span><span class="w"> </span><span class="o">(</span><span class="mi">35</span><span class="o">)</span><span class="w"> </span><span class="n">schannel</span><span class="o">:</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">InitializeSecurityContext</span><span class="w"> </span><span class="n">failed</span><span class="o">:</span><span class="w"> </span><span class="n">Unknown</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">(</span><span class="mi">0x80092012</span><span class="o">)</span><span class="w"> </span><span class="bp">-</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">revocation</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">unable</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">revocation</span><span class="w"> </span><span class="n">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">certificate</span>
</code></pre></div>
</div>

<p>If you see this error, you likely have an antivirus program that scans each downloaded file, which results in errors.
Please disable your antivirus program and then run <code>lake exe cache get!</code>.
The exclamation mark forces <code>lake</code> to re-download the cache files it failed to download before running this command.
(If you are uncomfortable disabling your antivirus, try to follow <a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/lake.20exe.20cache.20get.20errors/near/389019448">these instructions</a>
and then run <code>lake exe cache get!</code>).
You can turn on your antivirus program on afterwards.
However, some users also reported that the antivirus programs significantly slow down Lean during normal usage.
If Lean is slower than what is expected, either turn off your antivirus program or tell it to ignore/allow the operation of <code>lean.exe</code>.</p>
<ul>
<li>Sometimes under Windows a corrupted version of Lean is downloaded while installing/updating Lean. If this happens, this will result in an error</li>
</ul>
<div class="codehilite"><div class="codehilite"><pre><span></span><code><span class="n">uncaught</span><span class="w"> </span><span class="n">exception</span><span class="o">:</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="o">(</span><span class="n">error</span><span class="w"> </span><span class="n">code</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="o">)</span>
</code></pre></div>
</div>

<p>If this happens, you can manually delete your corrupted version of Lean by following the following two steps:</p>
<ul>
<li>Go to your user folder and navigate to <code>.elan &gt; toolchains</code> (typically <code>C:\Users\&lt;username&gt;\.elan\toolchains</code>), and delete the offending toolchain</li>
<li>Go to <code>.elan &gt; update-hashes</code> (e.g. <code>C:\Users\&lt;username&gt;\.elan\update-hashes</code>) and delete the file with the same name.
The toolchain will be automatically redownloaded the next time you call <code>lake update</code>, <code>lake exe cache get</code>, <code>lake build</code> or open a Lean file in VSCode in a repository that uses that toolchain.</li>
</ul>
<ul>
<li>If you would like to cleanup Lean files, these are stored in the following places.
<ul>
<li>Dependencies of a project are in the <code>.lake</code> folder of that project.</li>
<li>Lean toolchains are stored in <code>~/.elan/toolchains</code>. You can safely delete old toolchains from here. Whenever you delete toolchains, you should also delete the corresponding files from <code>~/.elan/update-hashes</code>.</li>
<li>Compressed and compiled Mathlib files are stored in <code>~/.cache/mathlib</code>. These can be safely deleted.</li>
<li>Lean 3 users might still have a folder <code>.mathlib</code> in their user directory.</li>
</ul>
</li>
</ul>

  </main>

    <nav id="navbar" class="d-md-block bg-light sidebar collapse navbar-light pb-4">
      <div class="d-none d-md-block mt-4"><a class="navbar-brand" href="https://leanprover-community.github.io/index.html">Lean Community</a></div>
      
        <h6 class="sidebar-heading mt-4">Community</h6>
        <ul class="nav">
          <li class="nav-item col-12"><a href="https://leanprover.zulipchat.com/">Zulip chat</a></li>
        
          <li class="nav-item col-12"><a href="https://github.com/leanprover-community/mathlib4">GitHub</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/blog">Blog</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/meet.html">Community information</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/meet.html#community-guidelines">Community guidelines</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/teams.html">Teams</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/papers.html">Papers about Lean</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/lean_projects.html">Projects using Lean</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/teaching/index.html">Teaching using Lean</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/events.html">Events</a></li>
        </ul>
      
        <h6 class="sidebar-heading mt-4">Installation</h6>
        <ul class="nav">
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/get_started.html">Get started</a></li>
        
          <li class="nav-item col-12"><a href="https://live.lean-lang.org/">Online version (no installation)</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/install/project.html">Using Lake (build system)</a></li>
        </ul>
      
        <h6 class="sidebar-heading mt-4">Documentation</h6>
        <ul class="nav">
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/learn.html">Learning resources (start here)</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/mathlib4_docs">API documentation</a></li>
        
          <li class="nav-item col-12"><a href="https://loogle.lean-lang.org/">Declaration search (Loogle)</a></li>
        
          <li class="nav-item col-12"><a href="https://lean-lang.org/doc/reference/latest/">Language reference</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/mathlib-manual/html-multi/">Tactic list</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/extras/calc.html">Calc mode</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/extras/conv.html">Conv mode</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/extras/simp.html">Simplifier</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/extras/well_founded_recursion.html">Well-founded recursion</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/extras/speedup.html">Speeding up Lean files</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/extras/pitfalls.html">Pitfalls and common mistakes</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/mwe.html">About MWEs</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/glossary.html">Glossary</a></li>
        </ul>
      
        <h6 class="sidebar-heading mt-4">Library overviews</h6>
        <ul class="nav">
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/mathlib-overview.html">Library overview</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/undergrad.html">Undergraduate maths</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/100.html">Wiedijk's 100 theorems</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/1000.html">1000+ theorems</a></li>
        </ul>
      
        <h6 class="sidebar-heading mt-4">Theories</h6>
        <ul class="nav">
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/theories/naturals.html">Natural Numbers</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/theories/linear_algebra.html">Linear Algebra</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/theories/sets.html">Sets and finite sets</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/theories/topology.html">Topology</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/theories/category_theory.html">Category Theory</a></li>
        </ul>
      
        <h6 class="sidebar-heading mt-4">Contributing</h6>
        <ul class="nav">
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/contribute/index.html">Pull request lifecycle</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/contribute/git.html">Git Guide for Mathlib4 Contributors</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/contribute/naming.html">Naming conventions</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/contribute/style.html">Code style guideline</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/contribute/doc.html">Documentation style</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/contribute/commit.html">Commit conventions</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/contribute/pr-review.html">Pull request review guide</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/mathlib_stats.html">Contribution statistics</a></li>
        
          <li class="nav-item col-12"><a href="https://leanprover-community.github.io/contribute/tags_and_branches.html">Tags and branches</a></li>
        </ul>
      
    </nav>

</div>


  <nav class="footer navbar navbar-expand-lg navbar-light bg-light justify-content-end">
  <ul class="nav">
    <li class="nav-item">
      <a class="nav-link active" href="https://github.com/leanprover-community/leanprover-community.github.io/blob/lean4/templates/install/project.md">Suggest edits to this page on GitHub</a>
    </li>
  </ul>
  </nav>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous"></script>
    <script src="https://leanprover-community.github.io//js/bootstrap.min.js"></script>
    <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
      mermaid.initialize({ startOnLoad: true });
    </script>
    
  </body>
</html>